{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u6587\u7ae0\u5217\u8868 \u5584\u72691 \u4e00\u4e9b\u5b9e\u7528\u7684\u547d\u4ee4(\u6301\u7eed\u66f4\u65b0) \u5584\u72692 \u89e3\u51b3ssh\u8fde\u63a5\u670d\u52a1\u5668\u6389\u7ebf\u95ee\u9898 \u5165\u95e8\u7cfb\u52171 \u5982\u4f55\u521b\u5efa\u670d\u52a1\u5668\u5e76\u7528\u547d\u4ee4\u884c\u767b\u5f55 \u5165\u95e8\u7cfb\u52172 \u5982\u4f55\u7ed9\u5206\u6790\u670d\u52a1\u5668\u6253(\u4e0a)\u955c(\u4fdd)\u50cf(\u9669) \u5165\u95e8\u7cfb\u52173 \u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb \u5165\u95e8\u7cfb\u52174 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-Web\u754c\u9762 \u5165\u95e8\u7cfb\u52175 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-\u547d\u4ee4\u884cCLI \u5165\u95e8\u7cfb\u52176 \u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e \u5165\u95e8\u7cfb\u52177 \u52a0\u901f\uff01\u4e3aEC2\u548cS3\u4e4b\u95f4\u642d\u5efa\u7231\u7684\u6865\u6881 \u5165\u95e8\u7cfb\u52178 EC2\u201c\u7ea2\u674f\u51fa\u5899\u201d\u963f\u91cc\u4e91OSS \u5165\u95e8\u7cfb\u52179 \u795e\u5668EFS\u7ec8\u4e8e\u6765\u4e86\uff01\u5f39\u6027\u5171\u4eab\u5b58\u50a8\uff01 \u5165\u95e8\u7cfb\u521710 \u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d\uff1f\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\u5e76\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\uff01 \u5165\u95e8\u7cfb\u521711 \u5982\u4f55\u8c03\u6574 EC2 \u914d\u7f6e\u548c EBS \u78c1\u76d8\u5927\u5c0f \u5165\u95e8\u7cfb\u521712 \u7528\u811a\u672c\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807 \u5165\u95e8\u7cfb\u521713 \u7528CW\u4ee3\u7406\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807(\u63a8\u8350) \u5165\u95e8\u7cfb\u521714 \u798f\u97f3\uff01\u7528\u597dAWS\u516c\u5f00\u6570\u636e\u96c6 \u5165\u95e8\u7cfb\u521715 \u96c6\u4e2d\u5f0f\u5907\u4efd\u7ba1\u7406\u670d\u52a1AWS Backup \u5165\u95e8\u7cfb\u521716 \u901a\u8fc7\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\u663e\u8457\u964d\u4f4e\u6210\u672c \u9ad8\u9636\u7cfb\u52171 \u4f7f\u7528aws cli\u4e3aEBS\u81ea\u52a8\u521b\u5efa\u5feb\u7167 \u9ad8\u9636\u7cfb\u52172 \u9ad8\u80fd\uff01\u5b9e\u73b0\u5168\u81ea\u52a8EBS\u5907\u4efd \u9ad8\u9636\u7cfb\u52173 BAM\u6587\u4ef6\u653e\u4e91\u4e0a\u597d\u4e86\uff0c\u672c\u5730IGV\u5f88\u65b9\u4fbf \u9ad8\u9636\u7cfb\u52174 10\u5206\u949f\u4e00\u952e\u521b\u5efaHPC\u96c6\u7fa4-pcluster \u9ad8\u9636\u7cfb\u52175 \u5bb9\u5668\uff01\u5229\u5668\uff01AWS Batch\u6279\u91cf\u8ba1\u7b97 \u9ad8\u9636\u7cfb\u52176 \u6784\u5efa\u57fa\u4e8eBatch\u548cwdl\u8bed\u8a00\u7684\u5206\u6790\u6d41\u7a0b \u9ad8\u9636\u7cfb\u52177 Kubernetes on AWS - EKS \u670d\u52a1 \u9ad8\u9636\u7cfb\u52178 \u9f20\u6807\u515a\u798f\u97f3\uff01\u7ed9EC2\u5b89\u88c5\u684c\u9762GUI \u5c3e\u7259 2020\u7684\u6700\u540e\u4e00\u5929","title":"\u6587\u7ae0"},{"location":"#_1","text":"\u5584\u72691 \u4e00\u4e9b\u5b9e\u7528\u7684\u547d\u4ee4(\u6301\u7eed\u66f4\u65b0) \u5584\u72692 \u89e3\u51b3ssh\u8fde\u63a5\u670d\u52a1\u5668\u6389\u7ebf\u95ee\u9898 \u5165\u95e8\u7cfb\u52171 \u5982\u4f55\u521b\u5efa\u670d\u52a1\u5668\u5e76\u7528\u547d\u4ee4\u884c\u767b\u5f55 \u5165\u95e8\u7cfb\u52172 \u5982\u4f55\u7ed9\u5206\u6790\u670d\u52a1\u5668\u6253(\u4e0a)\u955c(\u4fdd)\u50cf(\u9669) \u5165\u95e8\u7cfb\u52173 \u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb \u5165\u95e8\u7cfb\u52174 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-Web\u754c\u9762 \u5165\u95e8\u7cfb\u52175 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-\u547d\u4ee4\u884cCLI \u5165\u95e8\u7cfb\u52176 \u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e \u5165\u95e8\u7cfb\u52177 \u52a0\u901f\uff01\u4e3aEC2\u548cS3\u4e4b\u95f4\u642d\u5efa\u7231\u7684\u6865\u6881 \u5165\u95e8\u7cfb\u52178 EC2\u201c\u7ea2\u674f\u51fa\u5899\u201d\u963f\u91cc\u4e91OSS \u5165\u95e8\u7cfb\u52179 \u795e\u5668EFS\u7ec8\u4e8e\u6765\u4e86\uff01\u5f39\u6027\u5171\u4eab\u5b58\u50a8\uff01 \u5165\u95e8\u7cfb\u521710 \u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d\uff1f\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\u5e76\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\uff01 \u5165\u95e8\u7cfb\u521711 \u5982\u4f55\u8c03\u6574 EC2 \u914d\u7f6e\u548c EBS \u78c1\u76d8\u5927\u5c0f \u5165\u95e8\u7cfb\u521712 \u7528\u811a\u672c\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807 \u5165\u95e8\u7cfb\u521713 \u7528CW\u4ee3\u7406\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807(\u63a8\u8350) \u5165\u95e8\u7cfb\u521714 \u798f\u97f3\uff01\u7528\u597dAWS\u516c\u5f00\u6570\u636e\u96c6 \u5165\u95e8\u7cfb\u521715 \u96c6\u4e2d\u5f0f\u5907\u4efd\u7ba1\u7406\u670d\u52a1AWS Backup \u5165\u95e8\u7cfb\u521716 \u901a\u8fc7\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\u663e\u8457\u964d\u4f4e\u6210\u672c \u9ad8\u9636\u7cfb\u52171 \u4f7f\u7528aws cli\u4e3aEBS\u81ea\u52a8\u521b\u5efa\u5feb\u7167 \u9ad8\u9636\u7cfb\u52172 \u9ad8\u80fd\uff01\u5b9e\u73b0\u5168\u81ea\u52a8EBS\u5907\u4efd \u9ad8\u9636\u7cfb\u52173 BAM\u6587\u4ef6\u653e\u4e91\u4e0a\u597d\u4e86\uff0c\u672c\u5730IGV\u5f88\u65b9\u4fbf \u9ad8\u9636\u7cfb\u52174 10\u5206\u949f\u4e00\u952e\u521b\u5efaHPC\u96c6\u7fa4-pcluster \u9ad8\u9636\u7cfb\u52175 \u5bb9\u5668\uff01\u5229\u5668\uff01AWS Batch\u6279\u91cf\u8ba1\u7b97 \u9ad8\u9636\u7cfb\u52176 \u6784\u5efa\u57fa\u4e8eBatch\u548cwdl\u8bed\u8a00\u7684\u5206\u6790\u6d41\u7a0b \u9ad8\u9636\u7cfb\u52177 Kubernetes on AWS - EKS \u670d\u52a1 \u9ad8\u9636\u7cfb\u52178 \u9f20\u6807\u515a\u798f\u97f3\uff01\u7ed9EC2\u5b89\u88c5\u684c\u9762GUI \u5c3e\u7259 2020\u7684\u6700\u540e\u4e00\u5929","title":"\u6587\u7ae0\u5217\u8868"},{"location":"about/","text":"\u6b22\u8fce\u6295\u7a3f \u5982\u679c\u4f60\u613f\u610f\u5206\u4eab\u4f60\u7684\u5b9d\u8d35\u7ecf\u9a8c\uff0c\u6b22\u8fce\u5206\u4eab: md\u6587\u4ef6 + \u76f8\u5173\u56fe\u7247, \u6253\u5305\u53d1\u5230\u672cB\u7ad9\u90ae\u7bb1\uff0c\u5e76\u5728\u7fa4\u91cc\u63d0\u9192\u7ad9\u957f\u8d77\u5e8a~ B\u7ad9\u90ae\u7bb1: 22342969@qq.com \u4e0d\u77e5\u9053\u600e\u4e48\u5199\uff1f \u7537\u751f\u70b9\u8fd9\u91cc \u5973\u751f\u627e\u7ad9\u957f \u79ef\u6781\u6295\u7a3f\u8005\u4f1a\u6536\u5230\u4e0d\u5b9a\u671f\u7ea6\u996d\u9080\u8bf7+\u795e\u79d8\u793c\u7269+\u5e74\u5ea6\u9881\u5956 \u5173\u4e8e\u672c\u7ad9 \u5b87\u5b99\u65e0\u654c \u5f00\u5929\u8f9f\u5730 \u9b3c\u795e\u83ab\u6d4b \u5173\u4e8e\u7ad9\u957f \u8fd9\u4e2a\u4eba\u5f88\u61d2","title":"\u5173\u4e8e\u6b64\u7ad9"},{"location":"about/#_1","text":"\u5982\u679c\u4f60\u613f\u610f\u5206\u4eab\u4f60\u7684\u5b9d\u8d35\u7ecf\u9a8c\uff0c\u6b22\u8fce\u5206\u4eab: md\u6587\u4ef6 + \u76f8\u5173\u56fe\u7247, \u6253\u5305\u53d1\u5230\u672cB\u7ad9\u90ae\u7bb1\uff0c\u5e76\u5728\u7fa4\u91cc\u63d0\u9192\u7ad9\u957f\u8d77\u5e8a~ B\u7ad9\u90ae\u7bb1: 22342969@qq.com \u4e0d\u77e5\u9053\u600e\u4e48\u5199\uff1f \u7537\u751f\u70b9\u8fd9\u91cc \u5973\u751f\u627e\u7ad9\u957f \u79ef\u6781\u6295\u7a3f\u8005\u4f1a\u6536\u5230\u4e0d\u5b9a\u671f\u7ea6\u996d\u9080\u8bf7+\u795e\u79d8\u793c\u7269+\u5e74\u5ea6\u9881\u5956","title":"\u6b22\u8fce\u6295\u7a3f"},{"location":"about/#_2","text":"\u5b87\u5b99\u65e0\u654c \u5f00\u5929\u8f9f\u5730 \u9b3c\u795e\u83ab\u6d4b","title":"\u5173\u4e8e\u672c\u7ad9"},{"location":"about/#_3","text":"\u8fd9\u4e2a\u4eba\u5f88\u61d2","title":"\u5173\u4e8e\u7ad9\u957f"},{"location":"head/","text":"\u6b22\u8fce\u6765\u5230BioAWS\u6280\u672f\u7ad9 \u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u5206\u4eab\u751f\u7269\u4fe1\u606f\u6280\u672f\u5728AWS\u4e0a\u7684\u4f7f\u7528\u7ecf\u9a8c\u3002 \u6587\u7ae0\u5217\u8868","title":"\u9996\u9875"},{"location":"head/#bioaws","text":"\u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u5206\u4eab\u751f\u7269\u4fe1\u606f\u6280\u672f\u5728AWS\u4e0a\u7684\u4f7f\u7528\u7ecf\u9a8c\u3002 \u6587\u7ae0\u5217\u8868","title":"\u6b22\u8fce\u6765\u5230BioAWS\u6280\u672f\u7ad9"},{"location":"template/","text":"[TIPS] \u89e3\u51b3ssh\u8fde\u63a5EC2\u603b\u662f\u6389\u7684\u95ee\u9898 \u6211\u4eec\u90fd\u7ecf\u5386\u8fc7ssh\u8fde\u4e0a\u670d\u52a1\u5668\uff0c\u8fc7\u6bb5\u65f6\u95f4\u6ca1\u64cd\u4f5c\uff0c\u5c31\u81ea\u52a8\u65ad\u5f00\u4e86\uff0c\u6709\u65f6\u5019\u53ef\u80fd\u662f\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4fee\u6539\u4ee3\u7801\uff0c\u4e00\u4e0b\u5b50\u50bb\u4e86\uff0c\u5f53\u7136\u6211\u4eec\u4e0d\u63a8\u8350\u957f\u65f6\u95f4\u5728\u7ebf\u4fee\u6539\u4ee3\u7801\uff1a\uff09 -- D.C OpenSSH\u57fa\u4e8e\u5b89\u5168\u7684\u7406\u7531\uff0c\u5982\u679c\u7528\u6237\u8fde\u7ebf\u5230SSH Server\u540e\u95f2\u7f6e\u4e00\u6bb5\u65f6\u95f4\uff0cSSH Server\u4f1a\u5728\u8d85\u8fc7\u7279\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u7ec8\u6b62SSH\u8fde\u7ebf\u3002 \u4ee5\u4e0b\u65b9\u6cd5\uff0c\u4e2a\u4eba\u63a8\u8350\u7b2c2,3\u79cd\uff0c\u4fee\u6539\u6bcf\u53f0\u670d\u52a1\u5668\u771f\u7684\u5f88\u70e6\u5167~ \u65b9\u6cd51-\u4fee\u6539\u670d\u52a1\u5668\u7684sshd config \u8fdb\u5230ssh\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u53d1\u73b0\u6709ssh_config\u548csshd_config\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\u4e8c\u8005\u533a\u522b\u5728\u4e8e\uff0cssh_config\u662f\u9488\u5bf9\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0csshd_config\u5219\u662f\u9488\u5bf9\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u3002 $ cd /etc/ssh $ sudo vi /etc/ssh/sshd_config \u627e\u5230\u5185\u5bb9\uff0c\u53bb\u6389\u6ce8\u91ca\u5e76\u4fee\u6539\u5982\u4e0b\uff1a # \u5ba2\u6237\u7aef\u6bcf\u9694\u591a\u5c11\u79d2\u5411\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\u6570\u636e ClientAliveInterval 30 # \u8868\u793a\u4e0a\u8ff0\u591a\u5c11\u6b21\u5fc3\u8df3\u65e0\u54cd\u5e94\u4e4b\u540e\uff0c\u4f1a\u8ba4\u4e3aClient\u5df2\u7ecf\u65ad\u5f00\u3002 ClientAliveCountMax 1800 \u4fdd\u5b58\u5e76\u91cd\u542f\u670d\u52a1\u3002 $ service sshd restart \u65b9\u6cd52-\u4fee\u6539\u672c\u673a\u7684ssh_config \u6253\u5f00\u672c\u673a\u7684ssh_config\u6587\u4ef6\u3002 sudo vi /etc/ssh/ssh_config \u6dfb\u52a0\u5185\u5bb9\u5982\u4e0b\uff1a TCPKeepAlive=yes ServerAliveInterval 60 ServerAliveCountMax 600 StrictHostKeyChecking no ForwardAgent yes Compression yes \u4fdd\u5b58\uff0c\u91cd\u8fdeec2\u3002 \u65b9\u6cd53- \u5229\u7528\u5ba2\u6237\u7aef\u7684\u53cd\u65ad\u5f00\u529f\u80fd\uff08windows\uff09 MobaXterm: edit session - Advanced SSH settings - \u9009\u4e2d Do not exit after command ends \u3002 gitbash\uff1a\u4fee\u6539 C:\\Program Files\\Git\\etc\\ssh\\ssh_config \u3002 secureCRT\uff1a\u4f1a\u8bdd\u9009\u9879 - \u7ec8\u7aef - \u53cd\u7a7a\u95f2 - \u53d1\u9001NO-OP\u6bcfxxx\u79d2\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 putty\uff1aConnection - Seconds between keepalive(0 to turn off)\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 iTerm2\uff1aprofiles - sessions - When idle - send ASCII code. XShell\uff1asession properties - connection - Keep Alive - Send keep alive message while this session connected. Interval [xxx] sec. Always ask yourself lonely: what's the fact?","title":"[TIPS] \u89e3\u51b3ssh\u8fde\u63a5EC2\u603b\u662f\u6389\u7684\u95ee\u9898"},{"location":"template/#tips-sshec2","text":"\u6211\u4eec\u90fd\u7ecf\u5386\u8fc7ssh\u8fde\u4e0a\u670d\u52a1\u5668\uff0c\u8fc7\u6bb5\u65f6\u95f4\u6ca1\u64cd\u4f5c\uff0c\u5c31\u81ea\u52a8\u65ad\u5f00\u4e86\uff0c\u6709\u65f6\u5019\u53ef\u80fd\u662f\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4fee\u6539\u4ee3\u7801\uff0c\u4e00\u4e0b\u5b50\u50bb\u4e86\uff0c\u5f53\u7136\u6211\u4eec\u4e0d\u63a8\u8350\u957f\u65f6\u95f4\u5728\u7ebf\u4fee\u6539\u4ee3\u7801\uff1a\uff09 -- D.C OpenSSH\u57fa\u4e8e\u5b89\u5168\u7684\u7406\u7531\uff0c\u5982\u679c\u7528\u6237\u8fde\u7ebf\u5230SSH Server\u540e\u95f2\u7f6e\u4e00\u6bb5\u65f6\u95f4\uff0cSSH Server\u4f1a\u5728\u8d85\u8fc7\u7279\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u7ec8\u6b62SSH\u8fde\u7ebf\u3002 \u4ee5\u4e0b\u65b9\u6cd5\uff0c\u4e2a\u4eba\u63a8\u8350\u7b2c2,3\u79cd\uff0c\u4fee\u6539\u6bcf\u53f0\u670d\u52a1\u5668\u771f\u7684\u5f88\u70e6\u5167~","title":"[TIPS] \u89e3\u51b3ssh\u8fde\u63a5EC2\u603b\u662f\u6389\u7684\u95ee\u9898"},{"location":"template/#1-sshd-config","text":"\u8fdb\u5230ssh\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u53d1\u73b0\u6709ssh_config\u548csshd_config\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\u4e8c\u8005\u533a\u522b\u5728\u4e8e\uff0cssh_config\u662f\u9488\u5bf9\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0csshd_config\u5219\u662f\u9488\u5bf9\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u3002 $ cd /etc/ssh $ sudo vi /etc/ssh/sshd_config \u627e\u5230\u5185\u5bb9\uff0c\u53bb\u6389\u6ce8\u91ca\u5e76\u4fee\u6539\u5982\u4e0b\uff1a # \u5ba2\u6237\u7aef\u6bcf\u9694\u591a\u5c11\u79d2\u5411\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\u6570\u636e ClientAliveInterval 30 # \u8868\u793a\u4e0a\u8ff0\u591a\u5c11\u6b21\u5fc3\u8df3\u65e0\u54cd\u5e94\u4e4b\u540e\uff0c\u4f1a\u8ba4\u4e3aClient\u5df2\u7ecf\u65ad\u5f00\u3002 ClientAliveCountMax 1800 \u4fdd\u5b58\u5e76\u91cd\u542f\u670d\u52a1\u3002 $ service sshd restart","title":"\u65b9\u6cd51-\u4fee\u6539\u670d\u52a1\u5668\u7684sshd config"},{"location":"template/#2-ssh_config","text":"\u6253\u5f00\u672c\u673a\u7684ssh_config\u6587\u4ef6\u3002 sudo vi /etc/ssh/ssh_config \u6dfb\u52a0\u5185\u5bb9\u5982\u4e0b\uff1a TCPKeepAlive=yes ServerAliveInterval 60 ServerAliveCountMax 600 StrictHostKeyChecking no ForwardAgent yes Compression yes \u4fdd\u5b58\uff0c\u91cd\u8fdeec2\u3002","title":"\u65b9\u6cd52-\u4fee\u6539\u672c\u673a\u7684ssh_config"},{"location":"template/#3-windows","text":"MobaXterm: edit session - Advanced SSH settings - \u9009\u4e2d Do not exit after command ends \u3002 gitbash\uff1a\u4fee\u6539 C:\\Program Files\\Git\\etc\\ssh\\ssh_config \u3002 secureCRT\uff1a\u4f1a\u8bdd\u9009\u9879 - \u7ec8\u7aef - \u53cd\u7a7a\u95f2 - \u53d1\u9001NO-OP\u6bcfxxx\u79d2\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 putty\uff1aConnection - Seconds between keepalive(0 to turn off)\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 iTerm2\uff1aprofiles - sessions - When idle - send ASCII code. XShell\uff1asession properties - connection - Keep Alive - Send keep alive message while this session connected. Interval [xxx] sec. Always ask yourself lonely: what's the fact?","title":"\u65b9\u6cd53- \u5229\u7528\u5ba2\u6237\u7aef\u7684\u53cd\u65ad\u5f00\u529f\u80fd\uff08windows\uff09"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/","text":"10\u5206\u949f\u4e00\u952e\u521b\u5efaHPC\u96c6\u7fa4-pcluster (parallelcluster) brief introduction of pcluster on aws -- D.C \u4fd7\u8bdd\u8bf4\u7684\u597d\uff0c\u6ca1\u56fe\u8bf4\u4e2a\u57fa\u9738 \u597d\u8bdd\u8bf4\u524d\u5934 \u5bf9\u751f\u4fe1\u6765\u8bf4\uff0c\u7b2c\u4e00\u6b65\u4e0d\u662f\u5f80\u4e0b\u770b\uff0c\u800c\u662f\u627e\u5230\u6b63\u786e\u7684 AMI , \u8fd9\u4e2a\u955c\u50cf\u5e94\u8be5\u662f\u9884\u88c5\u597d\u4e86pcluster\u76f8\u5173\u5fc5\u8981\u7ec4\u4ef6\u7684\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65 \u81f3\u5173\u91cd\u8981 \u3002 pcluster\u7684\u7248\u672c\uff08\u76ee\u524d\u662f2.7.0\uff09\u5bf9\u5e94\u4e0d\u540c\u7684ami\uff0c\u6240\u4ee5\u4e5f\u8981\u533a\u5206\u6e05\u695a,\u5728\u521b\u5efaec2\u754c\u9762\u7684\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u53ef\u4ee5\u641c\u7d22 parallelcluster-2.7.0 ,\u76ee\u524d\u7684\u8bb0\u5f55\u663e\u793a\u670941\u4e2a\u76f8\u5173\u7684ami,\u6839\u636e\u4f60\u60f3\u8981\u7684\u64cd\u4f5c\u7cfb\u7edf\u8bb0\u4e0b\u5bf9\u5e94\u7684ami ID\u3002\u4e0d\u540cregion\u7684ami id\u4e5f\u4e0d\u540c\u3002 \u4e3e\u4f8b\uff1a pcluster \u7248\u672c \u7cfb\u7edf \u5b81\u590f\u533aami \u5317\u4eac\u533aami 2.5.1 ubuntu ami-0202652c7cb199eb6 ami-00881ffc995032786 2.5.1 linux ami-05038e0c41061b799 ami-0bbadb6ff64415ab3 2.5.1 ubuntu ami-0b0ebbfcd0c50f225 ami-0d3a6e7dd85085042 \u672c\u6587\u4f1a\u6d89\u53ca\u5230\u591a\u53f0\u673a\u5668\uff1a \u540d\u79f0 \u8bf4\u660e \u6a21\u677f\u673a \u4ece\u5b98\u65b9\u7684pcluster\u955c\u50cf\u542f\u52a8\uff0c\u5b89\u88c5\u7528\u6237\u81ea\u5df1\u7684\u8f6f\u4ef6\u540e\uff0c\u6253\u5305\u6210\u5206\u6790\u955c\u50cfAMI \u63a7\u5236\u673a \u4e0d\u9700\u8981\u4ece\u955c\u50cf\u542f\u52a8\uff0c\u7528\u4e8e\u5b89\u88c5pcluster\u547d\u4ee4\uff0c\u7528\u4e8e\u63a7\u5236\u96c6\u7fa4 \u4e3b\u8282\u70b9 \u7528\u4e8e\u8c03\u5ea6\u96c6\u7fa4\u4f5c\u4e1a\u7684\u8282\u70b9 \u8ba1\u7b97\u8282\u70b9 \u7528\u4e8e\u5206\u6790\u8ba1\u7b97\u7684\u8282\u70b9 [\u5fc5\u8bfb] \u521b\u5efa\u5206\u6790\u955c\u50cf \u5f00\u4e00\u53f0ec2\u4f5c\u4e3a \u6a21\u677f\u673a \uff08\u5982t2.micro\uff09\uff0c\u9009\u62e9\u4eceparallelcluster\u7684\u5b98\u65b9ami\u542f\u52a8 [\u5982aws-parallelcluster-2.7.0-amzn-hvm-202005172030 (ami-0c7a09bc17088086c)] \u5c06\u6211\u7684\u5206\u6790\u6d41\u7a0b\u90e8\u7f72\u5728\u8fd9\u53f0\u6a21\u677f\u673a\u4e0a\uff0c\u518d\u57fa\u4e8e \u8fd9\u53f0ec2 \u6253\u4e00\u4e2a\u65b0\u7684ami\uff0c\u62ff\u5230\u8fd9\u4e2a\u65b0\u7684ami id (\u5982ami-xxxxxxxxxxxxxx)\uff0c\u8fd9\u4e2aAMI\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u4e3apcluster\u96c6\u7fa4\u7684\u542f\u52a8ami,\u5bf9\u5e94\u4e0b\u9762template\u91cc\u9762\u7684custom_ami\u3002 \u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528parallelcluster\u4e00\u952e\u96c6\u7fa4\u7684\u529f\u80fd\uff0c\u9700\u8981\u4fdd\u8bc1 \u63a7\u5236\u670d\u52a1\u5668\u5b89\u88c5\u7684parallelcluster\u7248\u672c \u548c \u90e8\u7f72\u5206\u6790\u6d41\u7a0b\uff08\u7684\u6a21\u677f\u673a\uff09\u9009\u62e9ami\u7684parallelcluster\u7248\u672c \u90fd\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002\u5982\u90fd\u662f2.7.0\u7248\u672c\u3002 \u6240\u4ee5\u6d41\u7a0b\u5927\u81f4\u662f\uff1a \u539f\u59cbpcluster\u5b98\u65b9\u955c\u50cf\uff08ami-0c7a09bc17088086c\uff09 --> \u542f\u52a8\u6a21\u677f\u673a --> \u5b89\u88c5\u5206\u6790\u6d41\u7a0b --> custom_ami \u63a7\u5236\u673a(\u9ed8\u8ba4Amazon Linux 2 AMI) --> \u5b89\u88c5pcluster\u8f6f\u4ef6 --> \u914d\u7f6econfig --> \u8fd0\u884c\u547d\u4ee4\u542f\u52a8\u96c6\u7fa4 \u6253\u5f00\u4e00\u53f0\u865a\u62df\u673a\u4f5c\u4e3aPcluster\u7684 \u63a7\u5236\u670d\u52a1\u5668 (v2.7.0) \u9009\u62e9\u4e00\u4e2aec2\u914d\u7f6e eg. t2.micro \u8bb0\u4f4f\u6211\u7684\u5b89\u5168\u79d8\u94a5\u540d\u79f0 eg. mykey.pem \u767b\u5f55\u8fd9\u53f0\u673a\u5668 \u5b89\u88c5pcluster \u63a7\u5236\u8f6f\u4ef6 install pip curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py python get-pip.py pip install aws-parallelcluster configure aws cli $ aws configure AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE AWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY Default region name [us-east-1]: cn-northwest-1 Default output format [None]: json [\u53ef\u9009\u9879] \u5982\u679c\u60f3\u5b89\u88c5python3\u7684\u8bdd sudo yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel sudo yum install gcc -y sudo mkdir /usr/local/python3 cd /usr/local/ sudo wget https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz sudo tar -xvf Python-3.6.5.tgz cd ./Python-3.6.5/ sudo ./configure --prefix=/usr/local/python3 sudo make sudo make install sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3 \u751f\u6210\u5e76\u914d\u7f6e\u96c6\u7fa4\u7684config\u6587\u4ef6\uff0c \u4e00\u952e\u542f\u52a8pcluster cd ~/.parallelcluster vim config edit as you want [config template] [aws] aws_region_name = cn-northwest-1 # change if you want [global] cluster_template = myname # change if you want, MUST remember this name! update_check = true sanity_check = true [aliases] ssh = ssh {CFN_USER}@{MASTER_IP} {ARGS} [cluster myname] # change if you changed the name of cluster_template in [global] settings above key_name = mytest # change to your keypair name master_instance_type = c5.2xlarge # master node type compute_instance_type = c5.large # compute node type pre_install = https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/efsfix.sh # \u4e2d\u56fd\u533a\u7528EFS\u52a0\u4e0a\u8fd9\u53e5 pre_install_args = NONE # \u4e2d\u56fd\u533a\u7528EFS\u52a0\u4e0a\u8fd9\u53e5 initial_queue_size = 1 # number of compute nodes when this cluster be created max_queue_size = 30 # maximum number of compute nodes maintain_initial_size = true # will remain 1 compute node even no job submitted master_root_volume_size = 25 # master's root disk volumn, 17G by default compute_root_volume_size = 25 # compute's root disk volumn, 17G by default cluster_type = spot # ondemand/spot spot_price = 0.4 # change if you want use spot as compute nodes, get latest price of specific instance in your EC2 console base_os = alinux2 scheduler = sge # \u8bbe\u5b9a\u8c03\u5ea6\u5f15\u64ce\uff0csge,torque,slurm, awsbatch custom_ami = ami-xxxxxxxxxxxxxx # ami-0c7a09bc17088086c 2.7.0; ami-0c081e1551e30ee5a 2.6.1 ; change to your customized AMI based on pcluster ami s3_read_resource = NONE s3_read_write_resource = NONE placement = compute vpc_settings = default #ebs_settings = custom1, custom2 # use EBS to be shared as NFS efs_settings = custom1 # use EFS to be shared [recommmend] [vpc default] vpc_id = vpc-6b111111 # change to your vpc id master_subnet_id = subnet-a23v24c # change to your subnet id #compute_subnet_id = subnet-a23v24c # if you want to put compute in private subnet for security #[ebs custom1] # change or add more if you want #shared_dir = data1 # the dir will show in your master or compute nodes #volume_type = gp2 #volume_size = 80 # GB #[ebs custom2] # change or add more if you want #shared_dir = data2 #volume_type = gp2 #volume_size = 2000 # GB [efs custom1] shared_dir = myefs # change and will be mounted as /myefs in your master and computer node encrypted = false performance_mode = generalPurpose [scaling custom] scaledown_idletime = 10 # if idle time of compute nodes exceeds, it will be terminated for cost control (min) pcluster configure \u542f\u52a8\u96c6\u7fa4\u547d\u4ee4 pcluster <create/delete> <cluster_template> , \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0ccluster_template = myname, \u5927\u7ea6\u7b49\u5f8510\u5206\u949f\u5de6\u53f3\u3002 $ pcluster create -c config myname Beginning cluster creation for cluster: myname Creating stack named: parallelcluster-myname Status: parallelcluster-myname - CREATE_COMPLETE MasterPublicIP: 161.111.111.111 ClusterUser: ec2-user MasterPrivateIP: 172.11.11.11 PS: \u8fd9\u53f0\u8df3\u677f\u673a\u5728\u542f\u52a8\u96c6\u7fa4\u6210\u529f\u540e\uff0c\u5e73\u65f6\u53ef\u4ee5\u5173\u95ed\uff0c\u9700\u8981\u7684\u65f6\u5019\u5728\u5f00\u542f\uff0c\u8282\u7ea6\u8d39\u7528\u3002 \u767b\u5f55\u4e3b\u8282\u70b9\uff0c\u786e\u8ba4\u96c6\u7fa4\u670d\u52a1 \u8fdb\u5230AWS console\u754c\u9762\u67e5\u770bmaster\u548ccompute\u8282\u70b9\u72b6\u6001 ssh\u767b\u5f55master\u8282\u70b9 ssh -i 'xx.pem' ec2-user@192.111.11.11 \u5982\u679c\u662f Slurm (\u63a8\u8350) $ cat >> test.slurm<<EOF #!/bin/bash #SBATCH -J array #SBATCH -p compute #SBATCH -N 1 #SBATCH --cpus-per-task=1 #SBATCH -t 5:00 #SBATCH -a 0-2 input=(foo bar baz) echo \"This is job #${SLURM_ARRAY_JOB_ID}, with parameter ${input[$SLURM_ARRAY_TASK_ID]}\" echo \"There are ${SLURM_ARRAY_TASK_COUNT} task(s) in the array.\" echo \" Max index is ${SLURM_ARRAY_TASK_MAX}\" echo \" Min index is ${SLURM_ARRAY_TASK_MIN}\" sleep 5 EOF \u63d0\u4ea4\u4efb\u52a1 sbatch test.slurm \u5982\u679c\u662fPBS\uff1a $ cat >> test.pbs<<EOF #!/bin/bash #PBS -l nodes=1:ppn=2 sleep 600 EOF qsub test.pbs qstat \u5982\u679c\u662fSGE: $ cat >> test.sh<<EOF #!/bin/bash sleep 600 EOF qsub -cwd -pe smp 2 -l vf=2G test.sh qhost to check your queue df -h to check your volumns qsub test.sh to check your cluster function qstat -f to see job status submit your jobs using command like qsub -cwd -S /bin/bash -V -l vf=2G -pe smp 4 -o output -e output -q all.q yourscript.sh \u5173\u4e8e\u5171\u4eab\u5b58\u50a8 \u6211\u4eec\u4e00\u822c\u53ef\u4ee5\u7528EBS\u7684gp2\u7c7b\u578b\u6765\u7ec4\u5efaNFS\u76d8\uff0c\u53ef\u4ee5\u548c\u672c\u5730\u73af\u5883\u65e0\u7f1d\u5bf9\u63a5\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u9ad8IOPS\u7684\u5e94\u7528\u573a\u666f\uff0c\u53ef\u80fd\u5c31\u4f1a\u9047\u5230\u74f6\u9888\u4e86\uff0c\u6240\u5e78Pcluster\u8fd8\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5176\u4ed6\u7684\u5171\u4eab\u5b58\u50a8\u9009\u9879\uff1a EFS \u5f39\u6027\u6587\u4ef6\u7cfb\u7edf \uff08\u4e0a\u9762\u7684\u4f8b\u5b50\u7528\u7684\u5c31\u662fEFS\uff09 FSx Lustre \u4ee5EFS\u4e3a\u4f8b\uff0c\u5c06EBS\u8bbe\u7f6e\u90e8\u5206\u66ff\u6362\u6210\u5982\u4e0b\uff1a efs_settings = customfs [efs customfs] shared_dir = efs encrypted = false performance_mode = generalPurpose \u8fd9\u6837build\u51fa\u6765\u7684\u96c6\u7fa4\uff0c\u5171\u4eab\u5b58\u50a8\u6027\u80fd\u6709\u4fdd\u8bc1\uff0c\u4e14\u5bb9\u91cf\u5f39\u6027\uff0c\u6309\u7167\u5b9e\u9645\u5360\u7528\u7a7a\u95f4\u8ba1\u8d39\uff0c\u5982\u679c\u5584\u4e8e\u5229\u7528EFS\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\uff08\u53bbEFS\u9875\u9762\u8bbe\u7f6e\uff09\uff0c\u6210\u672c\u4e5f\u80fd\u63a7\u5236\u7684\u4e0d\u9519\u3002 for debug vi ~/.bashrc add export SGE_ROOT=/opt/sge add PATH=/opt/sge/bin:/opt/sge/bin/lx-amd64:/opt/amazon/openmpi/bin:$PATH source ~/.bashrc sudo /etc/init.d/sgemaster.p6444 <start/stop/restart> for autoscaling \u6df7\u642d[\u9ad8\u9636] wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/pcluster/asgmodify.json #\u4fee\u6539\u5176\u4e2dASG name\u3001LaunchTemplateName\u548c\u6240\u9700\u5b9e\u4f8b\u7c7b\u578b vi asgmodify.json aws autoscaling update-auto-scaling-group --cli-input-json file://asgmodify.json --profile zhy pcluster_User_Guide \u884c\u8005\u65e0\u7586\uff0c\u5e72\u5c31\u662f\u4e86\u3002","title":"10\u5206\u949f\u4e00\u952e\u521b\u5efaHPC\u96c6\u7fa4-pcluster (parallelcluster)"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#10hpc-pcluster-parallelcluster","text":"brief introduction of pcluster on aws -- D.C \u4fd7\u8bdd\u8bf4\u7684\u597d\uff0c\u6ca1\u56fe\u8bf4\u4e2a\u57fa\u9738","title":"10\u5206\u949f\u4e00\u952e\u521b\u5efaHPC\u96c6\u7fa4-pcluster (parallelcluster)"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#_1","text":"\u5bf9\u751f\u4fe1\u6765\u8bf4\uff0c\u7b2c\u4e00\u6b65\u4e0d\u662f\u5f80\u4e0b\u770b\uff0c\u800c\u662f\u627e\u5230\u6b63\u786e\u7684 AMI , \u8fd9\u4e2a\u955c\u50cf\u5e94\u8be5\u662f\u9884\u88c5\u597d\u4e86pcluster\u76f8\u5173\u5fc5\u8981\u7ec4\u4ef6\u7684\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65 \u81f3\u5173\u91cd\u8981 \u3002 pcluster\u7684\u7248\u672c\uff08\u76ee\u524d\u662f2.7.0\uff09\u5bf9\u5e94\u4e0d\u540c\u7684ami\uff0c\u6240\u4ee5\u4e5f\u8981\u533a\u5206\u6e05\u695a,\u5728\u521b\u5efaec2\u754c\u9762\u7684\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u53ef\u4ee5\u641c\u7d22 parallelcluster-2.7.0 ,\u76ee\u524d\u7684\u8bb0\u5f55\u663e\u793a\u670941\u4e2a\u76f8\u5173\u7684ami,\u6839\u636e\u4f60\u60f3\u8981\u7684\u64cd\u4f5c\u7cfb\u7edf\u8bb0\u4e0b\u5bf9\u5e94\u7684ami ID\u3002\u4e0d\u540cregion\u7684ami id\u4e5f\u4e0d\u540c\u3002 \u4e3e\u4f8b\uff1a pcluster \u7248\u672c \u7cfb\u7edf \u5b81\u590f\u533aami \u5317\u4eac\u533aami 2.5.1 ubuntu ami-0202652c7cb199eb6 ami-00881ffc995032786 2.5.1 linux ami-05038e0c41061b799 ami-0bbadb6ff64415ab3 2.5.1 ubuntu ami-0b0ebbfcd0c50f225 ami-0d3a6e7dd85085042 \u672c\u6587\u4f1a\u6d89\u53ca\u5230\u591a\u53f0\u673a\u5668\uff1a \u540d\u79f0 \u8bf4\u660e \u6a21\u677f\u673a \u4ece\u5b98\u65b9\u7684pcluster\u955c\u50cf\u542f\u52a8\uff0c\u5b89\u88c5\u7528\u6237\u81ea\u5df1\u7684\u8f6f\u4ef6\u540e\uff0c\u6253\u5305\u6210\u5206\u6790\u955c\u50cfAMI \u63a7\u5236\u673a \u4e0d\u9700\u8981\u4ece\u955c\u50cf\u542f\u52a8\uff0c\u7528\u4e8e\u5b89\u88c5pcluster\u547d\u4ee4\uff0c\u7528\u4e8e\u63a7\u5236\u96c6\u7fa4 \u4e3b\u8282\u70b9 \u7528\u4e8e\u8c03\u5ea6\u96c6\u7fa4\u4f5c\u4e1a\u7684\u8282\u70b9 \u8ba1\u7b97\u8282\u70b9 \u7528\u4e8e\u5206\u6790\u8ba1\u7b97\u7684\u8282\u70b9","title":"\u597d\u8bdd\u8bf4\u524d\u5934"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#_2","text":"\u5f00\u4e00\u53f0ec2\u4f5c\u4e3a \u6a21\u677f\u673a \uff08\u5982t2.micro\uff09\uff0c\u9009\u62e9\u4eceparallelcluster\u7684\u5b98\u65b9ami\u542f\u52a8 [\u5982aws-parallelcluster-2.7.0-amzn-hvm-202005172030 (ami-0c7a09bc17088086c)] \u5c06\u6211\u7684\u5206\u6790\u6d41\u7a0b\u90e8\u7f72\u5728\u8fd9\u53f0\u6a21\u677f\u673a\u4e0a\uff0c\u518d\u57fa\u4e8e \u8fd9\u53f0ec2 \u6253\u4e00\u4e2a\u65b0\u7684ami\uff0c\u62ff\u5230\u8fd9\u4e2a\u65b0\u7684ami id (\u5982ami-xxxxxxxxxxxxxx)\uff0c\u8fd9\u4e2aAMI\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u4e3apcluster\u96c6\u7fa4\u7684\u542f\u52a8ami,\u5bf9\u5e94\u4e0b\u9762template\u91cc\u9762\u7684custom_ami\u3002 \u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528parallelcluster\u4e00\u952e\u96c6\u7fa4\u7684\u529f\u80fd\uff0c\u9700\u8981\u4fdd\u8bc1 \u63a7\u5236\u670d\u52a1\u5668\u5b89\u88c5\u7684parallelcluster\u7248\u672c \u548c \u90e8\u7f72\u5206\u6790\u6d41\u7a0b\uff08\u7684\u6a21\u677f\u673a\uff09\u9009\u62e9ami\u7684parallelcluster\u7248\u672c \u90fd\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002\u5982\u90fd\u662f2.7.0\u7248\u672c\u3002 \u6240\u4ee5\u6d41\u7a0b\u5927\u81f4\u662f\uff1a \u539f\u59cbpcluster\u5b98\u65b9\u955c\u50cf\uff08ami-0c7a09bc17088086c\uff09 --> \u542f\u52a8\u6a21\u677f\u673a --> \u5b89\u88c5\u5206\u6790\u6d41\u7a0b --> custom_ami \u63a7\u5236\u673a(\u9ed8\u8ba4Amazon Linux 2 AMI) --> \u5b89\u88c5pcluster\u8f6f\u4ef6 --> \u914d\u7f6econfig --> \u8fd0\u884c\u547d\u4ee4\u542f\u52a8\u96c6\u7fa4","title":"[\u5fc5\u8bfb] \u521b\u5efa\u5206\u6790\u955c\u50cf"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#pcluster-v270","text":"\u9009\u62e9\u4e00\u4e2aec2\u914d\u7f6e eg. t2.micro \u8bb0\u4f4f\u6211\u7684\u5b89\u5168\u79d8\u94a5\u540d\u79f0 eg. mykey.pem \u767b\u5f55\u8fd9\u53f0\u673a\u5668","title":"\u6253\u5f00\u4e00\u53f0\u865a\u62df\u673a\u4f5c\u4e3aPcluster\u7684 \u63a7\u5236\u670d\u52a1\u5668  (v2.7.0)"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#pcluster","text":"install pip curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py python get-pip.py pip install aws-parallelcluster configure aws cli $ aws configure AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE AWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY Default region name [us-east-1]: cn-northwest-1 Default output format [None]: json [\u53ef\u9009\u9879] \u5982\u679c\u60f3\u5b89\u88c5python3\u7684\u8bdd sudo yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel sudo yum install gcc -y sudo mkdir /usr/local/python3 cd /usr/local/ sudo wget https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz sudo tar -xvf Python-3.6.5.tgz cd ./Python-3.6.5/ sudo ./configure --prefix=/usr/local/python3 sudo make sudo make install sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3","title":"\u5b89\u88c5pcluster \u63a7\u5236\u8f6f\u4ef6"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#config-pcluster","text":"cd ~/.parallelcluster vim config edit as you want [config template] [aws] aws_region_name = cn-northwest-1 # change if you want [global] cluster_template = myname # change if you want, MUST remember this name! update_check = true sanity_check = true [aliases] ssh = ssh {CFN_USER}@{MASTER_IP} {ARGS} [cluster myname] # change if you changed the name of cluster_template in [global] settings above key_name = mytest # change to your keypair name master_instance_type = c5.2xlarge # master node type compute_instance_type = c5.large # compute node type pre_install = https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/efsfix.sh # \u4e2d\u56fd\u533a\u7528EFS\u52a0\u4e0a\u8fd9\u53e5 pre_install_args = NONE # \u4e2d\u56fd\u533a\u7528EFS\u52a0\u4e0a\u8fd9\u53e5 initial_queue_size = 1 # number of compute nodes when this cluster be created max_queue_size = 30 # maximum number of compute nodes maintain_initial_size = true # will remain 1 compute node even no job submitted master_root_volume_size = 25 # master's root disk volumn, 17G by default compute_root_volume_size = 25 # compute's root disk volumn, 17G by default cluster_type = spot # ondemand/spot spot_price = 0.4 # change if you want use spot as compute nodes, get latest price of specific instance in your EC2 console base_os = alinux2 scheduler = sge # \u8bbe\u5b9a\u8c03\u5ea6\u5f15\u64ce\uff0csge,torque,slurm, awsbatch custom_ami = ami-xxxxxxxxxxxxxx # ami-0c7a09bc17088086c 2.7.0; ami-0c081e1551e30ee5a 2.6.1 ; change to your customized AMI based on pcluster ami s3_read_resource = NONE s3_read_write_resource = NONE placement = compute vpc_settings = default #ebs_settings = custom1, custom2 # use EBS to be shared as NFS efs_settings = custom1 # use EFS to be shared [recommmend] [vpc default] vpc_id = vpc-6b111111 # change to your vpc id master_subnet_id = subnet-a23v24c # change to your subnet id #compute_subnet_id = subnet-a23v24c # if you want to put compute in private subnet for security #[ebs custom1] # change or add more if you want #shared_dir = data1 # the dir will show in your master or compute nodes #volume_type = gp2 #volume_size = 80 # GB #[ebs custom2] # change or add more if you want #shared_dir = data2 #volume_type = gp2 #volume_size = 2000 # GB [efs custom1] shared_dir = myefs # change and will be mounted as /myefs in your master and computer node encrypted = false performance_mode = generalPurpose [scaling custom] scaledown_idletime = 10 # if idle time of compute nodes exceeds, it will be terminated for cost control (min) pcluster configure \u542f\u52a8\u96c6\u7fa4\u547d\u4ee4 pcluster <create/delete> <cluster_template> , \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0ccluster_template = myname, \u5927\u7ea6\u7b49\u5f8510\u5206\u949f\u5de6\u53f3\u3002 $ pcluster create -c config myname Beginning cluster creation for cluster: myname Creating stack named: parallelcluster-myname Status: parallelcluster-myname - CREATE_COMPLETE MasterPublicIP: 161.111.111.111 ClusterUser: ec2-user MasterPrivateIP: 172.11.11.11 PS: \u8fd9\u53f0\u8df3\u677f\u673a\u5728\u542f\u52a8\u96c6\u7fa4\u6210\u529f\u540e\uff0c\u5e73\u65f6\u53ef\u4ee5\u5173\u95ed\uff0c\u9700\u8981\u7684\u65f6\u5019\u5728\u5f00\u542f\uff0c\u8282\u7ea6\u8d39\u7528\u3002","title":"\u751f\u6210\u5e76\u914d\u7f6e\u96c6\u7fa4\u7684config\u6587\u4ef6\uff0c \u4e00\u952e\u542f\u52a8pcluster"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#_3","text":"\u8fdb\u5230AWS console\u754c\u9762\u67e5\u770bmaster\u548ccompute\u8282\u70b9\u72b6\u6001 ssh\u767b\u5f55master\u8282\u70b9 ssh -i 'xx.pem' ec2-user@192.111.11.11 \u5982\u679c\u662f Slurm (\u63a8\u8350) $ cat >> test.slurm<<EOF #!/bin/bash #SBATCH -J array #SBATCH -p compute #SBATCH -N 1 #SBATCH --cpus-per-task=1 #SBATCH -t 5:00 #SBATCH -a 0-2 input=(foo bar baz) echo \"This is job #${SLURM_ARRAY_JOB_ID}, with parameter ${input[$SLURM_ARRAY_TASK_ID]}\" echo \"There are ${SLURM_ARRAY_TASK_COUNT} task(s) in the array.\" echo \" Max index is ${SLURM_ARRAY_TASK_MAX}\" echo \" Min index is ${SLURM_ARRAY_TASK_MIN}\" sleep 5 EOF \u63d0\u4ea4\u4efb\u52a1 sbatch test.slurm \u5982\u679c\u662fPBS\uff1a $ cat >> test.pbs<<EOF #!/bin/bash #PBS -l nodes=1:ppn=2 sleep 600 EOF qsub test.pbs qstat \u5982\u679c\u662fSGE: $ cat >> test.sh<<EOF #!/bin/bash sleep 600 EOF qsub -cwd -pe smp 2 -l vf=2G test.sh qhost to check your queue df -h to check your volumns qsub test.sh to check your cluster function qstat -f to see job status submit your jobs using command like qsub -cwd -S /bin/bash -V -l vf=2G -pe smp 4 -o output -e output -q all.q yourscript.sh","title":"\u767b\u5f55\u4e3b\u8282\u70b9\uff0c\u786e\u8ba4\u96c6\u7fa4\u670d\u52a1"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#_4","text":"\u6211\u4eec\u4e00\u822c\u53ef\u4ee5\u7528EBS\u7684gp2\u7c7b\u578b\u6765\u7ec4\u5efaNFS\u76d8\uff0c\u53ef\u4ee5\u548c\u672c\u5730\u73af\u5883\u65e0\u7f1d\u5bf9\u63a5\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u9ad8IOPS\u7684\u5e94\u7528\u573a\u666f\uff0c\u53ef\u80fd\u5c31\u4f1a\u9047\u5230\u74f6\u9888\u4e86\uff0c\u6240\u5e78Pcluster\u8fd8\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5176\u4ed6\u7684\u5171\u4eab\u5b58\u50a8\u9009\u9879\uff1a EFS \u5f39\u6027\u6587\u4ef6\u7cfb\u7edf \uff08\u4e0a\u9762\u7684\u4f8b\u5b50\u7528\u7684\u5c31\u662fEFS\uff09 FSx Lustre \u4ee5EFS\u4e3a\u4f8b\uff0c\u5c06EBS\u8bbe\u7f6e\u90e8\u5206\u66ff\u6362\u6210\u5982\u4e0b\uff1a efs_settings = customfs [efs customfs] shared_dir = efs encrypted = false performance_mode = generalPurpose \u8fd9\u6837build\u51fa\u6765\u7684\u96c6\u7fa4\uff0c\u5171\u4eab\u5b58\u50a8\u6027\u80fd\u6709\u4fdd\u8bc1\uff0c\u4e14\u5bb9\u91cf\u5f39\u6027\uff0c\u6309\u7167\u5b9e\u9645\u5360\u7528\u7a7a\u95f4\u8ba1\u8d39\uff0c\u5982\u679c\u5584\u4e8e\u5229\u7528EFS\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\uff08\u53bbEFS\u9875\u9762\u8bbe\u7f6e\uff09\uff0c\u6210\u672c\u4e5f\u80fd\u63a7\u5236\u7684\u4e0d\u9519\u3002","title":"\u5173\u4e8e\u5171\u4eab\u5b58\u50a8"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#for-debug","text":"vi ~/.bashrc add export SGE_ROOT=/opt/sge add PATH=/opt/sge/bin:/opt/sge/bin/lx-amd64:/opt/amazon/openmpi/bin:$PATH source ~/.bashrc sudo /etc/init.d/sgemaster.p6444 <start/stop/restart>","title":"for debug"},{"location":"blogs/2019-12-27-10-mins-to-create-a-cluster-on-aws/#for-autoscaling","text":"wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/pcluster/asgmodify.json #\u4fee\u6539\u5176\u4e2dASG name\u3001LaunchTemplateName\u548c\u6240\u9700\u5b9e\u4f8b\u7c7b\u578b vi asgmodify.json aws autoscaling update-auto-scaling-group --cli-input-json file://asgmodify.json --profile zhy pcluster_User_Guide \u884c\u8005\u65e0\u7586\uff0c\u5e72\u5c31\u662f\u4e86\u3002","title":"for autoscaling \u6df7\u642d[\u9ad8\u9636]"},{"location":"blogs/2020-01-06-wdl-and-cromwell-on-aws-batch-china/","text":"\u4e00\u952e\u90e8\u7f72\u9762\u5411\u57fa\u56e0\u5206\u6790\u7684 Cromwell-on-AWS-Batch \u89e3\u51b3\u65b9\u6848\uff08\u4e2d\u56fd\u533a\u57df\uff09 Cromwell-on-AWS-Batch\u662fAWS\u5728\u751f\u547d\u79d1\u5b66\u9886\u57df\u8054\u5408Broad\u7814\u7a76\u9662\u63a8\u51fa\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5df2\u6709\u5f88\u591aAWS\u6d77\u5916\u533a\u57df\u7684\u5ba2\u6237\u5728\u4f7f\u7528\u8be5\u89e3\u51b3\u65b9\u6848\u8fdb\u884c\u57fa\u56e0\u5206\u6790\u3002AWS Batch\u670d\u52a1\u4e8e2019\u5e7410\u6708\u5728AWS\u4e2d\u56fd\u533a\u57df\u4e0a\u7ebf\u4e4b\u540e\uff0c\u6211\u4eec\u968f\u5373\u6839\u636eAWS\u4e2d\u56fd\u533a\u57df\u7684\u7279\u70b9\u5bf9\u8be5\u89e3\u51b3\u65b9\u6848\u8fdb\u884c\u4e86\u9002\u5e94\u4fee\u6539\u548c\u4f18\u5316\u63d0\u5347\uff0c\u672c\u6587\u901a\u8fc7\u4e00\u4e2a\u6d4b\u8bd5\u793a\u4f8b\u548c\u4e00\u4e2aGATK\u5b9e\u9645\u4f8b\u5b50\u6765\u6f14\u793a\u5728\u4e2d\u56fd\u533a\u57df\u4e00\u952e\u90e8\u7f72\u7684\u8fc7\u7a0b\uff0c\u4e3a\u56fd\u5185\u57fa\u56e0\u5206\u6790\u5ba2\u6237\u5feb\u901f\u4e0a\u624b\u4f7f\u7528\u8be5\u89e3\u51b3\u65b9\u6848\u52a0\u901f\u5206\u6790\u6548\u7387\u63d0\u4f9b\u53c2\u8003\u3002 -- D.C \u539f\u5e16\u5730\u5740 \u57fa\u672c\u4ecb\u7ecd Cromwell \u662f\u7531Broad\u7814\u7a76\u9662\u9762\u5411\u79d1\u7814\u9886\u57df\u5f00\u53d1\u7684\u4e00\u5957\u5de5\u4f5c\u6d41\u7ba1\u7406\u6846\u67b6\uff0c\u76ee\u524d\u5728\u57fa\u56e0\u5206\u6790\u9886\u57df\u66f4\u4e3a\u5e38\u7528\u3002Cromwell\u76ee\u524d\u5df2\u652f\u6301\u5bf9\u63a5AWS Batch\u4f5c\u4e3a\u5176\u96c6\u7fa4\u7ba1\u7406\u540e\u7aef\uff0c\u4e91\u7aef\u57fa\u7840\u8d44\u6e90\u7684\u8c03\u5ea6\u7ba1\u7406\u7531AWS Batch\u5b8c\u6210\u3002 Cromwell-on-AWS-Batch\u7684\u7ec4\u6210\u67b6\u6784\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002\u7531\u751f\u4fe1\u5de5\u7a0b\u5e08\u7f16\u5199wdl\u6216cwl\u683c\u5f0f\u7684\u57fa\u56e0\u5206\u6790\u5de5\u4f5c\u6d41\u811a\u672c\uff0c\u4f5c\u4e3aCromwell\u7684\u8f93\u5165\uff0c\u901a\u8fc7API\u8c03\u7528\uff08\u6216\u56fe\u5f62\u7ba1\u7406\u754c\u9762\uff09\u7684\u65b9\u5f0f\u63d0\u4ea4\u4efb\u52a1\uff0c\u5206\u6790\u8fc7\u7a0b\u4e2d\u53ef\u901a\u8fc7AWS Batch\u670d\u52a1\u7684\u63a7\u5236\u9762\u677f\u548cCloudWatch-Log\u8bb0\u5f55\u53ef\u4ee5\u67e5\u770b\u4efb\u52a1\u7684\u6267\u884c\u72b6\u6001\uff0c\u5206\u6790\u7684\u7ed3\u679c\u4fdd\u5b58\u5728Amazon S3\u5b58\u50a8\u4e0a\u3002\u5206\u6790\u4e2d\u652f\u6301\u8c03\u7528Spot\u7ade\u4ef7\u5b9e\u4f8b\u6765\u964d\u4f4e\u6837\u672c\u5206\u6790\u7684\u6210\u672c\u3002\u6b64\u5916Cromwell\u8fd8\u652f\u6301\u901a\u8fc7Amazon Aurora\u6570\u636e\u5e93\u670d\u52a1\u6765\u7ba1\u7406\u4f5c\u4e1a\u6570\u636e\u8bb0\u5f55\u3002 \u4e00\u952e\u90e8\u7f72\u7684\u8fc7\u7a0b\u53ca\u6d4b\u8bd5\u793a\u4f8b \u90e8\u7f72\u8fc7\u7a0b\u901a\u8fc7CloudFormation\u6a21\u677f\u5bfc\u5165\uff0c\u975e\u5e38\u65b9\u4fbf\u3002\u8fdb\u5165AWS\u63a7\u5236\u53f0\uff0c\u53f3\u4e0a\u89d2\u9009\u62e9\u5b81\u590f\u533a\u57df\uff0c\u5e76\u901a\u8fc7\u5de6\u4e0a\u89d2\u670d\u52a1\u83dc\u5355\u8fdb\u5165CloudFormation\u670d\u52a1\u754c\u9762\uff0c\u70b9\u51fb\u201c\u521b\u5efa\u5806\u6808\u201d\uff0c\u5728\u5806\u6808\u6a21\u677f\u7684URL\u4fe1\u606f\u680f\u4e2d\u586b\u5165\uff1ahttps://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/templates/cromwell-aio.template.yaml\u3002 \u8fdb\u5165\u4e0b\u4e00\u6b65\uff0c\u4e3a\u5806\u6808\u6307\u5b9a\u540d\u79f0\u3002\u5728\u5806\u6808\u53c2\u6570\u680f\u4e2d\uff0c\u4e0b\u62c9\u9009\u62e9EC2\u5bc6\u94a5\u5bf9\uff08\u5982\u679c\u4e0b\u62c9\u5217\u8868\u4e3a\u7a7a\uff0c\u53ef\u8fdb\u5165EC2\u670d\u52a1\u754c\u9762\u5de6\u4fa7\u5bc6\u94a5\u5bf9\u83dc\u5355\u4e2d\u5efa\u597d\u518d\u8fd4\u56de\u6b64\u5904\uff09\uff0c\u8be5\u5bc6\u94a5\u5bf9\u662f\u540e\u7eedSSH\u767b\u5f55\u7684\u51ed\u636e\uff1b\u5e76\u8f93\u5165S3\u5b58\u50a8\u6876\u7684\u540d\u79f0\uff0c\u8be5\u540d\u79f0\u9700\u7b26\u5408S3\u6876\u540d\u89c4\u8303\u5e76\u4fdd\u8bc1\u552f\u4e00\uff08\u4ea6\u53ef\u901a\u8fc7\u6307\u5b9aExisting\u9009\u9879\u4e3atrue\u6765\u4f7f\u7528\u5df2\u6709\u5b58\u50a8\u6876\u540d\uff09\u3002\u5728AWS Batch\u53c2\u6570\u4e2d\uff0c\u6307\u5b9aSpot\u7ade\u4ef7\u5b9e\u4f8b\u5728\u6240\u6709vCPU\u7684\u4f7f\u7528\u6bd4\u4f8b\uff0c\u5e76\u6307\u5b9a\u6700\u5c0f\u6700\u5927vCPU\u6570\u91cf\uff0c\u540e\u7eed\u4f1a\u5efaDefault\u548cHigh Priority\u4e24\u4e2a\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u961f\u5217\uff0c\u6545\u6700\u5c0f\u6700\u5927\u6570\u91cf\u53ef\u5206\u522b\u6307\u5b9a\u3002\u6b64\u5904\u4e24\u4e2a\u6700\u5c0f\u503c\u5747\u586b4\u3002\u5176\u4ed6\u53ef\u4fdd\u6301\u9ed8\u8ba4\u503c\uff0c\u8fdb\u5165\u4e0b\u4e00\u6b65\u3002 \u5728\u6743\u9650\u53c2\u6570\u4e2d\u9700\u8981\u6307\u5b9a\u4e00\u4e2aIAM\u6743\u9650\u89d2\u8272\u7528\u4e8e\u6388\u6743CloudFormation\u6765\u542f\u52a8\u8d44\u6e90\u7528\uff0c\u5982\u679c\u4e3a\u7a7a\uff0c\u53c2\u8003\u53f3\u4e0a\u89d2\u201c\u4e86\u89e3\u66f4\u591a\u201d\u7684\u6b65\u9aa4\u65b0\u5efa\u4e00\u4e2a\u89d2\u8272\uff08\u7b80\u4fbf\u8d77\u89c1\u53ef\u5148\u5efa\u4e00\u4e2a\u7ba1\u7406\u5458\u6743\u9650\u7684\uff09\u518d\u8fd4\u56de\u6b64\u5904\u8bbe\u7f6e\u3002 \u8fdb\u5165\u4e0b\u4e00\u6b65\uff0c\u52fe\u9009\u4e24\u4e2a\u786e\u8ba4\u6846\u3002 \u70b9\u51fb\u521b\u5efa\u5806\u6808\uff0c\u5373\u5f00\u59cb\u81ea\u52a8\u65b0\u5efa\u6574\u4e2a\u6846\u67b6\u5806\u6808\u3002\u7b49\u5f85\u5341\u51e0\u5206\u949f\u540e\u5806\u6808\u5efa\u7acb\u5b8c\u6210\uff0c\u5806\u6808\u72b6\u6001\u53ef\u770b\u5230\u5747\u4e3aCREATE_COMPLETE\u72b6\u6001\uff08\u8be5\u6a21\u677f\u81ea\u52a8\u5d4c\u59577\u4e2a\u5b50\u6a21\u677f\uff09\u3002 \u5728EC2\u5b9e\u4f8b\u5217\u8868\u91cc\u4e5f\u53ef\u4ee5\u67e5\u770b\u5230\u5bf9\u5e94\u7684\u5b9e\u4f8b\u4fe1\u606f\uff0c\u9009\u4e2dcromwell-server\u5b9e\u4f8b\u70b9\u51fb\u4e0a\u65b9\u201c\u8fde\u63a5\u201d\u67e5\u770bSSH\u767b\u5f55\u65b9\u5f0f\u3002 SSH\u767b\u5f55\u8fdbcromwell-server\u5b9e\u4f8b\u540e\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u63d0\u4ea4\u4e00\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u793a\u4f8b\u3002 wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/simple-hello.wdl curl -X POST \"http://localhost:8000/api/workflows/v1\" -H \"accept: application/json\" -F \"workflowSource=@simple-hello.wdl\" \u5176\u4e2dsimple-hello.wdl\u7684\u5185\u5bb9\u5982\u4e0b\uff0c\u662f\u4e00\u4e2a\u53ea\u6267\u884c\u4e00\u4e2atask\u7684\u6d4b\u8bd5\u811a\u672c: task echoHello{ command { echo \"Hello AWS!\" } runtime { docker: \"amazonlinux:latest\" } } workflow printHelloAndGoodbye { call echoHello } \u6d4b\u8bd5\u793a\u4f8b\u5f88\u5feb\u5b8c\u6210\uff0c\u5728CloudWatch Log\u4e2d\u6709\u8be6\u7ec6\u8bb0\u5f55\u4fe1\u606f. \u8fd0\u884c\u4e00\u4e2aGATK\u57fa\u56e0\u5206\u6790\u5904\u7406\u7684\u5b9e\u9645\u4f8b\u5b50 \u672c\u4f8b\u5b50\u662f\u57fa\u4e8ehg38\u516c\u5f00\u6570\u636e\u8fdb\u884cGATK\u5206\u6790\u6d41\u7a0b\u4e2dHaplotypeCaller \u6b65\u9aa4\u5904\u7406\u3002\uff08\u63d0\u793a\uff1a\u672c\u5b9e\u9a8c\u4f1a\u4ea7\u751f\u4e00\u5b9a\u8fd0\u884c\u8d39\u7528\u6839\u636e\u8fd0\u884c\u5b9e\u4f8b\u7c7b\u578b\u548cSpot\u6bd4\u4f8b\u8bbe\u7f6e\u6709\u6240\u4e0d\u540c\uff09 SSH\u767b\u5f55\u8fdbcromwell-server\u5b9e\u4f8b\u540e\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5de5\u4f5c\u6d41\u811a\u672cHaplotypeCaller.aws.wdl\u548c\u914d\u7f6e\u6587\u4ef6HaplotypeCaller.aws.json wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/HaplotypeCaller.aws.wdl wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/HaplotypeCaller.aws.json \u5176\u4e2d\u914d\u7f6e\u6587\u4ef6HaplotypeCaller.aws.json\u7684\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff0c\u5176\u4e2d\u7684s3://\u5f00\u5934\u7684\u5730\u65b9\u662f\u7528\u5230\u7684bam/fastq\u7b49\u8d44\u6e90\u6587\u4ef6\uff0c\u60a8\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5230\u81ea\u5df1S3\u5b58\u50a8\u6876\u7684\u6587\u4ef6\u94fe\u63a5\u3002 { \"##_COMMENT1\": \"INPUT BAM\", \"HaplotypeCallerGvcf_GATK4.input_bam\": \"s3://gatk-test-data/wgs_bam/NA12878_24RG_hg38/NA12878_24RG_small.hg38.bam\", \"HaplotypeCallerGvcf_GATK4.input_bam_index\": \"s3://gatk-test-data/wgs_bam/NA12878_24RG_hg38/NA12878_24RG_small.hg38.bai\", \"##_COMMENT2\": \"REFERENCE FILES\", \"HaplotypeCallerGvcf_GATK4.ref_dict\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.dict\", \"HaplotypeCallerGvcf_GATK4.ref_fasta\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.fasta\", \"HaplotypeCallerGvcf_GATK4.ref_fasta_index\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.fasta.fai\", \"##_COMMENT3\": \"INTERVALS\", \"HaplotypeCallerGvcf_GATK4.scattered_calling_intervals_list\": \"s3://gatk-test-data/intervals/hg38_wgs_scattered_calling_intervals.txt\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.interval_padding\": 100, \"##_COMMENT4\": \"DOCKERS\", \"HaplotypeCallerGvcf_GATK4.gatk_docker\": \"broadinstitute/gatk:4.0.0.0\", \"##_COMMENT5\": \"PATHS\", \"HaplotypeCallerGvcf_GATK4.gatk_path\": \"/gatk/gatk\", \"##_COMMENT6\": \"JAVA OPTIONS\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.java_opt\": \"-Xms8000m\", \"HaplotypeCallerGvcf_GATK4.MergeGVCFs.java_opt\": \"-Xms8000m\", \"##_COMMENT7\": \"MEMORY ALLOCATION\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.mem_size\": \"10 GB\", \"HaplotypeCallerGvcf_GATK4.MergeGVCFs.mem_size\": \"30 GB\", } \u63d0\u4ea4\u5982\u4e0b\u547d\u4ee4\u542f\u52a8\u5206\u6790\u6d41\u7a0b: curl -X POST \"http://localhost:8000/api/workflows/v1\" -H \"accept: application/json\" -F \"workflowSource=@HaplotypeCaller.aws.wdl\" -F workflowInputs=@HaplotypeCaller.aws.json \u5206\u6790\u5b8c\u6210\u540e\uff0c\u53ef\u5728CloudWatch Log\u4e2d\u67e5\u770b\u6bcf\u4e2a\u4efb\u52a1\u7684\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u7ed3\u679c\u6570\u636e\u6587\u4ef6\u5b58\u653e\u5728s3://yourbucket/cromwell-execution/HaplotypeCallerGvcf_GATK4/{UUID}/call-HaplotypeCaller/shard-xx/\u8def\u5f84\u4e0b\u3002 PS: \u5b9e\u9a8c\u5b8c\u6210\u540e\uff0c\u5728CloudFormation\u754c\u9762\u4e2d\u9009\u62e9\u6a21\u677f\u5220\u9664\u5373\u53ef\u91ca\u653e\u5806\u6808\u76f8\u5173\u8d44\u6e90\u907f\u514d\u4ea7\u751f\u4e0d\u5fc5\u8981\u7684\u8d39\u7528\uff0c\u5176\u4e2dS3\u5b58\u50a8\u6876\u548cCloudWatch Log\u8bb0\u5f55\u53ef\u5728\u5bf9\u5e94\u670d\u52a1\u5185\u624b\u52a8\u5220\u9664\u3002","title":"\u4e00\u952e\u90e8\u7f72\u9762\u5411\u57fa\u56e0\u5206\u6790\u7684 Cromwell-on-AWS-Batch \u89e3\u51b3\u65b9\u6848\uff08\u4e2d\u56fd\u533a\u57df\uff09"},{"location":"blogs/2020-01-06-wdl-and-cromwell-on-aws-batch-china/#cromwell-on-aws-batch","text":"Cromwell-on-AWS-Batch\u662fAWS\u5728\u751f\u547d\u79d1\u5b66\u9886\u57df\u8054\u5408Broad\u7814\u7a76\u9662\u63a8\u51fa\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5df2\u6709\u5f88\u591aAWS\u6d77\u5916\u533a\u57df\u7684\u5ba2\u6237\u5728\u4f7f\u7528\u8be5\u89e3\u51b3\u65b9\u6848\u8fdb\u884c\u57fa\u56e0\u5206\u6790\u3002AWS Batch\u670d\u52a1\u4e8e2019\u5e7410\u6708\u5728AWS\u4e2d\u56fd\u533a\u57df\u4e0a\u7ebf\u4e4b\u540e\uff0c\u6211\u4eec\u968f\u5373\u6839\u636eAWS\u4e2d\u56fd\u533a\u57df\u7684\u7279\u70b9\u5bf9\u8be5\u89e3\u51b3\u65b9\u6848\u8fdb\u884c\u4e86\u9002\u5e94\u4fee\u6539\u548c\u4f18\u5316\u63d0\u5347\uff0c\u672c\u6587\u901a\u8fc7\u4e00\u4e2a\u6d4b\u8bd5\u793a\u4f8b\u548c\u4e00\u4e2aGATK\u5b9e\u9645\u4f8b\u5b50\u6765\u6f14\u793a\u5728\u4e2d\u56fd\u533a\u57df\u4e00\u952e\u90e8\u7f72\u7684\u8fc7\u7a0b\uff0c\u4e3a\u56fd\u5185\u57fa\u56e0\u5206\u6790\u5ba2\u6237\u5feb\u901f\u4e0a\u624b\u4f7f\u7528\u8be5\u89e3\u51b3\u65b9\u6848\u52a0\u901f\u5206\u6790\u6548\u7387\u63d0\u4f9b\u53c2\u8003\u3002 -- D.C \u539f\u5e16\u5730\u5740","title":"\u4e00\u952e\u90e8\u7f72\u9762\u5411\u57fa\u56e0\u5206\u6790\u7684 Cromwell-on-AWS-Batch \u89e3\u51b3\u65b9\u6848\uff08\u4e2d\u56fd\u533a\u57df\uff09"},{"location":"blogs/2020-01-06-wdl-and-cromwell-on-aws-batch-china/#_1","text":"Cromwell \u662f\u7531Broad\u7814\u7a76\u9662\u9762\u5411\u79d1\u7814\u9886\u57df\u5f00\u53d1\u7684\u4e00\u5957\u5de5\u4f5c\u6d41\u7ba1\u7406\u6846\u67b6\uff0c\u76ee\u524d\u5728\u57fa\u56e0\u5206\u6790\u9886\u57df\u66f4\u4e3a\u5e38\u7528\u3002Cromwell\u76ee\u524d\u5df2\u652f\u6301\u5bf9\u63a5AWS Batch\u4f5c\u4e3a\u5176\u96c6\u7fa4\u7ba1\u7406\u540e\u7aef\uff0c\u4e91\u7aef\u57fa\u7840\u8d44\u6e90\u7684\u8c03\u5ea6\u7ba1\u7406\u7531AWS Batch\u5b8c\u6210\u3002 Cromwell-on-AWS-Batch\u7684\u7ec4\u6210\u67b6\u6784\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002\u7531\u751f\u4fe1\u5de5\u7a0b\u5e08\u7f16\u5199wdl\u6216cwl\u683c\u5f0f\u7684\u57fa\u56e0\u5206\u6790\u5de5\u4f5c\u6d41\u811a\u672c\uff0c\u4f5c\u4e3aCromwell\u7684\u8f93\u5165\uff0c\u901a\u8fc7API\u8c03\u7528\uff08\u6216\u56fe\u5f62\u7ba1\u7406\u754c\u9762\uff09\u7684\u65b9\u5f0f\u63d0\u4ea4\u4efb\u52a1\uff0c\u5206\u6790\u8fc7\u7a0b\u4e2d\u53ef\u901a\u8fc7AWS Batch\u670d\u52a1\u7684\u63a7\u5236\u9762\u677f\u548cCloudWatch-Log\u8bb0\u5f55\u53ef\u4ee5\u67e5\u770b\u4efb\u52a1\u7684\u6267\u884c\u72b6\u6001\uff0c\u5206\u6790\u7684\u7ed3\u679c\u4fdd\u5b58\u5728Amazon S3\u5b58\u50a8\u4e0a\u3002\u5206\u6790\u4e2d\u652f\u6301\u8c03\u7528Spot\u7ade\u4ef7\u5b9e\u4f8b\u6765\u964d\u4f4e\u6837\u672c\u5206\u6790\u7684\u6210\u672c\u3002\u6b64\u5916Cromwell\u8fd8\u652f\u6301\u901a\u8fc7Amazon Aurora\u6570\u636e\u5e93\u670d\u52a1\u6765\u7ba1\u7406\u4f5c\u4e1a\u6570\u636e\u8bb0\u5f55\u3002","title":"\u57fa\u672c\u4ecb\u7ecd"},{"location":"blogs/2020-01-06-wdl-and-cromwell-on-aws-batch-china/#_2","text":"\u90e8\u7f72\u8fc7\u7a0b\u901a\u8fc7CloudFormation\u6a21\u677f\u5bfc\u5165\uff0c\u975e\u5e38\u65b9\u4fbf\u3002\u8fdb\u5165AWS\u63a7\u5236\u53f0\uff0c\u53f3\u4e0a\u89d2\u9009\u62e9\u5b81\u590f\u533a\u57df\uff0c\u5e76\u901a\u8fc7\u5de6\u4e0a\u89d2\u670d\u52a1\u83dc\u5355\u8fdb\u5165CloudFormation\u670d\u52a1\u754c\u9762\uff0c\u70b9\u51fb\u201c\u521b\u5efa\u5806\u6808\u201d\uff0c\u5728\u5806\u6808\u6a21\u677f\u7684URL\u4fe1\u606f\u680f\u4e2d\u586b\u5165\uff1ahttps://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/templates/cromwell-aio.template.yaml\u3002 \u8fdb\u5165\u4e0b\u4e00\u6b65\uff0c\u4e3a\u5806\u6808\u6307\u5b9a\u540d\u79f0\u3002\u5728\u5806\u6808\u53c2\u6570\u680f\u4e2d\uff0c\u4e0b\u62c9\u9009\u62e9EC2\u5bc6\u94a5\u5bf9\uff08\u5982\u679c\u4e0b\u62c9\u5217\u8868\u4e3a\u7a7a\uff0c\u53ef\u8fdb\u5165EC2\u670d\u52a1\u754c\u9762\u5de6\u4fa7\u5bc6\u94a5\u5bf9\u83dc\u5355\u4e2d\u5efa\u597d\u518d\u8fd4\u56de\u6b64\u5904\uff09\uff0c\u8be5\u5bc6\u94a5\u5bf9\u662f\u540e\u7eedSSH\u767b\u5f55\u7684\u51ed\u636e\uff1b\u5e76\u8f93\u5165S3\u5b58\u50a8\u6876\u7684\u540d\u79f0\uff0c\u8be5\u540d\u79f0\u9700\u7b26\u5408S3\u6876\u540d\u89c4\u8303\u5e76\u4fdd\u8bc1\u552f\u4e00\uff08\u4ea6\u53ef\u901a\u8fc7\u6307\u5b9aExisting\u9009\u9879\u4e3atrue\u6765\u4f7f\u7528\u5df2\u6709\u5b58\u50a8\u6876\u540d\uff09\u3002\u5728AWS Batch\u53c2\u6570\u4e2d\uff0c\u6307\u5b9aSpot\u7ade\u4ef7\u5b9e\u4f8b\u5728\u6240\u6709vCPU\u7684\u4f7f\u7528\u6bd4\u4f8b\uff0c\u5e76\u6307\u5b9a\u6700\u5c0f\u6700\u5927vCPU\u6570\u91cf\uff0c\u540e\u7eed\u4f1a\u5efaDefault\u548cHigh Priority\u4e24\u4e2a\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u961f\u5217\uff0c\u6545\u6700\u5c0f\u6700\u5927\u6570\u91cf\u53ef\u5206\u522b\u6307\u5b9a\u3002\u6b64\u5904\u4e24\u4e2a\u6700\u5c0f\u503c\u5747\u586b4\u3002\u5176\u4ed6\u53ef\u4fdd\u6301\u9ed8\u8ba4\u503c\uff0c\u8fdb\u5165\u4e0b\u4e00\u6b65\u3002 \u5728\u6743\u9650\u53c2\u6570\u4e2d\u9700\u8981\u6307\u5b9a\u4e00\u4e2aIAM\u6743\u9650\u89d2\u8272\u7528\u4e8e\u6388\u6743CloudFormation\u6765\u542f\u52a8\u8d44\u6e90\u7528\uff0c\u5982\u679c\u4e3a\u7a7a\uff0c\u53c2\u8003\u53f3\u4e0a\u89d2\u201c\u4e86\u89e3\u66f4\u591a\u201d\u7684\u6b65\u9aa4\u65b0\u5efa\u4e00\u4e2a\u89d2\u8272\uff08\u7b80\u4fbf\u8d77\u89c1\u53ef\u5148\u5efa\u4e00\u4e2a\u7ba1\u7406\u5458\u6743\u9650\u7684\uff09\u518d\u8fd4\u56de\u6b64\u5904\u8bbe\u7f6e\u3002 \u8fdb\u5165\u4e0b\u4e00\u6b65\uff0c\u52fe\u9009\u4e24\u4e2a\u786e\u8ba4\u6846\u3002 \u70b9\u51fb\u521b\u5efa\u5806\u6808\uff0c\u5373\u5f00\u59cb\u81ea\u52a8\u65b0\u5efa\u6574\u4e2a\u6846\u67b6\u5806\u6808\u3002\u7b49\u5f85\u5341\u51e0\u5206\u949f\u540e\u5806\u6808\u5efa\u7acb\u5b8c\u6210\uff0c\u5806\u6808\u72b6\u6001\u53ef\u770b\u5230\u5747\u4e3aCREATE_COMPLETE\u72b6\u6001\uff08\u8be5\u6a21\u677f\u81ea\u52a8\u5d4c\u59577\u4e2a\u5b50\u6a21\u677f\uff09\u3002 \u5728EC2\u5b9e\u4f8b\u5217\u8868\u91cc\u4e5f\u53ef\u4ee5\u67e5\u770b\u5230\u5bf9\u5e94\u7684\u5b9e\u4f8b\u4fe1\u606f\uff0c\u9009\u4e2dcromwell-server\u5b9e\u4f8b\u70b9\u51fb\u4e0a\u65b9\u201c\u8fde\u63a5\u201d\u67e5\u770bSSH\u767b\u5f55\u65b9\u5f0f\u3002 SSH\u767b\u5f55\u8fdbcromwell-server\u5b9e\u4f8b\u540e\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u63d0\u4ea4\u4e00\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u793a\u4f8b\u3002 wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/simple-hello.wdl curl -X POST \"http://localhost:8000/api/workflows/v1\" -H \"accept: application/json\" -F \"workflowSource=@simple-hello.wdl\" \u5176\u4e2dsimple-hello.wdl\u7684\u5185\u5bb9\u5982\u4e0b\uff0c\u662f\u4e00\u4e2a\u53ea\u6267\u884c\u4e00\u4e2atask\u7684\u6d4b\u8bd5\u811a\u672c: task echoHello{ command { echo \"Hello AWS!\" } runtime { docker: \"amazonlinux:latest\" } } workflow printHelloAndGoodbye { call echoHello } \u6d4b\u8bd5\u793a\u4f8b\u5f88\u5feb\u5b8c\u6210\uff0c\u5728CloudWatch Log\u4e2d\u6709\u8be6\u7ec6\u8bb0\u5f55\u4fe1\u606f.","title":"\u4e00\u952e\u90e8\u7f72\u7684\u8fc7\u7a0b\u53ca\u6d4b\u8bd5\u793a\u4f8b"},{"location":"blogs/2020-01-06-wdl-and-cromwell-on-aws-batch-china/#gatk","text":"\u672c\u4f8b\u5b50\u662f\u57fa\u4e8ehg38\u516c\u5f00\u6570\u636e\u8fdb\u884cGATK\u5206\u6790\u6d41\u7a0b\u4e2dHaplotypeCaller \u6b65\u9aa4\u5904\u7406\u3002\uff08\u63d0\u793a\uff1a\u672c\u5b9e\u9a8c\u4f1a\u4ea7\u751f\u4e00\u5b9a\u8fd0\u884c\u8d39\u7528\u6839\u636e\u8fd0\u884c\u5b9e\u4f8b\u7c7b\u578b\u548cSpot\u6bd4\u4f8b\u8bbe\u7f6e\u6709\u6240\u4e0d\u540c\uff09 SSH\u767b\u5f55\u8fdbcromwell-server\u5b9e\u4f8b\u540e\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5de5\u4f5c\u6d41\u811a\u672cHaplotypeCaller.aws.wdl\u548c\u914d\u7f6e\u6587\u4ef6HaplotypeCaller.aws.json wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/HaplotypeCaller.aws.wdl wget https://awshcls.s3.cn-northwest-1.amazonaws.com.cn/cromwellcn/scripts/HaplotypeCaller.aws.json \u5176\u4e2d\u914d\u7f6e\u6587\u4ef6HaplotypeCaller.aws.json\u7684\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff0c\u5176\u4e2d\u7684s3://\u5f00\u5934\u7684\u5730\u65b9\u662f\u7528\u5230\u7684bam/fastq\u7b49\u8d44\u6e90\u6587\u4ef6\uff0c\u60a8\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5230\u81ea\u5df1S3\u5b58\u50a8\u6876\u7684\u6587\u4ef6\u94fe\u63a5\u3002 { \"##_COMMENT1\": \"INPUT BAM\", \"HaplotypeCallerGvcf_GATK4.input_bam\": \"s3://gatk-test-data/wgs_bam/NA12878_24RG_hg38/NA12878_24RG_small.hg38.bam\", \"HaplotypeCallerGvcf_GATK4.input_bam_index\": \"s3://gatk-test-data/wgs_bam/NA12878_24RG_hg38/NA12878_24RG_small.hg38.bai\", \"##_COMMENT2\": \"REFERENCE FILES\", \"HaplotypeCallerGvcf_GATK4.ref_dict\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.dict\", \"HaplotypeCallerGvcf_GATK4.ref_fasta\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.fasta\", \"HaplotypeCallerGvcf_GATK4.ref_fasta_index\": \"s3://broad-references/hg38/v0/Homo_sapiens_assembly38.fasta.fai\", \"##_COMMENT3\": \"INTERVALS\", \"HaplotypeCallerGvcf_GATK4.scattered_calling_intervals_list\": \"s3://gatk-test-data/intervals/hg38_wgs_scattered_calling_intervals.txt\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.interval_padding\": 100, \"##_COMMENT4\": \"DOCKERS\", \"HaplotypeCallerGvcf_GATK4.gatk_docker\": \"broadinstitute/gatk:4.0.0.0\", \"##_COMMENT5\": \"PATHS\", \"HaplotypeCallerGvcf_GATK4.gatk_path\": \"/gatk/gatk\", \"##_COMMENT6\": \"JAVA OPTIONS\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.java_opt\": \"-Xms8000m\", \"HaplotypeCallerGvcf_GATK4.MergeGVCFs.java_opt\": \"-Xms8000m\", \"##_COMMENT7\": \"MEMORY ALLOCATION\", \"HaplotypeCallerGvcf_GATK4.HaplotypeCaller.mem_size\": \"10 GB\", \"HaplotypeCallerGvcf_GATK4.MergeGVCFs.mem_size\": \"30 GB\", } \u63d0\u4ea4\u5982\u4e0b\u547d\u4ee4\u542f\u52a8\u5206\u6790\u6d41\u7a0b: curl -X POST \"http://localhost:8000/api/workflows/v1\" -H \"accept: application/json\" -F \"workflowSource=@HaplotypeCaller.aws.wdl\" -F workflowInputs=@HaplotypeCaller.aws.json \u5206\u6790\u5b8c\u6210\u540e\uff0c\u53ef\u5728CloudWatch Log\u4e2d\u67e5\u770b\u6bcf\u4e2a\u4efb\u52a1\u7684\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u7ed3\u679c\u6570\u636e\u6587\u4ef6\u5b58\u653e\u5728s3://yourbucket/cromwell-execution/HaplotypeCallerGvcf_GATK4/{UUID}/call-HaplotypeCaller/shard-xx/\u8def\u5f84\u4e0b\u3002 PS: \u5b9e\u9a8c\u5b8c\u6210\u540e\uff0c\u5728CloudFormation\u754c\u9762\u4e2d\u9009\u62e9\u6a21\u677f\u5220\u9664\u5373\u53ef\u91ca\u653e\u5806\u6808\u76f8\u5173\u8d44\u6e90\u907f\u514d\u4ea7\u751f\u4e0d\u5fc5\u8981\u7684\u8d39\u7528\uff0c\u5176\u4e2dS3\u5b58\u50a8\u6876\u548cCloudWatch Log\u8bb0\u5f55\u53ef\u5728\u5bf9\u5e94\u670d\u52a1\u5185\u624b\u52a8\u5220\u9664\u3002","title":"\u8fd0\u884c\u4e00\u4e2aGATK\u57fa\u56e0\u5206\u6790\u5904\u7406\u7684\u5b9e\u9645\u4f8b\u5b50"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/","text":"\u5bb9\u5668\uff01\u5229\u5668\uff01\u6279\u91cf\u8ba1\u7b97AWS Batch AWS Batch \u670d\u52a1\u8fd1\u671f\u5df2\u5728 AWS \u4e2d\u56fd\u533a\u57df\u4e0a\u7ebf\u8fd0\u884c\u3002 AWS Batch \u5df2\u5728\u5168\u7403\u8303\u56f4\u5185 \u5e7f\u6cdb\u670d\u52a1\u4e8e\u57fa\u56e0\u6d4b\u5e8f\u3001\u6570\u5b57\u5a92\u4f53\u6e32\u67d3\u3001\u79d1\u5b66\u7814\u7a76\u3001\u91d1\u878d\u670d\u52a1\u7b49\u9ad8\u6027\u80fd\u8ba1\u7b97\uff08HPC\uff09\u7684 \u4e1a\u52a1\u573a\u666f\u4e2d\u3002\u672c\u6587\u901a\u8fc7\u4e00\u4e2a\u53ea\u9700\u4e94\u4e2a\u6b65\u9aa4\u7684\u52a8\u624b\u5b9e\u8df5\u6765\u793a\u4f8b\u5982\u4f55\u5229\u7528 AWS Batch \u5feb\u901f \u642d\u5efa HPC \u96c6\u7fa4\uff0c \u4ee5\u5e2e\u52a9\u60a8\u5feb\u901f\u4e0a\u624b\u8fd0\u7528 AWS Batch \u670d\u52a1 -- D.C aws batch\u6587\u6863 AWS Batch \u57fa\u672c\u4ecb\u7ecd \u4e00\u53e5\u8bdd\u7406\u89e3\uff1a\u628a\u5206\u6790\u6d41\u7a0b\u6253\u5305\u6210docker\uff0c\u6279\u91cf\u63d0\u4ea4\u5230aws\uff0c\u4e0d\u7528\u53bb\u7ba1\u5f00\u4ec0\u4e48\u673a\u5668\uff0cbatch\u4f1a\u5e2e\u4f60\u641e\u5b9a\uff0c\u8dd1\u5b8c\u81ea\u52a8\u91ca\u653e\u8d44\u6e90\uff0c\u968f\u7528\u968f\u5f00\uff0c\u7528\u5b8c\u5c31\u5173\u3002 AWS Batch \u8ba9\u5f00\u53d1\u4eba\u5458\u3001\u79d1\u5b66\u5bb6\u548c\u5de5\u7a0b\u5e08\u80fd\u591f\u8f7b\u677e\u9ad8\u6548\u5730\u5728 AWS \u4e0a\u8fd0\u884c\u6210\u5343\u4e0a\u4e07\u4e2a\u6279 \u5904\u7406\u8ba1\u7b97\u4f5c\u4e1a\u3002 AWS Batch \u53ef\u6839\u636e\u63d0\u4ea4\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u5377\u548c\u7279\u5b9a\u8d44\u6e90\u9700\u6c42\u52a8\u6001\u9884\u7f6e\u6700 \u4f73\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5982 CPU \u6216\u5185\u5b58\u4f18\u5316\u5b9e\u4f8b\uff09\u6570\u91cf\u548c\u7c7b\u578b\u3002\u501f\u52a9 AWS Batch\uff0c\u60a8\u65e0\u9700\u5b89\u88c5 \u548c\u7ba1\u7406\u8fd0\u884c\u60a8\u7684\u4f5c\u4e1a\u6240\u4f7f\u7528\u7684\u6279\u5904\u7406\u8ba1\u7b97\u8f6f\u4ef6\u6216\u670d\u52a1\u5668\u96c6\u7fa4\uff0c\u4ece\u800c\u4f7f\u60a8\u80fd\u591f\u4e13\u6ce8\u4e8e\u5206 \u6790\u7ed3\u679c\u548c\u89e3\u51b3\u95ee\u9898\u3002 AWS Batch \u6709\u7740\u4e30\u5bcc\u7684\u529f\u80fd\u7279\u6027\uff0c\u652f\u6301\u52a8\u6001\u8ba1\u7b97\u8d44\u6e90\u9884\u7f6e\u548c\u6269 \u5c55\uff0c\u652f\u6301\u7cbe\u7ec6\u4f5c\u4e1a\u5b9a\u4e49\u548c\u6743\u9650\u63a7\u5236\uff0c \u652f\u6301\u7d27\u5bc6\u8026\u5408\u578b\u7684 HPC \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u53ef\u4ee5\u57fa\u4e8e\u4f18\u5148 \u7ea7\u6765\u8fdb\u884c\u4efb\u52a1\u5b89\u6392\uff0c\u5177\u6709\u96c6\u6210\u7684\u76d1\u63a7\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002 AWS Batch \u5177\u6709\u7684\u4f18\u52bf\u5305\u62ec\uff1a \u5168\u6258\u7ba1: AWS Batch \u53ef\u4e3a\u60a8\u7ba1\u7406\u6240\u6709\u57fa\u7840\u8bbe\u65bd\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9884\u7f6e\u3001\u7ba1\u7406\u3001\u76d1\u63a7\u548c \u6269\u5c55\u60a8\u7684\u6279\u5904\u7406\u8ba1\u7b97\u4f5c\u4e1a\u6240\u5e26\u6765\u7684\u590d\u6742\u6027\u3002 \u4e0e AWS \u539f\u751f\u96c6\u6210: AWS Batch \u5df2\u4e0e AWS \u5e73\u53f0\u539f\u751f\u96c6\u6210\uff0c\u8ba9\u60a8\u80fd\u591f\u5229\u7528 AWS \u7684 \u6269\u5c55\u3001\u8054\u7f51\u548c\u8bbf\u95ee\u7ba1\u7406\u529f\u80fd\u3002\u8fd9\u4fbf\u4e8e\u60a8\u8f7b\u677e\u8fd0\u884c\u80fd\u591f\u5b89\u5168\u5730\u4ece AWS \u6570\u636e\u5b58\u50a8\uff08\u5982 Amazon S3 \u548c Amazon DynamoDB\uff09\u4e2d\u68c0\u7d22\u6570\u636e\u5e76\u5411\u5176\u5199\u5165\u4f5c\u4e1a\u7684\u6570\u636e\u3002 \u6210\u672c\u4f18\u5316: AWS Batch \u53ef\u6839\u636e\u6240\u63d0\u4ea4\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u6570\u91cf\u548c\u8d44\u6e90\u8981\u6c42\u9884\u7f6e\u8ba1\u7b97\u8d44 \u6e90\u5e76\u4f18\u5316\u4f5c\u4e1a\u5206\u914d\u3002 AWS Batch \u80fd\u591f\u5c06\u8ba1\u7b97\u8d44\u6e90\u52a8\u6001\u6269\u5c55\u81f3\u8fd0\u884c\u60a8\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u6240 \u9700\u7684\u4efb\u4f55\u6570\u91cf\uff0c\u4ece\u800c\u4f7f\u60a8\u4e0d\u5fc5\u53d7\u56fa\u5b9a\u5bb9\u91cf\u96c6\u7fa4\u7684\u9650\u5236\u3002 AWS Batch \u8fd8\u53ef\u5229\u7528 Spot \u5b9e\u4f8b\u8fdb\u4e00\u6b65\u964d\u4f4e\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u8d39\u7528\u3002 \u5e94\u7528\u573a\u666f\uff08\u57fa\u56e0\uff09 \u751f\u547d\u79d1\u5b66\u4e2d DNA \u6d4b\u5e8f\u573a\u666f\u2014\u2014\u751f\u7269\u4fe1\u606f\u5b66\u5bb6\u8fdb\u884c\u57fa\u56e0\u7ec4\u5e8f\u5217\u7684\u4e8c\u7ea7\u5206\u6790\u65f6\uff0c\u5229\u7528 AWS Batch \u670d\u52a1\u6765\u7b80\u5316\u5e76\u52a0\u901f\u6d4b\u5e8f\u5206\u6790\u7684\u5904\u7406\u8fc7\u7a0b\uff0c \u4ee5\u6279\u91cf\u5904\u7406\u7684\u65b9\u5f0f\u5c06\u539f\u59cb DNA \u8bfb\u6570\u88c5\u914d\u6210\u5b8c\u6574\u57fa\u56e0\u7ec4\u5e8f\u5217\uff0c \u540c\u65f6\u51cf\u5c11\u6d4b\u5e8f\u5206\u6790\u7684\u6570\u636e\u504f\u5dee\u3002 Let's do it \u5229\u7528 AWS Batch \u642d\u5efa\u9ad8\u6027\u80fd\u96c6\u7fa4 \u4f60\u591f\u683c\u4e86\u4e48\uff1a \u5177\u6709\u4e00\u4e2a AWS \u4e2d\u56fd\u533a\u57df\u5e10\u53f7(\u6216 Global \u5e10\u53f7)\u3002 \u65b0\u5efa\u4e86\u8db3\u591f\u6743\u9650\u7684 IAM User \u5e76\u8bb0\u5f55\u4e86\u8bbf\u95ee\u5bc6\u94a5\uff08AK\uff09 \u548c\u79d8\u5bc6\u5bc6\u94a5\uff08SK\uff09 \u3002 \u638c\u63e1 Amazon EC2 \u542f\u52a8\u3001 SSH \u767b\u5f55 EC2\u3001\u521b\u5efa S3 \u5b58\u50a8\u6876\u7684\u57fa\u672c\u64cd\u4f5c\u3002 \u672c\u5b9e\u9a8c\u5229\u7528 Batch \u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u6293\u53d6\u811a\u672c\u8fd0\u884c\u7684 Demo\uff0c \u539f\u7406\u5982\u4e0b\u56fe\u6d41\u7a0b\u6240\u793a\u3002 Batch\u6267\u884c\u7684\u4efb\u52a1\u662f\u4ee5 Docker \u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\u7684\uff0c\u5bb9\u5668\u955c\u50cf\u57fa\u4e8e Amazon ECS \u670d\u52a1\u6765\u7ba1\u7406\u3002 \u5b9e\u9a8c\u4e2d\u751f\u6210\u7684\u7b80\u5355\u955c\u50cf\u91cc\u5305\u542b\u4e00\u4e2a\u8f85\u52a9\u7a0b\u5e8f\uff0c\u8d1f\u8d23\u4ece S3 \u5b58\u50a8\u4e2d\u4e0b\u8f7d\u540d\u4e3a myjob.sh \u7684\u81ea \u5b9a\u4e49\u4efb\u52a1\u811a\u672c\uff08\u540c\u65f6\u4e5f\u652f\u6301 zip \u6587\u4ef6\uff09\uff0c\u7531 Batch \u8d1f\u8d23\u542f\u52a8 EC2 \u5b9e\u4f8b\u6765\u88c5\u8f7d\u5bb9\u5668\u5177\u4f53\u6267 \u884c\u3002 \u5b9e\u9a8c\u4e2d\u7684\u4efb\u52a1\u811a\u672c\u4f1a\u8f93\u51fa\u6253\u5370\u4e00\u4e9b\u6f14\u793a\u4fe1\u606f\uff0c\u5728 CloudWatch \u7684 Log \u65e5\u5fd7\u8bb0\u5f55\u4e2d\u53ef \u4ee5\u67e5\u770b\u9a8c\u8bc1\u4efb\u52a1\u811a\u672c\u7684\u8fd9\u4e9b\u8f93\u51fa\u4fe1\u606f\u3002\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u81ea\u5df1\u6539\u5199\u6216\u4e30\u5bcc myjob.sh \u7684\u811a\u6b65\u6267\u884c\u5185\u5bb9\u3002 \u4e0a\u56fe\u4e2d\u51e0\u4e2aaws\u670d\u52a1\u7b80\u5355\u89e3\u91ca\u4e0b\uff1a ECR: \u6ce8\u518c\u4fdd\u5b58\u5bb9\u5668\u955c\u50cf\u7684\u5730\u65b9\uff0c\u6253\u597ddocker\u4e4b\u540e\u8981\u63a8\u5230\u8fd9\u91cc\uff0c\u7edf\u4e00\u6258\u7ba1\u3002 ECS\uff1a \u5e2e\u4f60\u8fd0\u884c\u548c\u7ba1\u7406\u5bb9\u5668\u7684\u670d\u52a1 Batch\uff1a \u6839\u636e\u4f60\u9884\u8bbe\u7684\u8ba1\u7b97\u8d44\u6e90\u548c\u961f\u5217\uff0c\u5e2e\u4f60\u63d0\u4ea4\u5206\u6790\u4efb\u52a1\u5230docker\uff0c\u5e76\u8c03\u5ea6\u4f5c\u4e1a\u961f\u5217\u3002 S3: \u5b58\u50a8\u6876\uff0c\u4f60\u53ef\u4ee5\u548c\u672c\u6587\u4e00\u6837\uff0c\u5c06\u4ee3\u7801\u5e93\u653e\u5728\u6876\u91cc\uff0c\u8dd1docker\u65f6\u62c9\u8fc7\u53bb\uff0c\u5bf9\u4e8e\u8981\u9891\u7e41\u4fee\u6539\u4ee3\u7801\u7684\u4eba\u6765\u8bf4\u662f\u798f\u97f3\uff0c\u56e0\u4e3a\u4f60\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u6253docker\u4e86\uff01 CloudWatch Log: log\u65e5\u5fd7\uff0c \u5f00\u53d1\u8c03\u8bd5\u7684\u65f6\u5019\u4f60\u5c31\u77e5\u9053\u5979\u597d\u4e86\uff1a\uff09 Role: aws\u59cb\u7ec8\u628a\u5b89\u5168\u653e\u5728\u7b2c\u4e00\u4f4d\uff0c\u6240\u4ee5\u6bcf\u4e2a\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u7684\u89d2\u8272\uff0c\u51b3\u5b9a\u5979\u80fd\u5e72\u4ec0\u4e48\u4e0d\u80fd\u5e72\u4ec0\u4e48\u3002 \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4\uff1a \u51c6\u5907\u5904\u7406\u4efb\u52a1\u7684 Docker \u955c\u50cf\u3002 \u672c\u5b9e\u9a8c\u9700\u8981\u542f\u52a8\u4e00\u4e2a EC2 \u5b9e\u4f8b\u6765\u5236\u4f5c Docker \u955c\u50cf\u3002 \u5728\u4e2d\u56fd\u533a\u57df\u5b9e\u9a8c\u65f6\u9009\u62e9\u5b81\u590f\u533a\u57df\uff0c \u542f\u52a8 EC2 \u73af\u5883\u65f6\u9009\u53d6 Amazon Linux 2 \u7c7b\u578b\u7684 AMI\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5b9e\u4f8b\u7c7b\u578b\u9009\u62e9 t2.micro\u3002 [\u9ad8\u80fd]\u4e00\u5927\u6ce2\u547d\u4ee4\u884c\u6765\u88ad \uff1a EC2 \u5c31\u7eea\u540e\u5728\u672c\u5730\u901a\u8fc7 SSH \u65b9\u5f0f\u767b\u5f55\uff08putty,xshell,gitbash...\uff09 ssh -i yourkey.pem ec2-user@your-ec2-public-ip \u914d\u7f6e CLI \u7684\u6743\u9650\uff0c\u6839\u636e\u547d\u4ee4\u63d0\u793a\u8f93\u5165 AK \u548c SK \u5bc6\u94a5\u503c\uff0c\u9ed8\u8ba4\uff1a aws configure \u6267\u884c\u4e00\u6b21\u66f4\u65b0\u5e76\u5b89\u88c5 docker \u670d\u52a1\uff1a sudo yum update -y sudo yum install docker \u542f\u52a8 Docker \u670d\u52a1\uff1a sudo service docker start \u4e0b\u8f7d\u5b9e\u9a8c\u5305\u7684 github \u6e90\u7801\uff1a wget https://github.com/awslabs/aws-batch-helpers/archive/master.zip unzip master.zip \u89e3\u538b\u8fdb\u5165\u8def\u5f84\u540e\u67e5\u770b Dockerfile \u6587\u4ef6\uff1a vim aws-batch-helpers-master/fetch-and-run/Dockerfile \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a FROM amazonlinux:latest # \u6307\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u955c\u50cf RUN yum -y install unzip aws-cli # \u5b89\u88c5aws \u547d\u4ee4\u884c\u5de5\u5177 ADD fetch_and_run.sh /usr/local/bin/fetch_and_run.sh # \u628a fetch_and_run.sh \u811a\u672c\u62f7\u8d1d\u81f3/usr/local/bin \u8def\u5f84\u4e0b WORKDIR /tmp # \u6307\u5b9a\u5de5\u4f5c\u76ee\u5f55 USER nobody # \u6307\u5b9auser ENTRYPOINT [\"/usr/local/bin/fetch_and_run.sh\"] # \u6307\u5b9a\u5bb9\u5668\u8fd0\u884c\u7684\u5165\u53e3\u662f\u8c03\u7528/usr/local/bin/fetch_and_run.sh \u811a\u672c \u5728 \u4e2d\u56fd\u533a \u5b9e\u9a8c\u65f6\u9700\u8981\u4fee\u6539\u4e00\u4e0b fetch_and_run.sh \u811a\u672c\u5185\u5bb9\uff08Global \u533a\u57df\u8df3\u8fc7\u6b64\u6b65\uff09 vim aws-batch-helpers-master/fetch-and-run/fetch_and_run.sh \u5c06 fetch_and_run_script()\u51fd\u6570\u7684\u7b2c\u4e00\u53e5\u6539\u6210\u5982\u4e0b\u5e76\u4fdd\u5b58\u9000\u51fa\u7f16\u8f91(\u4fee\u6539\u4e2d\u56fd\u533a\u7684S3\u5730\u5740)\uff1a aws s3 cp \"${BATCH_FILE_S3_URL}\" - > \"${TMPFILE}\" --endpoint \"https://s3.cn-northwest-1.amazonaws.com.cn\" || error_exit \"Failed to download S3 script.\" \u628a ec2-user \u52a0\u5230 docker \u7ec4\u91cc\uff08\u514d\u5f97\u540e\u7eed\u6bcf\u6b21 docker \u547d\u4ee4\u524d\u90fd\u8981\u52a0 sudo\uff09 , \u6267\u884c\u5b8c\u9000\u51fa SSH sudo usermod -a -G docker ec2-user Docker \u955c\u50cf\u4f20\u5165 ECR \u5b58\u50a8\u5e93 \u8fdb\u5165 ECR \u63a7\u5236\u53f0\u9009\u62e9\u201cRepositories\u201d\u9875\uff0c\u70b9\u51fb\u201c\u521b\u5efa\u5b58\u50a8\u5e93\u201d\uff0c\u586b\u5199\u540d\u79f0\u4e3a \u201cawsbatch/fetch_and_run\u201d\u540e\u70b9\u51fb\u521b\u5efa\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728\u201c\u5b58\u50a8\u5e93\u201d\u5217\u8868\u4e2d\u9009\u4e2d\u201cawsbatch/fetch_and_run\u201d\u8fd9\u4e00\u680f\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c\u67e5\u770b\u63a8\u9001\u547d\u4ee4\u201d\u6309\u94ae\uff0c\u5373\u51fa\u73b0\u5982\u4e0b\u754c\u9762\uff0c\u91cc\u9762\u8be6\u7ec6\u5217\u51fa\u4e86\u63a8\u9001\u81f3 ECR \u7684\u6b65\u9aa4\u3002 \u91cd\u65b0 SSH \u767b\u5f55\u5230 EC2 \u4e0a\u5e76\u8fdb\u5165 fetch-and-run \u8def\u5f84: ssh -i yourkey.pem ec2-user@your-ec2-public-ip cd aws-batch-helpers-master/fetch-and-run \u9010\u4e2a\u6267\u884c\u4e0a\u8ff0\u7b2c2\u6b65\u201c\u67e5\u770b\u63a8\u9001\u547d\u4ee4\u201d \u56fe\u4e2d\u7684\u56db\u6761\u547d\u4ee4\uff1a $(aws ecr get-login --no-include-email --region cn-northwest-1) docker build -t awsbatch/fetch_and_run . \u6b63\u5e38\u7f16\u8bd1\u5b8c\u6210\u7684\u8f93\u51fa\u4fe1\u606f\u5982\u4e0b\uff1a Sending build context to Docker daemon 373.8 kB Step 1/6 : FROM amazonlinux:latest latest: Pulling from library/amazonlinux c9141092a50d: Pull complete Digest: sha256:2010c88ac1****\u2026 Status: Downloaded newer image for amazonlinux:latest ---> 8ae6f52035b5 Step 2/6 : RUN yum -y install unzip aws-cli ---> Running in e49cba995ea6 Loaded plugins: ovl, priorities Resolving Dependencies --> Running transaction check ---> Package aws-cli.noarch 0:1.11.29-1.45.amzn1 will be installed << removed for brevity >> Complete! \u8f93\u5165\u547d\u4ee4\u9a8c\u8bc1\u4e0b\u955c\u50cf\u4fe1\u606f\uff1a $ docker images REPOSITORY TAG IMAGE ID CREATED awsbatch/fetch_and_run latest 9aa226c28efc 19 seconds ago amazonlinux latest 8ae6f52035b5 5 weeks ago \u7ee7\u7eed\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u7ed9\u955c\u50cf\u6dfb\u52a0\u6807\u7b7e\uff1a docker tag awsbatch/fetch_and_run:latest 112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run:latest \u6267\u884c docker \u955c\u50cf\u63a8\u9001\u547d\u4ee4\uff1a docker push 112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run:latest \u5f85\u63d0\u793a\u4fe1\u606f\u4e2d pushed \u5b8c\u6210\u540e\u53ef\u5728 ECR \u5b58\u50a8\u5e93\u4e2d\u67e5\u770b\u5230\u955c\u50cf\u7684\u4fe1\u606f\uff0c\u62f7\u8d1d\u8bb0\u5f55\u4e0b\u8be5 URI\u540d\u79f0\u3002 \u4e0a\u4f20\u4f5c\u4e1a\u811a\u672c\u81f3 S3 \u5b58\u50a8\u5e76\u914d\u7f6e\u5bf9\u5e94 IAM \u6743\u9650\u62f7\u8d1d\u4ee5\u4e0b\u4ee3\u7801\u5b58\u5165\u672c\u5730\u6587\u4ef6\u547d\u540d\u4e3a myjob.sh\u3002 #!/bin/bash date echo \"Args: $@\" env echo \"This is my simple test job!.\" echo \"jobId: $AWS_BATCH_JOB_ID\" echo \"jobQueue: $AWS_BATCH_JQ_NAME\" echo \"computeEnvironment: $AWS_BATCH_CE_NAME\" sleep $1 date echo \"bye bye!!\" \u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u4e0a\u4f20\u811a\u672c\u81f3\u5df2\u4e8b\u5148\u521b\u5efa\u597d\u7684 S3 \u5b58\u50a8\u6876\u3002 aws s3 cp myjob.sh s3://testbucket/myjob.sh \u7531\u4e8e\u955c\u50cf fetch_and_run \u4f5c\u4e3a Batch \u4f5c\u4e1a\u6267\u884c\u8fc7\u7a0b\u4e2d\u8981\u8bbf\u95ee S3 \u4e0b\u8f7d\u4efb\u52a1\u811a\u672c\uff0c\u6240\u4ee5\u9700\u8981\u7ed9 Batch \u4e2d\u7684\u5bb9\u5668\u914d\u7f6e\u4e00\u4e2a\u80fd\u8bfb\u53d6 S3 \u5b58\u50a8\u6876\u7684 IAM \u6743\u9650\u89d2\u8272\u3002\u63a7\u5236\u53f0\u641c\u7d22\u201cIAM\u201d\u5e76\u6253\u5f00IAM\uff0c\u5206\u522b\u70b9\u51fb\u89d2\u8272->\u521b\u5efa\u89d2\u8272\u3002\u53d7\u4fe1\u4efb\u5b9e\u4f53\u9009\u201cAWS \u4ea7\u54c1\u201d\uff0c\u5e76\u5728\u670d\u52a1\u4e2d\u9009\u62e9 \u201cElastic Container Service\u201d\uff1a \u7136\u540e\u5728\u968f\u4e4b\u51fa\u73b0\u7684\u4f7f\u7528\u6848\u4f8b\u5217\u8868\u91cc\uff0c\u9009\u62e9\u201cElastic Container Service Task\u201d\u4e00\u9879\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6743\u9650\u3002 \u5728 Attach \u6743\u9650\u7b56\u7565\u9875\u4e2d\u7684\u641c\u7d22\u680f\u4e2d\u8f93\u5165 AmazonS3ReadOnlyAccess \u641c\u7d22\u5e76\u9009\u53d6\u8be5\u6743\u9650\u7b56\u7565\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6807\u7b7e\u586b\u5199\uff08\u53ef\u9009\uff09\u6807\u7b7e\u5185\u5bb9\uff0c\u518d\u70b9\u51fb\u4e0b\u4e00\u6b65\u5ba1\u6838\uff0c\u5728\u89d2\u8272\u540d\u79f0\u4e2d\u586b\u5165 batchJobRole \u540e\uff0c\u70b9\u51fb\u521b\u5efa\u89d2\u8272\u6309\u94ae\u3002 Batch \u670d\u52a1\u7684\u4f5c\u4e1a\u914d\u7f6e\u3002 Batch \u7684\u4f5c\u4e1a\u914d\u7f6e\u4f9d\u6b21\u5305\u62ec\uff1a \u8ba1\u7b97\u73af\u5883(Compute Environment)\u914d\u7f6e : \u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Compute Environment \u9875\u70b9\u51fb\u521b\u5efa\u3002\u5176\u4e2d\u8ba1\u7b97\u73af\u5883\u53c2\u6570\u7ec4\u7684\u914d\u7f6e\u5982\u4e0b\u56fe\uff0c\u73af\u5883\u7c7b\u578b\u9009\u62e9\u6258\u7ba1\uff0c\u5c06\u7531 Batch \u6765\u8d1f\u8d23\u7ba1\u7406\u5b9e\u4f8b\u7684\u9009\u62e9\u548c\u8c03\u5ea6\u3002\u8ba1\u7b97\u8d44\u6e90\u53c2\u6570\u7ec4\u53ef\u6307\u5b9a\u9700\u8981\u7684\u5b9e\u4f8b\u7c7b\u578b\uff0c\u5176\u4e2d\u6700\u5c0f vCPU \u6570\u586b 1\uff0c\u6240\u9700 vCPU \u586b2\uff0c\u6700\u5927 vCPU \u586b 4\uff0c \u9009\u62e9\u5df2\u6709 EC2 \u5bc6\u94a5\u5bf9\uff0c \u5176\u4ed6\u4fdd\u6301\u9ed8\u8ba4\u5e76\u70b9\u51fb\u521b\u5efa\u3002 \u4f5c\u4e1a\u961f\u5217 \uff08JobQueue\uff09\u914d\u7f6e :\u4f5c\u4e1a\u961f\u5217\u7684\u914d\u7f6e\u662f\u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Job Queue \u9875\u70b9\u51fb\u521b\u5efa\u3002\u6307\u5b9a\u961f\u5217\u540d\u79f0queFetchRun\uff0c Priority \u4f18\u5148\u7ea7\u586b 1\uff0c\u4e0b\u65b9\u8ba1\u7b97\u73af\u5883\u9009\u62e9\u5217\u8868\u91cc\u9009\u62e9\u521a\u521b\u5efa\u7684\u8ba1\u7b97\u73af\u5883\u914d\u7f6e\u540d\u79f0 envFetchRun\uff0c\u9009\u53d6\u540e\u4f1a\u663e\u793a\u5176\u6458\u8981\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u4f5c\u4e1a\u5b9a\u4e49(Job Definition)\u7684\u914d\u7f6e : \u4f5c\u4e1a\u5b9a\u4e49\u914d\u7f6e\u662f\u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Job Definition \u9875\u70b9\u51fb\u521b\u5efa\u3002\u8f93\u5165 Job \u540d\u79f0\uff0c\u4f8b\u5982 defFetchRun\u3002 Job role \u91cc\u9009\u53d6\u521a\u521b\u5efa\u7684 IAM \u89d2\u8272 batchJobRole\u3002 Environment \u4e2d\u7684Container image \u4e00\u680f\u586b\u5165\u4e4b\u524d\u521b\u5efa\u7684 Dock \u955c\u50cf\u7684 URI \u540d\u79f0\uff0c\u4f8b\u5982112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run\u3002 \u6b64\u5904Command \u4e00\u680f\u4fdd\u6301\u4e3a\u7a7a\uff0c vCPU \u586b 1\uff0c Memory \u586b 500\uff0c Security \u4e2d\u7684 User \u680f\u586bnobody\u3002\u5168\u90e8\u586b\u5199\u5b8c\u6210\u540e\u70b9\u51fb\u521b\u5efa\u4f5c\u4e1a\u5b9a\u4e49\u3002 \u63d0\u4ea4 Batch \u4efb\u52a1\u5e76\u67e5\u770b\u6267\u884c\u72b6\u6001\u3002\uff08\u662f\u65f6\u5019\u5c55\u73b0\u771f\u6b63\u7684\u5b9e\u529b\u4e86\uff09 \u5728 Batch \u63a7\u5236\u53f0\u9009\u62e9 Jobs \u9875\u9762\u70b9\u51fb\u201c\u63d0\u4ea4\u4efb\u52a1\u201d\u6309\u94ae\u3002 Jobname \u680f\u8f93\u5165\u6307\u5b9a\u7684 Job \u540d\u79f0\uff0c Job definition \u4e2d\u9009\u62e9\u524d\u4e00\u6b65\u8bbe\u7f6e\u597d\u7684\u4f5c\u4e1a\u5b9a\u4e49defFetchRun:1(\u5192\u53f7\u540e\u662f\u7248\u672c\u53f7)\uff0c Job queue \u4e00\u680f\u9009\u53d6\u524d\u4e00\u6b65\u8bbe\u597d\u7684\u4f5c\u4e1a\u961f\u5217\u540d\u79f0queFetchRun\u3002 Command \u547d\u4ee4\u91cc\u9762\u8f93\u5165\u201cmyjob.sh 60\u201d\uff0c\u8bbe\u7f6e\u597d\u7684\u4fe1\u606f\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5728\u73af\u5883\u53d8\u91cf\u4e00\u680f\u4e2d\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u7684\u952e\u503c\u5bf9\uff1a Key=BATCH_FILE_TYPE, Value=script Key=BATCH_FILE_S3_URL, Value=s3://testbucket/myjob.sh \u4efb\u52a1\u63d0\u4ea4\u540e\u5728 Batch \u63a7\u5236\u53f0\u53ef\u4ee5\u67e5\u770b\u5176\u6700\u65b0\u72b6\u6001\uff0c\u4efb\u52a1\u4f1a\u7ecf\u5386 submitted\u3001 pending\u3001runnable\u3001 starting\u3001 running \u5404\u4e2a\u72b6\u6001\u3002\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u540e\u4f1a\u5728 succeeded \u4e00\u9875\u4e0b\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u70b9\u51fb\u4f5c\u4e1a ID \u94fe\u63a5\u7684\u8be6\u60c5\u9875\u9762\u4e2d\u53ef\u70b9\u51fb\u201cCloudWatch \u65e5\u5fd7\u201d \u7684\u94fe\u63a5\u67e5\u770b\u8be6\u7ec6\u65e5\u5fd7\u4fe1\u606f\uff0c\u5176\u4e2d\u5c31\u53ef\u4ee5\u770b\u5230 myjob.sh \u4e2d echo \u8f93\u51fa\u7684\u4fe1\u606f\u5185\u5bb9\u3002\u5982\u4e0b\u56fe\u6240\u793a: \uff08\u53ef\u9009\uff09\u5982\u679c\u9700\u8981\u6279\u91cf\u63d0\u4ea4\u66f4\u591a\u6570\u91cf\u7684\u4f5c\u4e1a\u4efb\u52a1\uff0c\u53ef\u5728\u63d0\u4ea4\u4efb\u52a1\u53c2\u6570\u9875\u9762\u4e2d\u7684Job Type \u4e2d\u9009\u62e9 Array \u7c7b\u578b\u5e76\u586b\u5165\u4e00\u4e2a\u6d4b\u8bd5\u6570\u91cf\u503c\uff0c\u540c\u6837\u53ef\u5728 CloudWatch \u4e2d\u67e5\u770b\u6279\u91cf\u4efb\u52a1\u6267\u884c\u7684\u60c5\u51b5\uff0c\u5e76\u5728 EC2 \u7684\u8d44\u6e90\u5217\u8868\u91cc\u53ef\u4ee5\u770b\u5bf9\u5e94\u7684\u5b9e\u4f8b\u6269\u5c55\u60c5\u51b5\u3002 \u56de\u6536\u8d44\u6e90 \u52a8\u624b\u5b9e\u9a8c\u5b8c\u6210\u540e\u8bb0\u5f97\u56de\u6536\u91ca\u653e\u76f8\u5e94\u8d44\u6e90\uff0c\u91ca\u653e\u7684\u8d44\u6e90\u5305\u62ec\uff1a \u7981\u7528\u5e76\u5220\u9664 Batch \u670d\u52a1\u4e2d\u7684\u4f5c\u4e1a\u961f\u5217\u548c\u8ba1\u7b97\u73af\u5883\u4e2d\u7684\u914d\u7f6e\u8d44\u6e90\u3002 \u7ec8\u6b62\u5236\u4f5c Docker \u955c\u50cf\u6240\u7528\u7684 EC2 \u5b9e\u4f8b\u3002 \u5220\u9664 ECR \u5b58\u50a8\u5e93\u4e2d\u7684 Image \u955c\u50cf\u3002 S3 \u4e2d\u7684\u4efb\u52a1\u811a\u672c\u5220\u9664\u3002 CloudWatch \u4e2d\u7684\u5bf9\u5e94\u65e5\u5fd7\u8bb0\u5f55\u5220\u9664\u3002","title":"\u5bb9\u5668\uff01\u5229\u5668\uff01\u6279\u91cf\u8ba1\u7b97AWS Batch"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#aws-batch","text":"AWS Batch \u670d\u52a1\u8fd1\u671f\u5df2\u5728 AWS \u4e2d\u56fd\u533a\u57df\u4e0a\u7ebf\u8fd0\u884c\u3002 AWS Batch \u5df2\u5728\u5168\u7403\u8303\u56f4\u5185 \u5e7f\u6cdb\u670d\u52a1\u4e8e\u57fa\u56e0\u6d4b\u5e8f\u3001\u6570\u5b57\u5a92\u4f53\u6e32\u67d3\u3001\u79d1\u5b66\u7814\u7a76\u3001\u91d1\u878d\u670d\u52a1\u7b49\u9ad8\u6027\u80fd\u8ba1\u7b97\uff08HPC\uff09\u7684 \u4e1a\u52a1\u573a\u666f\u4e2d\u3002\u672c\u6587\u901a\u8fc7\u4e00\u4e2a\u53ea\u9700\u4e94\u4e2a\u6b65\u9aa4\u7684\u52a8\u624b\u5b9e\u8df5\u6765\u793a\u4f8b\u5982\u4f55\u5229\u7528 AWS Batch \u5feb\u901f \u642d\u5efa HPC \u96c6\u7fa4\uff0c \u4ee5\u5e2e\u52a9\u60a8\u5feb\u901f\u4e0a\u624b\u8fd0\u7528 AWS Batch \u670d\u52a1 -- D.C aws batch\u6587\u6863","title":"\u5bb9\u5668\uff01\u5229\u5668\uff01\u6279\u91cf\u8ba1\u7b97AWS Batch"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#aws-batch_1","text":"\u4e00\u53e5\u8bdd\u7406\u89e3\uff1a\u628a\u5206\u6790\u6d41\u7a0b\u6253\u5305\u6210docker\uff0c\u6279\u91cf\u63d0\u4ea4\u5230aws\uff0c\u4e0d\u7528\u53bb\u7ba1\u5f00\u4ec0\u4e48\u673a\u5668\uff0cbatch\u4f1a\u5e2e\u4f60\u641e\u5b9a\uff0c\u8dd1\u5b8c\u81ea\u52a8\u91ca\u653e\u8d44\u6e90\uff0c\u968f\u7528\u968f\u5f00\uff0c\u7528\u5b8c\u5c31\u5173\u3002 AWS Batch \u8ba9\u5f00\u53d1\u4eba\u5458\u3001\u79d1\u5b66\u5bb6\u548c\u5de5\u7a0b\u5e08\u80fd\u591f\u8f7b\u677e\u9ad8\u6548\u5730\u5728 AWS \u4e0a\u8fd0\u884c\u6210\u5343\u4e0a\u4e07\u4e2a\u6279 \u5904\u7406\u8ba1\u7b97\u4f5c\u4e1a\u3002 AWS Batch \u53ef\u6839\u636e\u63d0\u4ea4\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u5377\u548c\u7279\u5b9a\u8d44\u6e90\u9700\u6c42\u52a8\u6001\u9884\u7f6e\u6700 \u4f73\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5982 CPU \u6216\u5185\u5b58\u4f18\u5316\u5b9e\u4f8b\uff09\u6570\u91cf\u548c\u7c7b\u578b\u3002\u501f\u52a9 AWS Batch\uff0c\u60a8\u65e0\u9700\u5b89\u88c5 \u548c\u7ba1\u7406\u8fd0\u884c\u60a8\u7684\u4f5c\u4e1a\u6240\u4f7f\u7528\u7684\u6279\u5904\u7406\u8ba1\u7b97\u8f6f\u4ef6\u6216\u670d\u52a1\u5668\u96c6\u7fa4\uff0c\u4ece\u800c\u4f7f\u60a8\u80fd\u591f\u4e13\u6ce8\u4e8e\u5206 \u6790\u7ed3\u679c\u548c\u89e3\u51b3\u95ee\u9898\u3002 AWS Batch \u6709\u7740\u4e30\u5bcc\u7684\u529f\u80fd\u7279\u6027\uff0c\u652f\u6301\u52a8\u6001\u8ba1\u7b97\u8d44\u6e90\u9884\u7f6e\u548c\u6269 \u5c55\uff0c\u652f\u6301\u7cbe\u7ec6\u4f5c\u4e1a\u5b9a\u4e49\u548c\u6743\u9650\u63a7\u5236\uff0c \u652f\u6301\u7d27\u5bc6\u8026\u5408\u578b\u7684 HPC \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u53ef\u4ee5\u57fa\u4e8e\u4f18\u5148 \u7ea7\u6765\u8fdb\u884c\u4efb\u52a1\u5b89\u6392\uff0c\u5177\u6709\u96c6\u6210\u7684\u76d1\u63a7\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002 AWS Batch \u5177\u6709\u7684\u4f18\u52bf\u5305\u62ec\uff1a \u5168\u6258\u7ba1: AWS Batch \u53ef\u4e3a\u60a8\u7ba1\u7406\u6240\u6709\u57fa\u7840\u8bbe\u65bd\uff0c\u4ece\u800c\u907f\u514d\u4e86\u9884\u7f6e\u3001\u7ba1\u7406\u3001\u76d1\u63a7\u548c \u6269\u5c55\u60a8\u7684\u6279\u5904\u7406\u8ba1\u7b97\u4f5c\u4e1a\u6240\u5e26\u6765\u7684\u590d\u6742\u6027\u3002 \u4e0e AWS \u539f\u751f\u96c6\u6210: AWS Batch \u5df2\u4e0e AWS \u5e73\u53f0\u539f\u751f\u96c6\u6210\uff0c\u8ba9\u60a8\u80fd\u591f\u5229\u7528 AWS \u7684 \u6269\u5c55\u3001\u8054\u7f51\u548c\u8bbf\u95ee\u7ba1\u7406\u529f\u80fd\u3002\u8fd9\u4fbf\u4e8e\u60a8\u8f7b\u677e\u8fd0\u884c\u80fd\u591f\u5b89\u5168\u5730\u4ece AWS \u6570\u636e\u5b58\u50a8\uff08\u5982 Amazon S3 \u548c Amazon DynamoDB\uff09\u4e2d\u68c0\u7d22\u6570\u636e\u5e76\u5411\u5176\u5199\u5165\u4f5c\u4e1a\u7684\u6570\u636e\u3002 \u6210\u672c\u4f18\u5316: AWS Batch \u53ef\u6839\u636e\u6240\u63d0\u4ea4\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u6570\u91cf\u548c\u8d44\u6e90\u8981\u6c42\u9884\u7f6e\u8ba1\u7b97\u8d44 \u6e90\u5e76\u4f18\u5316\u4f5c\u4e1a\u5206\u914d\u3002 AWS Batch \u80fd\u591f\u5c06\u8ba1\u7b97\u8d44\u6e90\u52a8\u6001\u6269\u5c55\u81f3\u8fd0\u884c\u60a8\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u6240 \u9700\u7684\u4efb\u4f55\u6570\u91cf\uff0c\u4ece\u800c\u4f7f\u60a8\u4e0d\u5fc5\u53d7\u56fa\u5b9a\u5bb9\u91cf\u96c6\u7fa4\u7684\u9650\u5236\u3002 AWS Batch \u8fd8\u53ef\u5229\u7528 Spot \u5b9e\u4f8b\u8fdb\u4e00\u6b65\u964d\u4f4e\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u8d39\u7528\u3002","title":"AWS Batch \u57fa\u672c\u4ecb\u7ecd"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#_1","text":"\u751f\u547d\u79d1\u5b66\u4e2d DNA \u6d4b\u5e8f\u573a\u666f\u2014\u2014\u751f\u7269\u4fe1\u606f\u5b66\u5bb6\u8fdb\u884c\u57fa\u56e0\u7ec4\u5e8f\u5217\u7684\u4e8c\u7ea7\u5206\u6790\u65f6\uff0c\u5229\u7528 AWS Batch \u670d\u52a1\u6765\u7b80\u5316\u5e76\u52a0\u901f\u6d4b\u5e8f\u5206\u6790\u7684\u5904\u7406\u8fc7\u7a0b\uff0c \u4ee5\u6279\u91cf\u5904\u7406\u7684\u65b9\u5f0f\u5c06\u539f\u59cb DNA \u8bfb\u6570\u88c5\u914d\u6210\u5b8c\u6574\u57fa\u56e0\u7ec4\u5e8f\u5217\uff0c \u540c\u65f6\u51cf\u5c11\u6d4b\u5e8f\u5206\u6790\u7684\u6570\u636e\u504f\u5dee\u3002","title":"\u5e94\u7528\u573a\u666f\uff08\u57fa\u56e0\uff09"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#lets-do-it-aws-batch","text":"\u4f60\u591f\u683c\u4e86\u4e48\uff1a \u5177\u6709\u4e00\u4e2a AWS \u4e2d\u56fd\u533a\u57df\u5e10\u53f7(\u6216 Global \u5e10\u53f7)\u3002 \u65b0\u5efa\u4e86\u8db3\u591f\u6743\u9650\u7684 IAM User \u5e76\u8bb0\u5f55\u4e86\u8bbf\u95ee\u5bc6\u94a5\uff08AK\uff09 \u548c\u79d8\u5bc6\u5bc6\u94a5\uff08SK\uff09 \u3002 \u638c\u63e1 Amazon EC2 \u542f\u52a8\u3001 SSH \u767b\u5f55 EC2\u3001\u521b\u5efa S3 \u5b58\u50a8\u6876\u7684\u57fa\u672c\u64cd\u4f5c\u3002 \u672c\u5b9e\u9a8c\u5229\u7528 Batch \u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u6293\u53d6\u811a\u672c\u8fd0\u884c\u7684 Demo\uff0c \u539f\u7406\u5982\u4e0b\u56fe\u6d41\u7a0b\u6240\u793a\u3002 Batch\u6267\u884c\u7684\u4efb\u52a1\u662f\u4ee5 Docker \u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\u7684\uff0c\u5bb9\u5668\u955c\u50cf\u57fa\u4e8e Amazon ECS \u670d\u52a1\u6765\u7ba1\u7406\u3002 \u5b9e\u9a8c\u4e2d\u751f\u6210\u7684\u7b80\u5355\u955c\u50cf\u91cc\u5305\u542b\u4e00\u4e2a\u8f85\u52a9\u7a0b\u5e8f\uff0c\u8d1f\u8d23\u4ece S3 \u5b58\u50a8\u4e2d\u4e0b\u8f7d\u540d\u4e3a myjob.sh \u7684\u81ea \u5b9a\u4e49\u4efb\u52a1\u811a\u672c\uff08\u540c\u65f6\u4e5f\u652f\u6301 zip \u6587\u4ef6\uff09\uff0c\u7531 Batch \u8d1f\u8d23\u542f\u52a8 EC2 \u5b9e\u4f8b\u6765\u88c5\u8f7d\u5bb9\u5668\u5177\u4f53\u6267 \u884c\u3002 \u5b9e\u9a8c\u4e2d\u7684\u4efb\u52a1\u811a\u672c\u4f1a\u8f93\u51fa\u6253\u5370\u4e00\u4e9b\u6f14\u793a\u4fe1\u606f\uff0c\u5728 CloudWatch \u7684 Log \u65e5\u5fd7\u8bb0\u5f55\u4e2d\u53ef \u4ee5\u67e5\u770b\u9a8c\u8bc1\u4efb\u52a1\u811a\u672c\u7684\u8fd9\u4e9b\u8f93\u51fa\u4fe1\u606f\u3002\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u81ea\u5df1\u6539\u5199\u6216\u4e30\u5bcc myjob.sh \u7684\u811a\u6b65\u6267\u884c\u5185\u5bb9\u3002 \u4e0a\u56fe\u4e2d\u51e0\u4e2aaws\u670d\u52a1\u7b80\u5355\u89e3\u91ca\u4e0b\uff1a ECR: \u6ce8\u518c\u4fdd\u5b58\u5bb9\u5668\u955c\u50cf\u7684\u5730\u65b9\uff0c\u6253\u597ddocker\u4e4b\u540e\u8981\u63a8\u5230\u8fd9\u91cc\uff0c\u7edf\u4e00\u6258\u7ba1\u3002 ECS\uff1a \u5e2e\u4f60\u8fd0\u884c\u548c\u7ba1\u7406\u5bb9\u5668\u7684\u670d\u52a1 Batch\uff1a \u6839\u636e\u4f60\u9884\u8bbe\u7684\u8ba1\u7b97\u8d44\u6e90\u548c\u961f\u5217\uff0c\u5e2e\u4f60\u63d0\u4ea4\u5206\u6790\u4efb\u52a1\u5230docker\uff0c\u5e76\u8c03\u5ea6\u4f5c\u4e1a\u961f\u5217\u3002 S3: \u5b58\u50a8\u6876\uff0c\u4f60\u53ef\u4ee5\u548c\u672c\u6587\u4e00\u6837\uff0c\u5c06\u4ee3\u7801\u5e93\u653e\u5728\u6876\u91cc\uff0c\u8dd1docker\u65f6\u62c9\u8fc7\u53bb\uff0c\u5bf9\u4e8e\u8981\u9891\u7e41\u4fee\u6539\u4ee3\u7801\u7684\u4eba\u6765\u8bf4\u662f\u798f\u97f3\uff0c\u56e0\u4e3a\u4f60\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u6253docker\u4e86\uff01 CloudWatch Log: log\u65e5\u5fd7\uff0c \u5f00\u53d1\u8c03\u8bd5\u7684\u65f6\u5019\u4f60\u5c31\u77e5\u9053\u5979\u597d\u4e86\uff1a\uff09 Role: aws\u59cb\u7ec8\u628a\u5b89\u5168\u653e\u5728\u7b2c\u4e00\u4f4d\uff0c\u6240\u4ee5\u6bcf\u4e2a\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u7684\u89d2\u8272\uff0c\u51b3\u5b9a\u5979\u80fd\u5e72\u4ec0\u4e48\u4e0d\u80fd\u5e72\u4ec0\u4e48\u3002 \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4\uff1a","title":"Let's do it \u5229\u7528 AWS Batch \u642d\u5efa\u9ad8\u6027\u80fd\u96c6\u7fa4"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#docker","text":"\u672c\u5b9e\u9a8c\u9700\u8981\u542f\u52a8\u4e00\u4e2a EC2 \u5b9e\u4f8b\u6765\u5236\u4f5c Docker \u955c\u50cf\u3002 \u5728\u4e2d\u56fd\u533a\u57df\u5b9e\u9a8c\u65f6\u9009\u62e9\u5b81\u590f\u533a\u57df\uff0c \u542f\u52a8 EC2 \u73af\u5883\u65f6\u9009\u53d6 Amazon Linux 2 \u7c7b\u578b\u7684 AMI\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5b9e\u4f8b\u7c7b\u578b\u9009\u62e9 t2.micro\u3002 [\u9ad8\u80fd]\u4e00\u5927\u6ce2\u547d\u4ee4\u884c\u6765\u88ad \uff1a EC2 \u5c31\u7eea\u540e\u5728\u672c\u5730\u901a\u8fc7 SSH \u65b9\u5f0f\u767b\u5f55\uff08putty,xshell,gitbash...\uff09 ssh -i yourkey.pem ec2-user@your-ec2-public-ip \u914d\u7f6e CLI \u7684\u6743\u9650\uff0c\u6839\u636e\u547d\u4ee4\u63d0\u793a\u8f93\u5165 AK \u548c SK \u5bc6\u94a5\u503c\uff0c\u9ed8\u8ba4\uff1a aws configure \u6267\u884c\u4e00\u6b21\u66f4\u65b0\u5e76\u5b89\u88c5 docker \u670d\u52a1\uff1a sudo yum update -y sudo yum install docker \u542f\u52a8 Docker \u670d\u52a1\uff1a sudo service docker start \u4e0b\u8f7d\u5b9e\u9a8c\u5305\u7684 github \u6e90\u7801\uff1a wget https://github.com/awslabs/aws-batch-helpers/archive/master.zip unzip master.zip \u89e3\u538b\u8fdb\u5165\u8def\u5f84\u540e\u67e5\u770b Dockerfile \u6587\u4ef6\uff1a vim aws-batch-helpers-master/fetch-and-run/Dockerfile \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a FROM amazonlinux:latest # \u6307\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u955c\u50cf RUN yum -y install unzip aws-cli # \u5b89\u88c5aws \u547d\u4ee4\u884c\u5de5\u5177 ADD fetch_and_run.sh /usr/local/bin/fetch_and_run.sh # \u628a fetch_and_run.sh \u811a\u672c\u62f7\u8d1d\u81f3/usr/local/bin \u8def\u5f84\u4e0b WORKDIR /tmp # \u6307\u5b9a\u5de5\u4f5c\u76ee\u5f55 USER nobody # \u6307\u5b9auser ENTRYPOINT [\"/usr/local/bin/fetch_and_run.sh\"] # \u6307\u5b9a\u5bb9\u5668\u8fd0\u884c\u7684\u5165\u53e3\u662f\u8c03\u7528/usr/local/bin/fetch_and_run.sh \u811a\u672c \u5728 \u4e2d\u56fd\u533a \u5b9e\u9a8c\u65f6\u9700\u8981\u4fee\u6539\u4e00\u4e0b fetch_and_run.sh \u811a\u672c\u5185\u5bb9\uff08Global \u533a\u57df\u8df3\u8fc7\u6b64\u6b65\uff09 vim aws-batch-helpers-master/fetch-and-run/fetch_and_run.sh \u5c06 fetch_and_run_script()\u51fd\u6570\u7684\u7b2c\u4e00\u53e5\u6539\u6210\u5982\u4e0b\u5e76\u4fdd\u5b58\u9000\u51fa\u7f16\u8f91(\u4fee\u6539\u4e2d\u56fd\u533a\u7684S3\u5730\u5740)\uff1a aws s3 cp \"${BATCH_FILE_S3_URL}\" - > \"${TMPFILE}\" --endpoint \"https://s3.cn-northwest-1.amazonaws.com.cn\" || error_exit \"Failed to download S3 script.\" \u628a ec2-user \u52a0\u5230 docker \u7ec4\u91cc\uff08\u514d\u5f97\u540e\u7eed\u6bcf\u6b21 docker \u547d\u4ee4\u524d\u90fd\u8981\u52a0 sudo\uff09 , \u6267\u884c\u5b8c\u9000\u51fa SSH sudo usermod -a -G docker ec2-user","title":"\u51c6\u5907\u5904\u7406\u4efb\u52a1\u7684 Docker \u955c\u50cf\u3002"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#docker-ecr","text":"\u8fdb\u5165 ECR \u63a7\u5236\u53f0\u9009\u62e9\u201cRepositories\u201d\u9875\uff0c\u70b9\u51fb\u201c\u521b\u5efa\u5b58\u50a8\u5e93\u201d\uff0c\u586b\u5199\u540d\u79f0\u4e3a \u201cawsbatch/fetch_and_run\u201d\u540e\u70b9\u51fb\u521b\u5efa\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728\u201c\u5b58\u50a8\u5e93\u201d\u5217\u8868\u4e2d\u9009\u4e2d\u201cawsbatch/fetch_and_run\u201d\u8fd9\u4e00\u680f\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c\u67e5\u770b\u63a8\u9001\u547d\u4ee4\u201d\u6309\u94ae\uff0c\u5373\u51fa\u73b0\u5982\u4e0b\u754c\u9762\uff0c\u91cc\u9762\u8be6\u7ec6\u5217\u51fa\u4e86\u63a8\u9001\u81f3 ECR \u7684\u6b65\u9aa4\u3002 \u91cd\u65b0 SSH \u767b\u5f55\u5230 EC2 \u4e0a\u5e76\u8fdb\u5165 fetch-and-run \u8def\u5f84: ssh -i yourkey.pem ec2-user@your-ec2-public-ip cd aws-batch-helpers-master/fetch-and-run \u9010\u4e2a\u6267\u884c\u4e0a\u8ff0\u7b2c2\u6b65\u201c\u67e5\u770b\u63a8\u9001\u547d\u4ee4\u201d \u56fe\u4e2d\u7684\u56db\u6761\u547d\u4ee4\uff1a $(aws ecr get-login --no-include-email --region cn-northwest-1) docker build -t awsbatch/fetch_and_run . \u6b63\u5e38\u7f16\u8bd1\u5b8c\u6210\u7684\u8f93\u51fa\u4fe1\u606f\u5982\u4e0b\uff1a Sending build context to Docker daemon 373.8 kB Step 1/6 : FROM amazonlinux:latest latest: Pulling from library/amazonlinux c9141092a50d: Pull complete Digest: sha256:2010c88ac1****\u2026 Status: Downloaded newer image for amazonlinux:latest ---> 8ae6f52035b5 Step 2/6 : RUN yum -y install unzip aws-cli ---> Running in e49cba995ea6 Loaded plugins: ovl, priorities Resolving Dependencies --> Running transaction check ---> Package aws-cli.noarch 0:1.11.29-1.45.amzn1 will be installed << removed for brevity >> Complete! \u8f93\u5165\u547d\u4ee4\u9a8c\u8bc1\u4e0b\u955c\u50cf\u4fe1\u606f\uff1a $ docker images REPOSITORY TAG IMAGE ID CREATED awsbatch/fetch_and_run latest 9aa226c28efc 19 seconds ago amazonlinux latest 8ae6f52035b5 5 weeks ago \u7ee7\u7eed\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u7ed9\u955c\u50cf\u6dfb\u52a0\u6807\u7b7e\uff1a docker tag awsbatch/fetch_and_run:latest 112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run:latest \u6267\u884c docker \u955c\u50cf\u63a8\u9001\u547d\u4ee4\uff1a docker push 112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run:latest \u5f85\u63d0\u793a\u4fe1\u606f\u4e2d pushed \u5b8c\u6210\u540e\u53ef\u5728 ECR \u5b58\u50a8\u5e93\u4e2d\u67e5\u770b\u5230\u955c\u50cf\u7684\u4fe1\u606f\uff0c\u62f7\u8d1d\u8bb0\u5f55\u4e0b\u8be5 URI\u540d\u79f0\u3002","title":"Docker \u955c\u50cf\u4f20\u5165 ECR \u5b58\u50a8\u5e93"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#s3-iam-myjobsh","text":"#!/bin/bash date echo \"Args: $@\" env echo \"This is my simple test job!.\" echo \"jobId: $AWS_BATCH_JOB_ID\" echo \"jobQueue: $AWS_BATCH_JQ_NAME\" echo \"computeEnvironment: $AWS_BATCH_CE_NAME\" sleep $1 date echo \"bye bye!!\" \u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u4e0a\u4f20\u811a\u672c\u81f3\u5df2\u4e8b\u5148\u521b\u5efa\u597d\u7684 S3 \u5b58\u50a8\u6876\u3002 aws s3 cp myjob.sh s3://testbucket/myjob.sh \u7531\u4e8e\u955c\u50cf fetch_and_run \u4f5c\u4e3a Batch \u4f5c\u4e1a\u6267\u884c\u8fc7\u7a0b\u4e2d\u8981\u8bbf\u95ee S3 \u4e0b\u8f7d\u4efb\u52a1\u811a\u672c\uff0c\u6240\u4ee5\u9700\u8981\u7ed9 Batch \u4e2d\u7684\u5bb9\u5668\u914d\u7f6e\u4e00\u4e2a\u80fd\u8bfb\u53d6 S3 \u5b58\u50a8\u6876\u7684 IAM \u6743\u9650\u89d2\u8272\u3002\u63a7\u5236\u53f0\u641c\u7d22\u201cIAM\u201d\u5e76\u6253\u5f00IAM\uff0c\u5206\u522b\u70b9\u51fb\u89d2\u8272->\u521b\u5efa\u89d2\u8272\u3002\u53d7\u4fe1\u4efb\u5b9e\u4f53\u9009\u201cAWS \u4ea7\u54c1\u201d\uff0c\u5e76\u5728\u670d\u52a1\u4e2d\u9009\u62e9 \u201cElastic Container Service\u201d\uff1a \u7136\u540e\u5728\u968f\u4e4b\u51fa\u73b0\u7684\u4f7f\u7528\u6848\u4f8b\u5217\u8868\u91cc\uff0c\u9009\u62e9\u201cElastic Container Service Task\u201d\u4e00\u9879\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6743\u9650\u3002 \u5728 Attach \u6743\u9650\u7b56\u7565\u9875\u4e2d\u7684\u641c\u7d22\u680f\u4e2d\u8f93\u5165 AmazonS3ReadOnlyAccess \u641c\u7d22\u5e76\u9009\u53d6\u8be5\u6743\u9650\u7b56\u7565\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6807\u7b7e\u586b\u5199\uff08\u53ef\u9009\uff09\u6807\u7b7e\u5185\u5bb9\uff0c\u518d\u70b9\u51fb\u4e0b\u4e00\u6b65\u5ba1\u6838\uff0c\u5728\u89d2\u8272\u540d\u79f0\u4e2d\u586b\u5165 batchJobRole \u540e\uff0c\u70b9\u51fb\u521b\u5efa\u89d2\u8272\u6309\u94ae\u3002","title":"\u4e0a\u4f20\u4f5c\u4e1a\u811a\u672c\u81f3 S3 \u5b58\u50a8\u5e76\u914d\u7f6e\u5bf9\u5e94 IAM \u6743\u9650\u62f7\u8d1d\u4ee5\u4e0b\u4ee3\u7801\u5b58\u5165\u672c\u5730\u6587\u4ef6\u547d\u540d\u4e3a myjob.sh\u3002"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#batch","text":"Batch \u7684\u4f5c\u4e1a\u914d\u7f6e\u4f9d\u6b21\u5305\u62ec\uff1a \u8ba1\u7b97\u73af\u5883(Compute Environment)\u914d\u7f6e : \u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Compute Environment \u9875\u70b9\u51fb\u521b\u5efa\u3002\u5176\u4e2d\u8ba1\u7b97\u73af\u5883\u53c2\u6570\u7ec4\u7684\u914d\u7f6e\u5982\u4e0b\u56fe\uff0c\u73af\u5883\u7c7b\u578b\u9009\u62e9\u6258\u7ba1\uff0c\u5c06\u7531 Batch \u6765\u8d1f\u8d23\u7ba1\u7406\u5b9e\u4f8b\u7684\u9009\u62e9\u548c\u8c03\u5ea6\u3002\u8ba1\u7b97\u8d44\u6e90\u53c2\u6570\u7ec4\u53ef\u6307\u5b9a\u9700\u8981\u7684\u5b9e\u4f8b\u7c7b\u578b\uff0c\u5176\u4e2d\u6700\u5c0f vCPU \u6570\u586b 1\uff0c\u6240\u9700 vCPU \u586b2\uff0c\u6700\u5927 vCPU \u586b 4\uff0c \u9009\u62e9\u5df2\u6709 EC2 \u5bc6\u94a5\u5bf9\uff0c \u5176\u4ed6\u4fdd\u6301\u9ed8\u8ba4\u5e76\u70b9\u51fb\u521b\u5efa\u3002 \u4f5c\u4e1a\u961f\u5217 \uff08JobQueue\uff09\u914d\u7f6e :\u4f5c\u4e1a\u961f\u5217\u7684\u914d\u7f6e\u662f\u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Job Queue \u9875\u70b9\u51fb\u521b\u5efa\u3002\u6307\u5b9a\u961f\u5217\u540d\u79f0queFetchRun\uff0c Priority \u4f18\u5148\u7ea7\u586b 1\uff0c\u4e0b\u65b9\u8ba1\u7b97\u73af\u5883\u9009\u62e9\u5217\u8868\u91cc\u9009\u62e9\u521a\u521b\u5efa\u7684\u8ba1\u7b97\u73af\u5883\u914d\u7f6e\u540d\u79f0 envFetchRun\uff0c\u9009\u53d6\u540e\u4f1a\u663e\u793a\u5176\u6458\u8981\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u4f5c\u4e1a\u5b9a\u4e49(Job Definition)\u7684\u914d\u7f6e : \u4f5c\u4e1a\u5b9a\u4e49\u914d\u7f6e\u662f\u5728 Batch \u63a7\u5236\u53f0\u4e2d\u9009\u62e9 Job Definition \u9875\u70b9\u51fb\u521b\u5efa\u3002\u8f93\u5165 Job \u540d\u79f0\uff0c\u4f8b\u5982 defFetchRun\u3002 Job role \u91cc\u9009\u53d6\u521a\u521b\u5efa\u7684 IAM \u89d2\u8272 batchJobRole\u3002 Environment \u4e2d\u7684Container image \u4e00\u680f\u586b\u5165\u4e4b\u524d\u521b\u5efa\u7684 Dock \u955c\u50cf\u7684 URI \u540d\u79f0\uff0c\u4f8b\u5982112233445566.dkr.ecr.cn-northwest-1.amazonaws.com/awsbatch/fetch_and_run\u3002 \u6b64\u5904Command \u4e00\u680f\u4fdd\u6301\u4e3a\u7a7a\uff0c vCPU \u586b 1\uff0c Memory \u586b 500\uff0c Security \u4e2d\u7684 User \u680f\u586bnobody\u3002\u5168\u90e8\u586b\u5199\u5b8c\u6210\u540e\u70b9\u51fb\u521b\u5efa\u4f5c\u4e1a\u5b9a\u4e49\u3002","title":"Batch \u670d\u52a1\u7684\u4f5c\u4e1a\u914d\u7f6e\u3002"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#batch_1","text":"\u5728 Batch \u63a7\u5236\u53f0\u9009\u62e9 Jobs \u9875\u9762\u70b9\u51fb\u201c\u63d0\u4ea4\u4efb\u52a1\u201d\u6309\u94ae\u3002 Jobname \u680f\u8f93\u5165\u6307\u5b9a\u7684 Job \u540d\u79f0\uff0c Job definition \u4e2d\u9009\u62e9\u524d\u4e00\u6b65\u8bbe\u7f6e\u597d\u7684\u4f5c\u4e1a\u5b9a\u4e49defFetchRun:1(\u5192\u53f7\u540e\u662f\u7248\u672c\u53f7)\uff0c Job queue \u4e00\u680f\u9009\u53d6\u524d\u4e00\u6b65\u8bbe\u597d\u7684\u4f5c\u4e1a\u961f\u5217\u540d\u79f0queFetchRun\u3002 Command \u547d\u4ee4\u91cc\u9762\u8f93\u5165\u201cmyjob.sh 60\u201d\uff0c\u8bbe\u7f6e\u597d\u7684\u4fe1\u606f\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5728\u73af\u5883\u53d8\u91cf\u4e00\u680f\u4e2d\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u7684\u952e\u503c\u5bf9\uff1a Key=BATCH_FILE_TYPE, Value=script Key=BATCH_FILE_S3_URL, Value=s3://testbucket/myjob.sh \u4efb\u52a1\u63d0\u4ea4\u540e\u5728 Batch \u63a7\u5236\u53f0\u53ef\u4ee5\u67e5\u770b\u5176\u6700\u65b0\u72b6\u6001\uff0c\u4efb\u52a1\u4f1a\u7ecf\u5386 submitted\u3001 pending\u3001runnable\u3001 starting\u3001 running \u5404\u4e2a\u72b6\u6001\u3002\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u540e\u4f1a\u5728 succeeded \u4e00\u9875\u4e0b\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u70b9\u51fb\u4f5c\u4e1a ID \u94fe\u63a5\u7684\u8be6\u60c5\u9875\u9762\u4e2d\u53ef\u70b9\u51fb\u201cCloudWatch \u65e5\u5fd7\u201d \u7684\u94fe\u63a5\u67e5\u770b\u8be6\u7ec6\u65e5\u5fd7\u4fe1\u606f\uff0c\u5176\u4e2d\u5c31\u53ef\u4ee5\u770b\u5230 myjob.sh \u4e2d echo \u8f93\u51fa\u7684\u4fe1\u606f\u5185\u5bb9\u3002\u5982\u4e0b\u56fe\u6240\u793a: \uff08\u53ef\u9009\uff09\u5982\u679c\u9700\u8981\u6279\u91cf\u63d0\u4ea4\u66f4\u591a\u6570\u91cf\u7684\u4f5c\u4e1a\u4efb\u52a1\uff0c\u53ef\u5728\u63d0\u4ea4\u4efb\u52a1\u53c2\u6570\u9875\u9762\u4e2d\u7684Job Type \u4e2d\u9009\u62e9 Array \u7c7b\u578b\u5e76\u586b\u5165\u4e00\u4e2a\u6d4b\u8bd5\u6570\u91cf\u503c\uff0c\u540c\u6837\u53ef\u5728 CloudWatch \u4e2d\u67e5\u770b\u6279\u91cf\u4efb\u52a1\u6267\u884c\u7684\u60c5\u51b5\uff0c\u5e76\u5728 EC2 \u7684\u8d44\u6e90\u5217\u8868\u91cc\u53ef\u4ee5\u770b\u5bf9\u5e94\u7684\u5b9e\u4f8b\u6269\u5c55\u60c5\u51b5\u3002","title":"\u63d0\u4ea4 Batch \u4efb\u52a1\u5e76\u67e5\u770b\u6267\u884c\u72b6\u6001\u3002\uff08\u662f\u65f6\u5019\u5c55\u73b0\u771f\u6b63\u7684\u5b9e\u529b\u4e86\uff09"},{"location":"blogs/2020-01-14-how-to-use-aws-batch-china/#_2","text":"\u52a8\u624b\u5b9e\u9a8c\u5b8c\u6210\u540e\u8bb0\u5f97\u56de\u6536\u91ca\u653e\u76f8\u5e94\u8d44\u6e90\uff0c\u91ca\u653e\u7684\u8d44\u6e90\u5305\u62ec\uff1a \u7981\u7528\u5e76\u5220\u9664 Batch \u670d\u52a1\u4e2d\u7684\u4f5c\u4e1a\u961f\u5217\u548c\u8ba1\u7b97\u73af\u5883\u4e2d\u7684\u914d\u7f6e\u8d44\u6e90\u3002 \u7ec8\u6b62\u5236\u4f5c Docker \u955c\u50cf\u6240\u7528\u7684 EC2 \u5b9e\u4f8b\u3002 \u5220\u9664 ECR \u5b58\u50a8\u5e93\u4e2d\u7684 Image \u955c\u50cf\u3002 S3 \u4e2d\u7684\u4efb\u52a1\u811a\u672c\u5220\u9664\u3002 CloudWatch \u4e2d\u7684\u5bf9\u5e94\u65e5\u5fd7\u8bb0\u5f55\u5220\u9664\u3002","title":"\u56de\u6536\u8d44\u6e90"},{"location":"blogs/2020-01-19-how-to-launch-ec2/","text":"\u5165\u95e8\u7cfb\u52171\u2014\u5982\u4f55\u521b\u5efa\u670d\u52a1\u5668\u5e76\u7528\u547d\u4ee4\u884c\u767b\u5f55 \u5f53\u6211\u4eec\u6709\u4e86\u8d26\u6237\u4e4b\u540e\uff0c\u5c31\u9700\u8981\u5f00\u542f\u6211\u4eec\u60f3\u8981\u7684\u670d\u52a1\u5668\uff0c\u5e76\u5728\u5176\u4e0a\u5b89\u88c5\u6211\u4eec\u7684\u751f\u4fe1\u5206\u6790\u6d41\u7a0b\u4e86\uff0c\u5e76\u4e14\u8fd8\u9700\u8981\u4f7f\u7528\u547d\u4ee4\u884c\u672c\u5730\u767b\u5f55\u4e91\u7aef\u670d\u52a1\u5668\u8fdb\u884c\u5b9e\u9645\u7684\u5404\u7c7b\u64cd\u4f5c\u3002 -- D.C \u521b\u5efaEC2\u673a\u578b\uff08Elasic Compute Cloud\uff09 \u767b\u5f55\u8d26\u6237\uff0c\u6765\u5230\u4f60\u7684\u63a7\u5236\u9762\u677fconsole\uff0c\u5728\u670d\u52a1\uff08services\uff09\u4e0b\u641c\u7d22EC2,\u70b9\u51fb\u8fdb\u5165EC2\u7684\u63a7\u5236\u754c\u9762\u3002 \u6620\u5165\u773c\u5e18\u7684\u5c31\u662fEC2\u7684dashboard,\u53ef\u4ee5\u770b\u5230\u51e0\u53f0\u5b9e\u4f8b\uff08instance\uff09\u5728\u8dd1\uff0c\u7528\u4e86\u591a\u5c11\u4e2a\u5f39\u6027IP\u5730\u5740\uff0c\u6709\u591a\u5c11\u4e2a\u5feb\u7167\u3002\u3002\u3002\u6211\u4eec\u76f4\u63a5\u70b9\u51fb\u542f\u52a8\u5b9e\u4f8b\uff08Launch instance\uff09\u6309\u94ae\uff0c\u9009\u62e9\u542f\u52a8\u5b9e\u4f8b\uff1a step1: \u9009\u62e9\u4e00\u4e2a\u4e9a\u9a6c\u900a\u673a\u5668\u955c\u50cf\uff08AMI\uff09\u3002 \u5176\u5b9e\u5c31\u662f\u6839\u636e\u4f60\u7684\u9700\u6c42\uff0c\u9009\u62e9\u4e00\u4e2a\u4f60\u7528\u7684\u987a\u624b\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u5c06\u4f1a\u5b89\u88c5\u5728\u4f60\u9009\u62e9\u7684\u673a\u5668\u4e0a\u3002\u8fd9\u91cc\u6211\u9009\u62e9Amazon Linux 2 AMI (HVM), SSD Volume Type, \u70b9\u51fbselect\u3002 step2: \u9009\u62e9\u4e00\u4e2a\u5b9e\u4f8b\u7c7b\u578b\u3002 \u8fd9\u91cc\u5c31\u8981\u6839\u636e\u4f60\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u9009\u62e9\u5408\u9002\u7684CPU\u548c\u5185\u5b58\u6570\uff0caws\u7684\u5b9e\u4f8b\u603b\u4f53\u5206\u4e3a5\u7c7b\uff0c\u4f5c\u4e3a\u5e38\u89c4\u751f\u4fe1\u5206\u6790\u6765\u8bf4\u4e00\u822c\u9009\u62e9R\u7cfb\u5217\u548cC\u7cfb\u5217\uff0c\u5f53\u7136m\u7cfb\u5217\u4e5f\u53ef\u4ee5\u3002\u56e0\u4e3a\u6211\u4eec\u662f\u6559\u5b66\uff0c\u6240\u4ee5\u9009\u62e9\u65b0\u7528\u6237\u6ce8\u518c\u514d\u8d39\u4e00\u5e74\u7684 t2.micro \u673a\u578b, \u70b9\u51fb\u4e0b\u4e00\u6b65:\u914d\u7f6e\u5b9e\u4f8b\u3002 \u600e\u4e48\u7406\u89e3\u540d\u5b57\uff1f \u6bd4\u5982 m5.2xlarge \u8868\u793a\u8fd9\u662f\u4e2am\u7cfb\u5217\u673a\u578b\uff0c\u62e5\u67098\u4e2avCPU\uff0c32GiB\u5185\u5b58, \u4f60\u4e00\u5b9a\u4f1a\u95ee\u600e\u4e48\u7b97\u7684\uff0c\u597d\u5427\uff0c\u5b57\u6bcd x \u4ee3\u88684, 2x \u5c31\u4ee3\u88682x4=8\u4e2avCPU, \u800cm\u7cfb\u5217\u673a\u578b\u7684CPU\u548c\u5185\u5b58\u6bd4\u662f1\uff1a4\uff0c\u6240\u4ee5\u5c068x4=32GiB\u5c31\u7b97\u51fa\u6765\u4e86\u3002\u90a3\u5176\u4ed6\u7cfb\u5217\u5462\uff1f \u7cfb\u5217 vCPU/\u5185\u5b58 \u7279\u70b9 m 1:4 \u901a\u7528\u578b\uff0c\u5e38\u89c4\u519b c 1:2 \u8ba1\u7b97\u4f18\u5316\u578b\uff0cCPU\u6bd4\u8f83\u725bb r 1:8 \u5185\u5b58\u4f18\u5316\u578b\uff0c\u5403\u5185\u5b58\u7684\u5206\u6790\u5c31\u627e\u4ed6 \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u7167\uff1a \u5b9e\u4f8b\u7c7b\u578b step3: \u914d\u7f6e\u5b9e\u4f8b\u3002 \u8fd9\u91cc\u6709\u5f88\u591a\u9009\u9879\uff0c\u770b\u5b98\u53ef\u80fd\u770b\u5230\u5934\u75bc\uff0c\u4f46\u662f\u5728\u5165\u95e8\u9636\u6bb5\u4f60\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u4efb\u4f55\u5730\u65b9\uff01\u76f4\u63a5\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u6dfb\u52a0\u5b58\u50a8\u3002 \u6709\u4e2a\u5730\u65b9\u8bf4\u4e0b Purchasing option : \u5bf9\u4e86\uff01\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u9009\u62e9\u662f\u5426\u4ee5\u7ade\u4ef7\u7684\u65b9\u5f0f\u53bb\u62cd\u4f60\u60f3\u8981\u7684\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u53ef\u4ee5\u7701\u5f88\u591a\u94b1\u54e6~ \u4f46\u8bf7\u6ce8\u610f\uff0ct\u7cfb\u5217\u4e0d\u652f\u6301\u7ade\u4ef7\u3002\u9009\u62e9\u4e4b\u540e\uff0c\u5c31\u4f1a\u51fa\u73b0\u4f60\u9009\u62e9\u7684\u5b9e\u4f8b\u5f53\u524d\u7684\u7ade\u4ef7\u4ef7\u683c\uff0c\u5e76\u4e14\u4f1a\u8ba9\u4f60\u51fa\u4e00\u4e2a\u4f60\u80fd\u63a5\u53d7\u7684\u6700\u5927\u4ef7\u683c, \u6bd4\u5982\u4e0b\u56fe\u4e2d\u5c31\u53ef\u4ee5\u9009\u62e9\u51fa4.51\u5143\uff0c\u8fd9\u53f0\u673a\u5668\u5c31\u4f1a\u7ed9\u4f60\u7528\u5566~ \u4f46\u8bf7\u6ce8\u610f\uff0c\u56e0\u4e3a\u8fd9\u662f\u95f2\u7f6e\u8d44\u6e90\u7ed9\u4f60\u7528\uff0c\u4e00\u65e6\u8d44\u6e90\u5403\u7d27\uff0c\u8fd9\u53f0\u673a\u5668\u53ef\u80fd\u4f1a\u88ab\u7cfb\u7edf\u5f3a\u5236\u56de\u6536\uff0c\u6240\u4ee5\u52a1\u5fc5\u786e\u4fdd\u4f60\u7684\u5206\u6790\u4efb\u52a1\u5bb9\u5fcd\u968f\u65f6\u6253\u65ad\u7684\u54e6 ! btw, \u6211\u66fe\u7ecf\u6d4b\u8bd5\u8fc732vCPU\uff0c256G\u7684spot\u8fde\u5f00\u4e00\u5468\u672a\u88ab\u56de\u6536\uff0c\u5404\u4f4d\u81ea\u884c\u5224\u65ad\u4e86 \uff1a\uff09 step4: \u6dfb\u52a0\u5b58\u50a8\u3002 \u5bf9\u4e86\uff0c\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u6dfb\u52a0\u78c1\u76d8\u4e86\uff0c\u9ed8\u8ba4SSD\uff0c\u8c03\u6574\u4f60\u60f3\u8981\u7684\u78c1\u76d8\u5927\u5c0f\uff0c\u6bd4\u5982 30G \uff0c\u8fd8\u8981\u6ce8\u610f\u6709\u4e2a\u9009\u9879\u7279\u522b\u91cd\u8981 Delete on Termination , \u9ed8\u8ba4\u6253\u52fe\uff0c\u90a3\u4e48\u4f60\u5728terminate\u4f60\u7684\u673a\u5668\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u4e5f\u4f1a\u81ea\u52a8\u5e2e\u4f60\u628a\u78c1\u76d8\u7ed9\u91ca\u653e\u4e86\uff0c\u610f\u5473\u7740\u4f60\u7684\u6570\u636e\u4f1a\u968f\u4e4b\u6d88\u5931\uff0c\u6240\u4ee5\u81ea\u5df1\u60f3\u597d\u54e6\u3002\u7136\u540e\u6211\u4eec\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u52a0\u6807\u7b7e\u3002 step5: \u6dfb\u52a0\u6807\u7b7e\u3002 \u8fd9\u4e00\u6b65\u5f88\u91cd\u8981\uff0c\u60f3\u8c61\u4e0b\u4f60\u6709100\u53f0\u673a\u5668\u5217\u8868\u663e\u793a\u5728\u4f60\u9762\u524d\uff0c\u4f60\u662f\u5426\u8fd8\u80fd\u6e05\u695a\u7684\u77e5\u9053\u54ea\u53f0\u673a\u5668\u662f\u505a\u4ec0\u4e48\u7684\uff1f\u6240\u4ee5\u6253\u6807\u7b7e\uff0c\u505a\u7b14\u8bb0\u5f88\u91cd\u8981\uff01\u6dfb\u52a0\u4f60\u60f3\u8981\u7684\u6807\u7b7e\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u914d\u7f6e\u5b89\u5168\u7ec4\u3002 step6\uff1a\u914d\u7f6e\u5b89\u5168\u7ec4\u3002\u9ed8\u8ba4\u65b0\u5efa\u4e00\u4e2a\u65b0\u7684\u5b89\u5168\u7ec4\u89c4\u5219\uff0c\u5982\u679c\u4f60\u4ee5\u524d\u5df2\u7ecf\u521b\u5efa\u8fc7\u548c\u8fd9\u53f0\u673a\u5668\u4e00\u6837\u7528\u9014\u7684\u5b89\u5168\u7ec4\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5df2\u5b58\u5728\u7684\u5b89\u5168\u7ec4\u3002\u5173\u4e8e\u5b89\u5168\u7ec4\u8fd9\u4e2a\u6982\u5ff5\uff0c\u7b80\u5355\u7406\u89e3\u7684\u8bdd\uff0c\u5c31\u662f\u7ed9\u4f60\u7684\u673a\u5668\u7a7f\u7684\u4e00\u5c42\u5b89\u5168\u9a6c\u7532\uff0c\u5b83\u89c4\u5b9a\u54ea\u4e9b\u534f\u8bae\u7684\u6570\u636e\u53ef\u4ee5\u8fdb\u6765\u548c\u51fa\u53bb\uff0c\u901a\u8fc7\u5404\u79cd\u7aef\u53e3\u3002 \u6bd4\u5982\u6211\u4eec\u8981ssh\u5230\u8fd9\u53f0\u673a\u5668\uff0c\u5c31\u5f97\u628atcp\u534f\u8bae\u6253\u5f00\uff08\u9ed8\u8ba4\uff09\uff0c\u5982\u679c\u4f60\u8fd8\u8981http\u8bbf\u95ee\uff0c\u90a3\u5c31\u70b9\u51fb Add Rule \u6765\u6dfb\u52a0http\u8bbf\u95ee\u89c4\u5219\u3002It's up to you! \u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u68c0\u67e5\u548c\u542f\u52a8\uff08Review and Launch \uff09\u3002 \u68c0\u67e5\u4e00\u904d\u6ca1\u95ee\u9898\uff0c\u70b9\u51fb\u542f\u52a8\u3002\u8fd9\u91cc\u8df3\u51fa\u6765\u7684\u5f39\u7a97\u65e0\u6bd4\u91cd\u8981\uff0c\u7528\u8fc7putty\uff0cxshell\u7b49CLI\u767b\u5f55\u8fc7\u670d\u52a1\u5668\u7684\u540c\u5b66\u90fd\u77e5\u9053\uff0c\u4e00\u822c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2akey\u6587\u4ef6\u624d\u80fd\u9a8c\u8bc1\u767b\u5f55\uff0c\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u5bf9\u8fd9\u53f0\u673a\u5668\u521b\u5efa\u4e00\u4e2akey pair\u6587\u4ef6\uff08\u6216\u6307\u5b9a\u4ee5\u524d\u521b\u5efa\u8fc7\u7684key\u6587\u4ef6\uff09\uff0c\u5728 Key pair name \u91cc\u547d\u540d\u4f60\u7684key\u6587\u4ef6\uff0c\u70b9\u51fb Download Key Pair \u6587\u4ef6\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u70b9\u51fb \u542f\u52a8\u5b9e\u4f8b \u3002 \u5b9e\u4f8b\u6b63\u5728\u542f\u52a8\uff0c\u6211\u4eec\u53ef\u4ee5\u70b9\u51fb\u4e0a\u56fe\u4e2d\u7684\u5b9e\u4f8bID\uff1a i-xxxxxxx \u67e5\u770b\u8fd9\u53f0\u673a\u5668\u7684\u72b6\u6001\uff0c\u4e0b\u56fe\u663e\u793a\uff0c\u8fd9\u53f0\u673a\u5668\u5df2\u7ecf\u6b63\u5e38running\uff0c\u5e76\u901a\u8fc7\u4e86\u72b6\u6001\u68c0\u67e5,\u3002\u8fd8\u8bb0\u5f97\u521a\u624d\u7684tag\u6807\u7b7e\u4e48\uff1f\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 \u9f7f\u8f6e \u56fe\u5f62\uff0c\u9009\u4e2d\u663e\u793a\u4f60\u8bbe\u5b9a\u7684\u6807\u7b7e\uff0c\u5c31\u53ef\u4ee5\u5728\u9762\u677f\u4e0a\u770b\u5230\u5566\uff0c\u8bf7\u517b\u6210\u597d\u4e60\u60ef\uff0c\u4ee5\u540e\u521b\u5efa\u7684\u673a\u5668\u90fd\u8981\u6dfb\u52a0\u8fd9\u51e0\u4e2a\u6807\u7b7e\u54e6~ \u6761\u4ef6\u8fc7\u6ee4\u770b\u5230\u4f60\u60f3\u8981\u7684\u5b9e\u4f8b\uff1a\u4e0a\u65b9\u7684\u641c\u7d22\u6846\u6709 Add filter \u5b57\u6837\uff0c\u9f20\u6807\u79fb\u52a8\u8fc7\u53bb\u70b9\u51fb\uff0c\u4f1a\u51fa\u73b0\u4e0b\u62c9\u8fc7\u6ee4\u83dc\u5355\uff0c\u65b9\u4fbf\u4f60\u627e\u5230\u7279\u5b9a\u7684\u673a\u5668\u54e6\uff01 \u81f3\u6b64\uff0c\u5982\u4f55\u5728aws\u542f\u52a8\u4e00\u53f0\u4f60\u60f3\u8981\u7684\u673a\u5668\u5c31\u5927\u529f\u544a\u6210\u4e86\uff01\u4f46\u662f\u673a\u5668\u5728\u4e91\u7aef\u8dd1\u4e86\uff0c\u800c\u6211\u53ea\u80fd\u8fdc\u89c2\u800c\u4e0d\u53ef\u4eb5\u73a9\u4e48\uff1f\u600e\u4e48\u53ef\u80fd\uff0c\u82b1\u4e86\u8fd9\u4e48\u591a\u529f\u592b\u4e0d\u5c31\u662f\u4e3a\u4e86\u4eb5\u73a9\u4e48\uff1f\u5144\u5f1f\u4eec\u8ddf\u6211\u4e0a\uff01 \u5982\u4f55\u767b\uff08\u4eb5\uff09\u5165\uff08\u73a9\uff09\u4e91\u670d\u52a1\u5668EC2 \u627e\u5230\u4f60\u4e0b\u8f7d\u7684key\u6587\u4ef6\uff0c\u6bd4\u5982\u6211\u7684\u662f mytest.pem \u3002 \u6253\u5f00\u4f60\u7684\u672c\u5730ssh\u5de5\u5177\uff0c\u6bd4\u5982\u6211\u7684\u662fgitbash, \u8fdb\u5230\u4f60key\u6240\u5728\u7684\u6587\u4ef6\u5939\u4e0b: $ ls *.pem mytest.pem \u5728aws\u63a7\u5236\u53f0\u4e0a\uff0c\u9009\u4e2d\u4f60\u542f\u52a8\u7684\u90a3\u53f0\u673a\u5668\uff0c\u70b9\u51fb Connect \uff0c\u8df3\u7a97\u7684\u4fe1\u606f\u4f1a\u8be6\u7ec6\u544a\u8bc9\u4f60\u5982\u4f55\u4eb5\u73a9\u4f60\u7684\u673a\u5668\uff0c\u4f60\u53ea\u8981copy\u5c31\u597d\uff0c\u5b9e\u5728\u662f\u592a\u65b9\u4fbf\u4e86\uff01 \u4e3a\u4e86\u6ee1\u8db3\u6211\u4eec\u7b49\u5b85\u7537\uff0caws\u771f\u662f\u7528\u5fc3\u826f\u82e6\u3002 $ chmod 400 mytest.pem $ ssh -i \"mytest.pem\" ec2-user@ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn The authenticity of host 'ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn (\u4e0d-\u544a-\u8bc9-\u4f60)' can't be established. ECDSA key fingerprint is SHA256:SSxxxxxxxxxxxxxxxxxxx. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn,\u4e0d-\u544a-\u8bc9-\u4f60' (ECDSA) to the list of known hosts. __| __|_ ) _| ( / Amazon Linux 2 AMI ___|\\___|___| https://aws.amazon.com/amazon-linux-2/ 3 package(s) needed for security, out of 24 available Run \"sudo yum update\" to apply all updates. [ec2-user@ip-\u4e0d-\u544a-\u8bc9-\u4f60 ~]$ \u81f3\u6b64\uff0c\u4f60\u5df2\u7ecf\u6210\u529f\u8fdb\u5165\u4e86\u670d\u52a1\u5668\uff0c\u63a5\u4e0b\u6765\u5c31\u968f\u4fbf\u4f60\u4e86\u3002 [ec2-user@ip-\u4e0d-\u544a-\u8bc9-\u4f60 ~]$ ping 8.8.8.8 PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data. 64 bytes from 8.8.8.8: icmp_seq=1 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=2 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=3 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=4 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=5 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=6 ttl=46 time=54.9 ms ^C --- 8.8.8.8 ping statistics --- 6 packets transmitted, 6 received, 0% packet loss, time 5007ms rtt min/avg/max/mdev = 54.849/54.877/54.908/0.192 ms PS: pem\u6587\u4ef6\u53ef\u4ee5\u7528\u4e8e\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u5728winscp\u91cc\u8bbe\u7f6e\u7528\u4e8e\u548cEC2\u7684\u6570\u636e\u4ea4\u4e92\u3002\u5982\u679c\u7528putty\uff0c\u9700\u8981\u5148\u5c06pem\u683c\u5f0f\u8f6c\u6362\u4e3appk\u683c\u5f0f\uff0c \u70b9\u6211","title":"\u5165\u95e8\u7cfb\u52171\u2014\u5982\u4f55\u521b\u5efa\u670d\u52a1\u5668\u5e76\u7528\u547d\u4ee4\u884c\u767b\u5f55"},{"location":"blogs/2020-01-19-how-to-launch-ec2/#1","text":"\u5f53\u6211\u4eec\u6709\u4e86\u8d26\u6237\u4e4b\u540e\uff0c\u5c31\u9700\u8981\u5f00\u542f\u6211\u4eec\u60f3\u8981\u7684\u670d\u52a1\u5668\uff0c\u5e76\u5728\u5176\u4e0a\u5b89\u88c5\u6211\u4eec\u7684\u751f\u4fe1\u5206\u6790\u6d41\u7a0b\u4e86\uff0c\u5e76\u4e14\u8fd8\u9700\u8981\u4f7f\u7528\u547d\u4ee4\u884c\u672c\u5730\u767b\u5f55\u4e91\u7aef\u670d\u52a1\u5668\u8fdb\u884c\u5b9e\u9645\u7684\u5404\u7c7b\u64cd\u4f5c\u3002 -- D.C","title":"\u5165\u95e8\u7cfb\u52171\u2014\u5982\u4f55\u521b\u5efa\u670d\u52a1\u5668\u5e76\u7528\u547d\u4ee4\u884c\u767b\u5f55"},{"location":"blogs/2020-01-19-how-to-launch-ec2/#ec2elasic-compute-cloud","text":"\u767b\u5f55\u8d26\u6237\uff0c\u6765\u5230\u4f60\u7684\u63a7\u5236\u9762\u677fconsole\uff0c\u5728\u670d\u52a1\uff08services\uff09\u4e0b\u641c\u7d22EC2,\u70b9\u51fb\u8fdb\u5165EC2\u7684\u63a7\u5236\u754c\u9762\u3002 \u6620\u5165\u773c\u5e18\u7684\u5c31\u662fEC2\u7684dashboard,\u53ef\u4ee5\u770b\u5230\u51e0\u53f0\u5b9e\u4f8b\uff08instance\uff09\u5728\u8dd1\uff0c\u7528\u4e86\u591a\u5c11\u4e2a\u5f39\u6027IP\u5730\u5740\uff0c\u6709\u591a\u5c11\u4e2a\u5feb\u7167\u3002\u3002\u3002\u6211\u4eec\u76f4\u63a5\u70b9\u51fb\u542f\u52a8\u5b9e\u4f8b\uff08Launch instance\uff09\u6309\u94ae\uff0c\u9009\u62e9\u542f\u52a8\u5b9e\u4f8b\uff1a step1: \u9009\u62e9\u4e00\u4e2a\u4e9a\u9a6c\u900a\u673a\u5668\u955c\u50cf\uff08AMI\uff09\u3002 \u5176\u5b9e\u5c31\u662f\u6839\u636e\u4f60\u7684\u9700\u6c42\uff0c\u9009\u62e9\u4e00\u4e2a\u4f60\u7528\u7684\u987a\u624b\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u5c06\u4f1a\u5b89\u88c5\u5728\u4f60\u9009\u62e9\u7684\u673a\u5668\u4e0a\u3002\u8fd9\u91cc\u6211\u9009\u62e9Amazon Linux 2 AMI (HVM), SSD Volume Type, \u70b9\u51fbselect\u3002 step2: \u9009\u62e9\u4e00\u4e2a\u5b9e\u4f8b\u7c7b\u578b\u3002 \u8fd9\u91cc\u5c31\u8981\u6839\u636e\u4f60\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u9009\u62e9\u5408\u9002\u7684CPU\u548c\u5185\u5b58\u6570\uff0caws\u7684\u5b9e\u4f8b\u603b\u4f53\u5206\u4e3a5\u7c7b\uff0c\u4f5c\u4e3a\u5e38\u89c4\u751f\u4fe1\u5206\u6790\u6765\u8bf4\u4e00\u822c\u9009\u62e9R\u7cfb\u5217\u548cC\u7cfb\u5217\uff0c\u5f53\u7136m\u7cfb\u5217\u4e5f\u53ef\u4ee5\u3002\u56e0\u4e3a\u6211\u4eec\u662f\u6559\u5b66\uff0c\u6240\u4ee5\u9009\u62e9\u65b0\u7528\u6237\u6ce8\u518c\u514d\u8d39\u4e00\u5e74\u7684 t2.micro \u673a\u578b, \u70b9\u51fb\u4e0b\u4e00\u6b65:\u914d\u7f6e\u5b9e\u4f8b\u3002 \u600e\u4e48\u7406\u89e3\u540d\u5b57\uff1f \u6bd4\u5982 m5.2xlarge \u8868\u793a\u8fd9\u662f\u4e2am\u7cfb\u5217\u673a\u578b\uff0c\u62e5\u67098\u4e2avCPU\uff0c32GiB\u5185\u5b58, \u4f60\u4e00\u5b9a\u4f1a\u95ee\u600e\u4e48\u7b97\u7684\uff0c\u597d\u5427\uff0c\u5b57\u6bcd x \u4ee3\u88684, 2x \u5c31\u4ee3\u88682x4=8\u4e2avCPU, \u800cm\u7cfb\u5217\u673a\u578b\u7684CPU\u548c\u5185\u5b58\u6bd4\u662f1\uff1a4\uff0c\u6240\u4ee5\u5c068x4=32GiB\u5c31\u7b97\u51fa\u6765\u4e86\u3002\u90a3\u5176\u4ed6\u7cfb\u5217\u5462\uff1f \u7cfb\u5217 vCPU/\u5185\u5b58 \u7279\u70b9 m 1:4 \u901a\u7528\u578b\uff0c\u5e38\u89c4\u519b c 1:2 \u8ba1\u7b97\u4f18\u5316\u578b\uff0cCPU\u6bd4\u8f83\u725bb r 1:8 \u5185\u5b58\u4f18\u5316\u578b\uff0c\u5403\u5185\u5b58\u7684\u5206\u6790\u5c31\u627e\u4ed6 \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u7167\uff1a \u5b9e\u4f8b\u7c7b\u578b step3: \u914d\u7f6e\u5b9e\u4f8b\u3002 \u8fd9\u91cc\u6709\u5f88\u591a\u9009\u9879\uff0c\u770b\u5b98\u53ef\u80fd\u770b\u5230\u5934\u75bc\uff0c\u4f46\u662f\u5728\u5165\u95e8\u9636\u6bb5\u4f60\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u4efb\u4f55\u5730\u65b9\uff01\u76f4\u63a5\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u6dfb\u52a0\u5b58\u50a8\u3002 \u6709\u4e2a\u5730\u65b9\u8bf4\u4e0b Purchasing option : \u5bf9\u4e86\uff01\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u9009\u62e9\u662f\u5426\u4ee5\u7ade\u4ef7\u7684\u65b9\u5f0f\u53bb\u62cd\u4f60\u60f3\u8981\u7684\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u53ef\u4ee5\u7701\u5f88\u591a\u94b1\u54e6~ \u4f46\u8bf7\u6ce8\u610f\uff0ct\u7cfb\u5217\u4e0d\u652f\u6301\u7ade\u4ef7\u3002\u9009\u62e9\u4e4b\u540e\uff0c\u5c31\u4f1a\u51fa\u73b0\u4f60\u9009\u62e9\u7684\u5b9e\u4f8b\u5f53\u524d\u7684\u7ade\u4ef7\u4ef7\u683c\uff0c\u5e76\u4e14\u4f1a\u8ba9\u4f60\u51fa\u4e00\u4e2a\u4f60\u80fd\u63a5\u53d7\u7684\u6700\u5927\u4ef7\u683c, \u6bd4\u5982\u4e0b\u56fe\u4e2d\u5c31\u53ef\u4ee5\u9009\u62e9\u51fa4.51\u5143\uff0c\u8fd9\u53f0\u673a\u5668\u5c31\u4f1a\u7ed9\u4f60\u7528\u5566~ \u4f46\u8bf7\u6ce8\u610f\uff0c\u56e0\u4e3a\u8fd9\u662f\u95f2\u7f6e\u8d44\u6e90\u7ed9\u4f60\u7528\uff0c\u4e00\u65e6\u8d44\u6e90\u5403\u7d27\uff0c\u8fd9\u53f0\u673a\u5668\u53ef\u80fd\u4f1a\u88ab\u7cfb\u7edf\u5f3a\u5236\u56de\u6536\uff0c\u6240\u4ee5\u52a1\u5fc5\u786e\u4fdd\u4f60\u7684\u5206\u6790\u4efb\u52a1\u5bb9\u5fcd\u968f\u65f6\u6253\u65ad\u7684\u54e6 ! btw, \u6211\u66fe\u7ecf\u6d4b\u8bd5\u8fc732vCPU\uff0c256G\u7684spot\u8fde\u5f00\u4e00\u5468\u672a\u88ab\u56de\u6536\uff0c\u5404\u4f4d\u81ea\u884c\u5224\u65ad\u4e86 \uff1a\uff09 step4: \u6dfb\u52a0\u5b58\u50a8\u3002 \u5bf9\u4e86\uff0c\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u6dfb\u52a0\u78c1\u76d8\u4e86\uff0c\u9ed8\u8ba4SSD\uff0c\u8c03\u6574\u4f60\u60f3\u8981\u7684\u78c1\u76d8\u5927\u5c0f\uff0c\u6bd4\u5982 30G \uff0c\u8fd8\u8981\u6ce8\u610f\u6709\u4e2a\u9009\u9879\u7279\u522b\u91cd\u8981 Delete on Termination , \u9ed8\u8ba4\u6253\u52fe\uff0c\u90a3\u4e48\u4f60\u5728terminate\u4f60\u7684\u673a\u5668\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u4e5f\u4f1a\u81ea\u52a8\u5e2e\u4f60\u628a\u78c1\u76d8\u7ed9\u91ca\u653e\u4e86\uff0c\u610f\u5473\u7740\u4f60\u7684\u6570\u636e\u4f1a\u968f\u4e4b\u6d88\u5931\uff0c\u6240\u4ee5\u81ea\u5df1\u60f3\u597d\u54e6\u3002\u7136\u540e\u6211\u4eec\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u52a0\u6807\u7b7e\u3002 step5: \u6dfb\u52a0\u6807\u7b7e\u3002 \u8fd9\u4e00\u6b65\u5f88\u91cd\u8981\uff0c\u60f3\u8c61\u4e0b\u4f60\u6709100\u53f0\u673a\u5668\u5217\u8868\u663e\u793a\u5728\u4f60\u9762\u524d\uff0c\u4f60\u662f\u5426\u8fd8\u80fd\u6e05\u695a\u7684\u77e5\u9053\u54ea\u53f0\u673a\u5668\u662f\u505a\u4ec0\u4e48\u7684\uff1f\u6240\u4ee5\u6253\u6807\u7b7e\uff0c\u505a\u7b14\u8bb0\u5f88\u91cd\u8981\uff01\u6dfb\u52a0\u4f60\u60f3\u8981\u7684\u6807\u7b7e\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u914d\u7f6e\u5b89\u5168\u7ec4\u3002 step6\uff1a\u914d\u7f6e\u5b89\u5168\u7ec4\u3002\u9ed8\u8ba4\u65b0\u5efa\u4e00\u4e2a\u65b0\u7684\u5b89\u5168\u7ec4\u89c4\u5219\uff0c\u5982\u679c\u4f60\u4ee5\u524d\u5df2\u7ecf\u521b\u5efa\u8fc7\u548c\u8fd9\u53f0\u673a\u5668\u4e00\u6837\u7528\u9014\u7684\u5b89\u5168\u7ec4\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5df2\u5b58\u5728\u7684\u5b89\u5168\u7ec4\u3002\u5173\u4e8e\u5b89\u5168\u7ec4\u8fd9\u4e2a\u6982\u5ff5\uff0c\u7b80\u5355\u7406\u89e3\u7684\u8bdd\uff0c\u5c31\u662f\u7ed9\u4f60\u7684\u673a\u5668\u7a7f\u7684\u4e00\u5c42\u5b89\u5168\u9a6c\u7532\uff0c\u5b83\u89c4\u5b9a\u54ea\u4e9b\u534f\u8bae\u7684\u6570\u636e\u53ef\u4ee5\u8fdb\u6765\u548c\u51fa\u53bb\uff0c\u901a\u8fc7\u5404\u79cd\u7aef\u53e3\u3002 \u6bd4\u5982\u6211\u4eec\u8981ssh\u5230\u8fd9\u53f0\u673a\u5668\uff0c\u5c31\u5f97\u628atcp\u534f\u8bae\u6253\u5f00\uff08\u9ed8\u8ba4\uff09\uff0c\u5982\u679c\u4f60\u8fd8\u8981http\u8bbf\u95ee\uff0c\u90a3\u5c31\u70b9\u51fb Add Rule \u6765\u6dfb\u52a0http\u8bbf\u95ee\u89c4\u5219\u3002It's up to you! \u70b9\u51fb\u4e0b\u4e00\u6b65\uff1a\u68c0\u67e5\u548c\u542f\u52a8\uff08Review and Launch \uff09\u3002 \u68c0\u67e5\u4e00\u904d\u6ca1\u95ee\u9898\uff0c\u70b9\u51fb\u542f\u52a8\u3002\u8fd9\u91cc\u8df3\u51fa\u6765\u7684\u5f39\u7a97\u65e0\u6bd4\u91cd\u8981\uff0c\u7528\u8fc7putty\uff0cxshell\u7b49CLI\u767b\u5f55\u8fc7\u670d\u52a1\u5668\u7684\u540c\u5b66\u90fd\u77e5\u9053\uff0c\u4e00\u822c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u4e00\u4e2akey\u6587\u4ef6\u624d\u80fd\u9a8c\u8bc1\u767b\u5f55\uff0c\u8fd9\u91cc\u5c31\u662f\u8ba9\u4f60\u5bf9\u8fd9\u53f0\u673a\u5668\u521b\u5efa\u4e00\u4e2akey pair\u6587\u4ef6\uff08\u6216\u6307\u5b9a\u4ee5\u524d\u521b\u5efa\u8fc7\u7684key\u6587\u4ef6\uff09\uff0c\u5728 Key pair name \u91cc\u547d\u540d\u4f60\u7684key\u6587\u4ef6\uff0c\u70b9\u51fb Download Key Pair \u6587\u4ef6\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u70b9\u51fb \u542f\u52a8\u5b9e\u4f8b \u3002 \u5b9e\u4f8b\u6b63\u5728\u542f\u52a8\uff0c\u6211\u4eec\u53ef\u4ee5\u70b9\u51fb\u4e0a\u56fe\u4e2d\u7684\u5b9e\u4f8bID\uff1a i-xxxxxxx \u67e5\u770b\u8fd9\u53f0\u673a\u5668\u7684\u72b6\u6001\uff0c\u4e0b\u56fe\u663e\u793a\uff0c\u8fd9\u53f0\u673a\u5668\u5df2\u7ecf\u6b63\u5e38running\uff0c\u5e76\u901a\u8fc7\u4e86\u72b6\u6001\u68c0\u67e5,\u3002\u8fd8\u8bb0\u5f97\u521a\u624d\u7684tag\u6807\u7b7e\u4e48\uff1f\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 \u9f7f\u8f6e \u56fe\u5f62\uff0c\u9009\u4e2d\u663e\u793a\u4f60\u8bbe\u5b9a\u7684\u6807\u7b7e\uff0c\u5c31\u53ef\u4ee5\u5728\u9762\u677f\u4e0a\u770b\u5230\u5566\uff0c\u8bf7\u517b\u6210\u597d\u4e60\u60ef\uff0c\u4ee5\u540e\u521b\u5efa\u7684\u673a\u5668\u90fd\u8981\u6dfb\u52a0\u8fd9\u51e0\u4e2a\u6807\u7b7e\u54e6~ \u6761\u4ef6\u8fc7\u6ee4\u770b\u5230\u4f60\u60f3\u8981\u7684\u5b9e\u4f8b\uff1a\u4e0a\u65b9\u7684\u641c\u7d22\u6846\u6709 Add filter \u5b57\u6837\uff0c\u9f20\u6807\u79fb\u52a8\u8fc7\u53bb\u70b9\u51fb\uff0c\u4f1a\u51fa\u73b0\u4e0b\u62c9\u8fc7\u6ee4\u83dc\u5355\uff0c\u65b9\u4fbf\u4f60\u627e\u5230\u7279\u5b9a\u7684\u673a\u5668\u54e6\uff01 \u81f3\u6b64\uff0c\u5982\u4f55\u5728aws\u542f\u52a8\u4e00\u53f0\u4f60\u60f3\u8981\u7684\u673a\u5668\u5c31\u5927\u529f\u544a\u6210\u4e86\uff01\u4f46\u662f\u673a\u5668\u5728\u4e91\u7aef\u8dd1\u4e86\uff0c\u800c\u6211\u53ea\u80fd\u8fdc\u89c2\u800c\u4e0d\u53ef\u4eb5\u73a9\u4e48\uff1f\u600e\u4e48\u53ef\u80fd\uff0c\u82b1\u4e86\u8fd9\u4e48\u591a\u529f\u592b\u4e0d\u5c31\u662f\u4e3a\u4e86\u4eb5\u73a9\u4e48\uff1f\u5144\u5f1f\u4eec\u8ddf\u6211\u4e0a\uff01","title":"\u521b\u5efaEC2\u673a\u578b\uff08Elasic Compute Cloud\uff09"},{"location":"blogs/2020-01-19-how-to-launch-ec2/#ec2","text":"\u627e\u5230\u4f60\u4e0b\u8f7d\u7684key\u6587\u4ef6\uff0c\u6bd4\u5982\u6211\u7684\u662f mytest.pem \u3002 \u6253\u5f00\u4f60\u7684\u672c\u5730ssh\u5de5\u5177\uff0c\u6bd4\u5982\u6211\u7684\u662fgitbash, \u8fdb\u5230\u4f60key\u6240\u5728\u7684\u6587\u4ef6\u5939\u4e0b: $ ls *.pem mytest.pem \u5728aws\u63a7\u5236\u53f0\u4e0a\uff0c\u9009\u4e2d\u4f60\u542f\u52a8\u7684\u90a3\u53f0\u673a\u5668\uff0c\u70b9\u51fb Connect \uff0c\u8df3\u7a97\u7684\u4fe1\u606f\u4f1a\u8be6\u7ec6\u544a\u8bc9\u4f60\u5982\u4f55\u4eb5\u73a9\u4f60\u7684\u673a\u5668\uff0c\u4f60\u53ea\u8981copy\u5c31\u597d\uff0c\u5b9e\u5728\u662f\u592a\u65b9\u4fbf\u4e86\uff01 \u4e3a\u4e86\u6ee1\u8db3\u6211\u4eec\u7b49\u5b85\u7537\uff0caws\u771f\u662f\u7528\u5fc3\u826f\u82e6\u3002 $ chmod 400 mytest.pem $ ssh -i \"mytest.pem\" ec2-user@ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn The authenticity of host 'ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn (\u4e0d-\u544a-\u8bc9-\u4f60)' can't be established. ECDSA key fingerprint is SHA256:SSxxxxxxxxxxxxxxxxxxx. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'ec2-\u4e0d-\u544a-\u8bc9-\u4f60.cn-northwest-1.compute.amazonaws.com.cn,\u4e0d-\u544a-\u8bc9-\u4f60' (ECDSA) to the list of known hosts. __| __|_ ) _| ( / Amazon Linux 2 AMI ___|\\___|___| https://aws.amazon.com/amazon-linux-2/ 3 package(s) needed for security, out of 24 available Run \"sudo yum update\" to apply all updates. [ec2-user@ip-\u4e0d-\u544a-\u8bc9-\u4f60 ~]$ \u81f3\u6b64\uff0c\u4f60\u5df2\u7ecf\u6210\u529f\u8fdb\u5165\u4e86\u670d\u52a1\u5668\uff0c\u63a5\u4e0b\u6765\u5c31\u968f\u4fbf\u4f60\u4e86\u3002 [ec2-user@ip-\u4e0d-\u544a-\u8bc9-\u4f60 ~]$ ping 8.8.8.8 PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data. 64 bytes from 8.8.8.8: icmp_seq=1 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=2 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=3 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=4 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=5 ttl=46 time=54.8 ms 64 bytes from 8.8.8.8: icmp_seq=6 ttl=46 time=54.9 ms ^C --- 8.8.8.8 ping statistics --- 6 packets transmitted, 6 received, 0% packet loss, time 5007ms rtt min/avg/max/mdev = 54.849/54.877/54.908/0.192 ms PS: pem\u6587\u4ef6\u53ef\u4ee5\u7528\u4e8e\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u5728winscp\u91cc\u8bbe\u7f6e\u7528\u4e8e\u548cEC2\u7684\u6570\u636e\u4ea4\u4e92\u3002\u5982\u679c\u7528putty\uff0c\u9700\u8981\u5148\u5c06pem\u683c\u5f0f\u8f6c\u6362\u4e3appk\u683c\u5f0f\uff0c \u70b9\u6211","title":"\u5982\u4f55\u767b\uff08\u4eb5\uff09\u5165\uff08\u73a9\uff09\u4e91\u670d\u52a1\u5668EC2"},{"location":"blogs/2020-01-25-how-to-create-ec2img/","text":"\u5982\u4f55\u4e3a\u5df2\u7ecf\u5e03\u597d\u5206\u6790\u6d41\u7a0b\u7684EC2\u521b\u5efa\u955c\u50cf\uff08\u4ee5\u8fbe\u5230\u957f\u671f\u5360\u6709\u7684\u76ee\u7684\uff09 \u7c7b\u4f3c\u4e8e\u672c\u5730\u670d\u52a1\u5668\uff0c\u6211\u7b49\u751f\u4fe1\u4eba\u5458\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u597d\u5206\u6790\u6d41\u7a0b\uff0c\u5e76\u4e14\u7528\u5c0f\u6570\u636e\u91cf\u6d4b\u8bd5\uff0c\u8c03\u8bd5\uff0c\u6700\u540e\u7ecf\u8fc7\u771f\u5b9e\u6837\u672c\u7684\u6d4b\u8bd5\uff0c\u4ece\u5f00\u53d1\u6b63\u5f0f\u8fc7\u6e21\u5230\u5b9e\u9645\u7684\u751f\u4ea7\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u5f80\u5f80\u4f1a\u505a\u597d\u76f8\u5173\u7684\u5907\u4efd\u548c\u955c\u50cf\uff0c\u56e0\u4e3a\u672c\u5730\u73af\u5883\u6709\u65f6\u5019\u4f1a\u9047\u5230\u5404\u79cd\u5947\u8469\u7684\u4e8b\u6545\uff0c\u6bd4\u5982\u78c1\u76d8\u6302\u6389\uff0c\u65ad\u7535\uff0c\u673a\u623f\u7740\u706b\uff0c\u7a7a\u8c03\u6f0f\u6c34\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u6211\u4eec\u8f9b\u8f9b\u82e6\u82e6\u5e03\u597d\u6d41\u7a0b\u7684\u673a\u5668\u5c31\u5e9f\u4e86\u3002\u5e78\u4e8f\u73b0\u5728\u6709\u4e86\u4e91\u7aef\u670d\u52a1\u5668\uff0c\u4ee5\u4e0a\u672c\u5730\u7684\u5f0a\u7aef\u53ef\u4ee5\u7edf\u7edf\u6254\u6389\uff0c\u8ba9\u6211\u4eec\u4e13\u6ce8\u4e8e\u5982\u4f55\u4f18\u5316\u81ea\u5df1\u7684\u5206\u6790\u6d41\u7a0b\u5c31\u597d\uff0c\u5b9e\u5728\u662f\u4eba\u751f\u82e6\u77ed~ -- D.C \u4e3aEC2\u521b\u5efa\u955c\u50cf \u767b\u5165aws console, \u8fdb\u5165ec2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u62e9\u5de6\u8fb9\u5bfc\u822a\u680f\u7684\u5b9e\u4f8b\uff08instance\uff09\u3002 \u9009\u4e2d\u6211\u4eec\u5df2\u7ecf\u6b65\u597d\u6d41\u7a0b\u7684EC2\u673a\u5668\uff0c\u4f8b\u5982\u672c\u56fe\u4e2d\u7684c4.xlarge\u673a\u5668\uff0c\u5047\u8bbe\u6211\u5df2\u7ecf\u5728\u4e0a\u9762\u5e03\u597d\u4e86\u4e00\u4e2a\u53eb\u505a lung14gene \u7684\u5206\u6790\u6d41\u7a0b\u3002 \u70b9\u51fb\u4e0a\u65b9\u7684 Action \u6309\u94ae\uff0c\u51fa\u73b0\u4e0b\u62c9\u83dc\u5355\uff0c\u9f20\u6807\u79fb\u52a8\u5230\u955c\u50cf\uff08image\uff09\uff0c\u70b9\u51fb \u521b\u5efa\u955c\u50cf \u3002 \u8f93\u5165\u955c\u50cf\u540d\u5b57 lung14gene , \u955c\u50cf\u63cf\u8ff0 this is used for analysis of lung cancer 14 gene \uff0c \u9ed8\u8ba4\u662f \u4e0d\u9700\u8981\u91cd\u542f(No reboot) \u5982\u679c\u9009\u62e9\uff0cEC2\u63a7\u5236\u53f0\u5c31\u4e0d\u4f1a\u5728\u521b\u5efa\u955c\u50cf\u524d\u5173\u95ed\u5b9e\u4f8b\uff0c\u4f46\u5b9e\u9645\u4e0a\u6211\u4fdd\u6301\u9ed8\u8ba4\uff0c\u5728\u521b\u5efa\u955c\u50cf\u65f6\u4e5f\u6ca1\u53d1\u73b0\u6709\u5173\u95ed\u5b9e\u4f8b\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u505a\u9009\u62e9\uff0c\u4fdd\u6301\u9ed8\u8ba4\u3002 \u63a5\u7740\u9009\u62e9\u9700\u8981\u6253\u955c\u50cf\u7684\u78c1\u76d8\uff0c\u4e00\u822cRoot\u662f\u5fc5\u9009\u7684\uff0c\u5176\u4ed6EBS\u78c1\u76d8\u89c6\u60c5\u51b5\u51b3\u5b9a\u662f\u5426\u53d6\u6d88\uff08\u70b9\u51fb x \u53d6\u6d88\uff09\uff0c\u4e00\u822c\u989d\u5916\u6302\u8f7d\u7684EBS\u76d8\u53ef\u4ee5\u7528\u4e8e\u5b58\u653e\u5e38\u7528\u6570\u636e\u5e93\uff0c\u4ee5\u53ca\u5b58\u653e\u5f85\u5206\u6790\u7684\u57fa\u56e0\u6570\u636e\uff0c\u6bd4\u5982\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u7b2c\u4e00\u5757EBS\u662f\u653e\u6570\u636e\u5e93\u7684\uff0c\u7b2c\u4e8c\u5757EBS\u662f\u653e\u4e34\u65f6\u6570\u636e\u7684\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u7ed9\u8fd9\u4e24\u5757\u6253\u955c\u50cf\uff0c\u5220\u6389\u8fd9\u4e24\u5757\u76d8\uff0c\u70b9\u51fb \u521b\u5efa\u955c\u50cf \u3002 \u63a5\u7740\u51fa\u73b0\u4e00\u4e2a\u8df3\u7a97\u544a\u8bc9\u6211\uff0c\u521b\u5efa\u955c\u50cf\u7684\u8bf7\u6c42\u5df2\u7ecf\u88ab\u63a5\u53d7\uff0c\u6b63\u5728\u6267\u884c\u4e2d\uff0c\u70b9\u51fbami-xxxxx\u8fd9\u4e2aID\uff0c\u5373\u53ef\u67e5\u770b\u8fd9\u4e2a\u955c\u50cfAMI (amazon mirror image)\u7684\u72b6\u6001,\u770b\u78c1\u76d8\u7684\u5927\u5c0f\uff0c\u7b49\u5f85\u7684\u65f6\u95f4\u4e5f\u6709\u957f\u77ed\uff0c\u6700\u540e status \u4f1a\u53d8\u6210\u7eff\u8272\u7684 available \uff0c\u5c31\u610f\u5473\u7740\u521b\u5efa\u955c\u50cf\u6210\u529f\u5566\u3002 \u4f60\u4e5f\u53ef\u4ee5\u70b9\u51fbEC2\u63a7\u5236\u53f0\u5de6\u4fa7\u5bfc\u822a\u680f\u5185\u7684 \u955c\u50cf - AMIs \u67e5\u770b\u4f60\u7684\u6240\u6709\u955c\u50cf\uff0c\u8bb0\u5f97\u6253\u597dtag\u4ee5\u4f5c\u65e5\u540e\u63d0\u9192\u54e6~ \u6062\u590dEC2\u955c\u50cf \u5982\u679c\u6211\u4eec\u7a81\u7136\u6765\u4e86100\u4f8b\u6837\u672c\u7684\u6570\u636e\uff0c3\u5929\u5185\u8981\u5206\u6790\u5b8c\u6bd5\uff0c\u600e\u4e48\u529e\uff1f\u522b\u6025\uff0c\u7c97\u7565\u7b97\u4e0b\u6211\u4eec\u9700\u8981\u7684\u673a\u5668\u6570\uff0c\u5f00\u8d77\u6765\u7b97\u5c31\u884c\u4e86\uff0c\u5229\u7528\u4ee5\u524d\u6211\u4eec\u521b\u5efa\u7684EC2\u955c\u50cf\uff0c\u53ef\u4ee5\u5feb\u901f\u590d\u5236\u51e0\u5341or\u4e0a\u767e\u53f0\u4e00\u6a21\u4e00\u6837\u5206\u6790\u73af\u5883\u7684\u670d\u52a1\u5668\u6765\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u4efb\u52a1\u3002 \u9009\u62e9\u955c\u50cf\u3002\u8fdb\u5165 \u955c\u50cf - AMIs \uff0c\u9009\u4e2d\u4f60\u9700\u8981\u7684\u955c\u50cf\u3002 \u70b9\u51fb\u4e0a\u65b9\u7684 Action \u4e0b\u62c9\u83dc\u5355\uff0c\u9009\u62e9 \u542f\u52a8 \u3002 \u4e4b\u540e\u5c31\u548c\u521b\u5efaEC2\u4e00\u6837\u7684\u64cd\u4f5c\uff0c\u533a\u522b\u662f\u7b2c\u4e00\u6b65\u4e0d\u7528\u9009\u62e9AMI\u4e86\uff0c\u9009\u62e9\u597d\u673a\u578b\uff0c\u914d\u7f6e\u597d\u5b9e\u4f8b\uff0c\u9009\u62e9\u5b58\u50a8\uff0c\u8fd9\u91cc\u6ce8\u610f\uff0c\u9ed8\u8ba4\u663e\u793a\u7684\u5b58\u50a8\u5927\u5c0f\uff0c\u5c31\u662f\u4f60\u5f53\u521d\u521b\u5efaAMI\u65f6\u7684\u5927\u5c0f\uff0c\u53ea\u80fd\u6539\u5927\uff0c\u4e0d\u80fd\u6539\u5c0f\u54e6\u3002\u4e4b\u540e\u6253\u597d\u6807\u7b7e\uff0c\u914d\u7f6e\u5b89\u5168\u7ec4\uff0c\u70b9\u51fb\u542f\u52a8\u540e\u9009\u62e9\u4e4b\u524d\u4fdd\u5b58\u7684key\u6587\u4ef6\uff0c\u628a I acknowledge ... \u52fe\u52fe\u6253\u4e0a\uff0c\u70b9\u51fb\u542f\u52a8\u5373\u53ef\u3002\u3001 \u8fd9\u6837\u542f\u52a8\u8d77\u6765\u7684\u673a\u5668\uff0c\u5c31\u6709\u54b1\u4eec\u4e4b\u524d\u6253\u955c\u50cf\u65f6\u4e00\u6478\u4e00\u6837\u7684\u5206\u6790\u73af\u5883\u4e86\uff0c\u8fd8\u4e0d\u5feb\u52a8\u624b\u8bd5\u8bd5\uff0c\u8d76\u7d27\u4e3a\u4f60\u7684\u5206\u6790\u6d41\u7a0b\u4e0a\u4efd\u4fdd\u9669\u5427 :-)","title":"\u5982\u4f55\u4e3a\u5df2\u7ecf\u5e03\u597d\u5206\u6790\u6d41\u7a0b\u7684EC2\u521b\u5efa\u955c\u50cf\uff08\u4ee5\u8fbe\u5230\u957f\u671f\u5360\u6709\u7684\u76ee\u7684\uff09"},{"location":"blogs/2020-01-25-how-to-create-ec2img/#ec2","text":"\u7c7b\u4f3c\u4e8e\u672c\u5730\u670d\u52a1\u5668\uff0c\u6211\u7b49\u751f\u4fe1\u4eba\u5458\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u597d\u5206\u6790\u6d41\u7a0b\uff0c\u5e76\u4e14\u7528\u5c0f\u6570\u636e\u91cf\u6d4b\u8bd5\uff0c\u8c03\u8bd5\uff0c\u6700\u540e\u7ecf\u8fc7\u771f\u5b9e\u6837\u672c\u7684\u6d4b\u8bd5\uff0c\u4ece\u5f00\u53d1\u6b63\u5f0f\u8fc7\u6e21\u5230\u5b9e\u9645\u7684\u751f\u4ea7\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u5f80\u5f80\u4f1a\u505a\u597d\u76f8\u5173\u7684\u5907\u4efd\u548c\u955c\u50cf\uff0c\u56e0\u4e3a\u672c\u5730\u73af\u5883\u6709\u65f6\u5019\u4f1a\u9047\u5230\u5404\u79cd\u5947\u8469\u7684\u4e8b\u6545\uff0c\u6bd4\u5982\u78c1\u76d8\u6302\u6389\uff0c\u65ad\u7535\uff0c\u673a\u623f\u7740\u706b\uff0c\u7a7a\u8c03\u6f0f\u6c34\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u6211\u4eec\u8f9b\u8f9b\u82e6\u82e6\u5e03\u597d\u6d41\u7a0b\u7684\u673a\u5668\u5c31\u5e9f\u4e86\u3002\u5e78\u4e8f\u73b0\u5728\u6709\u4e86\u4e91\u7aef\u670d\u52a1\u5668\uff0c\u4ee5\u4e0a\u672c\u5730\u7684\u5f0a\u7aef\u53ef\u4ee5\u7edf\u7edf\u6254\u6389\uff0c\u8ba9\u6211\u4eec\u4e13\u6ce8\u4e8e\u5982\u4f55\u4f18\u5316\u81ea\u5df1\u7684\u5206\u6790\u6d41\u7a0b\u5c31\u597d\uff0c\u5b9e\u5728\u662f\u4eba\u751f\u82e6\u77ed~ -- D.C","title":"\u5982\u4f55\u4e3a\u5df2\u7ecf\u5e03\u597d\u5206\u6790\u6d41\u7a0b\u7684EC2\u521b\u5efa\u955c\u50cf\uff08\u4ee5\u8fbe\u5230\u957f\u671f\u5360\u6709\u7684\u76ee\u7684\uff09"},{"location":"blogs/2020-01-25-how-to-create-ec2img/#ec2_1","text":"\u767b\u5165aws console, \u8fdb\u5165ec2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u62e9\u5de6\u8fb9\u5bfc\u822a\u680f\u7684\u5b9e\u4f8b\uff08instance\uff09\u3002 \u9009\u4e2d\u6211\u4eec\u5df2\u7ecf\u6b65\u597d\u6d41\u7a0b\u7684EC2\u673a\u5668\uff0c\u4f8b\u5982\u672c\u56fe\u4e2d\u7684c4.xlarge\u673a\u5668\uff0c\u5047\u8bbe\u6211\u5df2\u7ecf\u5728\u4e0a\u9762\u5e03\u597d\u4e86\u4e00\u4e2a\u53eb\u505a lung14gene \u7684\u5206\u6790\u6d41\u7a0b\u3002 \u70b9\u51fb\u4e0a\u65b9\u7684 Action \u6309\u94ae\uff0c\u51fa\u73b0\u4e0b\u62c9\u83dc\u5355\uff0c\u9f20\u6807\u79fb\u52a8\u5230\u955c\u50cf\uff08image\uff09\uff0c\u70b9\u51fb \u521b\u5efa\u955c\u50cf \u3002 \u8f93\u5165\u955c\u50cf\u540d\u5b57 lung14gene , \u955c\u50cf\u63cf\u8ff0 this is used for analysis of lung cancer 14 gene \uff0c \u9ed8\u8ba4\u662f \u4e0d\u9700\u8981\u91cd\u542f(No reboot) \u5982\u679c\u9009\u62e9\uff0cEC2\u63a7\u5236\u53f0\u5c31\u4e0d\u4f1a\u5728\u521b\u5efa\u955c\u50cf\u524d\u5173\u95ed\u5b9e\u4f8b\uff0c\u4f46\u5b9e\u9645\u4e0a\u6211\u4fdd\u6301\u9ed8\u8ba4\uff0c\u5728\u521b\u5efa\u955c\u50cf\u65f6\u4e5f\u6ca1\u53d1\u73b0\u6709\u5173\u95ed\u5b9e\u4f8b\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u505a\u9009\u62e9\uff0c\u4fdd\u6301\u9ed8\u8ba4\u3002 \u63a5\u7740\u9009\u62e9\u9700\u8981\u6253\u955c\u50cf\u7684\u78c1\u76d8\uff0c\u4e00\u822cRoot\u662f\u5fc5\u9009\u7684\uff0c\u5176\u4ed6EBS\u78c1\u76d8\u89c6\u60c5\u51b5\u51b3\u5b9a\u662f\u5426\u53d6\u6d88\uff08\u70b9\u51fb x \u53d6\u6d88\uff09\uff0c\u4e00\u822c\u989d\u5916\u6302\u8f7d\u7684EBS\u76d8\u53ef\u4ee5\u7528\u4e8e\u5b58\u653e\u5e38\u7528\u6570\u636e\u5e93\uff0c\u4ee5\u53ca\u5b58\u653e\u5f85\u5206\u6790\u7684\u57fa\u56e0\u6570\u636e\uff0c\u6bd4\u5982\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u7b2c\u4e00\u5757EBS\u662f\u653e\u6570\u636e\u5e93\u7684\uff0c\u7b2c\u4e8c\u5757EBS\u662f\u653e\u4e34\u65f6\u6570\u636e\u7684\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u7ed9\u8fd9\u4e24\u5757\u6253\u955c\u50cf\uff0c\u5220\u6389\u8fd9\u4e24\u5757\u76d8\uff0c\u70b9\u51fb \u521b\u5efa\u955c\u50cf \u3002 \u63a5\u7740\u51fa\u73b0\u4e00\u4e2a\u8df3\u7a97\u544a\u8bc9\u6211\uff0c\u521b\u5efa\u955c\u50cf\u7684\u8bf7\u6c42\u5df2\u7ecf\u88ab\u63a5\u53d7\uff0c\u6b63\u5728\u6267\u884c\u4e2d\uff0c\u70b9\u51fbami-xxxxx\u8fd9\u4e2aID\uff0c\u5373\u53ef\u67e5\u770b\u8fd9\u4e2a\u955c\u50cfAMI (amazon mirror image)\u7684\u72b6\u6001,\u770b\u78c1\u76d8\u7684\u5927\u5c0f\uff0c\u7b49\u5f85\u7684\u65f6\u95f4\u4e5f\u6709\u957f\u77ed\uff0c\u6700\u540e status \u4f1a\u53d8\u6210\u7eff\u8272\u7684 available \uff0c\u5c31\u610f\u5473\u7740\u521b\u5efa\u955c\u50cf\u6210\u529f\u5566\u3002 \u4f60\u4e5f\u53ef\u4ee5\u70b9\u51fbEC2\u63a7\u5236\u53f0\u5de6\u4fa7\u5bfc\u822a\u680f\u5185\u7684 \u955c\u50cf - AMIs \u67e5\u770b\u4f60\u7684\u6240\u6709\u955c\u50cf\uff0c\u8bb0\u5f97\u6253\u597dtag\u4ee5\u4f5c\u65e5\u540e\u63d0\u9192\u54e6~","title":"\u4e3aEC2\u521b\u5efa\u955c\u50cf"},{"location":"blogs/2020-01-25-how-to-create-ec2img/#ec2_2","text":"\u5982\u679c\u6211\u4eec\u7a81\u7136\u6765\u4e86100\u4f8b\u6837\u672c\u7684\u6570\u636e\uff0c3\u5929\u5185\u8981\u5206\u6790\u5b8c\u6bd5\uff0c\u600e\u4e48\u529e\uff1f\u522b\u6025\uff0c\u7c97\u7565\u7b97\u4e0b\u6211\u4eec\u9700\u8981\u7684\u673a\u5668\u6570\uff0c\u5f00\u8d77\u6765\u7b97\u5c31\u884c\u4e86\uff0c\u5229\u7528\u4ee5\u524d\u6211\u4eec\u521b\u5efa\u7684EC2\u955c\u50cf\uff0c\u53ef\u4ee5\u5feb\u901f\u590d\u5236\u51e0\u5341or\u4e0a\u767e\u53f0\u4e00\u6a21\u4e00\u6837\u5206\u6790\u73af\u5883\u7684\u670d\u52a1\u5668\u6765\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u4efb\u52a1\u3002 \u9009\u62e9\u955c\u50cf\u3002\u8fdb\u5165 \u955c\u50cf - AMIs \uff0c\u9009\u4e2d\u4f60\u9700\u8981\u7684\u955c\u50cf\u3002 \u70b9\u51fb\u4e0a\u65b9\u7684 Action \u4e0b\u62c9\u83dc\u5355\uff0c\u9009\u62e9 \u542f\u52a8 \u3002 \u4e4b\u540e\u5c31\u548c\u521b\u5efaEC2\u4e00\u6837\u7684\u64cd\u4f5c\uff0c\u533a\u522b\u662f\u7b2c\u4e00\u6b65\u4e0d\u7528\u9009\u62e9AMI\u4e86\uff0c\u9009\u62e9\u597d\u673a\u578b\uff0c\u914d\u7f6e\u597d\u5b9e\u4f8b\uff0c\u9009\u62e9\u5b58\u50a8\uff0c\u8fd9\u91cc\u6ce8\u610f\uff0c\u9ed8\u8ba4\u663e\u793a\u7684\u5b58\u50a8\u5927\u5c0f\uff0c\u5c31\u662f\u4f60\u5f53\u521d\u521b\u5efaAMI\u65f6\u7684\u5927\u5c0f\uff0c\u53ea\u80fd\u6539\u5927\uff0c\u4e0d\u80fd\u6539\u5c0f\u54e6\u3002\u4e4b\u540e\u6253\u597d\u6807\u7b7e\uff0c\u914d\u7f6e\u5b89\u5168\u7ec4\uff0c\u70b9\u51fb\u542f\u52a8\u540e\u9009\u62e9\u4e4b\u524d\u4fdd\u5b58\u7684key\u6587\u4ef6\uff0c\u628a I acknowledge ... \u52fe\u52fe\u6253\u4e0a\uff0c\u70b9\u51fb\u542f\u52a8\u5373\u53ef\u3002\u3001 \u8fd9\u6837\u542f\u52a8\u8d77\u6765\u7684\u673a\u5668\uff0c\u5c31\u6709\u54b1\u4eec\u4e4b\u524d\u6253\u955c\u50cf\u65f6\u4e00\u6478\u4e00\u6837\u7684\u5206\u6790\u73af\u5883\u4e86\uff0c\u8fd8\u4e0d\u5feb\u52a8\u624b\u8bd5\u8bd5\uff0c\u8d76\u7d27\u4e3a\u4f60\u7684\u5206\u6790\u6d41\u7a0b\u4e0a\u4efd\u4fdd\u9669\u5427 :-)","title":"\u6062\u590dEC2\u955c\u50cf"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/","text":"\u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb \u6211\u4eec\u77e5\u9053\uff0caws\u63d0\u4f9b\u7684\u5b58\u50a8\u670d\u52a1\u6709S3\uff0cEBS\uff0cEFS\uff0c\u6709\u4e9b\u540c\u5b66\u5728\u4f7f\u7528\u7684\u65f6\u5019\u4f1a\u6709\u4e9b\u56f0\u6270\uff0c\u54ea\u4e2a\u624d\u662f\u6700\u9002\u5408\u6211\u81ea\u5df1\u7684\u4e91\u5b58\u50a8\u65b9\u6848\u5462\uff0c\u73b0\u5728\u6211\u5c31\u548c\u5927\u5bb6\u4e00\u8d77\u6765\u5b66\u4e60\u4e0baws\u7684\u4e09\u4e2a\u5e38\u7528\u5b58\u50a8\u670d\u52a1\uff1aAmazon Elastic Block Store (Amazon EBS), Amazon Simple Storage Service (Amazon S3), \u548cAmazon Elastic File System (Amazon EFS) -- D.C \u4ec0\u4e48\u662fAmazon EFS\uff1f Amazon EFS \u662fAWS\u63d0\u4f9b\u7684NFS\u6587\u4ef6\u7cfb\u7edf\u6258\u7ba1\u670d\u52a1\uff0c\u80fd\u88ab\u591a\u4e2aAmazon EC2\u5b9e\u4f8b\u6240\u5171\u4eab\u3002 \u5b83\u7684\u5de5\u4f5c\u6a21\u5f0f\u7c7b\u4f3c\u4e8eNAS\u8bbe\u5907\uff0c\u5f88\u9002\u5408\u7528\u6765\u505a \u5927\u6570\u636e\u5206\u6790 \uff0c \u591a\u5a92\u4f53\u5904\u7406\u6d41\u7a0b \uff0c \u4ee5\u53ca \u5185\u5bb9\u7ba1\u7406 \u3002\u5176\u5b9e\u9009\u62e9\u54ea\u79cd\u5b58\u50a8\u670d\u52a1\u5173\u952e\u53d6\u51b3\u4e8e\u6211\u4eec\u7279\u5b9a\u7684\u7cfb\u7edf\u9700\u6c42\uff0c\u5305\u62ec\u6211\u4eec\u5bf9\u6210\u672c\u7684\u63a7\u5236\uff0c\u6027\u80fd\uff0c\u548c\u8bbf\u95ee\u7684\u65b9\u5f0f\u3002 Amazon EFS\u63d0\u4f9b\u7b80\u5355\u3001\u53ef\u6269\u5c55\u3001\u5b8c\u5168\u6258\u7ba1\u7684\u5f39\u6027 NFS \u6587\u4ef6\u7cfb\u7edf\u3002\u5b83\u53ef\u6309\u9700\u6269\u5c55\u81f3 PB \u7ea7\uff0c\u800c\u4e0d\u4f1a\u4e2d\u65ad\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5728\u6dfb\u52a0\u548c\u5220\u9664\u6587\u4ef6\u65f6\u81ea\u52a8\u589e\u52a0\u548c\u7f29\u5c0f\uff0c\u4ece\u800c\u65e0\u9700\u9884\u7f6e\u548c\u7ba1\u7406\u5bb9\u91cf\u4ee5\u9002\u5e94\u589e\u957f\u3002 \u8981\u6ce8\u610f\uff0c\u5728\u8003\u8651\u5b58\u50a8\u6210\u672c\u7684\u540c\u65f6\uff0c\u6700\u597d\u548c\u8ba1\u7b97\u8d44\u6e90\u6210\u672c\u540c\u65f6\u8003\u8651\u624d\u6709\u610f\u4e49\u54e6\uff0c\u53e6\u5916EFS\u7c7b\u4f3cS3\uff0c\u4e5f\u6709\u975e\u9891\u7e41\u8bbf\u95ee\u6a21\u5f0f\uff08IA), \u867d\u7136\u5de5\u4f5c\u8d1f\u8f7d\u6a21\u5f0f\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5ba2\u6237\u901a\u5e38\u4f1a\u53d1\u73b0 80% \u7684\u6587\u4ef6\u4e0d\u7ecf\u5e38\u8bbf\u95ee\uff08\u5e76\u4e14\u9002\u5408 EFS IA\uff09\uff0c20% \u7684\u6587\u4ef6\u6b63\u5728\u4f7f\u7528\uff08\u9002\u7528\u4e8e EFS \u6807\u51c6\uff09\uff0c\u6240\u4ee5\u901a\u8fc7\u5229\u7528IA\u53ef\u4ee5\u5f88\u597d\u63a7\u5236\u6210\u672c\u3002 \u4ec0\u4e48\u662fAmazon S3\uff1f Amazon S3 \u662fAWS\u63d0\u4f9b\u7684\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u3002\u5b83\u662f\u4e00\u4e2a\u9759\u6001\u7684\u5b58\u50a8\u670d\u52a1\uff0c\u53ef\u7528\u4e8e\u9759\u6001\u7f51\u7ad9\u6258\u7ba1\uff0c\u591a\u5a92\u4f53\u5185\u5bb9\u90e8\u7f72\u548c\u5206\u53d1\uff08cloudfront\uff09\uff0c\u7248\u672c\u7ba1\u7406\uff0c\u5927\u6570\u636e\u5206\u6790\u4ee5\u53ca\u5f52\u6863\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0cS3\u81ea\u5e26\u6570\u636e\u6e56\u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u548cAthena\uff08aws\u7684\u7b80\u5355sql\u67e5\u8be2\u670d\u52a1\uff09\u4ee5\u53caGlu\uff08aws\u5927\u6570\u636eETL\u670d\u52a1\uff09\u642d\u914d\u7528\u4e8e\u5927\u6570\u636e\u5206\u6790\u3002 \u4ec0\u4e48\u662fEBS\uff1f Amazon EBS \u662fAWS\u63d0\u4f9b\u7684\u5757\u5b58\u50a8\u670d\u52a1\u3002\u4e00\u4e2aEBS\u5377\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u5757\u78c1\u76d8\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\uff0c\u90e8\u7f72\u5404\u7c7b\u5206\u6790\u6d41\u7a0b\u7b49\u3002 \u4e09\u7c7b\u5b58\u50a8\u5bf9\u6bd4\u8868 \u7279\u70b9 S3 EBS EFS \u5b58\u50a8\u6210\u672c \uff08\u5b81\u590f\u533a\u57df\u4e3a\u4f8b\uff09 [\u6807\u51c6\u578b] \u7b2c\u4e00\u4e2a50TB/\u6708\u90e8\u5206: 0.1755\u5143/GB\uff1b 50TB-450TB\u90e8\u5206: 0.1719\u5143/GB 500TB\u4ee5\u4e0a/\u6708\u90e8\u5206\uff1a0.1629\u5143/GB gp2\u901a\u7528\u578bSSD: 0.664\u5143/GB-\u6708 io1\u9884\u914dIOPS SSD: \u5b58\u50a80.764\u5143/GB-\u6708\uff0c 0.399\u5143/\u9884\u914d\u7f6eIOPS-\u6708 st1\u541e\u5410\u4f18\u5316HDD\uff1a0.299\u5143/GB-\u6708 sc1 cold HDD: 0.166\u5143/GB-\u6708 EBS \u78c1\u6027\u4ecb\u8d28\uff1a0.364\u5143/GB-\u6708\uff0c0.364/100\u4e07I/O\u8bf7\u6c42 \u6807\u51c6\u5b58\u50a8\uff1a2.145\u5143/GB-\u6708 \u4e0d\u9891\u7e41\u8bbf\u95ee\u5b58\u50a8\uff1a0.200\u5143/GB-\u6708 \u4e0d\u9891\u7e41\u8bbf\u95ee\u8bf7\u6c42\uff1a0.071\u5143\uff08\u6bcfGB\u4f20\u8f93\u6570\u636e\uff09 \u9884\u7f6e\u541e\u5410\u91cf\uff08MB/\u79d2-\u6708\uff09\uff1a42.891\u5143(MB/S-\u6708) \u5b58\u50a8\u5927\u5c0f \u5b58\u50a8\u5bf9\u8c61\u6570\u91cf\u65e0\u9650\u5236 \u6700\u5927\u4e3a16TB \u65e0\u9650\u5236\uff0c\u81ea\u52a8\u5f39\u6027\u6269\u5c55 \u6587\u4ef6\u5927\u5c0f \u5355\u4e2aS3\u5bf9\u8c61\u6700\u5c0f0 byte\uff0c\u6700\u59275TB \u65e0\u9650\u5236 \u5355\u4e2a\u6587\u4ef6\u6700\u592747.9TiB \u6570\u636e\u541e\u5410\u548cI/O \u652f\u6301\u5206\u6bb5\u4e0a\u4f20\uff0c\u5efa\u8bae\u5927\u4e8e100MB\u7684\u6587\u4ef6\u90fd\u91c7\u7528\u8be5\u4e0a\u4f20\u65b9\u5f0f \u8c03\u7528PUT API\u8fdb\u884c\u4e0a\u4f20\u7684\u5355\u4e2a\u6587\u4ef6\u9650\u5236\u4e3a5GB \u57fa\u4e8eSSD\u548cHDD\u4e24\u7c7b \u5982\u679c\u5bf9I/O\u6709\u8981\u6c42\uff0c\u63a8\u8350\u91c7\u7528SDD+\u9884\u7559IOPS \u6240\u6709\u8fde\u63a5\u7684client\uff1a\u9ed8\u8ba43GB/s\uff0c\u541e\u5410\u91cf\u548c IOPS \u968f\u7740\u6587\u4ef6\u7cfb\u7edf\u7684\u6269\u5927\u800c\u6269\u5c55\uff0c\u53ef\u4ee5\u5728\u77ed\u65f6\u95f4\u5185\u5feb\u901f\u8fbe\u5230\u66f4\u9ad8\u7684\u541e\u5410\u91cf\u7ea7\u522b \u6027\u80fd \u9ad8\u6269\u5c55\u6027\uff0c\u652f\u63013500 PUT/LIST/DELETE \u8bf7\u6c42/\u79d2 \u652f\u63015500 GET \u8bf7\u6c42/\u79d2 \u53ef\u624b\u52a8\u6269\u5c55\u5377\u5927\u5c0f\u800c\u4e0d\u7528\u505c\u6b62\u5b9e\u4f8b \u57fa\u51c6\u6027\u80fd\uff1a3 IOPS/GB gp2 \u66f4\u9ad8\u6027\u80fd\u8981\u6c42\u8bf7\u9009\u62e9io1 \u9ad8\u5ea6\u53ef\u6269\u5c55\u7684\u6258\u7ba1\u670d\u52a1 \u652f\u6301\u6700\u9ad87000\u6b21/\u79d2\u7684\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c \u6570\u636e \u6570\u636e\u5b58\u50a8\u5728\u533a\u57df\u5185 \u5728\u4e00\u4e2a\u533a\u57df\u5185\u7684\u591a\u4e2a\u53ef\u7528\u533a\u5907\u4efd \u53ef\u4ee5\u901a\u8fc7\u8de8\u533a\u57df\u590d\u5236\uff08CRR\uff09\u8fbe\u5230\u8de8\u533a\u57df\u7ea7\u7684\u5bb9\u707e \u6570\u636e\u5b58\u50a8\u5728\u540c\u4e00\u53ef\u7528\u533a \u53ef\u4ee5\u5728\u591a\u4e2a\u53ef\u7528\u533a\u521b\u5efa\u526f\u672c\u63d0\u9ad8\u53ef\u7528\u6027 EFS\u6570\u636e\u5b58\u50a8\u5728\u533a\u57df\u5185 \u5728\u533a\u57df\u5185\u7684\u591a\u53ef\u7528\u533a\u5907\u4efd \u6570\u636e\u8bbf\u95ee \u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u6743\u9650 \u53ef\u901a\u8fc7Internet\u8bbf\u95ee \u53ea\u80fd\u88ab\u4e00\u53f0EC2\u5b9e\u4f8b\u8bbf\u95ee \u80fd\u88ab1-1000s\u53f0EC2\u8de8AZ\u7684\u5b9e\u4f8b\u540c\u65f6\u8bbf\u95ee \u6587\u4ef6\u7cfb\u7edf\u9650\u5236 \u53ef\u4ee5\u4f5c\u4e3a\u6587\u4ef6\u7cfb\u7edf\u88abmount\uff08 s3fs\u670d\u52a1 \uff09, \u4f46\u4e0d\u63a8\u8350\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6876\u7684\u6743\u9650\u4e0d\u4f1a\u81ea\u52a8\u4f20\u9012\u5230\u6876\u5185\u7684\u6587\u4ef6\u5939\u3002 \u652f\u6301\u5404\u7c7b\u6587\u4ef6\u7cfb\u7edf\uff0c\u5305\u62ecext3\u548cext4 EC2\u7684\u6587\u4ef6\u5b58\u50a8\u670d\u52a1 EFS\u8fd8\u80fd\u57fa\u4e8eAWS Direct Connect\u4e3a\u672c\u5730\u670d\u52a1\u5668\u63d0\u4f9bNFS\u670d\u52a1 \u652f\u6301\u7684\u52a0\u5bc6\u673a\u5236 \u670d\u52a1\u5668\u7aef\u52a0\u5bc6\uff08SSE-Amazon S3, SSE-KMS, SSE-C\uff09 \u5ba2\u6237\u7aef\u52a0\u5bc6\uff08CMK+\u5ba2\u6237\u7aefmaster key\uff09 AWS KMS\u6258\u7ba1\u7684CMK\u548cAES 256-bit \u52a0\u5bc6\u6807\u51c6 AWS KMS\u6258\u7ba1\u7684CMK\u548cAES 256-bit \u52a0\u5bc6\u6807\u51c6 \u8bbf\u95ee\u63a7\u5236 \u8bbe\u7f6e\u6876\u7b56\u7565\u548c\u7528\u6237\u7b56\u7565 \u901a\u8fc7ACLs\uff08access control list\uff09\u6765\u7ba1\u7406\u8bbf\u95ee \u57fa\u4e8eIAM\u89d2\u8272\u7684\u9884\u7b7e\u540d URL\u8bbf\u95ee \u5b89\u5168\u7ec4 NACL \u57fa\u4e8e\u7528\u6237\u7684\u6388\u6743\uff08\u5982IAM\uff09 \u5b89\u5168\u7ec4 \u57fa\u4e8e\u7528\u6237\u7684\u6388\u6743\uff08\u5982IAM\uff09 \u53ef\u7528\u6027 \u4e00\u5e74\u518599.99%\u7684\u53ef\u7528\u6027 99.99%\u53ef\u7528\u6027 \u9ad8\u53ef\u7528\u6027 \u53ef\u7528\u533a\u5bb9\u707e \u80fd\u627f\u53d72\u4e2a\u53ef\u7528\u533a\u6302\u6389 \u4e0d\u80fd\u627f\u53d7\u6240\u5728\u53ef\u7528\u533a\u6302\u6389\uff08\u5982\u679c\u6ca1\u6709\u53ca\u65f6\u521b\u5efaEBS\u955c\u50cf\u7684\u8bdd\uff09 \u5206\u5e03\u5f0f\u5b58\u50a8 \u591a\u4e2a\u53ef\u7528\u533a \u80fd\u627f\u53d71\u4e2a\u53ef\u7528\u533a\u6302\u6389 \u6301\u4e45\u6027 99.999999999% \u662f\u666e\u901a\u786c\u76d8\u768420\u500d \u9ad8\u6301\u4e45\u6027 \u6700\u7ec8\u4e00\u81f4\u6027\u95ee\u9898 S3 \u5728\u6240\u6709\u533a\u57df\u63d0\u4f9bPUTS\u548cDELETES\u7684\u6700\u7ec8\u4e00\u81f4\u6027 \u65e0\u6b64\u95ee\u9898 \u65e0\u6b64\u95ee\u9898 \u603b\u7ed3 \u7efc\u4e0a\uff0c\u5728\u8fd9\u4e09\u4e2a\u5b58\u50a8\u9009\u9879\u4e2d\uff0cS3\u6700\u4fbf\u5b9c\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e3a\u4ece\u4efb\u4f55\u5730\u65b9\u8bbf\u95ee\uff0c\u9002\u7528\u4e8e\u91c7\u7528\u4e00\u6b21\u5199\u5165\u3001\u591a\u6b21\u8bfb\u53d6\u7684\u5e94\u7528\u3002 \u518d\u770b\u770bEFS\u548cEBS\u7684\u6210\u672c\u5bf9\u6bd4\uff0cEFS \u7684\u4ef7\u683c\u8981\u6bd4EBS\u8d35\uff0c\u4f46\u66f4\u4fbf\u5b9c\u7684EBS\u4e00\u6b21\u53ea\u80fd\u8ba9\u4f60\u7684\u4e00\u4e2aAmazonEC2\u5b9e\u4f8b\u53bb\u8bbf\u95ee\uff0c\u8fd9\u5c31\u5f88\u96be\u5e94\u7528\u4e8e\u96c6\u7fa4\u6216\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u7684\u5206\u6790\u573a\u666f\u3002\u7136\u800cEBS\u53ef\u4ee5\u63d0\u4f9b\u6bd4EFS\u66f4\u5f3a\u7684\u6027\u80fd\u3002\u6240\u4ee5\u7b80\u5355\u7406\u89e3\uff0cEFS \u5176\u5b9e\u662f\u6bd4EBS\u591a\u4e86\u4e00\u4e2a\u5171\u4eab\u7f51\u7edc\u5b58\u50a8\u7684\u529f\u80fd\uff0c\u5173\u952e\u8fd8\u662f\u770b\u6211\u4eec\u7684\u5b9e\u9645\u9700\u6c42\u4e86\u3002 \u9759\u6001EBS VS \u81ea\u52a8\u6269\u5c55EFS \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u4f7f\u7528EBS\u548c\u4f7f\u7528EFS\u7684\u533a\u522b\u53ef\u4ee5\u6bd4\u4f5c\u4f60\u9700\u8981\u5c06\u6c7d\u8f66\u505c\u653e\u5728\u5bb6\u5ead\u8f66\u5e93\uff0c\u8fd8\u662f\u5c06\u6c7d\u8f66\u505c\u653e\u5728\u79df\u8d41\u505c\u8f66\u573a\u3002\u4f7f\u7528EBS\u5c31\u50cf\u5728\u4f60\u81ea\u5df1\u7684\u79c1\u4eba\u8f66\u5e93\u505c\u8f66\uff1a\u4f60\u7ecf\u5e38\u4f7f\u7528\u4f60\u7684\u8f66\uff0c\u800c\u4e14\u8fd9\u4e2a\u7a7a\u95f4\u975e\u5e38\u5b89\u5168\u3002\u4f7f\u7528EFS\u66f4\u50cf\u662f\u5728\u4e00\u4e2a\u5927\u7684\u51fa\u79df\u505c\u8f66\u573a\u505c\u8f66\uff1a\u6709\u5f88\u591a\u4eba\uff0c\u5305\u62ec\u4f60\u81ea\u5df1\uff0c\u5171\u4eab\u4e00\u4e2a\u516c\u5171\u7a7a\u95f4\u6765\u5bb9\u7eb3\u5927\u91cf\u7684\u4e2a\u4eba\u3002\u8ba9\u6211\u4eec\u770b\u770bAWS EBS\u548cAWS EFS\u4e4b\u95f4\u7684\u7c7b\u6bd4\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002 EBS\u901a\u5e38\u7528\u4e8e\u6301\u4e45\u5757\u5b58\u50a8\u3002\u5b83\u975e\u5e38\u9002\u5408\u4e8e\u9700\u8981\u9ad8IOPS\u6216\u541e\u5410\u91cf\u7684\u6570\u636e\u5e93\u548c\u5176\u4ed6\u4f4e\u5ef6\u8fdf\u4ea4\u4e92\u5f0f\u5e94\u7528\u7a0b\u5e8f\uff0c\u7279\u522b\u662f\u5177\u6709\u4e00\u81f4\u548c\u53ef\u9884\u6d4b\u6027\u80fd\u7684\u4f4e\u5ef6\u8fdf\u5e94\u7528\u7a0b\u5e8f\u3002\u73b0\u5728\uff0c\u6709\u4e00\u79cd\u89c2\u70b9\u8ba4\u4e3a\u53ef\u4ee5\u4f7f\u7528EFS\u800c\u4e0d\u662fEBS\uff0c\u8fd9\u6837\u5c31\u4e0d\u5fc5\u62c5\u5fc3\u7a7a\u95f4\u95ee\u9898\u4e86\u3002\u4f46\u662f\uff0c\u56de\u5230\u6211\u4eec\u7684\u7c7b\u6bd4\uff0c\u5efa\u7acb\u4e00\u4e2a\u5de8\u5927\u7684\u505c\u8f66\u573a\u6765\u4e3a\u4f60\u7684\u8f66\u63d0\u4f9b\u989d\u5916\u7684\u7a7a\u95f4\u6709\u65f6\u5019\u5e76\u4e0d\u662f\u4e00\u4e2a\u660e\u667a\u7684\u60f3\u6cd5\uff1a\u5b83\u8ba9\u4f60\u82b1\u8d39\u66f4\u591a\uff0c\u5f88\u591a\u7a7a\u95f4\u5c06\u88ab\u95f2\u7f6e\u3002\u800cEBS\u5377\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aAPI\u8c03\u7528\u8fdb\u884c\u653e\u5927\u6216\u7f29\u5c0f\uff0c\u800c\u65e0\u9700\u505c\u6b62\u5b9e\u4f8b\u3002 \u90a3\u4e48\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528EFS\u5462\uff1fEFS\u662f\u4e3a\u5927\u6570\u636e\u5de5\u4f5c\u8d1f\u8f7d\u548c\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\u751f\u6210\u7684\u5927\u91cf\u6570\u636e\u800c\u8bbe\u8ba1\u7684\uff1b\u5927\u91cf\u7684\u6570\u636e\u5bf9\u4e8e\u8fde\u63a5EBS\u7684EC2\u5b9e\u4f8b\u6765\u8bf4\u662f\u4e0d\u53ef\u80fd\u8fdb\u884c\u8bbf\u95ee\u5904\u7406\u548c\u5206\u6790\u7684\u3002\u56e0\u6b64\uff0c\u5728\u5b58\u50a8\u5171\u4eab\u3001\u5a92\u4f53\u5904\u7406\u5de5\u4f5c\u6d41\u3001\u5185\u5bb9\u7ba1\u7406\u548cweb\u670d\u52a1\u65b9\u9762\uff0cEFS\u6bd4EBS\u66f4\u5177\u4f18\u52bf\uff0c\u5c3d\u7ba1EBS\u7684\u6210\u672c\u66f4\u4f4e\u3002 \u4fbf\u5b9cS3 VS \u9ad8\u6027\u80fdEFS \u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770bEFS vs S3\u3002\u7531\u4e8eS3\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u4e0eEFS\u76f8\u6bd4\uff0cS3\u7684\u901f\u5ea6\u53ef\u80fd\u7a0d\u6162\u4e00\u4e9b\uff0c\u800c\u540e\u8005EFS\u5177\u6709\u6700\u9ad8\u7684I/O\u6027\u80fd\u6a21\u5f0f\uff0c\u5177\u6709\u66f4\u9ad8\u7684\u5199\u5165\u901f\u5ea6\u548c\u541e\u5410\u91cf\u3002 EFS\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u95f4\u70b9\u88ab\u540c\u4e00\u533a\u57df\u5185\u591a\u4e2a\u53ef\u7528\u533a\u7684\u591a\u4e2aEC2\u5b9e\u4f8b\u8bbf\u95ee\uff1bS3\u53ef\u4ee5\u901a\u8fc7API\u88ab\u4efb\u4f55\u5730\u65b9\u6240\u8bbf\u95ee\u3002S3\u4fdd\u8bc1\u4e8611\u4e2a9\u7684\u6301\u4e45\u6027\uff0cEFS\u6682\u65f6\u6ca1\u6709\u516c\u5e03\uff0c\u5e10\u6237\u53ef\u4ee5\u542f\u52a8\u7684EFS\u5b9e\u4f8b\u7684\u6570\u91cf\u4e5f\u6709\u4e00\u5b9a\u9650\u5236\u3002 \u6700\u540e\uff1a\u5728\u6210\u672c\u548c\u5fc5\u8981\u6027\u4e0a\u5bfb\u6c42\u5e73\u8861 EBS\u4e0eS3\u3001EFS\u4e0eS3\u3001EBS\u4e0eEFS\u4e4b\u95f4\u7684\u51b3\u5b9a\u56e0\u7d20\u5f88\u53ef\u80fd\u53d6\u51b3\u4e8e\u4f60\u515c\u91cc\u6709\u591a\u5c11\u94b1\u6765\u652f\u4ed8\u5b58\u50a8\u8d39\u7528\u3002 S3\u6709\u5f88\u591a\u7279\u6027\uff0c\u4f46\u662f\u6709\u5404\u79cd\u5b9a\u4ef7\u53c2\u6570\uff0c\u6bd4\u5982\u6bcf\u6708\u4f7f\u7528\u7684\u5b58\u50a8\u91cf\u3001\u53d1\u51fa\u7684\u8bf7\u6c42\u6570\uff08\u4f8b\u5982\uff1aPOST\u3001GET\u7b49\uff09\u3001S3\u5b58\u50a8\u6e05\u5355\u3001S3\u5206\u6790\u3001\u5b58\u50a8\u7b49\u7ea7\u5206\u6790\u3001S3\u5bf9\u8c61\u6807\u8bb0\u3001\u4f20\u51faS3\u7684\u6bcfGB\u6570\u636e\u4f20\u8f93\u8d39\u548cS3\u4f20\u8f93\u52a0\u901f\u3002 \u4e0eS3\u76f8\u6bd4\uff0cEBS\u7684\u5b9a\u4ef7\u66f4\u7b80\u5355\uff0c\u5b83\u5305\u62ec\u6bcf\u6708\u5206\u914d\u7684\u6bcfGB\u5b58\u50a8\u8d39\u3001IOPS\u7684\u9884\u914d\u7f6e\u8d39\u548cEBS\u5feb\u7167\u5b58\u50a8\u8d39\u7528\u3002 EFS\u7684\u5b9a\u4ef7\u66f4\u4e3a\u76f4\u63a5\uff1a\u60a8\u53ea\u9700\u652f\u4ed8\u4ee5GB/\u6708\u4e3a\u5355\u4f4d\u7684\u5b58\u50a8\u4f7f\u7528\u8d39\u3002 \u6240\u4ee5\uff0cS3\u770b\u8d77\u6765\u662f\u6700\u4fbf\u5b9c\u7684\uff0c\u4f46\u5728\u6027\u80fd\u65b9\u9762\uff0cAmazon EBS\u7531\u4e8e\u53ef\u4ee5\u63d0\u4f9b\u9ad8IOPS\uff0c\u901f\u5ea6\u6700\u5feb\uff0c\u4f46\u662f\u5728\u5171\u4eab\u548c\u53ef\u5f39\u6027\u4f38\u7f29\u7684\u6587\u4ef6\u7cfb\u7edf\u65b9\u9762\uff0cAmazon EFS\u662f\u6700\u597d\u7684\u9009\u62e9\u3002 \u6ca1\u6709\u5b8c\u7f8e\u7684\u4ea7\u54c1\uff0c\u53ea\u6709\u5b8c\u7f8e\u7684\u5e73\u8861\u3002","title":"\u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#s3ebsefs","text":"\u6211\u4eec\u77e5\u9053\uff0caws\u63d0\u4f9b\u7684\u5b58\u50a8\u670d\u52a1\u6709S3\uff0cEBS\uff0cEFS\uff0c\u6709\u4e9b\u540c\u5b66\u5728\u4f7f\u7528\u7684\u65f6\u5019\u4f1a\u6709\u4e9b\u56f0\u6270\uff0c\u54ea\u4e2a\u624d\u662f\u6700\u9002\u5408\u6211\u81ea\u5df1\u7684\u4e91\u5b58\u50a8\u65b9\u6848\u5462\uff0c\u73b0\u5728\u6211\u5c31\u548c\u5927\u5bb6\u4e00\u8d77\u6765\u5b66\u4e60\u4e0baws\u7684\u4e09\u4e2a\u5e38\u7528\u5b58\u50a8\u670d\u52a1\uff1aAmazon Elastic Block Store (Amazon EBS), Amazon Simple Storage Service (Amazon S3), \u548cAmazon Elastic File System (Amazon EFS) -- D.C","title":"\u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#amazon-efs","text":"Amazon EFS \u662fAWS\u63d0\u4f9b\u7684NFS\u6587\u4ef6\u7cfb\u7edf\u6258\u7ba1\u670d\u52a1\uff0c\u80fd\u88ab\u591a\u4e2aAmazon EC2\u5b9e\u4f8b\u6240\u5171\u4eab\u3002 \u5b83\u7684\u5de5\u4f5c\u6a21\u5f0f\u7c7b\u4f3c\u4e8eNAS\u8bbe\u5907\uff0c\u5f88\u9002\u5408\u7528\u6765\u505a \u5927\u6570\u636e\u5206\u6790 \uff0c \u591a\u5a92\u4f53\u5904\u7406\u6d41\u7a0b \uff0c \u4ee5\u53ca \u5185\u5bb9\u7ba1\u7406 \u3002\u5176\u5b9e\u9009\u62e9\u54ea\u79cd\u5b58\u50a8\u670d\u52a1\u5173\u952e\u53d6\u51b3\u4e8e\u6211\u4eec\u7279\u5b9a\u7684\u7cfb\u7edf\u9700\u6c42\uff0c\u5305\u62ec\u6211\u4eec\u5bf9\u6210\u672c\u7684\u63a7\u5236\uff0c\u6027\u80fd\uff0c\u548c\u8bbf\u95ee\u7684\u65b9\u5f0f\u3002 Amazon EFS\u63d0\u4f9b\u7b80\u5355\u3001\u53ef\u6269\u5c55\u3001\u5b8c\u5168\u6258\u7ba1\u7684\u5f39\u6027 NFS \u6587\u4ef6\u7cfb\u7edf\u3002\u5b83\u53ef\u6309\u9700\u6269\u5c55\u81f3 PB \u7ea7\uff0c\u800c\u4e0d\u4f1a\u4e2d\u65ad\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5728\u6dfb\u52a0\u548c\u5220\u9664\u6587\u4ef6\u65f6\u81ea\u52a8\u589e\u52a0\u548c\u7f29\u5c0f\uff0c\u4ece\u800c\u65e0\u9700\u9884\u7f6e\u548c\u7ba1\u7406\u5bb9\u91cf\u4ee5\u9002\u5e94\u589e\u957f\u3002 \u8981\u6ce8\u610f\uff0c\u5728\u8003\u8651\u5b58\u50a8\u6210\u672c\u7684\u540c\u65f6\uff0c\u6700\u597d\u548c\u8ba1\u7b97\u8d44\u6e90\u6210\u672c\u540c\u65f6\u8003\u8651\u624d\u6709\u610f\u4e49\u54e6\uff0c\u53e6\u5916EFS\u7c7b\u4f3cS3\uff0c\u4e5f\u6709\u975e\u9891\u7e41\u8bbf\u95ee\u6a21\u5f0f\uff08IA), \u867d\u7136\u5de5\u4f5c\u8d1f\u8f7d\u6a21\u5f0f\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5ba2\u6237\u901a\u5e38\u4f1a\u53d1\u73b0 80% \u7684\u6587\u4ef6\u4e0d\u7ecf\u5e38\u8bbf\u95ee\uff08\u5e76\u4e14\u9002\u5408 EFS IA\uff09\uff0c20% \u7684\u6587\u4ef6\u6b63\u5728\u4f7f\u7528\uff08\u9002\u7528\u4e8e EFS \u6807\u51c6\uff09\uff0c\u6240\u4ee5\u901a\u8fc7\u5229\u7528IA\u53ef\u4ee5\u5f88\u597d\u63a7\u5236\u6210\u672c\u3002","title":"\u4ec0\u4e48\u662fAmazon EFS\uff1f"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#amazon-s3","text":"Amazon S3 \u662fAWS\u63d0\u4f9b\u7684\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u3002\u5b83\u662f\u4e00\u4e2a\u9759\u6001\u7684\u5b58\u50a8\u670d\u52a1\uff0c\u53ef\u7528\u4e8e\u9759\u6001\u7f51\u7ad9\u6258\u7ba1\uff0c\u591a\u5a92\u4f53\u5185\u5bb9\u90e8\u7f72\u548c\u5206\u53d1\uff08cloudfront\uff09\uff0c\u7248\u672c\u7ba1\u7406\uff0c\u5927\u6570\u636e\u5206\u6790\u4ee5\u53ca\u5f52\u6863\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0cS3\u81ea\u5e26\u6570\u636e\u6e56\u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u548cAthena\uff08aws\u7684\u7b80\u5355sql\u67e5\u8be2\u670d\u52a1\uff09\u4ee5\u53caGlu\uff08aws\u5927\u6570\u636eETL\u670d\u52a1\uff09\u642d\u914d\u7528\u4e8e\u5927\u6570\u636e\u5206\u6790\u3002","title":"\u4ec0\u4e48\u662fAmazon S3\uff1f"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#ebs","text":"Amazon EBS \u662fAWS\u63d0\u4f9b\u7684\u5757\u5b58\u50a8\u670d\u52a1\u3002\u4e00\u4e2aEBS\u5377\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u5757\u78c1\u76d8\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\uff0c\u90e8\u7f72\u5404\u7c7b\u5206\u6790\u6d41\u7a0b\u7b49\u3002","title":"\u4ec0\u4e48\u662fEBS\uff1f"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#_1","text":"\u7279\u70b9 S3 EBS EFS \u5b58\u50a8\u6210\u672c \uff08\u5b81\u590f\u533a\u57df\u4e3a\u4f8b\uff09 [\u6807\u51c6\u578b] \u7b2c\u4e00\u4e2a50TB/\u6708\u90e8\u5206: 0.1755\u5143/GB\uff1b 50TB-450TB\u90e8\u5206: 0.1719\u5143/GB 500TB\u4ee5\u4e0a/\u6708\u90e8\u5206\uff1a0.1629\u5143/GB gp2\u901a\u7528\u578bSSD: 0.664\u5143/GB-\u6708 io1\u9884\u914dIOPS SSD: \u5b58\u50a80.764\u5143/GB-\u6708\uff0c 0.399\u5143/\u9884\u914d\u7f6eIOPS-\u6708 st1\u541e\u5410\u4f18\u5316HDD\uff1a0.299\u5143/GB-\u6708 sc1 cold HDD: 0.166\u5143/GB-\u6708 EBS \u78c1\u6027\u4ecb\u8d28\uff1a0.364\u5143/GB-\u6708\uff0c0.364/100\u4e07I/O\u8bf7\u6c42 \u6807\u51c6\u5b58\u50a8\uff1a2.145\u5143/GB-\u6708 \u4e0d\u9891\u7e41\u8bbf\u95ee\u5b58\u50a8\uff1a0.200\u5143/GB-\u6708 \u4e0d\u9891\u7e41\u8bbf\u95ee\u8bf7\u6c42\uff1a0.071\u5143\uff08\u6bcfGB\u4f20\u8f93\u6570\u636e\uff09 \u9884\u7f6e\u541e\u5410\u91cf\uff08MB/\u79d2-\u6708\uff09\uff1a42.891\u5143(MB/S-\u6708) \u5b58\u50a8\u5927\u5c0f \u5b58\u50a8\u5bf9\u8c61\u6570\u91cf\u65e0\u9650\u5236 \u6700\u5927\u4e3a16TB \u65e0\u9650\u5236\uff0c\u81ea\u52a8\u5f39\u6027\u6269\u5c55 \u6587\u4ef6\u5927\u5c0f \u5355\u4e2aS3\u5bf9\u8c61\u6700\u5c0f0 byte\uff0c\u6700\u59275TB \u65e0\u9650\u5236 \u5355\u4e2a\u6587\u4ef6\u6700\u592747.9TiB \u6570\u636e\u541e\u5410\u548cI/O \u652f\u6301\u5206\u6bb5\u4e0a\u4f20\uff0c\u5efa\u8bae\u5927\u4e8e100MB\u7684\u6587\u4ef6\u90fd\u91c7\u7528\u8be5\u4e0a\u4f20\u65b9\u5f0f \u8c03\u7528PUT API\u8fdb\u884c\u4e0a\u4f20\u7684\u5355\u4e2a\u6587\u4ef6\u9650\u5236\u4e3a5GB \u57fa\u4e8eSSD\u548cHDD\u4e24\u7c7b \u5982\u679c\u5bf9I/O\u6709\u8981\u6c42\uff0c\u63a8\u8350\u91c7\u7528SDD+\u9884\u7559IOPS \u6240\u6709\u8fde\u63a5\u7684client\uff1a\u9ed8\u8ba43GB/s\uff0c\u541e\u5410\u91cf\u548c IOPS \u968f\u7740\u6587\u4ef6\u7cfb\u7edf\u7684\u6269\u5927\u800c\u6269\u5c55\uff0c\u53ef\u4ee5\u5728\u77ed\u65f6\u95f4\u5185\u5feb\u901f\u8fbe\u5230\u66f4\u9ad8\u7684\u541e\u5410\u91cf\u7ea7\u522b \u6027\u80fd \u9ad8\u6269\u5c55\u6027\uff0c\u652f\u63013500 PUT/LIST/DELETE \u8bf7\u6c42/\u79d2 \u652f\u63015500 GET \u8bf7\u6c42/\u79d2 \u53ef\u624b\u52a8\u6269\u5c55\u5377\u5927\u5c0f\u800c\u4e0d\u7528\u505c\u6b62\u5b9e\u4f8b \u57fa\u51c6\u6027\u80fd\uff1a3 IOPS/GB gp2 \u66f4\u9ad8\u6027\u80fd\u8981\u6c42\u8bf7\u9009\u62e9io1 \u9ad8\u5ea6\u53ef\u6269\u5c55\u7684\u6258\u7ba1\u670d\u52a1 \u652f\u6301\u6700\u9ad87000\u6b21/\u79d2\u7684\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c \u6570\u636e \u6570\u636e\u5b58\u50a8\u5728\u533a\u57df\u5185 \u5728\u4e00\u4e2a\u533a\u57df\u5185\u7684\u591a\u4e2a\u53ef\u7528\u533a\u5907\u4efd \u53ef\u4ee5\u901a\u8fc7\u8de8\u533a\u57df\u590d\u5236\uff08CRR\uff09\u8fbe\u5230\u8de8\u533a\u57df\u7ea7\u7684\u5bb9\u707e \u6570\u636e\u5b58\u50a8\u5728\u540c\u4e00\u53ef\u7528\u533a \u53ef\u4ee5\u5728\u591a\u4e2a\u53ef\u7528\u533a\u521b\u5efa\u526f\u672c\u63d0\u9ad8\u53ef\u7528\u6027 EFS\u6570\u636e\u5b58\u50a8\u5728\u533a\u57df\u5185 \u5728\u533a\u57df\u5185\u7684\u591a\u53ef\u7528\u533a\u5907\u4efd \u6570\u636e\u8bbf\u95ee \u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u6743\u9650 \u53ef\u901a\u8fc7Internet\u8bbf\u95ee \u53ea\u80fd\u88ab\u4e00\u53f0EC2\u5b9e\u4f8b\u8bbf\u95ee \u80fd\u88ab1-1000s\u53f0EC2\u8de8AZ\u7684\u5b9e\u4f8b\u540c\u65f6\u8bbf\u95ee \u6587\u4ef6\u7cfb\u7edf\u9650\u5236 \u53ef\u4ee5\u4f5c\u4e3a\u6587\u4ef6\u7cfb\u7edf\u88abmount\uff08 s3fs\u670d\u52a1 \uff09, \u4f46\u4e0d\u63a8\u8350\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6876\u7684\u6743\u9650\u4e0d\u4f1a\u81ea\u52a8\u4f20\u9012\u5230\u6876\u5185\u7684\u6587\u4ef6\u5939\u3002 \u652f\u6301\u5404\u7c7b\u6587\u4ef6\u7cfb\u7edf\uff0c\u5305\u62ecext3\u548cext4 EC2\u7684\u6587\u4ef6\u5b58\u50a8\u670d\u52a1 EFS\u8fd8\u80fd\u57fa\u4e8eAWS Direct Connect\u4e3a\u672c\u5730\u670d\u52a1\u5668\u63d0\u4f9bNFS\u670d\u52a1 \u652f\u6301\u7684\u52a0\u5bc6\u673a\u5236 \u670d\u52a1\u5668\u7aef\u52a0\u5bc6\uff08SSE-Amazon S3, SSE-KMS, SSE-C\uff09 \u5ba2\u6237\u7aef\u52a0\u5bc6\uff08CMK+\u5ba2\u6237\u7aefmaster key\uff09 AWS KMS\u6258\u7ba1\u7684CMK\u548cAES 256-bit \u52a0\u5bc6\u6807\u51c6 AWS KMS\u6258\u7ba1\u7684CMK\u548cAES 256-bit \u52a0\u5bc6\u6807\u51c6 \u8bbf\u95ee\u63a7\u5236 \u8bbe\u7f6e\u6876\u7b56\u7565\u548c\u7528\u6237\u7b56\u7565 \u901a\u8fc7ACLs\uff08access control list\uff09\u6765\u7ba1\u7406\u8bbf\u95ee \u57fa\u4e8eIAM\u89d2\u8272\u7684\u9884\u7b7e\u540d URL\u8bbf\u95ee \u5b89\u5168\u7ec4 NACL \u57fa\u4e8e\u7528\u6237\u7684\u6388\u6743\uff08\u5982IAM\uff09 \u5b89\u5168\u7ec4 \u57fa\u4e8e\u7528\u6237\u7684\u6388\u6743\uff08\u5982IAM\uff09 \u53ef\u7528\u6027 \u4e00\u5e74\u518599.99%\u7684\u53ef\u7528\u6027 99.99%\u53ef\u7528\u6027 \u9ad8\u53ef\u7528\u6027 \u53ef\u7528\u533a\u5bb9\u707e \u80fd\u627f\u53d72\u4e2a\u53ef\u7528\u533a\u6302\u6389 \u4e0d\u80fd\u627f\u53d7\u6240\u5728\u53ef\u7528\u533a\u6302\u6389\uff08\u5982\u679c\u6ca1\u6709\u53ca\u65f6\u521b\u5efaEBS\u955c\u50cf\u7684\u8bdd\uff09 \u5206\u5e03\u5f0f\u5b58\u50a8 \u591a\u4e2a\u53ef\u7528\u533a \u80fd\u627f\u53d71\u4e2a\u53ef\u7528\u533a\u6302\u6389 \u6301\u4e45\u6027 99.999999999% \u662f\u666e\u901a\u786c\u76d8\u768420\u500d \u9ad8\u6301\u4e45\u6027 \u6700\u7ec8\u4e00\u81f4\u6027\u95ee\u9898 S3 \u5728\u6240\u6709\u533a\u57df\u63d0\u4f9bPUTS\u548cDELETES\u7684\u6700\u7ec8\u4e00\u81f4\u6027 \u65e0\u6b64\u95ee\u9898 \u65e0\u6b64\u95ee\u9898","title":"\u4e09\u7c7b\u5b58\u50a8\u5bf9\u6bd4\u8868"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#_2","text":"\u7efc\u4e0a\uff0c\u5728\u8fd9\u4e09\u4e2a\u5b58\u50a8\u9009\u9879\u4e2d\uff0cS3\u6700\u4fbf\u5b9c\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e3a\u4ece\u4efb\u4f55\u5730\u65b9\u8bbf\u95ee\uff0c\u9002\u7528\u4e8e\u91c7\u7528\u4e00\u6b21\u5199\u5165\u3001\u591a\u6b21\u8bfb\u53d6\u7684\u5e94\u7528\u3002 \u518d\u770b\u770bEFS\u548cEBS\u7684\u6210\u672c\u5bf9\u6bd4\uff0cEFS \u7684\u4ef7\u683c\u8981\u6bd4EBS\u8d35\uff0c\u4f46\u66f4\u4fbf\u5b9c\u7684EBS\u4e00\u6b21\u53ea\u80fd\u8ba9\u4f60\u7684\u4e00\u4e2aAmazonEC2\u5b9e\u4f8b\u53bb\u8bbf\u95ee\uff0c\u8fd9\u5c31\u5f88\u96be\u5e94\u7528\u4e8e\u96c6\u7fa4\u6216\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u7684\u5206\u6790\u573a\u666f\u3002\u7136\u800cEBS\u53ef\u4ee5\u63d0\u4f9b\u6bd4EFS\u66f4\u5f3a\u7684\u6027\u80fd\u3002\u6240\u4ee5\u7b80\u5355\u7406\u89e3\uff0cEFS \u5176\u5b9e\u662f\u6bd4EBS\u591a\u4e86\u4e00\u4e2a\u5171\u4eab\u7f51\u7edc\u5b58\u50a8\u7684\u529f\u80fd\uff0c\u5173\u952e\u8fd8\u662f\u770b\u6211\u4eec\u7684\u5b9e\u9645\u9700\u6c42\u4e86\u3002","title":"\u603b\u7ed3"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#ebs-vs-efs","text":"\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u4f7f\u7528EBS\u548c\u4f7f\u7528EFS\u7684\u533a\u522b\u53ef\u4ee5\u6bd4\u4f5c\u4f60\u9700\u8981\u5c06\u6c7d\u8f66\u505c\u653e\u5728\u5bb6\u5ead\u8f66\u5e93\uff0c\u8fd8\u662f\u5c06\u6c7d\u8f66\u505c\u653e\u5728\u79df\u8d41\u505c\u8f66\u573a\u3002\u4f7f\u7528EBS\u5c31\u50cf\u5728\u4f60\u81ea\u5df1\u7684\u79c1\u4eba\u8f66\u5e93\u505c\u8f66\uff1a\u4f60\u7ecf\u5e38\u4f7f\u7528\u4f60\u7684\u8f66\uff0c\u800c\u4e14\u8fd9\u4e2a\u7a7a\u95f4\u975e\u5e38\u5b89\u5168\u3002\u4f7f\u7528EFS\u66f4\u50cf\u662f\u5728\u4e00\u4e2a\u5927\u7684\u51fa\u79df\u505c\u8f66\u573a\u505c\u8f66\uff1a\u6709\u5f88\u591a\u4eba\uff0c\u5305\u62ec\u4f60\u81ea\u5df1\uff0c\u5171\u4eab\u4e00\u4e2a\u516c\u5171\u7a7a\u95f4\u6765\u5bb9\u7eb3\u5927\u91cf\u7684\u4e2a\u4eba\u3002\u8ba9\u6211\u4eec\u770b\u770bAWS EBS\u548cAWS EFS\u4e4b\u95f4\u7684\u7c7b\u6bd4\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002 EBS\u901a\u5e38\u7528\u4e8e\u6301\u4e45\u5757\u5b58\u50a8\u3002\u5b83\u975e\u5e38\u9002\u5408\u4e8e\u9700\u8981\u9ad8IOPS\u6216\u541e\u5410\u91cf\u7684\u6570\u636e\u5e93\u548c\u5176\u4ed6\u4f4e\u5ef6\u8fdf\u4ea4\u4e92\u5f0f\u5e94\u7528\u7a0b\u5e8f\uff0c\u7279\u522b\u662f\u5177\u6709\u4e00\u81f4\u548c\u53ef\u9884\u6d4b\u6027\u80fd\u7684\u4f4e\u5ef6\u8fdf\u5e94\u7528\u7a0b\u5e8f\u3002\u73b0\u5728\uff0c\u6709\u4e00\u79cd\u89c2\u70b9\u8ba4\u4e3a\u53ef\u4ee5\u4f7f\u7528EFS\u800c\u4e0d\u662fEBS\uff0c\u8fd9\u6837\u5c31\u4e0d\u5fc5\u62c5\u5fc3\u7a7a\u95f4\u95ee\u9898\u4e86\u3002\u4f46\u662f\uff0c\u56de\u5230\u6211\u4eec\u7684\u7c7b\u6bd4\uff0c\u5efa\u7acb\u4e00\u4e2a\u5de8\u5927\u7684\u505c\u8f66\u573a\u6765\u4e3a\u4f60\u7684\u8f66\u63d0\u4f9b\u989d\u5916\u7684\u7a7a\u95f4\u6709\u65f6\u5019\u5e76\u4e0d\u662f\u4e00\u4e2a\u660e\u667a\u7684\u60f3\u6cd5\uff1a\u5b83\u8ba9\u4f60\u82b1\u8d39\u66f4\u591a\uff0c\u5f88\u591a\u7a7a\u95f4\u5c06\u88ab\u95f2\u7f6e\u3002\u800cEBS\u5377\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aAPI\u8c03\u7528\u8fdb\u884c\u653e\u5927\u6216\u7f29\u5c0f\uff0c\u800c\u65e0\u9700\u505c\u6b62\u5b9e\u4f8b\u3002 \u90a3\u4e48\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528EFS\u5462\uff1fEFS\u662f\u4e3a\u5927\u6570\u636e\u5de5\u4f5c\u8d1f\u8f7d\u548c\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\u751f\u6210\u7684\u5927\u91cf\u6570\u636e\u800c\u8bbe\u8ba1\u7684\uff1b\u5927\u91cf\u7684\u6570\u636e\u5bf9\u4e8e\u8fde\u63a5EBS\u7684EC2\u5b9e\u4f8b\u6765\u8bf4\u662f\u4e0d\u53ef\u80fd\u8fdb\u884c\u8bbf\u95ee\u5904\u7406\u548c\u5206\u6790\u7684\u3002\u56e0\u6b64\uff0c\u5728\u5b58\u50a8\u5171\u4eab\u3001\u5a92\u4f53\u5904\u7406\u5de5\u4f5c\u6d41\u3001\u5185\u5bb9\u7ba1\u7406\u548cweb\u670d\u52a1\u65b9\u9762\uff0cEFS\u6bd4EBS\u66f4\u5177\u4f18\u52bf\uff0c\u5c3d\u7ba1EBS\u7684\u6210\u672c\u66f4\u4f4e\u3002","title":"\u9759\u6001EBS VS \u81ea\u52a8\u6269\u5c55EFS"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#s3-vs-efs","text":"\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770bEFS vs S3\u3002\u7531\u4e8eS3\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u4e0eEFS\u76f8\u6bd4\uff0cS3\u7684\u901f\u5ea6\u53ef\u80fd\u7a0d\u6162\u4e00\u4e9b\uff0c\u800c\u540e\u8005EFS\u5177\u6709\u6700\u9ad8\u7684I/O\u6027\u80fd\u6a21\u5f0f\uff0c\u5177\u6709\u66f4\u9ad8\u7684\u5199\u5165\u901f\u5ea6\u548c\u541e\u5410\u91cf\u3002 EFS\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u95f4\u70b9\u88ab\u540c\u4e00\u533a\u57df\u5185\u591a\u4e2a\u53ef\u7528\u533a\u7684\u591a\u4e2aEC2\u5b9e\u4f8b\u8bbf\u95ee\uff1bS3\u53ef\u4ee5\u901a\u8fc7API\u88ab\u4efb\u4f55\u5730\u65b9\u6240\u8bbf\u95ee\u3002S3\u4fdd\u8bc1\u4e8611\u4e2a9\u7684\u6301\u4e45\u6027\uff0cEFS\u6682\u65f6\u6ca1\u6709\u516c\u5e03\uff0c\u5e10\u6237\u53ef\u4ee5\u542f\u52a8\u7684EFS\u5b9e\u4f8b\u7684\u6570\u91cf\u4e5f\u6709\u4e00\u5b9a\u9650\u5236\u3002","title":"\u4fbf\u5b9cS3 VS \u9ad8\u6027\u80fdEFS"},{"location":"blogs/2020-01-26-s3-ebs-efs-compare/#_3","text":"EBS\u4e0eS3\u3001EFS\u4e0eS3\u3001EBS\u4e0eEFS\u4e4b\u95f4\u7684\u51b3\u5b9a\u56e0\u7d20\u5f88\u53ef\u80fd\u53d6\u51b3\u4e8e\u4f60\u515c\u91cc\u6709\u591a\u5c11\u94b1\u6765\u652f\u4ed8\u5b58\u50a8\u8d39\u7528\u3002 S3\u6709\u5f88\u591a\u7279\u6027\uff0c\u4f46\u662f\u6709\u5404\u79cd\u5b9a\u4ef7\u53c2\u6570\uff0c\u6bd4\u5982\u6bcf\u6708\u4f7f\u7528\u7684\u5b58\u50a8\u91cf\u3001\u53d1\u51fa\u7684\u8bf7\u6c42\u6570\uff08\u4f8b\u5982\uff1aPOST\u3001GET\u7b49\uff09\u3001S3\u5b58\u50a8\u6e05\u5355\u3001S3\u5206\u6790\u3001\u5b58\u50a8\u7b49\u7ea7\u5206\u6790\u3001S3\u5bf9\u8c61\u6807\u8bb0\u3001\u4f20\u51faS3\u7684\u6bcfGB\u6570\u636e\u4f20\u8f93\u8d39\u548cS3\u4f20\u8f93\u52a0\u901f\u3002 \u4e0eS3\u76f8\u6bd4\uff0cEBS\u7684\u5b9a\u4ef7\u66f4\u7b80\u5355\uff0c\u5b83\u5305\u62ec\u6bcf\u6708\u5206\u914d\u7684\u6bcfGB\u5b58\u50a8\u8d39\u3001IOPS\u7684\u9884\u914d\u7f6e\u8d39\u548cEBS\u5feb\u7167\u5b58\u50a8\u8d39\u7528\u3002 EFS\u7684\u5b9a\u4ef7\u66f4\u4e3a\u76f4\u63a5\uff1a\u60a8\u53ea\u9700\u652f\u4ed8\u4ee5GB/\u6708\u4e3a\u5355\u4f4d\u7684\u5b58\u50a8\u4f7f\u7528\u8d39\u3002 \u6240\u4ee5\uff0cS3\u770b\u8d77\u6765\u662f\u6700\u4fbf\u5b9c\u7684\uff0c\u4f46\u5728\u6027\u80fd\u65b9\u9762\uff0cAmazon EBS\u7531\u4e8e\u53ef\u4ee5\u63d0\u4f9b\u9ad8IOPS\uff0c\u901f\u5ea6\u6700\u5feb\uff0c\u4f46\u662f\u5728\u5171\u4eab\u548c\u53ef\u5f39\u6027\u4f38\u7f29\u7684\u6587\u4ef6\u7cfb\u7edf\u65b9\u9762\uff0cAmazon EFS\u662f\u6700\u597d\u7684\u9009\u62e9\u3002 \u6ca1\u6709\u5b8c\u7f8e\u7684\u4ea7\u54c1\uff0c\u53ea\u6709\u5b8c\u7f8e\u7684\u5e73\u8861\u3002","title":"\u6700\u540e\uff1a\u5728\u6210\u672c\u548c\u5fc5\u8981\u6027\u4e0a\u5bfb\u6c42\u5e73\u8861"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/","text":"\u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e \u4e00\u822c\u6765\u8bf4\uff0c\u56e0\u4e3as3\u7684\u5b58\u50a8\u6210\u672c\u4f18\u52bf\uff0c\u6211\u4eec\u90fd\u4f1a\u628a\u6570\u636e\u5982bcl\uff0cfastq\uff0cbam\uff0csam\u7b49\u5168\u90e8\u4e22\u5230s3\u4e0a\u957f\u671f\u4fdd\u5b58\uff0c\u7136\u540e\u9700\u8981\u5206\u6790\u7684\u65f6\u5019\uff0c\u5f00\u542f\u4e00\u53f0\u670d\u52a1\u5668EC2\uff0c\u62f7\u8d1d\u8fd9\u4e9b\u6570\u636e\u5230EC2\u8fde\u63a5\u7684EBS/EFS\u4e0a\uff0c\u518d\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u5206\u6790\uff0c\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u6211\u600e\u4e48\u624d\u80fd\u5e2eEC2\u6478\u5230s3\u4e0a\u7684\u6570\u636e\u5462\uff1f -- D.C \u4f60\u8be5\u77e5\u9053\u7684 EC2\u7684AMI\u5b9e\u9645\u4e0a\u4fdd\u5b58\u5728S3\u4e0a\uff0cAMI\u662f\u4e3a\u4e86\u5feb\u901f\u542f\u52a8\u51e0\u5341\u4e0a\u767e\u53f0\u540c\u6837\u5206\u6790\u73af\u5883\u7684\u673a\u5668 EBS\u7684snapshot\u5b9e\u9645\u4e0a\u4e5f\u4fdd\u5b58\u5728S3\u4e0a\uff0csnapshot\u53ef\u4ee5\u8ba9\u6211\u4eec\u5feb\u901f\u6062\u590d\u6570\u636e\uff0c\u5982\u6570\u636e\u5e93\uff0c\u5206\u6790\u6d41\u7a0b\uff0c\u8fd8\u53ef\u4ee5\u4f5c\u4e3a\u6a21\u677f\uff0c\u5feb\u901f\u521b\u5efa\u540c\u6837\u7c7b\u578b\u7684\u78c1\u76d8\uff0c\u5982\u9884\u7f6e\u597d\u7279\u5b9aIOPS\u7684io1\u578bEBS\u3002 S3\u4e0a\u7684\u6bcf\u4e2a\u6587\u4ef6\u90fd\u662f\u4e00\u4e2aobject\u5bf9\u8c61\uff0c\u6876\u662f\u8fd9\u4e2a\u5bf9\u8c61\u6700\u9ad8\u7684\u547d\u540d\u7a7a\u95f4\uff08namespace\uff09,\u7c7b\u4f3c\u4e8e\u8bbf\u95eeinternet\u7684\u57df\u540d\uff0c\u5982\u679c\u5f00\u901a\u4e86ICP\u5907\u6848\u767d\u540d\u5355\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5bf9\u8c61\u548c\u6240\u5728\u6876\u7684\u8bbf\u95ee\u6743\u9650\u5f00\u653e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u53ef\u4ee5\u7528http\u7684URL (Uniform Resource Locator)\u8fdb\u884c\u8bbf\u95ee\uff0c\u6bd4\u5982\uff1a http://aws-s3-bucket1.s3.amazonaws.com/photos/mygarden.jpg \u4f60\u8be5\u638c\u63e1\u7684 \u5982\u4f55\u521b\u5efa\u865a\u62df\u673aEC2 \u5982\u4f55\u7528CLI\u767b\u5f55EC2 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3 \u65b9\u5f0f1 - GET \u6216 wget \u8fd9\u4e24\u4e2a\u547d\u4ee4\u6211\u4eec\u4e00\u5b9a\u4e0d\u964c\u751f\u5427\uff0cwget\u662fHTTP\u548cFTP\u5ba2\u6237\u7aef\u7684\u5e38\u7528\u4e0b\u8f7d\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u5728Amazon Linux\u4e2d\u90fd\u5b89\u88c5\u597d\u7684\u3002\u6240\u4ee5\u5982\u679c\u6211\u4eec\u77e5\u9053\u8981\u4e0b\u8f7d\u5bf9\u8c61\u7684URL\uff0c\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u547d\u4ee4\u4e0b\u8f7d\uff1a wget https://my_bucket.s3.amazonaws.com/path-to-file \u9700\u8981\u6ce8\u610f : \u8981\u5148\u767b\u5f55\u5230EC2\u4e0a S3\u5df2\u7ecf\u5f00\u4e86ICP\u5907\u6848\u7684\u767d\u540d\u5355\uff08\u8054\u7cfbaws\uff09 \u8bbf\u95ee\u7684\u5bf9\u8c61\u5305\u62ec\u5bf9\u8c61\u6240\u5728\u7684\u6876\u6743\u9650\u662f\u516c\u5f00\u7684\uff0c\u5426\u5219\u4f1a\u6536\u5230\u9519\u8bef\u4fe1\u606f\u201cERROR 403: Forbidden\u201d \u65b9\u5f0f2 - AKSK\u8bbf\u95ee \u4ec0\u4e48\u662fAKSK? \u7b80\u5355\u6765\u8bf4\uff0c\u6211\u4eec\u5728aws\u8d26\u6237\u4e0b\u65b0\u5efauser\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u7ed9\u6211\u4eec\u4e00\u4e2acsv\u683c\u5f0f\u6587\u4ef6\uff0c\u91cc\u9762\u4fdd\u5b58\u7684\u5c31\u662fAKSK\u4e24\u4e2akey\uff0c\u5728\u5411\u4e91\u7aef\u53d1\u8d77\u8bbf\u95ee\u65f6\u5411\u5b83\u8bc1\u660e\u4f60\u5c31\u662f\u4f60\u3002 \u901a\u8fc7\u914d\u7f6eEC2\u4e0a\u7684AWS CLI \u8bbf\u95eeS3\u4e0a\u7684\u6876\u548c\u6587\u4ef6\uff0cAWS CLI\u9ed8\u8ba4\u90fd\u5728EC2\u4e0a\u88c5\u597d\u7684\u3002\u5728\u8fd9\u53f0EC2\u4e0a\u914d\u7f6e\u597dCLI\u7684AKSK\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u5411S3\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u4e86\uff0c\u800c\u4e14\u65e0\u987b\u7533\u8bf7S3\u7684ICP\u5907\u6848 \u767d\u540d\u5355\uff0c\u7f3a\u70b9\u662f\u6bcf\u53f0EC2\u90fd\u8981\u914d\u7f6e\u4e00\u6b21AKSK\u5bc6\u94a5\u4fe1\u606f\uff0c\u4e0d\u592a\u5b89\u5168\u3002 $ aws configure AWS Access Key ID [****************xxxx]: # \u8f93\u5165\u4f60\u7684AK key AWS Secret Access Key [****************xxxx]: # \u8f93\u5165\u4f60\u7684SK key Default region name [cn-northwest-1]: # \u5b81\u590f\uff1acn-northwest-1\uff0c\u5317\u4eac\uff1acn-north-1 Default output format [json]: # \u9ed8\u8ba4json \u914d\u7f6e\u5b8c\u4e4b\u540e\u5229\u7528aws cli\u4e2d\u7684S3\u6a21\u5757\u547d\u4ee4\u8fdb\u884c\u6570\u636e\u62f7\u8d1d\uff1a \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4ece Amazon S3 \u590d\u5236\u5230EC2: aws s3 cp s3://my_bucket/my_folder/my_file.ext my_copied_file.ext \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4ece\u60a8\u7684\u5b9e\u4f8b\u590d\u5236\u5230 Amazon S3: aws s3 cp my_copied_file.ext s3://my_bucket/my_folder/my_file.ext \u5c06S3\u4e0a\u7684\u6876/\u6587\u4ef6\u5939\u540c\u6b65\u5230EC2\uff1a aws s3 sync s3://remote_S3_bucket ./ aws s3 sync s3://remote_S3_bucket/myfolder ./myfolder \u5c06EC2\u4e0a\u7684\u6587\u4ef6\u5939\u590d\u5236\u5230S3\uff1a aws s3 sync myfolder s3://remote_S3_bucket/myfolder \u65b9\u5f0f3 - IAM\u89d2\u8272\u8bbe\u7f6e(\u63a8\u8350) \u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u6709\u5229\u6709\u5f0a\uff0c\u7528IAM\u89d2\u8272\u6765\u63a7\u5236EC2\u7684\u6743\u9650\u662f\u5b98\u65b9\u63a8\u8350\u7684 \u6700\u4f73\u5b9e\u8df5 \u54e6\u3002 \u4ec0\u4e48\u662fAWS IAM\uff1f\u5168\u79f0 AWS Identity and Access Management \uff0c\u7528\u4e8e\u96c6\u4e2d\u7ba1\u7406\u7528\u6237\u3001\u8bbf\u95ee\u5bc6\u94a5\u7b49\u5b89\u5168\u51ed\u8bc1\uff0c\u4ee5\u53ca\u63a7\u5236\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b AWS \u8d44\u6e90\u7684\u6743\u9650\u3002\uff08\u8fd9\u91cc\u4ec5\u4f5c\u7b80\u8981\u4ecb\u7ecd\uff0c\u540e\u9762\u4f1a\u5f00\u4e13\u8d34\u8be6\u89e3\uff09 \u767b\u5f55aws control console\uff0c\u641c\u7d22IAM\uff0c\u70b9\u51fb\u8fdb\u5165 \u9009\u62e9\u5de6\u4fa7\u89d2\u8272\uff08Roles\uff09\uff0c\u7136\u540e\u9009\u62e9\u521b\u5efa\u89d2\u8272\uff08Create role\uff09 \u9009\u62e9AWS \u670d\u52a1\uff08AWS service\uff09,\u4e0b\u65b9\u9009\u62e9EC2\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u5728\u641c\u7d22\u6846\u5185\u641c\u7d22 s3 , \u9009\u4e2dAmazonS3FullAccess\u8fd9\u6761\u7b56\u7565\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u7ed9\u8fd9\u4e2a\u89d2\u8272\u6dfb\u52a0\u4e00\u4e9b\u5907\u6ce8\uff0c\u8bf7\u8bb0\u4f4f\uff0c\u4e0d\u8981\u5bf9\u81ea\u5df1\u7684\u8bb0\u6027\u8fc7\u5ea6\u81ea\u4fe1\uff1a\uff09\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u7ed9\u8fd9\u4e2a\u89d2\u8272\u547d\u4e2a\u540d\uff1a ec2accs3full , \u70b9\u51fb\u521b\u5efa\u89d2\u8272\uff0c\u5f39\u7a97\u6d88\u5931\uff0c\u53ef\u4ee5\u770b\u5230\u89d2\u8272\u5217\u8868\u91cc\u5df2\u7ecf\u6709\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u89d2\u8272\u4e86\u3002 \u56de\u5230EC2\u7684\u63a7\u5236\u53f0\uff0c\u9009\u4e2d\u4f60\u7684EC2\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 \u64cd\u4f5c \u83dc\u5355\uff08Action\uff09\uff0c\u9009\u62e9 \u9644\u52a0/\u66ff\u6362 IAM\u89d2\u8272 \u3002 \u9009\u4e2d\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u7b56\u7565 ec2accs3full , \u70b9\u51fb Apply \u3002 \u767b\u5f55\u8fd9\u53f0EC2\uff0c\u5c1d\u8bd5\u770b\u770bS3\u4e0a\u7684\u4e1c\u897f\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u62a5\u9519\u4e86\uff01 aws s3 ls An error occurred (InvalidToken) when calling the ListBuckets operation: The provided token is malformed or otherwise invalid. why ??? \u5f88\u7b80\u5355\uff0c\u6211\u4eec\u77e5\u9053\uff0cs3\u7684\u6876\u540d\u5fc5\u662f\u540c\u533a\u57df\u5185\u552f\u4e00\u7684\uff0c\u4f46\u4e0d\u540c\u533a\u57df\u5185\u7684\u6876\u540d\u662f\u6709\u53ef\u80fd\u76f8\u540c\u7684\uff0c\u6240\u4ee5\uff0c\u867d\u7136\u6211\u4eec\u7ed9\u4e86EC2\u8bbf\u95eeS3\u7684\u6743\u9650\uff0c\u4f46\u662fAWS\u5168\u7403\u90a3\u4e48\u591a\u533a\u57df\uff0c\u5b83\u600e\u4e48\u77e5\u9053\u53bb\u54ea\u4e2a\u533a\u627e\u4f60\u7684s3\u5462\uff1f $ aws configure AWS Access Key ID [None]: # \u4e0d\u9700\u8981\u8f93\u5165\uff0c\u76f4\u63a5\u56de\u8f66 AWS Secret Access Key [None]: # \u4e0d\u9700\u8981\u8f93\u5165\uff0c\u76f4\u63a5\u56de\u8f66 Default region name [None]: cn-northwest-1 # \u544a\u8bc9\u5b83\u5728\u54ea\u4e2a\u533a\u57df Default output format [None]: json \u518d\u8bd5\u8bd5...#_# $ aws s3 ls 2020-01-02 13:28:47 91porn 2020-01-09 13:15:15 athena \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 aws s3 cp \u6216\u662f aws s3 sync \u6765\u548cS3\u7684\u6570\u636e\u8fdb\u884c\u4ea4\u4e92\u4e86\uff01\u4e0d\u9700\u8981\u8f93\u5165\u4efb\u4f55\u5bc6\u94a5\uff0c\u4e5f\u4e0d\u9700\u8981ICP\u5907\u6848\u767d\u540d\u5355\u3002\u4ee5\u540e\u518d\u521b\u5efa\u65b0\u7684ec2\u670d\u52a1\u5668\uff0c\u76f4\u63a5attach\u6211\u4eec\u521b\u5efa\u597d\u7684\u89d2\u8272 (Role)\u7ed9\u5b83\uff0c\u518d\u914d\u7f6e\u4e00\u6b21 aws configure \u5c31\u53ef\u4ee5\u4e86\uff01 \u9053\u8def\u5343\u4e07\u6761\uff0c\u5b89\u5168\u7b2c\u4e00\u6761\u3002","title":"\u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#ec2s3","text":"\u4e00\u822c\u6765\u8bf4\uff0c\u56e0\u4e3as3\u7684\u5b58\u50a8\u6210\u672c\u4f18\u52bf\uff0c\u6211\u4eec\u90fd\u4f1a\u628a\u6570\u636e\u5982bcl\uff0cfastq\uff0cbam\uff0csam\u7b49\u5168\u90e8\u4e22\u5230s3\u4e0a\u957f\u671f\u4fdd\u5b58\uff0c\u7136\u540e\u9700\u8981\u5206\u6790\u7684\u65f6\u5019\uff0c\u5f00\u542f\u4e00\u53f0\u670d\u52a1\u5668EC2\uff0c\u62f7\u8d1d\u8fd9\u4e9b\u6570\u636e\u5230EC2\u8fde\u63a5\u7684EBS/EFS\u4e0a\uff0c\u518d\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u5206\u6790\uff0c\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u6211\u600e\u4e48\u624d\u80fd\u5e2eEC2\u6478\u5230s3\u4e0a\u7684\u6570\u636e\u5462\uff1f -- D.C","title":"\u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#_1","text":"EC2\u7684AMI\u5b9e\u9645\u4e0a\u4fdd\u5b58\u5728S3\u4e0a\uff0cAMI\u662f\u4e3a\u4e86\u5feb\u901f\u542f\u52a8\u51e0\u5341\u4e0a\u767e\u53f0\u540c\u6837\u5206\u6790\u73af\u5883\u7684\u673a\u5668 EBS\u7684snapshot\u5b9e\u9645\u4e0a\u4e5f\u4fdd\u5b58\u5728S3\u4e0a\uff0csnapshot\u53ef\u4ee5\u8ba9\u6211\u4eec\u5feb\u901f\u6062\u590d\u6570\u636e\uff0c\u5982\u6570\u636e\u5e93\uff0c\u5206\u6790\u6d41\u7a0b\uff0c\u8fd8\u53ef\u4ee5\u4f5c\u4e3a\u6a21\u677f\uff0c\u5feb\u901f\u521b\u5efa\u540c\u6837\u7c7b\u578b\u7684\u78c1\u76d8\uff0c\u5982\u9884\u7f6e\u597d\u7279\u5b9aIOPS\u7684io1\u578bEBS\u3002 S3\u4e0a\u7684\u6bcf\u4e2a\u6587\u4ef6\u90fd\u662f\u4e00\u4e2aobject\u5bf9\u8c61\uff0c\u6876\u662f\u8fd9\u4e2a\u5bf9\u8c61\u6700\u9ad8\u7684\u547d\u540d\u7a7a\u95f4\uff08namespace\uff09,\u7c7b\u4f3c\u4e8e\u8bbf\u95eeinternet\u7684\u57df\u540d\uff0c\u5982\u679c\u5f00\u901a\u4e86ICP\u5907\u6848\u767d\u540d\u5355\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5bf9\u8c61\u548c\u6240\u5728\u6876\u7684\u8bbf\u95ee\u6743\u9650\u5f00\u653e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u53ef\u4ee5\u7528http\u7684URL (Uniform Resource Locator)\u8fdb\u884c\u8bbf\u95ee\uff0c\u6bd4\u5982\uff1a http://aws-s3-bucket1.s3.amazonaws.com/photos/mygarden.jpg","title":"\u4f60\u8be5\u77e5\u9053\u7684"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#_2","text":"\u5982\u4f55\u521b\u5efa\u865a\u62df\u673aEC2 \u5982\u4f55\u7528CLI\u767b\u5f55EC2 \u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3","title":"\u4f60\u8be5\u638c\u63e1\u7684"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#1-get-wget","text":"\u8fd9\u4e24\u4e2a\u547d\u4ee4\u6211\u4eec\u4e00\u5b9a\u4e0d\u964c\u751f\u5427\uff0cwget\u662fHTTP\u548cFTP\u5ba2\u6237\u7aef\u7684\u5e38\u7528\u4e0b\u8f7d\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u5728Amazon Linux\u4e2d\u90fd\u5b89\u88c5\u597d\u7684\u3002\u6240\u4ee5\u5982\u679c\u6211\u4eec\u77e5\u9053\u8981\u4e0b\u8f7d\u5bf9\u8c61\u7684URL\uff0c\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u547d\u4ee4\u4e0b\u8f7d\uff1a wget https://my_bucket.s3.amazonaws.com/path-to-file \u9700\u8981\u6ce8\u610f : \u8981\u5148\u767b\u5f55\u5230EC2\u4e0a S3\u5df2\u7ecf\u5f00\u4e86ICP\u5907\u6848\u7684\u767d\u540d\u5355\uff08\u8054\u7cfbaws\uff09 \u8bbf\u95ee\u7684\u5bf9\u8c61\u5305\u62ec\u5bf9\u8c61\u6240\u5728\u7684\u6876\u6743\u9650\u662f\u516c\u5f00\u7684\uff0c\u5426\u5219\u4f1a\u6536\u5230\u9519\u8bef\u4fe1\u606f\u201cERROR 403: Forbidden\u201d","title":"\u65b9\u5f0f1 - GET \u6216 wget"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#2-aksk","text":"\u4ec0\u4e48\u662fAKSK? \u7b80\u5355\u6765\u8bf4\uff0c\u6211\u4eec\u5728aws\u8d26\u6237\u4e0b\u65b0\u5efauser\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u7ed9\u6211\u4eec\u4e00\u4e2acsv\u683c\u5f0f\u6587\u4ef6\uff0c\u91cc\u9762\u4fdd\u5b58\u7684\u5c31\u662fAKSK\u4e24\u4e2akey\uff0c\u5728\u5411\u4e91\u7aef\u53d1\u8d77\u8bbf\u95ee\u65f6\u5411\u5b83\u8bc1\u660e\u4f60\u5c31\u662f\u4f60\u3002 \u901a\u8fc7\u914d\u7f6eEC2\u4e0a\u7684AWS CLI \u8bbf\u95eeS3\u4e0a\u7684\u6876\u548c\u6587\u4ef6\uff0cAWS CLI\u9ed8\u8ba4\u90fd\u5728EC2\u4e0a\u88c5\u597d\u7684\u3002\u5728\u8fd9\u53f0EC2\u4e0a\u914d\u7f6e\u597dCLI\u7684AKSK\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u5411S3\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u4e86\uff0c\u800c\u4e14\u65e0\u987b\u7533\u8bf7S3\u7684ICP\u5907\u6848 \u767d\u540d\u5355\uff0c\u7f3a\u70b9\u662f\u6bcf\u53f0EC2\u90fd\u8981\u914d\u7f6e\u4e00\u6b21AKSK\u5bc6\u94a5\u4fe1\u606f\uff0c\u4e0d\u592a\u5b89\u5168\u3002 $ aws configure AWS Access Key ID [****************xxxx]: # \u8f93\u5165\u4f60\u7684AK key AWS Secret Access Key [****************xxxx]: # \u8f93\u5165\u4f60\u7684SK key Default region name [cn-northwest-1]: # \u5b81\u590f\uff1acn-northwest-1\uff0c\u5317\u4eac\uff1acn-north-1 Default output format [json]: # \u9ed8\u8ba4json \u914d\u7f6e\u5b8c\u4e4b\u540e\u5229\u7528aws cli\u4e2d\u7684S3\u6a21\u5757\u547d\u4ee4\u8fdb\u884c\u6570\u636e\u62f7\u8d1d\uff1a \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4ece Amazon S3 \u590d\u5236\u5230EC2: aws s3 cp s3://my_bucket/my_folder/my_file.ext my_copied_file.ext \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4ece\u60a8\u7684\u5b9e\u4f8b\u590d\u5236\u5230 Amazon S3: aws s3 cp my_copied_file.ext s3://my_bucket/my_folder/my_file.ext \u5c06S3\u4e0a\u7684\u6876/\u6587\u4ef6\u5939\u540c\u6b65\u5230EC2\uff1a aws s3 sync s3://remote_S3_bucket ./ aws s3 sync s3://remote_S3_bucket/myfolder ./myfolder \u5c06EC2\u4e0a\u7684\u6587\u4ef6\u5939\u590d\u5236\u5230S3\uff1a aws s3 sync myfolder s3://remote_S3_bucket/myfolder","title":"\u65b9\u5f0f2 - AKSK\u8bbf\u95ee"},{"location":"blogs/2020-01-28-ec2-s3-data-exchange/#3-iam","text":"\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u6709\u5229\u6709\u5f0a\uff0c\u7528IAM\u89d2\u8272\u6765\u63a7\u5236EC2\u7684\u6743\u9650\u662f\u5b98\u65b9\u63a8\u8350\u7684 \u6700\u4f73\u5b9e\u8df5 \u54e6\u3002 \u4ec0\u4e48\u662fAWS IAM\uff1f\u5168\u79f0 AWS Identity and Access Management \uff0c\u7528\u4e8e\u96c6\u4e2d\u7ba1\u7406\u7528\u6237\u3001\u8bbf\u95ee\u5bc6\u94a5\u7b49\u5b89\u5168\u51ed\u8bc1\uff0c\u4ee5\u53ca\u63a7\u5236\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b AWS \u8d44\u6e90\u7684\u6743\u9650\u3002\uff08\u8fd9\u91cc\u4ec5\u4f5c\u7b80\u8981\u4ecb\u7ecd\uff0c\u540e\u9762\u4f1a\u5f00\u4e13\u8d34\u8be6\u89e3\uff09 \u767b\u5f55aws control console\uff0c\u641c\u7d22IAM\uff0c\u70b9\u51fb\u8fdb\u5165 \u9009\u62e9\u5de6\u4fa7\u89d2\u8272\uff08Roles\uff09\uff0c\u7136\u540e\u9009\u62e9\u521b\u5efa\u89d2\u8272\uff08Create role\uff09 \u9009\u62e9AWS \u670d\u52a1\uff08AWS service\uff09,\u4e0b\u65b9\u9009\u62e9EC2\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u5728\u641c\u7d22\u6846\u5185\u641c\u7d22 s3 , \u9009\u4e2dAmazonS3FullAccess\u8fd9\u6761\u7b56\u7565\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u7ed9\u8fd9\u4e2a\u89d2\u8272\u6dfb\u52a0\u4e00\u4e9b\u5907\u6ce8\uff0c\u8bf7\u8bb0\u4f4f\uff0c\u4e0d\u8981\u5bf9\u81ea\u5df1\u7684\u8bb0\u6027\u8fc7\u5ea6\u81ea\u4fe1\uff1a\uff09\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65 \u7ed9\u8fd9\u4e2a\u89d2\u8272\u547d\u4e2a\u540d\uff1a ec2accs3full , \u70b9\u51fb\u521b\u5efa\u89d2\u8272\uff0c\u5f39\u7a97\u6d88\u5931\uff0c\u53ef\u4ee5\u770b\u5230\u89d2\u8272\u5217\u8868\u91cc\u5df2\u7ecf\u6709\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u89d2\u8272\u4e86\u3002 \u56de\u5230EC2\u7684\u63a7\u5236\u53f0\uff0c\u9009\u4e2d\u4f60\u7684EC2\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 \u64cd\u4f5c \u83dc\u5355\uff08Action\uff09\uff0c\u9009\u62e9 \u9644\u52a0/\u66ff\u6362 IAM\u89d2\u8272 \u3002 \u9009\u4e2d\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u7b56\u7565 ec2accs3full , \u70b9\u51fb Apply \u3002 \u767b\u5f55\u8fd9\u53f0EC2\uff0c\u5c1d\u8bd5\u770b\u770bS3\u4e0a\u7684\u4e1c\u897f\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u62a5\u9519\u4e86\uff01 aws s3 ls An error occurred (InvalidToken) when calling the ListBuckets operation: The provided token is malformed or otherwise invalid. why ??? \u5f88\u7b80\u5355\uff0c\u6211\u4eec\u77e5\u9053\uff0cs3\u7684\u6876\u540d\u5fc5\u662f\u540c\u533a\u57df\u5185\u552f\u4e00\u7684\uff0c\u4f46\u4e0d\u540c\u533a\u57df\u5185\u7684\u6876\u540d\u662f\u6709\u53ef\u80fd\u76f8\u540c\u7684\uff0c\u6240\u4ee5\uff0c\u867d\u7136\u6211\u4eec\u7ed9\u4e86EC2\u8bbf\u95eeS3\u7684\u6743\u9650\uff0c\u4f46\u662fAWS\u5168\u7403\u90a3\u4e48\u591a\u533a\u57df\uff0c\u5b83\u600e\u4e48\u77e5\u9053\u53bb\u54ea\u4e2a\u533a\u627e\u4f60\u7684s3\u5462\uff1f $ aws configure AWS Access Key ID [None]: # \u4e0d\u9700\u8981\u8f93\u5165\uff0c\u76f4\u63a5\u56de\u8f66 AWS Secret Access Key [None]: # \u4e0d\u9700\u8981\u8f93\u5165\uff0c\u76f4\u63a5\u56de\u8f66 Default region name [None]: cn-northwest-1 # \u544a\u8bc9\u5b83\u5728\u54ea\u4e2a\u533a\u57df Default output format [None]: json \u518d\u8bd5\u8bd5...#_# $ aws s3 ls 2020-01-02 13:28:47 91porn 2020-01-09 13:15:15 athena \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 aws s3 cp \u6216\u662f aws s3 sync \u6765\u548cS3\u7684\u6570\u636e\u8fdb\u884c\u4ea4\u4e92\u4e86\uff01\u4e0d\u9700\u8981\u8f93\u5165\u4efb\u4f55\u5bc6\u94a5\uff0c\u4e5f\u4e0d\u9700\u8981ICP\u5907\u6848\u767d\u540d\u5355\u3002\u4ee5\u540e\u518d\u521b\u5efa\u65b0\u7684ec2\u670d\u52a1\u5668\uff0c\u76f4\u63a5attach\u6211\u4eec\u521b\u5efa\u597d\u7684\u89d2\u8272 (Role)\u7ed9\u5b83\uff0c\u518d\u914d\u7f6e\u4e00\u6b21 aws configure \u5c31\u53ef\u4ee5\u4e86\uff01 \u9053\u8def\u5343\u4e07\u6761\uff0c\u5b89\u5168\u7b2c\u4e00\u6761\u3002","title":"\u65b9\u5f0f3 - IAM\u89d2\u8272\u8bbe\u7f6e(\u63a8\u8350)"},{"location":"blogs/2020-01-29-s3-data-ops/","text":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1 - Web \u754c\u9762 \u5927\u5bb6\u90fd\u77e5\u9053\uff0cs3\u662faws2006\u5e74\u5c31\u63a8\u51fa\u7684\u57fa\u672c\u5b58\u50a8\u670d\u52a1\uff0c\u53ef\u4ee5\u8bf4\u73b0\u5728\u5e02\u9762\u4e0a\u6240\u6709\u7684\u516c\u6709\u4e91\u5b58\u50a8\u90fd\u662f\u5b83\u7684\u6a21\u4eff\u8005\uff0c\u90a3\u4e48\u5b66\u4e60\u5982\u4f55\u5229\u7528S3\u8fd9\u4e2a\u670d\u52a1\u5c31\u975e\u5e38\u91cd\u8981\u4e86\uff0c\u4f5c\u4e3a\u6700\u65e9\u63a8\u51fa\u7684\u4e24\u4e2a\u516c\u6709\u4e91\u670d\u52a1\u4e4b\u4e00\uff08\u53e6\u4e00\u4e2a\u662fEC2\uff09\uff0c\u5b83\u5728\u6574\u4e2a\u516c\u6709\u4e91\u751f\u6001\u4e2d\u7684\u91cd\u8981\u6027\u975e\u5e38\u4e4b\u9ad8\uff0c\u662f\u5f88\u591a\u5176\u4ed6\u7684\u670d\u52a1\u7684\u5e95\u5c42\u652f\u6301\u3002 -- D.C web\u754c\u9762\u4e0a\u4f20\u6570\u636e\u5230s3 \u767b\u5f55 aws console \uff0c \u641c\u7d22\u680f\u4e2d\u641c\u7d22s3\uff0c\u70b9\u51fb\u8fdb\u5165\u3002 \u70b9\u51fb \u65b0\u5efa\u6876\uff08Create bucket\uff09 \uff0c\u60f3\u597d\u4e00\u4e2a\u7b80\u5355\u6613\u61c2\u7684\u540d\u5b57,\u8fd9\u4e2a\u540d\u5b57\u6700\u597d\u548c\u4f60\u8981\u653e\u7684\u5185\u5bb9\u6709\u5173\u8054\uff0c\u4e00\u76ee\u4e86\u7136\uff0c\u6bd4\u5982\u6211\u7684\u6876\u540d\u53eb lovevideo ,\u7528\u4e8e\u653e\u4e00\u4e9b\u53ef\u4ee5\u53cd\u590d\u9274\u8d4f\u7684\u89c6\u9891\u6587\u4ef6\uff0c\u55ef\u55ef\u3002 \u5199\u5165 \u6876\u540d \uff0c Region \u9ed8\u8ba4\uff0c\u63a5\u7740\u4f1a\u8ba9\u6211\u9009\u62e9\u4e00\u4e2a\u73b0\u6709\u7684\u6876\uff0c\u5e72\u4ec0\u4e48\u5462\uff1f\u5982\u679c\u6211\u613f\u610f\uff0c\u53ef\u4ee5\u628a\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6876\u5c5e\u6027\uff0c\u590d\u5236\u5230\u8fd9\u4e2a\u5373\u5c06\u521b\u5efa\u7684\u65b0\u6876\u4e0a\uff0c\u8282\u7ea6\u65f6\u95f4\u54e6\uff01\u4f46\u662f\u8fd9\u91cc\u6211\u4e0d\u9009\uff0c \u4e0b\u4e00\u6b65 \u3002 \u8fd9\u4e00\u6b65\u5c31\u662f\u505a\u6876\u7684\u4e00\u4e9b\u8bbe\u7f6e\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u90fd\u6709\u54ea\u4e9b\uff1f\u8fd9\u91cc\u6211\u9664\u4e86\u6253\u6807\u7b7e\uff0c\u5176\u4ed6\u90fd\u6ca1\u9009\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u9009\u9879 \u4e2d\u6587\u540d \u89e3\u91ca versioning \u7248\u672c\u63a7\u5236 \u5982\u679c\u9009\u62e9\uff0c\u5c31\u4f1a\u4fdd\u7559\u6bcf\u4e2a\u6587\u4ef6\u7684\u4e0d\u540c\u7248\u672c\uff0c\u6bd4\u5982a\u6587\u4ef6\u8fde\u7eed\u88ab\u8986\u76d6\u4e862\u6b21\uff0c\u90a3\u4e48S3\u4e0a\u5c31\u4f1a\u67093\u4efd\u4e0d\u540c\u7248\u672c\u7684a\u6587\u4ef6\uff0c\u6211\u968f\u65f6\u53ef\u4ee5\u9009\u62e9\u5c06\u73b0\u5728\u7684a\u6587\u4ef6\u6062\u590d\u5230\u54ea\u4e2a\u7248\u672c\uff0c\u9632\u6b62\u8bef\u6539\u8bef\u5220\uff0c\u90a3\u662f\u6781\u597d\u7684\uff0c\u4f46\u662f\u4f1a\u5360\u7528\u5b58\u50a8\u7a7a\u95f4\u54e6~ Server access logging \u670d\u52a1\u5668\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55 \u542f\u7528\u8be5\u670d\u52a1\u4e4b\u540e\uff0caws\u4f1a\u5e2e\u6211\u4eec\u8be6\u7ec6\u8bb0\u5f55\u6211\u4eec\u5728\u65e5\u5e38\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5bf9s3 \u5b58\u50a8\u6876\u63d0\u51fa\u7684\u5404\u79cd\u8bf7\u6c42\uff0c\u65e5\u5fd7\u4f1a\u4fdd\u5b58\u5230\u4e0e\u6e90\u5b58\u50a8\u6876\u76f8\u540c\u7684 AWS \u533a\u57df\u7684\u5b58\u50a8\u6876\u4e2d\u3002\u5bf9\u4e8e\u5927\u591a\u6570\u7684\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\uff0c\u6709log\u65e5\u5fd7\u4f1a\u65b9\u4fbf\u5f88\u591a\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u50a8\u5b58\u4e00\u4e9b\u6bd4\u8f83\u654f\u611f\u7684\u6570\u636e\uff0c\u5b89\u5168\u6027\u548c\u8bbf\u95ee\u6743\u9650\u5ba1\u6838\u65b9\u9762\u7684\u5408\u89c4\u6027\u5c31\u663e\u5f97\u975e\u5e38\u91cd\u8981\u4e86\u3002 \u6bcf\u4e2a\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u90fd\u63d0\u4f9b\u6709\u5173\u5355\u4e2a\u8bbf\u95ee\u8bf7\u6c42\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5982\u8bf7\u6c42\u8005\u3001\u5b58\u50a8\u6876\u540d\u79f0\u3001\u8bf7\u6c42\u65f6\u95f4\u3001\u8bf7\u6c42\u64cd\u4f5c\u3001\u54cd\u5e94\u72b6\u6001\u548c\u9519\u8bef\u4ee3\u7801\uff08\u5982\u679c\u76f8\u5173\uff09\u3002 \u52fe\u9009\u4e4b\u540e\uff1a\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u76ee\u6807\u5b58\u50a8\u6876\uff0c\u7528\u4e8e\u5b58\u653e\u65e5\u5fd7\u6587\u4ef6\uff1b\u8fd8\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u65e5\u5fd7\u5bf9\u8c61\u524d\u7f00\uff0c\u7528\u4e8e\u4ee5\u540e\u66f4\u65b9\u4fbf\u7684\u67e5\u627e\u8fd9\u4e9b\u65e5\u5fd7\u5bf9\u8c61\uff0c\u5982\u6211\u6307\u5b9a\u524d\u7f00\u4e3a logs/ ,\u90a3\u4e48s3\u521b\u5efa\u7684\u6240\u6709\u65e5\u5fd7\u5bf9\u8c61\u90fd\u662f\u4ee5 logs/ \u5f00\u5934\uff0c\u5982 logs/2013-11-01-21-32-16-E568B2907131C0C0 \u5bf9\u5e94\u7684\u683c\u5f0f\u4e3a TargetPrefixYYYY-mm-DD-HH-MM-SS-UniqueString \u5173\u4e8e\u94b1\uff1a\u5f00\u542f\u8fd9\u4e2a\u670d\u52a1\u4e0d\u4f1a\u989d\u5916\u6536\u8d39\uff0c\u4f46\u662f\u4f1a\u4ea7\u751f\u65e5\u5fd7\u6587\u4ef6\u7684S3\u5b58\u50a8\u8d39\u7528\uff0c\u4e00\u822c\u53ef\u4ee5\u5ffd\u7565\u3002 Tags \u6253\u6807\u7b7e \u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\u5566~\u6253\u5c31\u662f\u4e86 Object-level logging \u5bf9\u8c61\u7ea7\u65e5\u5fd7 \u662f\u5426\u542f\u7528\u5bf9\u8c61\u7ea7\u522b\u7684API\u8c03\u7528\u76d1\u63a7\u3002\u5229\u7528\u7684\u662fAWS CloudTrail\u670d\u52a1\uff0c\u6240\u4ee5\u4f1a\u4ea7\u751f\u989d\u5916\u8d39\u7528\u54e6\uff0c \u7a77\u4eba\u70b9\u6211 :-) CloudTrail \u4f1a\u6355\u83b7\u5bf9Amazon S3 \u7684 API \u8c03\u7528\u4e8b\u4ef6\uff0c\u5305\u62ec\u6765\u81ea Amazon S3 \u63a7\u5236\u53f0\u7684\u8c03\u7528\u548c\u5bf9 Amazon S3 API \u7684\u4ee3\u7801\u8c03\u7528\u3002\u5982\u679c\u6253\u52fe\u521b\u5efa\u8ddf\u8e2a\uff0c\u5219\u53ef\u4ee5\u4f7f CloudTrail \u4e8b\u4ef6\u6301\u7eed\u4f20\u9001\u5230 Amazon S3 \u5b58\u50a8\u6876\uff08\u5305\u62ec Amazon S3 \u7684\u4e8b\u4ef6\uff09\u3002\u5982\u679c\u4e0d\u914d\u7f6e\u8ddf\u8e2a\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 CloudTrail \u63a7\u5236\u53f0\u7684 Event history (\u4e8b\u4ef6\u5386\u53f2\u8bb0\u5f55) \u4e2d\u67e5\u770b\u6700\u65b0\u4e8b\u4ef6\u3002 \u901a\u8fc7\u4f7f\u7528 CloudTrail \u6536\u96c6\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u5411 Amazon S3 \u53d1\u51fa\u4e86\u4ec0\u4e48\u8bf7\u6c42\u3001\u53d1\u51fa\u8bf7\u6c42\u7684 IP \u5730\u5740\u3001\u4f55\u4eba\u53d1\u51fa\u7684\u8bf7\u6c42\u3001\u8bf7\u6c42\u7684\u53d1\u51fa\u65f6\u95f4\u4ee5\u53ca\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\uff0c\u7279\u522b\u9002\u7528\u4e8e\u559c\u6b22\u7591\u795e\u7591\u9b3c\u7684\u540c\u5b66\u3002 Default encryption \u9ed8\u8ba4\u52a0\u5bc6 \u4e00\u65e6\u9009\u62e9\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6254\u5230\u8fd9\u4e2a\u6876\u91cc\u7684\u5bf9\u8c61\u90fd\u4f1a\u88ab\u81ea\u52a8\u52a0\u5bc6\u3002 \u63d0\u4f9b\u4e24\u4e2a\u52a0\u5bc6\u9009\u9879: AES-256 \u548c AWS-KMS, \u524d\u8005\u662fS3\u5e2e\u4f60\u52a0\u5bc6\uff0c\u540e\u8005\u662faws\u7684kms\u670d\u52a1\u5e2e\u4f60\u52a0\u5bc6\u3002 Object lock \u5bf9\u8c61\u9501\u5b9a \u987e\u540d\u601d\u4e49\uff0c\u9501\u5b9a\u6876\u548c\u6876\u91cc\u7684\u5bf9\u8c61\uff0c\u9632\u6b62\u88ab\u4fee\u6539\u548c\u5220\u9664\u3002 \u4f7f\u7528\u5b83\u6709\u4e2a\u524d\u63d0\uff0c\u5148\u8981\u5f00\u542f \u7248\u672c\u63a7\u5236 \u3002\u4e00\u65e6\u542f\u7528\uff0c\u653e\u5165\u5176\u4e2d\u7684\u5bf9\u8c61\u5c31\u4f1a\u5728\u4e00\u5b9a\u5468\u671f\u5185\u6216\u65e0\u9650\u671f\u88ab\u9501\u5b9a\uff0c\u800c\u6211\u4eec\u65e0\u6cd5\u5c06\u5176\u5220\u9664\u3002 \u6ee1\u8db3WORM\uff08\u4e00\u6b21\u5199\u5165\uff0c\u591a\u6b21\u8bfb\u53d6\uff09\u5b58\u50a8\u6cd5\u89c4\u8981\u6c42\uff0c\u53ef\u5728\u53d7 SEC 17a-4\u3001CTCC \u548c FINRA \u6cd5\u89c4\u7ea6\u675f\u7684\u73af\u5883\u4e2d\u4f7f\u7528\u3002 \u66f4\u591a\u70b9\u6211 CloudWatch request metrics CloudWatch\u76d1\u63a7\u8bf7\u6c42\u6307\u6807 \u4f7f\u7528CloudWatch\u6765\u76d1\u63a7S3\u7684\u8bf7\u6c42\u6307\u6807\uff0c\u6bcf\u5206\u949f\u66f4\u65b0\u4e00\u6b21\uff0c\u9488\u5bf9\u5f02\u5e38\u6307\u6807\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u8b66\u62a5\uff0c\u548c\u81ea\u52a8\u5904\u7406\u63aa\u65bd\uff08\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff09\u3002 \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8fc7\u6ee4\u6761\u4ef6\u6765\u76d1\u63a7\u7279\u5b9a\u524d\u7f00\u6216\u6807\u7b7e\u7684\u5bf9\u8c61\u3002 \u8bf7\u6c42\u6307\u6807\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aAllRequests\uff0cGetRequests\uff0cPutRequests\uff0cDeleteRequests ... \u63a5\u4e0b\u6765\u5c31\u662f\u5b89\u5168\u6027\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u65b0\u5efa\u7684\u6876\u662f\u5bf9\u6240\u6709\u516c\u5f00\u8bbf\u95ee\u90fd\u62d2\u7edd\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 Review \u4e00\u904d\u6ca1\u95ee\u9898\uff0c\u70b9\u51fb\u521b\u5efa\uff0cdeng~deng~deng\uff01deng\uff01\u6211\u7684\u7231\u60c5\u52a8\u4f5c\u7247\u7ec8\u4e8e\u6709\u4e00\u4e2a\u5bb6\u4e86\uff01 \u70b9\u51fb\u6876\u540d lovevideo \u8fdb\u53bb\uff0c\u5565\u90fd\u6ca1\u6709\uff0c\u8d76\u7d27\u4f20\u70b9\u4e1c\u897f\u8fdb\u53bb\uff01\u70b9\u51fb Upload \u4e0a\u4f20\u6587\u4ef6\uff0c\u6216\u8005 \u521b\u5efa\u6587\u4ef6\u5939 \u6765\u7ed9\u6211\u7684\u6587\u4ef6\u5206\u5206\u7c7b\uff0c\u6bd4\u5982\u65e5\u672c\uff0c\u97e9\u56fd\uff0c\u5927\u9646\uff0c\u53f0\u6e7e\uff0c\u7f8e\u56fd\uff0c\u6cf0\u56fd\u3002\u3002\u3002 \u70b9\u51fb Upload \u4e4b\u540e\uff0c\u5c31\u4f1a\u51fa\u73b0\u5f39\u7a97\uff0c\u9009\u62e9\u597d\u6587\u4ef6\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4fdd\u6301\u9ed8\u8ba4\u8bbe\u7f6e\u76f4\u63a5\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684 Upload \uff0c\u6216\u662f\u70b9\u51fb \u4e0b\u4e00\u6b65 \uff0c\u8bbe\u7f6e\u6743\u9650\u3002 Manage Users : \u8bbe\u7f6e\u62e5\u6709\u8005\u6743\u9650\uff1b Access for other AWS account \uff1a \u8bbe\u7f6e\u5176\u4ed6aws\u8d26\u53f7\u80fd\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u505a\u4ec0\u4e48\u3002\u6bd4\u5982\u8bf4\u6709\u4e00\u90e8\u65b0\u51fa\u7684\u5c9b\u56fd\u52a8\u4f5c\u7247\u5f88\u597d\u770b\uff0c\u6211\u5c31\u53ef\u4ee5\u628a\u5b83\u5206\u4eab\u7ed9\u4f60\u7684aws\u8d26\u53f7\u4e86\u3002\uff08\u8fd9\u91cc\u5148\u57cb\u4e2a\u5751\uff0c\u4e8b\u5b9e\u4e0a\u6ca1\u8fd9\u4e48\u7b80\u5355\uff0c\u8fd8\u8bb0\u5f97public block\u90a3\u4e2a\u6743\u9650\u4e48\uff09 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u79cdweb\u754c\u9762\u7684\u4e0a\u4f20\u65b9\u5f0f\u4e00\u822c\u9488\u5bf9\u7684\u662f\u5c0f\u6587\u4ef6\uff0c\u5355\u4e2a\u6700\u5927\u6587\u4ef6\u662f5GB\u3002\u4e00\u822c\u6765\u8bf4\uff0caws\u63a8\u8350\u4e0a\u4f20\u5927\u4e8e100MB\u5c31\u8981\u8003\u8651\u4e0a \u5206\u6bb5\u4e0a\u4f20 \u4e86\u3002\uff08 \u5206\u6bb5\u4e0a\u4f20API \uff09 \u5206\u6bb5\u4e0a\u4f20\u7684\u597d\u5904\u662f\uff0c\u901a\u8fc7\u628a\u6587\u4ef6\u5207\u7247\uff0c\u5206\u6bb5\u8fdb\u884c\u4e0a\u4f20\uff0c\u63d0\u9ad8\u4e86\u541e\u5410\u91cf\u7684\u540c\u65f6\uff0c\u4e5f\u80fd\u4ece\u4efb\u4f55\u7f51\u7edc\u95ee\u9898\u4e2d\u5feb\u901f\u6062\u590d\uff0c\u8fd8\u6709\u4e00\u70b9\u6bd4\u8f83\u6709\u610f\u601d\uff0c\u5c31\u662f\u53ef\u4ee5\u5728\u6211\u4e0d\u77e5\u9053\u6587\u4ef6\u5927\u5c0f\u7684\u65f6\u5019\u5c31\u5f00\u59cb\u4e0a\u4f20\uff0c\u600e\u4e48\u7406\u89e3\uff1f\u6211\u53ef\u4ee5\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u5c31\u540c\u65f6\u628a\u5b83\u4e0a\u4f20\uff0c\u6709\u70b9\u70e7\u8111\uff0c\u540c\u5b66\u4eec\u81ea\u5df1\u4f53\u4f1a\u4e0b\u3002 \u8bbe\u7f6e\u5b58\u50a8\u5c5e\u6027\uff0c\u4ece\u9009\u9879\u6211\u4eec\u53ef\u4ee5\u770b\u5230aws\u63d0\u4f9b7\u79cd\u5b58\u50a8\u6a21\u5f0f\uff0c\u5e38\u7528\u7684\u4e00\u822c\u662f\u524d6\u79cd\uff0c\u4e1a\u754c\u6700\u591a\u4e86\u3002\u4ece\u4e0b\u8868\u53ef\u4ee5\u770b\u5230aws\u7684\u786e\u662f\u4e1a\u754c\u826f\u5fc3\uff0c\u9664\u4e86 S3 \u5355\u533a \u4e4b\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u9ed8\u8ba43\u4e2a\u4ee5\u4e0a\u7684\u53ef\u7528\u533a\u5907\u4efd\uff0c\u8fd9\u6837\u5c31\u628a\u6570\u636e\u4e22\u5931\u7684\u6982\u7387\u964d\u5230\u6781\u4f4e\uff0c\u76f8\u6bd4\u5f88\u591a\u540c\u884c\u4e70\u4e2a\u673a\u623f\u5165\u7f51\u5c31\u5bf9\u5916\u8bf4\u662f\u53ef\u7528\u533a\u5f3a\u592a\u591a\u4e86\u3002\u8fd8\u6709\u4e00\u70b9\u5c31\u662f\u4ef7\u683c\uff0c\u56fd\u5185\u51e0\u5bb6\u4e91\u5546\u6211\u4e5f\u7528\u8fc7\uff0c\u5b98\u7f51\u865a\u6807\u7684\u4ef7\u683c\u7b80\u76f4\u6ca1\u6cd5\u53c2\u8003\uff0c\u56e0\u4e3a\u79c1\u4e0b\u91cc\u6253\u6298\u592a\u5389\u5bb3\uff0caws\u8fd9\u70b9\u505a\u5f97\u4e0d\u9519\uff0c\u660e\u7801\u6807\u4ef7\uff0c\u6211\u53ef\u4ee5\u76f4\u63a5\u62ff\u8fc7\u6765\u7ed9\u516c\u53f8\u505a\u4e2a\u4e09\u5e74\u7684\u9884\u7b97\u3002 \u5c5e\u6027 \u89e3\u91ca \u6bd4\u5982 S3 \u6807\u51c6\u5b58\u50a8(\u5b81\u590f\u4e3a\u4f8b\uff09 S3 Standard \u8bbf\u95ee\uff1a\u6d3b\u52a8\uff0c\u9891\u7e41\u8bbf\u95ee \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1629/GB \u5f85\u5206\u6790\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e S3 \u667a\u80fd\u5206\u5c42\u5b58\u50a8 S3 Intelligent-Tiering \u8bbf\u95ee\uff1a\u8bbf\u95ee\u9891\u7387\u53ef\u53d8 \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1030029/GB \u81f3 \u00a50.1629/GB \u9010\u5bf9\u8c61\u76d1\u63a7\u8ba1\u8d39\uff1a\u8fde\u7eed 30 \u5929\u672a\u8bbf\u95ee\u7684\u5bf9\u8c61\u79fb\u81f3\u4e0d\u9891\u7e41\u8bbf\u95ee\u5c42\uff0c\u4e00\u65e6\u88ab\u8bbf\u95ee\u53c8\u79fb\u56de\u9891\u7e41\u8bbf\u95ee\u5c42 \u6700\u5c0f\u5b58\u50a8\u671f\u9650\uff1a30\u5929 (\u6ca1\u5b58\u6ee130\u5929\u5c31\u5220\u9664\uff0c\u6536\u53d630\u5929\u7684\u8d39\u7528\uff0c\u8003\u8651\u597d\u54e6\uff01) \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB\uff08\u5c0f\u4e8e128KB \u59cb\u7ec8\u653e\u5728\u9891\u7e41\u8bbf\u95ee\u5c42\uff09 \u61d2\u4eba\u6a21\u5f0f\uff0c\u4e0d\u786e\u5b9a1-3\u4e2a\u6708\u4f1a\u4e0d\u4f1a\u5206\u6790\u7684bam\uff0cvcf\u7b49\u6570\u636e S3 \u6807\u51c6\u5b58\u50a8\uff0c\u4e0d\u9891\u7e41\u8bbf\u95ee S3 Standard-IA \u8bbf\u95ee\uff1a\u4e0d\u5e38\u8bbf\u95ee \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1030029/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f: 30\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB \uff08\u5c0f\u4e8e 128 KB\uff0cS3 \u4f1a\u6536\u53d6 128 KB \u7684\u8d39\u7528\uff09 1-3\u4e2a\u6708\u5185\u8fd8\u53ef\u80fd\u8bbf\u95ee\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e S3 \u5355\u533a \u2013 \u4e0d\u9891\u7e41\u8bbf\u95ee S3 One Zone-IA \u8bbf\u95ee\uff1a\u4e0d\u5e38\u8bbf\u95ee\u6570\u636e\uff0c\u6613\u91cd\u6784\u5efa\uff0c \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a1 AZ\uff0c\u6570\u636e\u65e0\u6cd5\u7075\u6d3b\u5730\u5e94\u5bf9\u7531\u4e8e\u5730\u9707\u548c\u6d2a\u6c34\u707e\u5bb3\u800c\u9020\u6210\u53ef\u7528\u533a\u7269\u7406\u4e22\u5931\u7684\u60c5\u51b5\u3002 \u8d77\u7b97: \u00a50.08240232/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a30\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB bam\uff0cvcf\u7b49\u53ef\u518d\u751f\u6570\u636e Amazon S3 Glacier \u5b58\u50a8 S3 Glacier \u8bbf\u95ee\uff1a\u5f52\u6863\u6570\u636e \u5ef6\u8fdf\uff1a\u6062\u590d\u5728\u7ebf\u5ef6\u65f63-5\u5c0f\u65f6 \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.03006/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a 90\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a40KB bcl\uff0c\u81f3\u5c113\u4e2a\u6708\u5185\u4e0d\u4f1a\u518d\u78b0\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e Amazon S3 Glacier Deep Archive \u5b58\u50a8 S3 Glacier Deep Archive \u8bbf\u95ee\uff1a\u6df1\u5ea6\u5f52\u6863\u6570\u636e \u5ef6\u8fdf\uff1a\u6062\u590d\u5728\u7ebf\u5ef6\u65f610+\u5c0f\u65f6 \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.01082/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a180\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a 40KB bcl\uff0c\u81f3\u5c11\u534a\u5e74\u5185\u4e0d\u4f1a\u518d\u78b0\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e\uff0c\u76ee\u524d\u5168\u884c\u4e1a\u6700\u4fbf\u5b9c\u3002 \u8fd9\u91cc\uff0c\u6211\u4eec\u9009\u62e9Standard\u5c31\u884c\u4e86\uff0c\u6bd5\u7adf\u597d\u7247\u8fd8\u662f\u8981\u7ecf\u5e38\u62ff\u51fa\u6765\u7ecf\u5e38\u6b23\u8d4f\u6b23\u8d4f\u7684 (x_x)\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \uff0c \u518d\u70b9\u51fb \u4e0a\u4f20 \uff0c\u53ef\u4ee5\u770b\u5230\u5e95\u90e8\u7684\u4e0a\u4f20\u8fdb\u5ea6\u6761\u4e86 Operations 0 In progress 1 Success 0 Error , \u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u3002 web\u754c\u9762\u4eceS3\u4e0b\u8f7d\u6570\u636e \u4eces3\u4e0b\u8f7d\u6570\u636e\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff0c\u70b9\u51fb\u6587\u4ef6\u540d\uff0c\u8fdb\u5165\u5bf9\u8c61\u63cf\u8ff0\u754c\u9762, \u70b9\u51fb \u4e0b\u8f7d \u3002 \u70b9\u51fb \u53e6\u5b58\u4e3a \uff0c\u8df3\u51fa\u5f39\u7a97\uff0c\u53f3\u952e\u70b9\u51fb\u5f39\u7a97\u91cc\u7684\u6587\u4ef6\u540d \u5c0f\u6cfd.avi \uff0c\u70b9\u51fb \u94fe\u63a5\u53e6\u5b58\u4e3a , \u5c31\u53ef\u4ee5\u4fdd\u5b58\u5230\u4e0d\u5bb9\u6613\u88ab\u7238\u7238\u5988\u5988\u53d1\u73b0\u7684\u5730\u65b9\u4e86\u3002 \u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u70b9\u51fb\u5176\u4ed6tab\u770b\u770b\uff0c\u5982 \u5c5e\u6027 \uff0c \u6743\u9650 \uff0c Select from , \u6709\u4e9b\u5df2\u7ecf\u8bb2\u8fc7\uff0c\u6709\u4e9b\u8fd8\u6ca1\u6709\uff0c\u5148\u81ea\u884c\u641c\u7d22\u7406\u89e3\uff0c\u518d\u5728\u7fa4\u91cc\u8ba8\u8bba\u5427~ \u9002\u5408\u4f60\u7684\uff0c\u624d\u662f\u6700\u597d\u7684\u3002","title":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1 - Web \u754c\u9762"},{"location":"blogs/2020-01-29-s3-data-ops/#s3-web","text":"\u5927\u5bb6\u90fd\u77e5\u9053\uff0cs3\u662faws2006\u5e74\u5c31\u63a8\u51fa\u7684\u57fa\u672c\u5b58\u50a8\u670d\u52a1\uff0c\u53ef\u4ee5\u8bf4\u73b0\u5728\u5e02\u9762\u4e0a\u6240\u6709\u7684\u516c\u6709\u4e91\u5b58\u50a8\u90fd\u662f\u5b83\u7684\u6a21\u4eff\u8005\uff0c\u90a3\u4e48\u5b66\u4e60\u5982\u4f55\u5229\u7528S3\u8fd9\u4e2a\u670d\u52a1\u5c31\u975e\u5e38\u91cd\u8981\u4e86\uff0c\u4f5c\u4e3a\u6700\u65e9\u63a8\u51fa\u7684\u4e24\u4e2a\u516c\u6709\u4e91\u670d\u52a1\u4e4b\u4e00\uff08\u53e6\u4e00\u4e2a\u662fEC2\uff09\uff0c\u5b83\u5728\u6574\u4e2a\u516c\u6709\u4e91\u751f\u6001\u4e2d\u7684\u91cd\u8981\u6027\u975e\u5e38\u4e4b\u9ad8\uff0c\u662f\u5f88\u591a\u5176\u4ed6\u7684\u670d\u52a1\u7684\u5e95\u5c42\u652f\u6301\u3002 -- D.C","title":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1 - Web \u754c\u9762"},{"location":"blogs/2020-01-29-s3-data-ops/#webs3","text":"\u767b\u5f55 aws console \uff0c \u641c\u7d22\u680f\u4e2d\u641c\u7d22s3\uff0c\u70b9\u51fb\u8fdb\u5165\u3002 \u70b9\u51fb \u65b0\u5efa\u6876\uff08Create bucket\uff09 \uff0c\u60f3\u597d\u4e00\u4e2a\u7b80\u5355\u6613\u61c2\u7684\u540d\u5b57,\u8fd9\u4e2a\u540d\u5b57\u6700\u597d\u548c\u4f60\u8981\u653e\u7684\u5185\u5bb9\u6709\u5173\u8054\uff0c\u4e00\u76ee\u4e86\u7136\uff0c\u6bd4\u5982\u6211\u7684\u6876\u540d\u53eb lovevideo ,\u7528\u4e8e\u653e\u4e00\u4e9b\u53ef\u4ee5\u53cd\u590d\u9274\u8d4f\u7684\u89c6\u9891\u6587\u4ef6\uff0c\u55ef\u55ef\u3002 \u5199\u5165 \u6876\u540d \uff0c Region \u9ed8\u8ba4\uff0c\u63a5\u7740\u4f1a\u8ba9\u6211\u9009\u62e9\u4e00\u4e2a\u73b0\u6709\u7684\u6876\uff0c\u5e72\u4ec0\u4e48\u5462\uff1f\u5982\u679c\u6211\u613f\u610f\uff0c\u53ef\u4ee5\u628a\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6876\u5c5e\u6027\uff0c\u590d\u5236\u5230\u8fd9\u4e2a\u5373\u5c06\u521b\u5efa\u7684\u65b0\u6876\u4e0a\uff0c\u8282\u7ea6\u65f6\u95f4\u54e6\uff01\u4f46\u662f\u8fd9\u91cc\u6211\u4e0d\u9009\uff0c \u4e0b\u4e00\u6b65 \u3002 \u8fd9\u4e00\u6b65\u5c31\u662f\u505a\u6876\u7684\u4e00\u4e9b\u8bbe\u7f6e\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u90fd\u6709\u54ea\u4e9b\uff1f\u8fd9\u91cc\u6211\u9664\u4e86\u6253\u6807\u7b7e\uff0c\u5176\u4ed6\u90fd\u6ca1\u9009\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u9009\u9879 \u4e2d\u6587\u540d \u89e3\u91ca versioning \u7248\u672c\u63a7\u5236 \u5982\u679c\u9009\u62e9\uff0c\u5c31\u4f1a\u4fdd\u7559\u6bcf\u4e2a\u6587\u4ef6\u7684\u4e0d\u540c\u7248\u672c\uff0c\u6bd4\u5982a\u6587\u4ef6\u8fde\u7eed\u88ab\u8986\u76d6\u4e862\u6b21\uff0c\u90a3\u4e48S3\u4e0a\u5c31\u4f1a\u67093\u4efd\u4e0d\u540c\u7248\u672c\u7684a\u6587\u4ef6\uff0c\u6211\u968f\u65f6\u53ef\u4ee5\u9009\u62e9\u5c06\u73b0\u5728\u7684a\u6587\u4ef6\u6062\u590d\u5230\u54ea\u4e2a\u7248\u672c\uff0c\u9632\u6b62\u8bef\u6539\u8bef\u5220\uff0c\u90a3\u662f\u6781\u597d\u7684\uff0c\u4f46\u662f\u4f1a\u5360\u7528\u5b58\u50a8\u7a7a\u95f4\u54e6~ Server access logging \u670d\u52a1\u5668\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55 \u542f\u7528\u8be5\u670d\u52a1\u4e4b\u540e\uff0caws\u4f1a\u5e2e\u6211\u4eec\u8be6\u7ec6\u8bb0\u5f55\u6211\u4eec\u5728\u65e5\u5e38\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5bf9s3 \u5b58\u50a8\u6876\u63d0\u51fa\u7684\u5404\u79cd\u8bf7\u6c42\uff0c\u65e5\u5fd7\u4f1a\u4fdd\u5b58\u5230\u4e0e\u6e90\u5b58\u50a8\u6876\u76f8\u540c\u7684 AWS \u533a\u57df\u7684\u5b58\u50a8\u6876\u4e2d\u3002\u5bf9\u4e8e\u5927\u591a\u6570\u7684\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\uff0c\u6709log\u65e5\u5fd7\u4f1a\u65b9\u4fbf\u5f88\u591a\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u50a8\u5b58\u4e00\u4e9b\u6bd4\u8f83\u654f\u611f\u7684\u6570\u636e\uff0c\u5b89\u5168\u6027\u548c\u8bbf\u95ee\u6743\u9650\u5ba1\u6838\u65b9\u9762\u7684\u5408\u89c4\u6027\u5c31\u663e\u5f97\u975e\u5e38\u91cd\u8981\u4e86\u3002 \u6bcf\u4e2a\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u90fd\u63d0\u4f9b\u6709\u5173\u5355\u4e2a\u8bbf\u95ee\u8bf7\u6c42\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5982\u8bf7\u6c42\u8005\u3001\u5b58\u50a8\u6876\u540d\u79f0\u3001\u8bf7\u6c42\u65f6\u95f4\u3001\u8bf7\u6c42\u64cd\u4f5c\u3001\u54cd\u5e94\u72b6\u6001\u548c\u9519\u8bef\u4ee3\u7801\uff08\u5982\u679c\u76f8\u5173\uff09\u3002 \u52fe\u9009\u4e4b\u540e\uff1a\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u76ee\u6807\u5b58\u50a8\u6876\uff0c\u7528\u4e8e\u5b58\u653e\u65e5\u5fd7\u6587\u4ef6\uff1b\u8fd8\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u65e5\u5fd7\u5bf9\u8c61\u524d\u7f00\uff0c\u7528\u4e8e\u4ee5\u540e\u66f4\u65b9\u4fbf\u7684\u67e5\u627e\u8fd9\u4e9b\u65e5\u5fd7\u5bf9\u8c61\uff0c\u5982\u6211\u6307\u5b9a\u524d\u7f00\u4e3a logs/ ,\u90a3\u4e48s3\u521b\u5efa\u7684\u6240\u6709\u65e5\u5fd7\u5bf9\u8c61\u90fd\u662f\u4ee5 logs/ \u5f00\u5934\uff0c\u5982 logs/2013-11-01-21-32-16-E568B2907131C0C0 \u5bf9\u5e94\u7684\u683c\u5f0f\u4e3a TargetPrefixYYYY-mm-DD-HH-MM-SS-UniqueString \u5173\u4e8e\u94b1\uff1a\u5f00\u542f\u8fd9\u4e2a\u670d\u52a1\u4e0d\u4f1a\u989d\u5916\u6536\u8d39\uff0c\u4f46\u662f\u4f1a\u4ea7\u751f\u65e5\u5fd7\u6587\u4ef6\u7684S3\u5b58\u50a8\u8d39\u7528\uff0c\u4e00\u822c\u53ef\u4ee5\u5ffd\u7565\u3002 Tags \u6253\u6807\u7b7e \u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\u5566~\u6253\u5c31\u662f\u4e86 Object-level logging \u5bf9\u8c61\u7ea7\u65e5\u5fd7 \u662f\u5426\u542f\u7528\u5bf9\u8c61\u7ea7\u522b\u7684API\u8c03\u7528\u76d1\u63a7\u3002\u5229\u7528\u7684\u662fAWS CloudTrail\u670d\u52a1\uff0c\u6240\u4ee5\u4f1a\u4ea7\u751f\u989d\u5916\u8d39\u7528\u54e6\uff0c \u7a77\u4eba\u70b9\u6211 :-) CloudTrail \u4f1a\u6355\u83b7\u5bf9Amazon S3 \u7684 API \u8c03\u7528\u4e8b\u4ef6\uff0c\u5305\u62ec\u6765\u81ea Amazon S3 \u63a7\u5236\u53f0\u7684\u8c03\u7528\u548c\u5bf9 Amazon S3 API \u7684\u4ee3\u7801\u8c03\u7528\u3002\u5982\u679c\u6253\u52fe\u521b\u5efa\u8ddf\u8e2a\uff0c\u5219\u53ef\u4ee5\u4f7f CloudTrail \u4e8b\u4ef6\u6301\u7eed\u4f20\u9001\u5230 Amazon S3 \u5b58\u50a8\u6876\uff08\u5305\u62ec Amazon S3 \u7684\u4e8b\u4ef6\uff09\u3002\u5982\u679c\u4e0d\u914d\u7f6e\u8ddf\u8e2a\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 CloudTrail \u63a7\u5236\u53f0\u7684 Event history (\u4e8b\u4ef6\u5386\u53f2\u8bb0\u5f55) \u4e2d\u67e5\u770b\u6700\u65b0\u4e8b\u4ef6\u3002 \u901a\u8fc7\u4f7f\u7528 CloudTrail \u6536\u96c6\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u5411 Amazon S3 \u53d1\u51fa\u4e86\u4ec0\u4e48\u8bf7\u6c42\u3001\u53d1\u51fa\u8bf7\u6c42\u7684 IP \u5730\u5740\u3001\u4f55\u4eba\u53d1\u51fa\u7684\u8bf7\u6c42\u3001\u8bf7\u6c42\u7684\u53d1\u51fa\u65f6\u95f4\u4ee5\u53ca\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\uff0c\u7279\u522b\u9002\u7528\u4e8e\u559c\u6b22\u7591\u795e\u7591\u9b3c\u7684\u540c\u5b66\u3002 Default encryption \u9ed8\u8ba4\u52a0\u5bc6 \u4e00\u65e6\u9009\u62e9\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6254\u5230\u8fd9\u4e2a\u6876\u91cc\u7684\u5bf9\u8c61\u90fd\u4f1a\u88ab\u81ea\u52a8\u52a0\u5bc6\u3002 \u63d0\u4f9b\u4e24\u4e2a\u52a0\u5bc6\u9009\u9879: AES-256 \u548c AWS-KMS, \u524d\u8005\u662fS3\u5e2e\u4f60\u52a0\u5bc6\uff0c\u540e\u8005\u662faws\u7684kms\u670d\u52a1\u5e2e\u4f60\u52a0\u5bc6\u3002 Object lock \u5bf9\u8c61\u9501\u5b9a \u987e\u540d\u601d\u4e49\uff0c\u9501\u5b9a\u6876\u548c\u6876\u91cc\u7684\u5bf9\u8c61\uff0c\u9632\u6b62\u88ab\u4fee\u6539\u548c\u5220\u9664\u3002 \u4f7f\u7528\u5b83\u6709\u4e2a\u524d\u63d0\uff0c\u5148\u8981\u5f00\u542f \u7248\u672c\u63a7\u5236 \u3002\u4e00\u65e6\u542f\u7528\uff0c\u653e\u5165\u5176\u4e2d\u7684\u5bf9\u8c61\u5c31\u4f1a\u5728\u4e00\u5b9a\u5468\u671f\u5185\u6216\u65e0\u9650\u671f\u88ab\u9501\u5b9a\uff0c\u800c\u6211\u4eec\u65e0\u6cd5\u5c06\u5176\u5220\u9664\u3002 \u6ee1\u8db3WORM\uff08\u4e00\u6b21\u5199\u5165\uff0c\u591a\u6b21\u8bfb\u53d6\uff09\u5b58\u50a8\u6cd5\u89c4\u8981\u6c42\uff0c\u53ef\u5728\u53d7 SEC 17a-4\u3001CTCC \u548c FINRA \u6cd5\u89c4\u7ea6\u675f\u7684\u73af\u5883\u4e2d\u4f7f\u7528\u3002 \u66f4\u591a\u70b9\u6211 CloudWatch request metrics CloudWatch\u76d1\u63a7\u8bf7\u6c42\u6307\u6807 \u4f7f\u7528CloudWatch\u6765\u76d1\u63a7S3\u7684\u8bf7\u6c42\u6307\u6807\uff0c\u6bcf\u5206\u949f\u66f4\u65b0\u4e00\u6b21\uff0c\u9488\u5bf9\u5f02\u5e38\u6307\u6807\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u8b66\u62a5\uff0c\u548c\u81ea\u52a8\u5904\u7406\u63aa\u65bd\uff08\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff09\u3002 \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8fc7\u6ee4\u6761\u4ef6\u6765\u76d1\u63a7\u7279\u5b9a\u524d\u7f00\u6216\u6807\u7b7e\u7684\u5bf9\u8c61\u3002 \u8bf7\u6c42\u6307\u6807\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aAllRequests\uff0cGetRequests\uff0cPutRequests\uff0cDeleteRequests ... \u63a5\u4e0b\u6765\u5c31\u662f\u5b89\u5168\u6027\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u65b0\u5efa\u7684\u6876\u662f\u5bf9\u6240\u6709\u516c\u5f00\u8bbf\u95ee\u90fd\u62d2\u7edd\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 Review \u4e00\u904d\u6ca1\u95ee\u9898\uff0c\u70b9\u51fb\u521b\u5efa\uff0cdeng~deng~deng\uff01deng\uff01\u6211\u7684\u7231\u60c5\u52a8\u4f5c\u7247\u7ec8\u4e8e\u6709\u4e00\u4e2a\u5bb6\u4e86\uff01 \u70b9\u51fb\u6876\u540d lovevideo \u8fdb\u53bb\uff0c\u5565\u90fd\u6ca1\u6709\uff0c\u8d76\u7d27\u4f20\u70b9\u4e1c\u897f\u8fdb\u53bb\uff01\u70b9\u51fb Upload \u4e0a\u4f20\u6587\u4ef6\uff0c\u6216\u8005 \u521b\u5efa\u6587\u4ef6\u5939 \u6765\u7ed9\u6211\u7684\u6587\u4ef6\u5206\u5206\u7c7b\uff0c\u6bd4\u5982\u65e5\u672c\uff0c\u97e9\u56fd\uff0c\u5927\u9646\uff0c\u53f0\u6e7e\uff0c\u7f8e\u56fd\uff0c\u6cf0\u56fd\u3002\u3002\u3002 \u70b9\u51fb Upload \u4e4b\u540e\uff0c\u5c31\u4f1a\u51fa\u73b0\u5f39\u7a97\uff0c\u9009\u62e9\u597d\u6587\u4ef6\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4fdd\u6301\u9ed8\u8ba4\u8bbe\u7f6e\u76f4\u63a5\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684 Upload \uff0c\u6216\u662f\u70b9\u51fb \u4e0b\u4e00\u6b65 \uff0c\u8bbe\u7f6e\u6743\u9650\u3002 Manage Users : \u8bbe\u7f6e\u62e5\u6709\u8005\u6743\u9650\uff1b Access for other AWS account \uff1a \u8bbe\u7f6e\u5176\u4ed6aws\u8d26\u53f7\u80fd\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u505a\u4ec0\u4e48\u3002\u6bd4\u5982\u8bf4\u6709\u4e00\u90e8\u65b0\u51fa\u7684\u5c9b\u56fd\u52a8\u4f5c\u7247\u5f88\u597d\u770b\uff0c\u6211\u5c31\u53ef\u4ee5\u628a\u5b83\u5206\u4eab\u7ed9\u4f60\u7684aws\u8d26\u53f7\u4e86\u3002\uff08\u8fd9\u91cc\u5148\u57cb\u4e2a\u5751\uff0c\u4e8b\u5b9e\u4e0a\u6ca1\u8fd9\u4e48\u7b80\u5355\uff0c\u8fd8\u8bb0\u5f97public block\u90a3\u4e2a\u6743\u9650\u4e48\uff09 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u79cdweb\u754c\u9762\u7684\u4e0a\u4f20\u65b9\u5f0f\u4e00\u822c\u9488\u5bf9\u7684\u662f\u5c0f\u6587\u4ef6\uff0c\u5355\u4e2a\u6700\u5927\u6587\u4ef6\u662f5GB\u3002\u4e00\u822c\u6765\u8bf4\uff0caws\u63a8\u8350\u4e0a\u4f20\u5927\u4e8e100MB\u5c31\u8981\u8003\u8651\u4e0a \u5206\u6bb5\u4e0a\u4f20 \u4e86\u3002\uff08 \u5206\u6bb5\u4e0a\u4f20API \uff09 \u5206\u6bb5\u4e0a\u4f20\u7684\u597d\u5904\u662f\uff0c\u901a\u8fc7\u628a\u6587\u4ef6\u5207\u7247\uff0c\u5206\u6bb5\u8fdb\u884c\u4e0a\u4f20\uff0c\u63d0\u9ad8\u4e86\u541e\u5410\u91cf\u7684\u540c\u65f6\uff0c\u4e5f\u80fd\u4ece\u4efb\u4f55\u7f51\u7edc\u95ee\u9898\u4e2d\u5feb\u901f\u6062\u590d\uff0c\u8fd8\u6709\u4e00\u70b9\u6bd4\u8f83\u6709\u610f\u601d\uff0c\u5c31\u662f\u53ef\u4ee5\u5728\u6211\u4e0d\u77e5\u9053\u6587\u4ef6\u5927\u5c0f\u7684\u65f6\u5019\u5c31\u5f00\u59cb\u4e0a\u4f20\uff0c\u600e\u4e48\u7406\u89e3\uff1f\u6211\u53ef\u4ee5\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u5c31\u540c\u65f6\u628a\u5b83\u4e0a\u4f20\uff0c\u6709\u70b9\u70e7\u8111\uff0c\u540c\u5b66\u4eec\u81ea\u5df1\u4f53\u4f1a\u4e0b\u3002 \u8bbe\u7f6e\u5b58\u50a8\u5c5e\u6027\uff0c\u4ece\u9009\u9879\u6211\u4eec\u53ef\u4ee5\u770b\u5230aws\u63d0\u4f9b7\u79cd\u5b58\u50a8\u6a21\u5f0f\uff0c\u5e38\u7528\u7684\u4e00\u822c\u662f\u524d6\u79cd\uff0c\u4e1a\u754c\u6700\u591a\u4e86\u3002\u4ece\u4e0b\u8868\u53ef\u4ee5\u770b\u5230aws\u7684\u786e\u662f\u4e1a\u754c\u826f\u5fc3\uff0c\u9664\u4e86 S3 \u5355\u533a \u4e4b\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u9ed8\u8ba43\u4e2a\u4ee5\u4e0a\u7684\u53ef\u7528\u533a\u5907\u4efd\uff0c\u8fd9\u6837\u5c31\u628a\u6570\u636e\u4e22\u5931\u7684\u6982\u7387\u964d\u5230\u6781\u4f4e\uff0c\u76f8\u6bd4\u5f88\u591a\u540c\u884c\u4e70\u4e2a\u673a\u623f\u5165\u7f51\u5c31\u5bf9\u5916\u8bf4\u662f\u53ef\u7528\u533a\u5f3a\u592a\u591a\u4e86\u3002\u8fd8\u6709\u4e00\u70b9\u5c31\u662f\u4ef7\u683c\uff0c\u56fd\u5185\u51e0\u5bb6\u4e91\u5546\u6211\u4e5f\u7528\u8fc7\uff0c\u5b98\u7f51\u865a\u6807\u7684\u4ef7\u683c\u7b80\u76f4\u6ca1\u6cd5\u53c2\u8003\uff0c\u56e0\u4e3a\u79c1\u4e0b\u91cc\u6253\u6298\u592a\u5389\u5bb3\uff0caws\u8fd9\u70b9\u505a\u5f97\u4e0d\u9519\uff0c\u660e\u7801\u6807\u4ef7\uff0c\u6211\u53ef\u4ee5\u76f4\u63a5\u62ff\u8fc7\u6765\u7ed9\u516c\u53f8\u505a\u4e2a\u4e09\u5e74\u7684\u9884\u7b97\u3002 \u5c5e\u6027 \u89e3\u91ca \u6bd4\u5982 S3 \u6807\u51c6\u5b58\u50a8(\u5b81\u590f\u4e3a\u4f8b\uff09 S3 Standard \u8bbf\u95ee\uff1a\u6d3b\u52a8\uff0c\u9891\u7e41\u8bbf\u95ee \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1629/GB \u5f85\u5206\u6790\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e S3 \u667a\u80fd\u5206\u5c42\u5b58\u50a8 S3 Intelligent-Tiering \u8bbf\u95ee\uff1a\u8bbf\u95ee\u9891\u7387\u53ef\u53d8 \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1030029/GB \u81f3 \u00a50.1629/GB \u9010\u5bf9\u8c61\u76d1\u63a7\u8ba1\u8d39\uff1a\u8fde\u7eed 30 \u5929\u672a\u8bbf\u95ee\u7684\u5bf9\u8c61\u79fb\u81f3\u4e0d\u9891\u7e41\u8bbf\u95ee\u5c42\uff0c\u4e00\u65e6\u88ab\u8bbf\u95ee\u53c8\u79fb\u56de\u9891\u7e41\u8bbf\u95ee\u5c42 \u6700\u5c0f\u5b58\u50a8\u671f\u9650\uff1a30\u5929 (\u6ca1\u5b58\u6ee130\u5929\u5c31\u5220\u9664\uff0c\u6536\u53d630\u5929\u7684\u8d39\u7528\uff0c\u8003\u8651\u597d\u54e6\uff01) \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB\uff08\u5c0f\u4e8e128KB \u59cb\u7ec8\u653e\u5728\u9891\u7e41\u8bbf\u95ee\u5c42\uff09 \u61d2\u4eba\u6a21\u5f0f\uff0c\u4e0d\u786e\u5b9a1-3\u4e2a\u6708\u4f1a\u4e0d\u4f1a\u5206\u6790\u7684bam\uff0cvcf\u7b49\u6570\u636e S3 \u6807\u51c6\u5b58\u50a8\uff0c\u4e0d\u9891\u7e41\u8bbf\u95ee S3 Standard-IA \u8bbf\u95ee\uff1a\u4e0d\u5e38\u8bbf\u95ee \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.1030029/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f: 30\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB \uff08\u5c0f\u4e8e 128 KB\uff0cS3 \u4f1a\u6536\u53d6 128 KB \u7684\u8d39\u7528\uff09 1-3\u4e2a\u6708\u5185\u8fd8\u53ef\u80fd\u8bbf\u95ee\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e S3 \u5355\u533a \u2013 \u4e0d\u9891\u7e41\u8bbf\u95ee S3 One Zone-IA \u8bbf\u95ee\uff1a\u4e0d\u5e38\u8bbf\u95ee\u6570\u636e\uff0c\u6613\u91cd\u6784\u5efa\uff0c \u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7\u8bbf\u95ee \u5907\u4efd\uff1a1 AZ\uff0c\u6570\u636e\u65e0\u6cd5\u7075\u6d3b\u5730\u5e94\u5bf9\u7531\u4e8e\u5730\u9707\u548c\u6d2a\u6c34\u707e\u5bb3\u800c\u9020\u6210\u53ef\u7528\u533a\u7269\u7406\u4e22\u5931\u7684\u60c5\u51b5\u3002 \u8d77\u7b97: \u00a50.08240232/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a30\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a128KB bam\uff0cvcf\u7b49\u53ef\u518d\u751f\u6570\u636e Amazon S3 Glacier \u5b58\u50a8 S3 Glacier \u8bbf\u95ee\uff1a\u5f52\u6863\u6570\u636e \u5ef6\u8fdf\uff1a\u6062\u590d\u5728\u7ebf\u5ef6\u65f63-5\u5c0f\u65f6 \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.03006/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a 90\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a40KB bcl\uff0c\u81f3\u5c113\u4e2a\u6708\u5185\u4e0d\u4f1a\u518d\u78b0\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e Amazon S3 Glacier Deep Archive \u5b58\u50a8 S3 Glacier Deep Archive \u8bbf\u95ee\uff1a\u6df1\u5ea6\u5f52\u6863\u6570\u636e \u5ef6\u8fdf\uff1a\u6062\u590d\u5728\u7ebf\u5ef6\u65f610+\u5c0f\u65f6 \u5907\u4efd\uff1a\u2265 3 AZ \u8d77\u7b97: \u00a50.01082/GB \u6570\u636e\u83b7\u53d6\u6309GB\u8ba1\u8d39 \u6700\u5c0f\u5b58\u50a8\u65f6\u957f\uff1a180\u5929 \u6700\u5c0f\u5bf9\u8c61\u5927\u5c0f\uff1a 40KB bcl\uff0c\u81f3\u5c11\u534a\u5e74\u5185\u4e0d\u4f1a\u518d\u78b0\u7684fastq\uff0cbam\uff0cvcf\u7b49\u6570\u636e\uff0c\u76ee\u524d\u5168\u884c\u4e1a\u6700\u4fbf\u5b9c\u3002 \u8fd9\u91cc\uff0c\u6211\u4eec\u9009\u62e9Standard\u5c31\u884c\u4e86\uff0c\u6bd5\u7adf\u597d\u7247\u8fd8\u662f\u8981\u7ecf\u5e38\u62ff\u51fa\u6765\u7ecf\u5e38\u6b23\u8d4f\u6b23\u8d4f\u7684 (x_x)\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \uff0c \u518d\u70b9\u51fb \u4e0a\u4f20 \uff0c\u53ef\u4ee5\u770b\u5230\u5e95\u90e8\u7684\u4e0a\u4f20\u8fdb\u5ea6\u6761\u4e86 Operations 0 In progress 1 Success 0 Error , \u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u3002","title":"web\u754c\u9762\u4e0a\u4f20\u6570\u636e\u5230s3"},{"location":"blogs/2020-01-29-s3-data-ops/#webs3_1","text":"\u4eces3\u4e0b\u8f7d\u6570\u636e\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff0c\u70b9\u51fb\u6587\u4ef6\u540d\uff0c\u8fdb\u5165\u5bf9\u8c61\u63cf\u8ff0\u754c\u9762, \u70b9\u51fb \u4e0b\u8f7d \u3002 \u70b9\u51fb \u53e6\u5b58\u4e3a \uff0c\u8df3\u51fa\u5f39\u7a97\uff0c\u53f3\u952e\u70b9\u51fb\u5f39\u7a97\u91cc\u7684\u6587\u4ef6\u540d \u5c0f\u6cfd.avi \uff0c\u70b9\u51fb \u94fe\u63a5\u53e6\u5b58\u4e3a , \u5c31\u53ef\u4ee5\u4fdd\u5b58\u5230\u4e0d\u5bb9\u6613\u88ab\u7238\u7238\u5988\u5988\u53d1\u73b0\u7684\u5730\u65b9\u4e86\u3002 \u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u70b9\u51fb\u5176\u4ed6tab\u770b\u770b\uff0c\u5982 \u5c5e\u6027 \uff0c \u6743\u9650 \uff0c Select from , \u6709\u4e9b\u5df2\u7ecf\u8bb2\u8fc7\uff0c\u6709\u4e9b\u8fd8\u6ca1\u6709\uff0c\u5148\u81ea\u884c\u641c\u7d22\u7406\u89e3\uff0c\u518d\u5728\u7fa4\u91cc\u8ba8\u8bba\u5427~ \u9002\u5408\u4f60\u7684\uff0c\u624d\u662f\u6700\u597d\u7684\u3002","title":"web\u754c\u9762\u4eceS3\u4e0b\u8f7d\u6570\u636e"},{"location":"blogs/2020-01-31-efs-user-guide-101/","text":"\u795e\u5668EFS\u6765\u5566\uff01\u51e0\u5206\u949f\u62e5\u6709\u4e00\u4e2a\u5f39\u6027\u5171\u4eab\u5b58\u50a8\uff01 \u524d\u4e0d\u4e45\uff0caws\u4e2d\u56fd\u533a\u57df\u7ec8\u4e8e\u843d\u5730\u4e86EFS\u670d\u52a1\uff0c\u771f\u53ef\u8c13\u662f\u5343\u547c\u4e07\u5524\u59cb\u51fa\u6765\u554a\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u670d\u52a1\u8fd9\u4e48\u7275\u52a8\u4eba\u5fc3\u5462\uff1f\u5176\u5b9e\u554a\u8fd9\u662f\u7531\u54b1\u4eec\u5b9e\u9645\u7684\u4f7f\u7528\u9700\u6c42\u51b3\u5b9a\u7684\uff0c\u5728\u8fd9\u4e2a\u670d\u52a1\u6ca1\u6709\u51fa\u6765\u4e4b\u524d\uff0c\u6211\u4eec\u505a\u751f\u4fe1\u5206\u6790\u7ec4\u5efa\u4e91\u7aef\u96c6\u7fa4\uff0c\u57fa\u672c\u90fd\u662f\u7528EBS\u5377\u6765\u505aNFS\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b9e\u73b0\u591a\u53f0EC2\u4e4b\u95f4\u7684\u5171\u4eab\u8bfb\u5199\uff0c\u8fd9\u79cd\u65b9\u5f0f\u548c\u672c\u5730\u662f\u4e00\u6837\u4e00\u6837\u7684\uff0c\u4f46\u662f\u5df2\u7ecf\u4e0a\u4e91\u7684\u5148\u884c\u8005\u4eec\uff0c\u4ed6\u4eec\u7684\u601d\u7ef4\u65b9\u5f0f\u5df2\u7ecf\u53d1\u751f\u4e86\u5de8\u5927\u7684\u8f6c\u53d8\uff0c\u6bd5\u7adf\u4e91\u4e0a\u7684\u6bcf\u4e2a\u5360\u7528\u7684\u8d44\u6e90\u90fd\u662f\u8981\u4ed8\u8d39\u7684\u561b~\u4e3e\u4f8b\u6765\u8bf4\uff0c\u7528EBS\u7ec4\u5efa\u7684\u4e8610T\u7684NFS\u7cfb\u7edf\uff0c\u54ea\u6015\u6211\u91cc\u9762\u653e\u7684\u6587\u4ef6\u53ea\u5360\u7528\u4e8610G\uff0c\u6536\u8d39\u53ef\u8fd8\u662f\u6309\u716710T\u6765\u6536\uff1b\u5982\u679c\u6211\u5b9e\u9645\u5360\u7528\u8d85\u8fc7\u4e8610T\uff0c\u6211\u8fd8\u8981\u53bb\u8c03\u6574EBS\u5171\u4eab\u5b58\u50a8\u7684\u5927\u5c0f\uff0c\u7740\u5b9e\u4e0d\u592a\u65b9\u4fbf\uff0c\u8fd9\u4e00\u70b9\u4e5f\u4e0d\u7b26\u5408\u4e91\u7aef\u7075\u6d3b\u7684\u7279\u70b9\u561b\uff01 \u90a3\u6709\u6ca1\u6709\u4e00\u79cd\u5171\u4eab\u5b58\u50a8\u65b9\u6848\u7c7b\u4f3cS3\u670d\u52a1\uff0c\u662f\u6309\u7167\u6211\u5b9e\u9645\u5360\u7528\u7684\u7a7a\u95f4\u6536\u8d39\uff0c\u800c\u4e14\u5728\u6211\u5360\u7528\u589e\u5927\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u6269\u5bb9\u5462\uff1f\u5bf9\u4e86\uff0cEFS\u5c31\u80fd\u6ee1\u8db3\u4f60\u7684\u8fd9\u4e2a\u9700\u6c42\u3002 --D.C \u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u770b\u5b8c\u539f\u7406\u56fe\uff0c\u6211\u4eec\u76f4\u63a5\u63d2\u5165\u6b63\u9898\u3002 \u521b\u5efaefs\u6587\u4ef6\u7cfb\u7edf\u3002 \u767b\u5f55aws console\uff0c\u641c\u7d22efs\uff0c\u70b9\u51fb\u767b\u5f55\u3002\uff08\u5b81\u590f\u533a\u4e3a\u4f8b\uff09 \u5728efs\u63a7\u5236\u53f0\u91cc\uff0c\u70b9\u51fb Create file system \u3002 \u8fd9\u4e2a\u65f6\u5019\u51fa\u6765\u4e00\u4e2a\u914d\u7f6e\u754c\u9762\uff0c\u7528\u4e8e\u6307\u5b9a\u6211\u4eec\u7684EC2\u5b9e\u4f8b\u6240\u5728\u7684VPC\uff08\u4e00\u822c\u662f\u9ed8\u8ba4\uff09\uff0c\u4ee5\u53ca\u5728\u5404\u4e2a\u53ef\u7528\u533a\u7684\u5b50\u7f51\u5185\u521b\u5efa\u4e00\u4e2amount target\uff0c\u4ee5\u4fbf\u5728\u540c\u4e00\u4e2aVPC\u5185\u7684\u4e0d\u540c\u53ef\u7528\u533a\u7684EC2\u90fd\u80fd\u591fmount\u5230\u8fd9\u5757EFS\u4e0a\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u63a5\u4e0b\u6765\u662f\u8bbe\u7f6eefs\u81ea\u5df1\uff0c \u6253\u6807\u7b7e \u5c31\u4e0d\u7528\u591a\u8bf4\u4e86\uff0c \u542f\u7528\u751f\u547d\u5468\u671f\u7ba1\u7406 \u8fd9\u4e2a\u662f\u548c\u94b1\u6709\u5173\u7684\uff0c\u5404\u4f4d\u8981\u7ad6\u8d77\u8033\u6735\uff0c\u4e0d\u5bf9\uff0c\u662f\u77aa\u5927\u773c\u775b\u770b\u54e6\uff0c\u63d0\u4f9b\u7684\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u62107-14-30-60-90\u5929\u4e0d\u78b0\u7684\u6570\u636e\uff0c\u81ea\u52a8\u5e2e\u4f60\u653e\u5230EFS\u975e\u9891\u7e41\u8bbf\u95ee\u5c42\uff0c\u964d\u4f4e\u4f60\u7684\u6210\u672c\uff01\u5b98\u65b9\u8bf4\u7528\u5f97\u597d\uff0c\u6700\u9ad8\u53ef\u4ee5\u770192%\u7684\u8d39\u7528~ \u5176\u4ed6\u9009\u9879\u5206\u522b\u662f\uff1a\u8bbe\u7f6e \u541e\u5410\u6a21\u5f0f \uff0c \u6027\u80fd\u6a21\u5f0f \uff0c \u662f\u5426\u52a0\u5bc6 \uff0c\u4fdd\u6301\u9ed8\u8ba4\u7684\u591f\u7528\u4e86\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u8fd9\u4e00\u6b65\u662f\u5b89\u5168\u6027\u8bbe\u7f6e\uff0c\u9009\u62e9policy\u6216\u662fJSON\u683c\u5f0f\u5199\uff0c\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef\u3002\u8fd8\u6709\u4e00\u9879\u662f Access Points , \u4e2d\u6587\u53eb\u8bbf\u95ee\u70b9\uff0c\u8fd9\u662f\u4e13\u95e8\u9488\u5bf9\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95eeefs\u800c\u8bbe\u5b9a\uff0c\u7528\u4e8e\u7ba1\u7406\u8bf8\u591a\u5e94\u7528\u7a0b\u5e8f\u5bf9efs\u7684\u8bbf\u95ee\u3002\uff0c\u8bbf\u95ee\u70b9\u53ef\u4ee5\u4e3a\u901a\u8fc7\u8bbf\u95ee\u70b9\u53d1\u51fa\u7684\u6240\u6709\u6587\u4ef6\u7cfb\u7edf\u8bf7\u6c42\u5f3a\u5236\u6267\u884c\u7528\u6237\u8ba4\u8bc1\uff08\u5305\u62ec\u7528\u6237POSIX\u7ec4\uff09\u3002\u8bbf\u95ee\u70b9\u8fd8\u53ef\u4ee5\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5f3a\u5236\u6267\u884c\u4e0d\u540c\u7684\u6839\u76ee\u5f55\uff0c\u8fd9\u6837\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u5c31\u53ea\u80fd\u8bbf\u95ee\u6307\u5b9a\u76ee\u5f55\u6216\u5b50\u76ee\u5f55\u4e2d\u7684\u6570\u636e\u3002\u8fd9\u662f\u4e2a\u8fdb\u9636\u529f\u80fd\uff0c\u4e0d\u9002\u5408\u672c\u6587\u7684\u6c14\u8d28\uff0c\u540e\u9762\u5f00\u4e13\u8d34\u8ba8\u8bba\u3002 \u8fd9\u4e00\u6b65\u6211\u90fd\u4fdd\u6301\u9ed8\u8ba4\uff0c\u76f4\u63a5\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u9ed8\u8ba4\u7684JSON\u683c\u5f0f\u5b89\u5168\u7b56\u7565\uff1a { \"Version\": \"2012-10-17\", \"Id\": \"efs-policy-wizard-fc436d5f-a87f-4bef-b11b-3a34e7ec2dc3\", \"Statement\": [ { \"Sid\": \"efs-statement-53841e56-22be-4606-ad44-fb25a8a062b6\", \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"*\" }, \"Action\": [ \"elasticfilesystem:ClientMount\", \"elasticfilesystem:ClientWrite\", \"elasticfilesystem:ClientRootAccess\" ] } ] } \u770b\u4e00\u773c\uff0c\u70b9\u51fb Create File System \u3002\u968f\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u3002\u9009\u4e2d\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u770b\u5230\u8be6\u60c5\u3002 \u7528EC2\u5b9e\u4f8b\u8fde\u63a5EFS \u70b9\u51fbefs\u8be6\u60c5\u9875\u4e2d\u7684 Amazon EC2 mount instructions (from local VPC) ,\u5f39\u7a97\u91cc\u6709\u8be6\u7ec6\u7684\u8bf4\u660e\u3002 \u53e6\u5916\u6253\u5f00\u4e00\u4e2aEC2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u4e2d\u4e00\u53f0\u6211\u4eec\u8981\u8fde\u63a5\u7684EC2\uff0c\u6309\u56fe\u4e2d\u6240\u793a\uff0c\u66f4\u6539\u5b83\u7684\u5b89\u5168\u7ec4\u8bbe\u7f6e\uff0c\u6211\u7684\u8fd9\u53f0EC2\u5b89\u5168\u7ec4\u4e3a launch-wizard-1 ,\u6211\u8fd8\u9700\u8981\u628a default \u8fd9\u4e2a\u5b89\u5168\u7ec4\u9009\u4e2d\uff0c\u70b9\u51fb Assign Security Groups \u3002 \u5982\u679c\u6709\u5176\u4ed6EC2\u4e5f\u9700\u8981\u8fde\u63a5\u5230\u8fd9\u4e2aefs\uff0c\u76f8\u540c\u64cd\u4f5c\u3002\u968f\u540e\u6211\u4eec\u767b\u9646EC2\u673a\u5668\uff0c\u8fdb\u884c\u547d\u4ee4\u884c\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u8d34\u51fa\u6211\u7684\u547d\u4ee4\u4f9b\u5927\u5bb6\u53c2\u8003\u3002 $ sudo yum install -y amazon-efs-utils $ sudo mkdir efs $ sudo mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport fs-38fd1cdd.efs.cn-northwest-1.amazonaws.com.cn:/ efs # check disk $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 484M 64K 484M 1% /dev tmpfs 493M 0 493M 0% /dev/shm /dev/xvda1 50G 6.4G 43G 13% / fs-38fd1cdd.efs.cn-northwest-1.amazonaws.com.cn:/ 8.0E 0 8.0E 0% /home/ec2-user/efs # \u8bd5\u7740\u5728EFS\u521b\u5efa\u4e00\u4e2a1GiB\u7684\u6587\u4ef6 $ sudo dd if=/dev/zero of=~/efs/1GiB bs=1M count=1024 status=progress $ cd /efs $ ls -lh total 1.0G -rw-r--r-- 1 root root 1.0G Jan 31 10:58 1GiB \u77a7\uff0c\u6211\u7684EC2\u7ec8\u4e8e\u9e1f\u67aa\u6362\u70ae\uff0c\u7528\u4e0a\u4e86\u5f39\u6027\u4f38\u7f29\u7684\u5171\u4eab\u6587\u4ef6\u7cfb\u7edfEFS\uff0c\u518d\u4e5f\u4e0d\u7528\u7b97\u6211\u7684EBS\u8be5\u8bbe\u591a\u5927\u4e86\uff01\uff08\u5176\u4ed6EC2\u7684\u6302\u8f7d\u8bbe\u7f6e\u540c\u4e0a\uff09 PS: \u5728\u521b\u5efa\u5b8c1GiB\u7684\u6587\u4ef6\u4ee5\u540e\uff0cEFS\u7684\u5927\u5c0f\u4e5f\u4f1a\u968f\u4e4b\u66f4\u65b0\uff0c\u53cd\u6620\u5230\u754c\u9762\u4e0a\u6709\u4e00\u4e22\u4e22\u7684\u5ef6\u65f6\u3002 \u9ed1\u6697\u4e0d\u662f\u6ca1\u6709\u5149\uff0c\u53ea\u662f\u9c9c\u6709\u4eba\u770b\u89c1\u3002","title":"\u795e\u5668EFS\u6765\u5566\uff01\u51e0\u5206\u949f\u62e5\u6709\u4e00\u4e2a\u5f39\u6027\u5171\u4eab\u5b58\u50a8\uff01"},{"location":"blogs/2020-01-31-efs-user-guide-101/#efs","text":"\u524d\u4e0d\u4e45\uff0caws\u4e2d\u56fd\u533a\u57df\u7ec8\u4e8e\u843d\u5730\u4e86EFS\u670d\u52a1\uff0c\u771f\u53ef\u8c13\u662f\u5343\u547c\u4e07\u5524\u59cb\u51fa\u6765\u554a\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u670d\u52a1\u8fd9\u4e48\u7275\u52a8\u4eba\u5fc3\u5462\uff1f\u5176\u5b9e\u554a\u8fd9\u662f\u7531\u54b1\u4eec\u5b9e\u9645\u7684\u4f7f\u7528\u9700\u6c42\u51b3\u5b9a\u7684\uff0c\u5728\u8fd9\u4e2a\u670d\u52a1\u6ca1\u6709\u51fa\u6765\u4e4b\u524d\uff0c\u6211\u4eec\u505a\u751f\u4fe1\u5206\u6790\u7ec4\u5efa\u4e91\u7aef\u96c6\u7fa4\uff0c\u57fa\u672c\u90fd\u662f\u7528EBS\u5377\u6765\u505aNFS\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b9e\u73b0\u591a\u53f0EC2\u4e4b\u95f4\u7684\u5171\u4eab\u8bfb\u5199\uff0c\u8fd9\u79cd\u65b9\u5f0f\u548c\u672c\u5730\u662f\u4e00\u6837\u4e00\u6837\u7684\uff0c\u4f46\u662f\u5df2\u7ecf\u4e0a\u4e91\u7684\u5148\u884c\u8005\u4eec\uff0c\u4ed6\u4eec\u7684\u601d\u7ef4\u65b9\u5f0f\u5df2\u7ecf\u53d1\u751f\u4e86\u5de8\u5927\u7684\u8f6c\u53d8\uff0c\u6bd5\u7adf\u4e91\u4e0a\u7684\u6bcf\u4e2a\u5360\u7528\u7684\u8d44\u6e90\u90fd\u662f\u8981\u4ed8\u8d39\u7684\u561b~\u4e3e\u4f8b\u6765\u8bf4\uff0c\u7528EBS\u7ec4\u5efa\u7684\u4e8610T\u7684NFS\u7cfb\u7edf\uff0c\u54ea\u6015\u6211\u91cc\u9762\u653e\u7684\u6587\u4ef6\u53ea\u5360\u7528\u4e8610G\uff0c\u6536\u8d39\u53ef\u8fd8\u662f\u6309\u716710T\u6765\u6536\uff1b\u5982\u679c\u6211\u5b9e\u9645\u5360\u7528\u8d85\u8fc7\u4e8610T\uff0c\u6211\u8fd8\u8981\u53bb\u8c03\u6574EBS\u5171\u4eab\u5b58\u50a8\u7684\u5927\u5c0f\uff0c\u7740\u5b9e\u4e0d\u592a\u65b9\u4fbf\uff0c\u8fd9\u4e00\u70b9\u4e5f\u4e0d\u7b26\u5408\u4e91\u7aef\u7075\u6d3b\u7684\u7279\u70b9\u561b\uff01 \u90a3\u6709\u6ca1\u6709\u4e00\u79cd\u5171\u4eab\u5b58\u50a8\u65b9\u6848\u7c7b\u4f3cS3\u670d\u52a1\uff0c\u662f\u6309\u7167\u6211\u5b9e\u9645\u5360\u7528\u7684\u7a7a\u95f4\u6536\u8d39\uff0c\u800c\u4e14\u5728\u6211\u5360\u7528\u589e\u5927\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u6269\u5bb9\u5462\uff1f\u5bf9\u4e86\uff0cEFS\u5c31\u80fd\u6ee1\u8db3\u4f60\u7684\u8fd9\u4e2a\u9700\u6c42\u3002 --D.C \u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u770b\u5b8c\u539f\u7406\u56fe\uff0c\u6211\u4eec\u76f4\u63a5\u63d2\u5165\u6b63\u9898\u3002","title":"\u795e\u5668EFS\u6765\u5566\uff01\u51e0\u5206\u949f\u62e5\u6709\u4e00\u4e2a\u5f39\u6027\u5171\u4eab\u5b58\u50a8\uff01"},{"location":"blogs/2020-01-31-efs-user-guide-101/#efs_1","text":"\u767b\u5f55aws console\uff0c\u641c\u7d22efs\uff0c\u70b9\u51fb\u767b\u5f55\u3002\uff08\u5b81\u590f\u533a\u4e3a\u4f8b\uff09 \u5728efs\u63a7\u5236\u53f0\u91cc\uff0c\u70b9\u51fb Create file system \u3002 \u8fd9\u4e2a\u65f6\u5019\u51fa\u6765\u4e00\u4e2a\u914d\u7f6e\u754c\u9762\uff0c\u7528\u4e8e\u6307\u5b9a\u6211\u4eec\u7684EC2\u5b9e\u4f8b\u6240\u5728\u7684VPC\uff08\u4e00\u822c\u662f\u9ed8\u8ba4\uff09\uff0c\u4ee5\u53ca\u5728\u5404\u4e2a\u53ef\u7528\u533a\u7684\u5b50\u7f51\u5185\u521b\u5efa\u4e00\u4e2amount target\uff0c\u4ee5\u4fbf\u5728\u540c\u4e00\u4e2aVPC\u5185\u7684\u4e0d\u540c\u53ef\u7528\u533a\u7684EC2\u90fd\u80fd\u591fmount\u5230\u8fd9\u5757EFS\u4e0a\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u63a5\u4e0b\u6765\u662f\u8bbe\u7f6eefs\u81ea\u5df1\uff0c \u6253\u6807\u7b7e \u5c31\u4e0d\u7528\u591a\u8bf4\u4e86\uff0c \u542f\u7528\u751f\u547d\u5468\u671f\u7ba1\u7406 \u8fd9\u4e2a\u662f\u548c\u94b1\u6709\u5173\u7684\uff0c\u5404\u4f4d\u8981\u7ad6\u8d77\u8033\u6735\uff0c\u4e0d\u5bf9\uff0c\u662f\u77aa\u5927\u773c\u775b\u770b\u54e6\uff0c\u63d0\u4f9b\u7684\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u62107-14-30-60-90\u5929\u4e0d\u78b0\u7684\u6570\u636e\uff0c\u81ea\u52a8\u5e2e\u4f60\u653e\u5230EFS\u975e\u9891\u7e41\u8bbf\u95ee\u5c42\uff0c\u964d\u4f4e\u4f60\u7684\u6210\u672c\uff01\u5b98\u65b9\u8bf4\u7528\u5f97\u597d\uff0c\u6700\u9ad8\u53ef\u4ee5\u770192%\u7684\u8d39\u7528~ \u5176\u4ed6\u9009\u9879\u5206\u522b\u662f\uff1a\u8bbe\u7f6e \u541e\u5410\u6a21\u5f0f \uff0c \u6027\u80fd\u6a21\u5f0f \uff0c \u662f\u5426\u52a0\u5bc6 \uff0c\u4fdd\u6301\u9ed8\u8ba4\u7684\u591f\u7528\u4e86\u3002\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u8fd9\u4e00\u6b65\u662f\u5b89\u5168\u6027\u8bbe\u7f6e\uff0c\u9009\u62e9policy\u6216\u662fJSON\u683c\u5f0f\u5199\uff0c\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef\u3002\u8fd8\u6709\u4e00\u9879\u662f Access Points , \u4e2d\u6587\u53eb\u8bbf\u95ee\u70b9\uff0c\u8fd9\u662f\u4e13\u95e8\u9488\u5bf9\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95eeefs\u800c\u8bbe\u5b9a\uff0c\u7528\u4e8e\u7ba1\u7406\u8bf8\u591a\u5e94\u7528\u7a0b\u5e8f\u5bf9efs\u7684\u8bbf\u95ee\u3002\uff0c\u8bbf\u95ee\u70b9\u53ef\u4ee5\u4e3a\u901a\u8fc7\u8bbf\u95ee\u70b9\u53d1\u51fa\u7684\u6240\u6709\u6587\u4ef6\u7cfb\u7edf\u8bf7\u6c42\u5f3a\u5236\u6267\u884c\u7528\u6237\u8ba4\u8bc1\uff08\u5305\u62ec\u7528\u6237POSIX\u7ec4\uff09\u3002\u8bbf\u95ee\u70b9\u8fd8\u53ef\u4ee5\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5f3a\u5236\u6267\u884c\u4e0d\u540c\u7684\u6839\u76ee\u5f55\uff0c\u8fd9\u6837\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u5c31\u53ea\u80fd\u8bbf\u95ee\u6307\u5b9a\u76ee\u5f55\u6216\u5b50\u76ee\u5f55\u4e2d\u7684\u6570\u636e\u3002\u8fd9\u662f\u4e2a\u8fdb\u9636\u529f\u80fd\uff0c\u4e0d\u9002\u5408\u672c\u6587\u7684\u6c14\u8d28\uff0c\u540e\u9762\u5f00\u4e13\u8d34\u8ba8\u8bba\u3002 \u8fd9\u4e00\u6b65\u6211\u90fd\u4fdd\u6301\u9ed8\u8ba4\uff0c\u76f4\u63a5\u70b9\u51fb \u4e0b\u4e00\u6b65 \u3002 \u9ed8\u8ba4\u7684JSON\u683c\u5f0f\u5b89\u5168\u7b56\u7565\uff1a { \"Version\": \"2012-10-17\", \"Id\": \"efs-policy-wizard-fc436d5f-a87f-4bef-b11b-3a34e7ec2dc3\", \"Statement\": [ { \"Sid\": \"efs-statement-53841e56-22be-4606-ad44-fb25a8a062b6\", \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"*\" }, \"Action\": [ \"elasticfilesystem:ClientMount\", \"elasticfilesystem:ClientWrite\", \"elasticfilesystem:ClientRootAccess\" ] } ] } \u770b\u4e00\u773c\uff0c\u70b9\u51fb Create File System \u3002\u968f\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u3002\u9009\u4e2d\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u770b\u5230\u8be6\u60c5\u3002","title":"\u521b\u5efaefs\u6587\u4ef6\u7cfb\u7edf\u3002"},{"location":"blogs/2020-01-31-efs-user-guide-101/#ec2efs","text":"\u70b9\u51fbefs\u8be6\u60c5\u9875\u4e2d\u7684 Amazon EC2 mount instructions (from local VPC) ,\u5f39\u7a97\u91cc\u6709\u8be6\u7ec6\u7684\u8bf4\u660e\u3002 \u53e6\u5916\u6253\u5f00\u4e00\u4e2aEC2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u4e2d\u4e00\u53f0\u6211\u4eec\u8981\u8fde\u63a5\u7684EC2\uff0c\u6309\u56fe\u4e2d\u6240\u793a\uff0c\u66f4\u6539\u5b83\u7684\u5b89\u5168\u7ec4\u8bbe\u7f6e\uff0c\u6211\u7684\u8fd9\u53f0EC2\u5b89\u5168\u7ec4\u4e3a launch-wizard-1 ,\u6211\u8fd8\u9700\u8981\u628a default \u8fd9\u4e2a\u5b89\u5168\u7ec4\u9009\u4e2d\uff0c\u70b9\u51fb Assign Security Groups \u3002 \u5982\u679c\u6709\u5176\u4ed6EC2\u4e5f\u9700\u8981\u8fde\u63a5\u5230\u8fd9\u4e2aefs\uff0c\u76f8\u540c\u64cd\u4f5c\u3002\u968f\u540e\u6211\u4eec\u767b\u9646EC2\u673a\u5668\uff0c\u8fdb\u884c\u547d\u4ee4\u884c\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u8d34\u51fa\u6211\u7684\u547d\u4ee4\u4f9b\u5927\u5bb6\u53c2\u8003\u3002 $ sudo yum install -y amazon-efs-utils $ sudo mkdir efs $ sudo mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport fs-38fd1cdd.efs.cn-northwest-1.amazonaws.com.cn:/ efs # check disk $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 484M 64K 484M 1% /dev tmpfs 493M 0 493M 0% /dev/shm /dev/xvda1 50G 6.4G 43G 13% / fs-38fd1cdd.efs.cn-northwest-1.amazonaws.com.cn:/ 8.0E 0 8.0E 0% /home/ec2-user/efs # \u8bd5\u7740\u5728EFS\u521b\u5efa\u4e00\u4e2a1GiB\u7684\u6587\u4ef6 $ sudo dd if=/dev/zero of=~/efs/1GiB bs=1M count=1024 status=progress $ cd /efs $ ls -lh total 1.0G -rw-r--r-- 1 root root 1.0G Jan 31 10:58 1GiB \u77a7\uff0c\u6211\u7684EC2\u7ec8\u4e8e\u9e1f\u67aa\u6362\u70ae\uff0c\u7528\u4e0a\u4e86\u5f39\u6027\u4f38\u7f29\u7684\u5171\u4eab\u6587\u4ef6\u7cfb\u7edfEFS\uff0c\u518d\u4e5f\u4e0d\u7528\u7b97\u6211\u7684EBS\u8be5\u8bbe\u591a\u5927\u4e86\uff01\uff08\u5176\u4ed6EC2\u7684\u6302\u8f7d\u8bbe\u7f6e\u540c\u4e0a\uff09 PS: \u5728\u521b\u5efa\u5b8c1GiB\u7684\u6587\u4ef6\u4ee5\u540e\uff0cEFS\u7684\u5927\u5c0f\u4e5f\u4f1a\u968f\u4e4b\u66f4\u65b0\uff0c\u53cd\u6620\u5230\u754c\u9762\u4e0a\u6709\u4e00\u4e22\u4e22\u7684\u5ef6\u65f6\u3002 \u9ed1\u6697\u4e0d\u662f\u6ca1\u6709\u5149\uff0c\u53ea\u662f\u9c9c\u6709\u4eba\u770b\u89c1\u3002","title":"\u7528EC2\u5b9e\u4f8b\u8fde\u63a5EFS"},{"location":"blogs/2020-01-31-put-bam-on-s3/","text":"BAM\u6587\u4ef6\u653e\u4e91\u4e0a\u597d\u4e86\uff0c\u672c\u5730IGV\u5f88\u65b9\u4fbf -- Sam \u5e73\u5e38\u600e\u4e48\u7528IGV\u770b\u57fa\u56e0\u7ec4\u6bd4\u5bf9\u56fe\uff1f \u76f8\u4fe1\u5bf9\u4e8e\u505a\u57fa\u56e0\u7ec4\u53d8\u5f02\u5206\u6790\u7684\u4eba\u6765\u8bf4\uff0c\u6bd4\u5bf9\u5b8c\u57fa\u56e0\u7ec4\u540e\u7528 IGV \u67e5\u770b\u6bd4\u5bf9\u60c5\u51b5\uff0c\u4ee5\u53ca\u8089\u773c\u786e\u8ba4 GATK \u7b49\u8f6f\u4ef6\u5206\u6790\u51fa\u6765\u7684\u53d8\u5f02\u7b49\u5de5\u4f5c\u518d\u719f\u6089\u4e0d\u8fc7\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\u4ee5\u524d\u6ca1\u6709\u9002\u7528\u4e91\u7684\u65f6\u5019\uff0c\u6211\u662f\u901a\u8fc7\u81ea\u5df1\u7684\u7535\u8111SSH\u767b\u9646\u5230\u516c\u53f8\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u4e00\u987f\u547d\u4ee4\u884c\u64cd\u4f5c\u5c06FQ\u6587\u4ef6\u5206\u6790\u6210\u6211\u60f3\u8981\u7684BAM\uff0c\u7136\u540e\u8f93\u5165\u547d\u4ee4 java -jar -Xmx4g igv.jar \uff0c\u7535\u8111\u5c31\u4f1a\u4e3a\u6211\u6253\u5f00IGV\u7684\u56fe\u5f62\u754c\u9762\u3002 \u5f53\u7136\uff0c\u7531\u4e8e\u6253\u5f00IGV\u7684\u670d\u52a1\u5668\u662fLinux\u7cfb\u7edf\uff0c\u5176\u4f7f\u7528\u7684\u56fe\u5f62\u754c\u9762\u670d\u52a1\u662fX11\uff0c\u5982\u679c\u4f60\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u591a\u534a\u4f60\u9700\u8981\u5b89\u88c5 Xming \uff0c\u5982\u679c\u662fOSX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u80fd\u4f60\u9700\u8981\u5b89\u88c5 XQuartz \u3002 \u8fd9\u6837\u505a\u4e00\u822c\u6765\u8bf4\u662f\u4e0b\u610f\u8bc6\u5c31\u80fd\u60f3\u5230\u7684\uff0c\u6211\u8fd9\u4e48\u505a\u4e86\u597d\u591a\u5e74\u3002\u4f46\u6709\u4e00\u4e9b\u7f3a\u70b9\uff1a \u9700\u8981\u6709\u4e00\u53f0\u670d\u52a1\u5668\u4e00\u76f4\u5f00\u7740\uff0c\u5c31\u4f1a\u6709\u8d44\u6e90\u6d6a\u8d39\u7684\u53ef\u80fd\u3002\u5bf9\u4e8e\u6709\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u7684\u6765\u8bf4\u4e5f\u6ca1\u4ec0\u4e48\uff0c\u53cd\u6b63\u672c\u6765\u5c31\u4f1a\u6d6a\u8d39\u7684\uff1a\uff09\uff09\uff09\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528\u4e91\u670d\u52a1\u5668\u7684\uff0c\u8fd9\u4e2a\u5f00\u9500\u8fd8\u662f\u633a\u53ef\u89c2\u7684\u3002 X11\u5728Mac\u7535\u8111OSX\u7cfb\u7edf\u4e0a\u7684\u5b98\u65b9\u652f\u6301\u65e9\u5df2\u662f\u8fc7\u53bb\u5f0f\uff0c\u901a\u8fc7XQuartz\u5b9e\u73b0\u8be5\u529f\u80fd\u663e\u5f97\u8fc7\u4e8e\u7e41\u7410\u3002\u6211\u6700\u8fd1\u4e00\u53f0\u65b0\u7535\u8111\u5347\u7ea7\u4e86OSX 10.15\u4e4b\u540e\u8017\u8d39\u4e86\u6211\u5f88\u957f\u65f6\u95f4\uff0c\u6700\u7ec8\u6211\u653e\u5f03\u4e86\uff0c\u56e0\u4e3a\u6211\u4e0d\u60f3\u628a\u6211\u7684\u7535\u8111\u5f04\u5f97\u5f88\u4e71\uff1a\uff09\uff09\uff09 BAM\u6587\u4ef6\u4e00\u822c\u90fd\u6bd4\u8f83\u5927\uff0cPanel\u7684\u6570\u636e\u4e5f\u89811GB\u591a\uff0c\u5168\u57fa\u56e0\u7ec4\u8981\u51e0\u5341\u4e0a\u767eGB\u3002\u8fd9\u4e48\u5927\u7684\u6587\u4ef6\u653e\u5728\u5b58\u50a8\u670d\u52a1\u5668\u4e0a\uff0c\u9ad8\u901f\u5b58\u50a8\u6d6a\u8d39\u8d44\u6e90\uff0c\u4f4e\u901f\u5b58\u50a8\u53cd\u5e94\u53c8\u6162\uff0c\u5bf9\u4e8e\u7ef4\u62a4\u800c\u8a00\u7684\u786e\u6bd4\u8f83\u9ebb\u70e6\u3002 \u6587\u4ef6\u5b58\u50a8\u4e3a\u4ec0\u4e48\u8981\u653e\u5728\u4e91\u4e0a\uff1f \u5f53\u7136\uff0c\u4e91\u4e0d\u662f\u4e07\u80fd\u7684\uff0c\u4e5f\u5b58\u5728\u5f88\u591a\u79cd\u60c5\u51b5\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u66f4\u52a0\u9ad8\u6548\u8282\u7701\u3002 \u5bf9\u4e8e\u751f\u4fe1\u754c\uff0c\u76ee\u524d\u6211\u4e2a\u4eba\u8ba4\u4e3a\u6587\u4ef6\u5b58\u50a8\u653e\u5728\u4e91\u4e0a\u6bd4\u8f83\u5408\u9002\u7684\uff0c\u6211\u7684\u7406\u7531\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a \u653e\u5fc3\u3002\u522b\u7b11\u6211\uff0c\u5982\u679c\u505a\u597d\u4fe1\u606f\u7684\u9694\u79bb\uff0c\u4e91\u4e0a\u7684\u6570\u636e\u662f \u76f8\u5f53 \u5b89\u5168\u7684\u3002\u6211\u4eec\u8981\u5f3a\u8feb\u81ea\u5df1\u7406\u6027\u601d\u7ef4\uff0c\u6bd4\u5982\u4f60\u4e3a\u4ec0\u4e48\u89c9\u5f97\u653e\u5728\u4e91\u4e0a\u4e0d\u5b89\u5168\u3002\u4ece\u6570\u636e\u9690\u79c1\u4fdd\u62a4\u3001\u53ef\u7528\u6027\u7b49\u65b9\u9762\u6765\u770b\uff0c\u6570\u5b57\u53ef\u4ee5\u544a\u8bc9\u6211\u4eec\u5927\u5382\u7684\u4e91\u5b58\u50a8\u6bd4\u7edd\u5927\u591a\u6570\u6570\u636e\u4e2d\u5fc3\u5b89\u5168\u3002 \u7701\u5fc3\u3002\u4e00\u822c\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u90fd\u63d0\u4f9b\u4e86\u591a\u79cd\u89c4\u683c\u3001\u9002\u7528\u591a\u79cd\u5e94\u7528\u573a\u666f\u7684\u5b58\u50a8\u65b9\u6848\u53ca\u4ef7\u683c\uff0c\u8fd9\u6837\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u62e9\u4e0d\u540c\u7684\u5b58\u50a8\u7ea7\u522b\u3002\u4e4b\u524d\u7684\u6587\u7ae0 \u5165\u95e8\u7cfb\u52173 \u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb \u4e2d\u4ee5AWS S3\u4e3a\u4f8b\u5217\u4e3e\u4e86\u6807\u51c6\u3001\u975e\u9891\u7e41\u8bbf\u95ee\u3001\u5f52\u6863\u7b49\u591a\u79cd\u5b58\u50a8\u65b9\u6848\u53ca\u4ef7\u683c\u4f53\u7cfb\u3002 \u8d34\u5fc3\u3002AWS S3\u63d0\u4f9b\u4e86\u4f17\u591a\u6743\u9650\u7ba1\u7406\u3001\u8bbf\u95ee\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8bbe\u5b9a\u4e0d\u540c\u6570\u636e\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u4ee5\u53ca\u5728\u51fa\u95ee\u9898\u7684\u65f6\u5019\u67e5\u627e\u95ee\u9898\u539f\u56e0\u3002 IGV\u80fd\u6253\u5f00\u5b58\u5728S3\u4e0a\u7684BAM\u6587\u4ef6\u5417\uff1f IGV\u5b98\u65b9\u6587\u6863 \u4e0a\u8bf4IGV\u53ef\u4ee5\u8f7d\u5165\u6570\u636e\u7684\u65b9\u5f0f\u6709\u672c\u5730\u6587\u4ef6\u3001HTTP URL\u4ee5\u53caIGV\u6570\u636e\u670d\u52a1\u5668\u3002 \u663e\u7136\uff0cIGV\u76ee\u524d\u4e0d\u652f\u6301S3\u7684\u94fe\u63a5\u3002\u4f46\u5176\u5b9e\u4eceS3\u7684Web\u754c\u9762\u4e0a\u53ef\u4ee5\u8f7b\u677e\u67e5\u5230\u83b7\u53d6\u6587\u4ef6HTTP URL\u7684\u65b9\u5f0f\uff0c\u4e0d\u77e5\u9053\u7684\u8bf7\u8f6c\u9605 \u6b64\u94fe\u63a5 \u4e2d\u6587\u4ef6\u6982\u8ff0\u622a\u56fe\u4e2d\u7684URL\u3002 \u6162\u7740\uff0cS3\u4e0a\u7684\u64cd\u4f5c\u8fd8\u5dee\u4e00\u6b65\u4e86\uff0c\u5982\u679c\u8981\u4eceIGV\u8bbf\u95ee\u8fd8\u9700\u8981\u5f00\u653eS3\u4e0a\u5bf9\u5e94\u6587\u4ef6\u7684\u53ef\u8bfb\u6743\u9650\uff0c\u5982\u4e0b\u56fe\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\u3002 \u4e0a\u56fe\uff1aAWS S3\u4e2d\u5f00\u653e\u6587\u4ef6\u53ef\u8bfb\u6743\u9650 \u7136\u540e\u6253\u5f00\u7535\u8111\u4e0aIGV\uff0c\u6309\u7167 File > Load from URL \u4f9d\u6b21\u70b9\u5f00\u83dc\u5355\uff0c\u5728\u5982\u4e0b\u56fe\u7684\u4e24\u4e2a\u6846\u4e2d\u8f93\u5165BAM\u6587\u4ef6\u4ee5\u53ca\u5bf9\u5e94BAI\u6587\u4ef6\u7684URL\u5c31\u53ef\u4ee5\u8f7b\u677e\u67e5\u770b\u6bd4\u5bf9\u4fe1\u606f\u4eba\u5de5\u786e\u8ba4\u53d8\u5f02\u4e86\u3002 \u4e0a\u56fe\uff1aIGV\u4e2d\u8f7d\u5165URL \u9057\u7559\u95ee\u9898 \u81f3\u6b64\uff0c\u672c\u5730\u6253\u5f00S3\u4e0a\u7684BAM\u6587\u4ef6\u89e3\u51b3\u4e86\uff0c\u4f46\u8fd8\u6709\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\u6ca1\u6709\u5728\u672c\u6587\u4e2d\u4ecb\u7ecd\uff1a \u8fd9\u4e48\u5927\u7684\u6587\u4ef6\u4ece\u7f51\u7edc\u4e0a\u4e0b\u8f7d\uff0c\u4f1a\u4e0d\u4f1a\u7279\u522b\u6162\u554a\uff1f\u4f1a\u4e0d\u4f1a\u6d41\u91cf\u8d39\u7279\u522b\u8d35\u554a\uff1f \u201cMake public\u201d\uff0c\u8ba9\u8be5\u6587\u4ef6\u8bfb\u53d6\u6743\u9650\u66b4\u9732\u5728\u4e92\u8054\u7f51\u4e2d\uff0c\u4efb\u4f55\u62e5\u6709\u8be5\u6743\u9650\u7684\u4eba\u90fd\u53ef\u4ee5\u67e5\u770b\uff0c\u8fd9\u70b9\u80af\u5b9a\u4e0d\u5bf9\u3002 \u5bf9\u4e8eFQ\u3001BAM\u3001VCF\u7b49\u4e0d\u540c\u7c7b\u578b\u6587\u4ef6\u7684\u5b58\u50a8\u65b9\u6848\u662f\u4ec0\u4e48\uff1f\u90fd\u653e\u5728\u6807\u51c6\u5b58\u50a8\u4e2d\u5417\uff1f \u8fd9\u51e0\u4e2a\u95ee\u9898\u6211\u4f1a\u5728\u4eca\u540e\u7684\u6587\u7ae0\u4e2d\u9010\u4e00\u89e3\u91ca\u3002","title":"BAM\u6587\u4ef6\u653e\u4e91\u4e0a\u597d\u4e86\uff0c\u672c\u5730IGV\u5f88\u65b9\u4fbf"},{"location":"blogs/2020-01-31-put-bam-on-s3/#bamigv","text":"-- Sam","title":"BAM\u6587\u4ef6\u653e\u4e91\u4e0a\u597d\u4e86\uff0c\u672c\u5730IGV\u5f88\u65b9\u4fbf"},{"location":"blogs/2020-01-31-put-bam-on-s3/#igv","text":"\u76f8\u4fe1\u5bf9\u4e8e\u505a\u57fa\u56e0\u7ec4\u53d8\u5f02\u5206\u6790\u7684\u4eba\u6765\u8bf4\uff0c\u6bd4\u5bf9\u5b8c\u57fa\u56e0\u7ec4\u540e\u7528 IGV \u67e5\u770b\u6bd4\u5bf9\u60c5\u51b5\uff0c\u4ee5\u53ca\u8089\u773c\u786e\u8ba4 GATK \u7b49\u8f6f\u4ef6\u5206\u6790\u51fa\u6765\u7684\u53d8\u5f02\u7b49\u5de5\u4f5c\u518d\u719f\u6089\u4e0d\u8fc7\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\u4ee5\u524d\u6ca1\u6709\u9002\u7528\u4e91\u7684\u65f6\u5019\uff0c\u6211\u662f\u901a\u8fc7\u81ea\u5df1\u7684\u7535\u8111SSH\u767b\u9646\u5230\u516c\u53f8\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u4e00\u987f\u547d\u4ee4\u884c\u64cd\u4f5c\u5c06FQ\u6587\u4ef6\u5206\u6790\u6210\u6211\u60f3\u8981\u7684BAM\uff0c\u7136\u540e\u8f93\u5165\u547d\u4ee4 java -jar -Xmx4g igv.jar \uff0c\u7535\u8111\u5c31\u4f1a\u4e3a\u6211\u6253\u5f00IGV\u7684\u56fe\u5f62\u754c\u9762\u3002 \u5f53\u7136\uff0c\u7531\u4e8e\u6253\u5f00IGV\u7684\u670d\u52a1\u5668\u662fLinux\u7cfb\u7edf\uff0c\u5176\u4f7f\u7528\u7684\u56fe\u5f62\u754c\u9762\u670d\u52a1\u662fX11\uff0c\u5982\u679c\u4f60\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u591a\u534a\u4f60\u9700\u8981\u5b89\u88c5 Xming \uff0c\u5982\u679c\u662fOSX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u80fd\u4f60\u9700\u8981\u5b89\u88c5 XQuartz \u3002 \u8fd9\u6837\u505a\u4e00\u822c\u6765\u8bf4\u662f\u4e0b\u610f\u8bc6\u5c31\u80fd\u60f3\u5230\u7684\uff0c\u6211\u8fd9\u4e48\u505a\u4e86\u597d\u591a\u5e74\u3002\u4f46\u6709\u4e00\u4e9b\u7f3a\u70b9\uff1a \u9700\u8981\u6709\u4e00\u53f0\u670d\u52a1\u5668\u4e00\u76f4\u5f00\u7740\uff0c\u5c31\u4f1a\u6709\u8d44\u6e90\u6d6a\u8d39\u7684\u53ef\u80fd\u3002\u5bf9\u4e8e\u6709\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u7684\u6765\u8bf4\u4e5f\u6ca1\u4ec0\u4e48\uff0c\u53cd\u6b63\u672c\u6765\u5c31\u4f1a\u6d6a\u8d39\u7684\uff1a\uff09\uff09\uff09\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528\u4e91\u670d\u52a1\u5668\u7684\uff0c\u8fd9\u4e2a\u5f00\u9500\u8fd8\u662f\u633a\u53ef\u89c2\u7684\u3002 X11\u5728Mac\u7535\u8111OSX\u7cfb\u7edf\u4e0a\u7684\u5b98\u65b9\u652f\u6301\u65e9\u5df2\u662f\u8fc7\u53bb\u5f0f\uff0c\u901a\u8fc7XQuartz\u5b9e\u73b0\u8be5\u529f\u80fd\u663e\u5f97\u8fc7\u4e8e\u7e41\u7410\u3002\u6211\u6700\u8fd1\u4e00\u53f0\u65b0\u7535\u8111\u5347\u7ea7\u4e86OSX 10.15\u4e4b\u540e\u8017\u8d39\u4e86\u6211\u5f88\u957f\u65f6\u95f4\uff0c\u6700\u7ec8\u6211\u653e\u5f03\u4e86\uff0c\u56e0\u4e3a\u6211\u4e0d\u60f3\u628a\u6211\u7684\u7535\u8111\u5f04\u5f97\u5f88\u4e71\uff1a\uff09\uff09\uff09 BAM\u6587\u4ef6\u4e00\u822c\u90fd\u6bd4\u8f83\u5927\uff0cPanel\u7684\u6570\u636e\u4e5f\u89811GB\u591a\uff0c\u5168\u57fa\u56e0\u7ec4\u8981\u51e0\u5341\u4e0a\u767eGB\u3002\u8fd9\u4e48\u5927\u7684\u6587\u4ef6\u653e\u5728\u5b58\u50a8\u670d\u52a1\u5668\u4e0a\uff0c\u9ad8\u901f\u5b58\u50a8\u6d6a\u8d39\u8d44\u6e90\uff0c\u4f4e\u901f\u5b58\u50a8\u53cd\u5e94\u53c8\u6162\uff0c\u5bf9\u4e8e\u7ef4\u62a4\u800c\u8a00\u7684\u786e\u6bd4\u8f83\u9ebb\u70e6\u3002","title":"\u5e73\u5e38\u600e\u4e48\u7528IGV\u770b\u57fa\u56e0\u7ec4\u6bd4\u5bf9\u56fe\uff1f"},{"location":"blogs/2020-01-31-put-bam-on-s3/#_1","text":"\u5f53\u7136\uff0c\u4e91\u4e0d\u662f\u4e07\u80fd\u7684\uff0c\u4e5f\u5b58\u5728\u5f88\u591a\u79cd\u60c5\u51b5\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u66f4\u52a0\u9ad8\u6548\u8282\u7701\u3002 \u5bf9\u4e8e\u751f\u4fe1\u754c\uff0c\u76ee\u524d\u6211\u4e2a\u4eba\u8ba4\u4e3a\u6587\u4ef6\u5b58\u50a8\u653e\u5728\u4e91\u4e0a\u6bd4\u8f83\u5408\u9002\u7684\uff0c\u6211\u7684\u7406\u7531\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a \u653e\u5fc3\u3002\u522b\u7b11\u6211\uff0c\u5982\u679c\u505a\u597d\u4fe1\u606f\u7684\u9694\u79bb\uff0c\u4e91\u4e0a\u7684\u6570\u636e\u662f \u76f8\u5f53 \u5b89\u5168\u7684\u3002\u6211\u4eec\u8981\u5f3a\u8feb\u81ea\u5df1\u7406\u6027\u601d\u7ef4\uff0c\u6bd4\u5982\u4f60\u4e3a\u4ec0\u4e48\u89c9\u5f97\u653e\u5728\u4e91\u4e0a\u4e0d\u5b89\u5168\u3002\u4ece\u6570\u636e\u9690\u79c1\u4fdd\u62a4\u3001\u53ef\u7528\u6027\u7b49\u65b9\u9762\u6765\u770b\uff0c\u6570\u5b57\u53ef\u4ee5\u544a\u8bc9\u6211\u4eec\u5927\u5382\u7684\u4e91\u5b58\u50a8\u6bd4\u7edd\u5927\u591a\u6570\u6570\u636e\u4e2d\u5fc3\u5b89\u5168\u3002 \u7701\u5fc3\u3002\u4e00\u822c\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u90fd\u63d0\u4f9b\u4e86\u591a\u79cd\u89c4\u683c\u3001\u9002\u7528\u591a\u79cd\u5e94\u7528\u573a\u666f\u7684\u5b58\u50a8\u65b9\u6848\u53ca\u4ef7\u683c\uff0c\u8fd9\u6837\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u62e9\u4e0d\u540c\u7684\u5b58\u50a8\u7ea7\u522b\u3002\u4e4b\u524d\u7684\u6587\u7ae0 \u5165\u95e8\u7cfb\u52173 \u5173\u4e8eS3,EBS,EFS\u7684\u4e09\u89d2\u5173\u7cfb \u4e2d\u4ee5AWS S3\u4e3a\u4f8b\u5217\u4e3e\u4e86\u6807\u51c6\u3001\u975e\u9891\u7e41\u8bbf\u95ee\u3001\u5f52\u6863\u7b49\u591a\u79cd\u5b58\u50a8\u65b9\u6848\u53ca\u4ef7\u683c\u4f53\u7cfb\u3002 \u8d34\u5fc3\u3002AWS S3\u63d0\u4f9b\u4e86\u4f17\u591a\u6743\u9650\u7ba1\u7406\u3001\u8bbf\u95ee\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8bbe\u5b9a\u4e0d\u540c\u6570\u636e\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u4ee5\u53ca\u5728\u51fa\u95ee\u9898\u7684\u65f6\u5019\u67e5\u627e\u95ee\u9898\u539f\u56e0\u3002","title":"\u6587\u4ef6\u5b58\u50a8\u4e3a\u4ec0\u4e48\u8981\u653e\u5728\u4e91\u4e0a\uff1f"},{"location":"blogs/2020-01-31-put-bam-on-s3/#igvs3bam","text":"IGV\u5b98\u65b9\u6587\u6863 \u4e0a\u8bf4IGV\u53ef\u4ee5\u8f7d\u5165\u6570\u636e\u7684\u65b9\u5f0f\u6709\u672c\u5730\u6587\u4ef6\u3001HTTP URL\u4ee5\u53caIGV\u6570\u636e\u670d\u52a1\u5668\u3002 \u663e\u7136\uff0cIGV\u76ee\u524d\u4e0d\u652f\u6301S3\u7684\u94fe\u63a5\u3002\u4f46\u5176\u5b9e\u4eceS3\u7684Web\u754c\u9762\u4e0a\u53ef\u4ee5\u8f7b\u677e\u67e5\u5230\u83b7\u53d6\u6587\u4ef6HTTP URL\u7684\u65b9\u5f0f\uff0c\u4e0d\u77e5\u9053\u7684\u8bf7\u8f6c\u9605 \u6b64\u94fe\u63a5 \u4e2d\u6587\u4ef6\u6982\u8ff0\u622a\u56fe\u4e2d\u7684URL\u3002 \u6162\u7740\uff0cS3\u4e0a\u7684\u64cd\u4f5c\u8fd8\u5dee\u4e00\u6b65\u4e86\uff0c\u5982\u679c\u8981\u4eceIGV\u8bbf\u95ee\u8fd8\u9700\u8981\u5f00\u653eS3\u4e0a\u5bf9\u5e94\u6587\u4ef6\u7684\u53ef\u8bfb\u6743\u9650\uff0c\u5982\u4e0b\u56fe\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\u3002 \u4e0a\u56fe\uff1aAWS S3\u4e2d\u5f00\u653e\u6587\u4ef6\u53ef\u8bfb\u6743\u9650 \u7136\u540e\u6253\u5f00\u7535\u8111\u4e0aIGV\uff0c\u6309\u7167 File > Load from URL \u4f9d\u6b21\u70b9\u5f00\u83dc\u5355\uff0c\u5728\u5982\u4e0b\u56fe\u7684\u4e24\u4e2a\u6846\u4e2d\u8f93\u5165BAM\u6587\u4ef6\u4ee5\u53ca\u5bf9\u5e94BAI\u6587\u4ef6\u7684URL\u5c31\u53ef\u4ee5\u8f7b\u677e\u67e5\u770b\u6bd4\u5bf9\u4fe1\u606f\u4eba\u5de5\u786e\u8ba4\u53d8\u5f02\u4e86\u3002 \u4e0a\u56fe\uff1aIGV\u4e2d\u8f7d\u5165URL","title":"IGV\u80fd\u6253\u5f00\u5b58\u5728S3\u4e0a\u7684BAM\u6587\u4ef6\u5417\uff1f"},{"location":"blogs/2020-01-31-put-bam-on-s3/#_2","text":"\u81f3\u6b64\uff0c\u672c\u5730\u6253\u5f00S3\u4e0a\u7684BAM\u6587\u4ef6\u89e3\u51b3\u4e86\uff0c\u4f46\u8fd8\u6709\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\u6ca1\u6709\u5728\u672c\u6587\u4e2d\u4ecb\u7ecd\uff1a \u8fd9\u4e48\u5927\u7684\u6587\u4ef6\u4ece\u7f51\u7edc\u4e0a\u4e0b\u8f7d\uff0c\u4f1a\u4e0d\u4f1a\u7279\u522b\u6162\u554a\uff1f\u4f1a\u4e0d\u4f1a\u6d41\u91cf\u8d39\u7279\u522b\u8d35\u554a\uff1f \u201cMake public\u201d\uff0c\u8ba9\u8be5\u6587\u4ef6\u8bfb\u53d6\u6743\u9650\u66b4\u9732\u5728\u4e92\u8054\u7f51\u4e2d\uff0c\u4efb\u4f55\u62e5\u6709\u8be5\u6743\u9650\u7684\u4eba\u90fd\u53ef\u4ee5\u67e5\u770b\uff0c\u8fd9\u70b9\u80af\u5b9a\u4e0d\u5bf9\u3002 \u5bf9\u4e8eFQ\u3001BAM\u3001VCF\u7b49\u4e0d\u540c\u7c7b\u578b\u6587\u4ef6\u7684\u5b58\u50a8\u65b9\u6848\u662f\u4ec0\u4e48\uff1f\u90fd\u653e\u5728\u6807\u51c6\u5b58\u50a8\u4e2d\u5417\uff1f \u8fd9\u51e0\u4e2a\u95ee\u9898\u6211\u4f1a\u5728\u4eca\u540e\u7684\u6587\u7ae0\u4e2d\u9010\u4e00\u89e3\u91ca\u3002","title":"\u9057\u7559\u95ee\u9898"},{"location":"blogs/2020-02-01-s3-data-cli/","text":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-\u547d\u4ee4\u884cCLI \u4e4b\u524d\u548c\u5927\u5bb6\u4ecb\u7ecd\u8fc7web\u754c\u9762\u4e0a\u4f20\u6570\u636e\u5230S3\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u7528\u60ef\u4e86\u547d\u4ee4\u884c\u7684\u751f\u4fe1\u4eba\u5458\u663e\u7136\u662f\u65e0\u6cd5\u6ee1\u8db3\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6765\u8fdb\u884cs3\u7684\u6570\u636e\u4f20\u8f93\uff0c\u4ee5\u4fbf\u5c06\u547d\u4ee4\u884c\u5199\u5165\u672c\u5730\u4ee3\u7801\u5b9e\u73b0\u81ea\u52a8\u5316\u6570\u636e\u4f20\u8f93\u3002 -- D.C \u5b89\u88c5\u672c\u5730\u5ba2\u6237\u7aef \u5728\u4e0a\u4f20\u6570\u636e\u4e4b\u524d\uff0c\u9700\u8981\u5728\u672c\u5730\u670d\u52a1\u5668/\u672c\u5730\u7535\u8111\u5b89\u88c5aws cli\u5de5\u5177\u5305\uff1a \u9488\u5bf9Linix\uff1a curl \"https://d1vvhvl2y92vvt.cloudfront.net/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\" unzip awscliv2.zip sudo ./aws/install \u9488\u5bf9Mac\uff1a curl \"https://d1vvhvl2y92vvt.cloudfront.net/awscli-exe-macos.zip\" -o \"awscliv2.zip\" unzip awscliv2.zip sudo ./aws/install \u5b89\u88c5\u9009\u9879 \u8bf4\u660e --install-dir \u6216-i \u6b64\u9009\u9879\u6307\u5b9a\u8981\u5c06\u6240\u6709\u6587\u4ef6\u590d\u5236\u5230\u7684\u6587\u4ef6\u5939\u3002\u6b64\u793a\u4f8b\u5c06\u6587\u4ef6\u5b89\u88c5\u5230\u540d\u4e3a /usr/local/aws-cli \u7684\u6587\u4ef6\u5939\u3002 \u60a8\u5fc5\u987b\u5177\u6709\u5bf9 /usr/local \u7684\u5199\u5165\u6743\u9650\u624d\u80fd\u521b\u5efa\u6b64\u6587\u4ef6\u5939\u3002 \u9ed8\u8ba4\u503c\u4e3a /usr/local/aws-cli\u3002 --bin-dir \u6216-b \u6b64\u9009\u9879\u6307\u5b9a\u5c06\u5b89\u88c5\u6587\u4ef6\u5939\u4e2d\u7684\u4e3b aws \u7a0b\u5e8f\u7b26\u53f7\u94fe\u63a5\u5230\u6307\u5b9a\u8def\u5f84\u4e2d\u7684 aws2 \u6587\u4ef6\u3002\u6b64\u793a\u4f8b\u521b\u5efa\u7b26\u53f7\u94fe\u63a5 /usr/local/bin/aws2\u3002\u60a8\u5fc5\u987b\u5177\u6709\u5bf9\u6307\u5b9a\u6587\u4ef6\u5939\u7684\u5199\u5165\u6743\u9650\u3002 \u521b\u5efa\u6307\u5411\u8def\u5f84\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\u5939\u7684\u7b26\u53f7\u94fe\u63a5\u540e\uff0c\u65e0\u9700\u518d\u5c06\u5b89\u88c5\u76ee\u5f55\u6dfb\u52a0\u5230\u7528\u6237\u7684 $PATH \u53d8\u91cf\u4e2d\u3002 \u9ed8\u8ba4\u503c\u4e3a /usr/local/bin\u3002 \u786e\u8ba4\u672c\u5730\u5b89\u88c5\u6210\u529f\u3002 $ aws2 --version aws-cli/2.0.0dev0 Python/3.7.3 Linux/4.14.133-113.105.amzn2.x86_64 botocore/2.0.0dev0 \u914d\u7f6e\u672c\u5730cli\u73af\u5883 \u63a5\u7740\u8981\u914d\u7f6e\u672c\u5730\u7684credentials,\u6709\u70b9\u773c\u719f\u5427\uff1f\u6ca1\u9519\uff0c\u8fd9\u4e2a\u6865\u6bb5\u8fd9\u7bc7\u6587\u7ae0\u51fa\u73b0\u8fc7- \u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e \uff0c\u603b\u800c\u8a00\u4e4b\u5c31\u662f\u8ba9\u670d\u52a1\u5668\u5177\u6709\u5408\u6cd5\u8bbf\u95ee\u7684\u8eab\u4efd\u3002\u4e0b\u9762\u7684\u547d\u4ee4\u90fd\u662f aws \u5f00\u5934\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u8bbe\u7f6e alias \uff0c\u90a3\u5c31\u7528 aws2 \u5427\u3002 $ aws configure AWS Access Key ID [****************xxxx]: # \u8f93\u5165\u4f60\u7684AK key AWS Secret Access Key [****************xxxx]: # \u8f93\u5165\u4f60\u7684SK key Default region name [cn-northwest-1]: # \u5b81\u590f\uff1acn-northwest-1\uff0c\u5317\u4eac\uff1acn-north-1 Default output format [json]: # \u9ed8\u8ba4json \u6d4b\u8bd5\u4e0b\uff0c\u6210\u529f\u6478\u5230s3\u7684\u5c0f\u86ee\u8170\u3002 $aws s3 ls 2019-09-04 16:12:22 cloudtrail-awslogs 2019-09-21 21:35:26 config-bucket 2019-12-06 13:12:11 rawdata 2019-09-04 16:27:26 do-not-delete \u4f7f\u7528aws cli \u63a5\u4e0b\u6765\u5c31\u8981\u5229\u7528\u672c\u5730\u7684aws cli\u547d\u4ee4\u4e0a\u4f20\u6570\u636e\u4e86\u3002\u901a\u8fc7 aws2 s3 help \u53ef\u4ee5\u770b\u5230s3\u7684\u547d\u4ee4\u6a21\u5757\uff1a \u6876\u547d\u4ee4 \u8bf4\u660e mb aws s3 mb s3://bucket-name \u521b\u5efa\u5b58\u50a8\u6876\uff0c\u5b58\u50a8\u6876\u540d\u79f0\u53ef\u4ee5\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u8fde\u5b57\u7b26\u548c\u70b9\u53f7\u3002\u5b58\u50a8\u6876\u540d\u79f0\u53ea\u80fd\u4ee5\u5b57\u6bcd\u6216\u6570\u5b57\u5f00\u5934\u548c\u7ed3\u5c3e\uff0c\u8fde\u5b57\u7b26\u6216\u70b9\u53f7\u540e\u4e0d\u80fd\u8ddf\u70b9\u53f7\u3002 ls aws s3 ls \u5217\u51fa\u60a8\u7684\u5b58\u50a8\u6876 aws s3 ls s3://bucket-name \u5217\u51fa\u5b58\u50a8\u6876\u4e0b\u7684\u5bf9\u8c61\u548c\u6587\u4ef6\u5939 rb aws s3 rb s3://bucket-name \u5220\u9664\u7a7a\u6876 aws s3 rb s3://bucket-name --force \u5220\u9664\u65e0\u7248\u672c\u63a7\u5236\u7684\u975e\u7a7a\u6876\u548c\u6876\u5185\u6240\u6709\u5185\u5bb9 \u5bf9\u8c61\u547d\u4ee4 \u8bf4\u660e cp aws s3 cp file.txt s3://my-bucket/ \u62f7\u8d1d\u6587\u4ef6\u5230S3\uff0c\u53cd\u4e4b\u4ea6\u7136 mv aws s3 cp file.txt s3://my-bucket/ \u79fb\u52a8\u672c\u5730\u6587\u4ef6\u5230S3\uff0c\u53cd\u4e4b\u4ea6\u7136 rm aws s3 rm s3://my-bucket/path/MySubdirectory/MyFile3.txt \u5220\u9664S3\u4e0a\u7684\u6587\u4ef6MyFile3.txt sync aws s3 sync . s3://my-bucket/path presign aws s3 presign s3://awsexamplebucket/test2.txt --expires-in 604800 \u4e3a\u67d0\u4e2a\u5bf9\u8c61\u521b\u5efa\u7279\u5b9a\u65f6\u95f4\uff08\u79d2\u4e3a\u5355\u4f4d\uff0c604800=1\u5468\uff09\u6709\u6548\u7684http\u8bbf\u95ee\u94fe\u63a5\uff0c\u4ee5\u4f9b\u4ed6\u4eba\u8bbf\u95ee\uff0c\u56fd\u5916\u968f\u610f\uff0c\u56fd\u5185\u8bf7\u5148\u5f00ICP \u4ee5\u4e0a\u547d\u4ee4\u5982cp\u3001mv \u6216 rm\u7528\u4e8e\u76ee\u5f55\u6216\u6587\u4ef6\u5939\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0 --recursive \u9009\u9879\u6765\u904d\u5386\u76ee\u5f55\u6811\uff0c\u5305\u62ec\u6240\u6709\u5b50\u76ee\u5f55\u3002 // \u5220\u9664s3://my-bucket/path \u76ee\u5f55\u548c\u5176\u4e0b\u6240\u6709\u5185\u5bb9 $ aws s3 rm s3://my-bucket/path --recursive [\u6ce8\u610f] \uff1a\u5982\u679c\u5bf9\u8c61\u5f88\u5927\uff0c\u6240\u6709\u6d89\u53ca\u5411S3 \u5b58\u50a8\u6876\uff08s3 cp\u3001s3 mv \u548c s3 sync\uff09\u4e0a\u4f20\u5bf9\u8c61\u7684\u9ad8\u7ea7\u547d\u4ee4\u90fd\u4f1a\u81ea\u52a8\u6267\u884c \u5206\u6bb5\u4e0a\u4f20 \u3002\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u65f6\uff0c\u65e0\u6cd5\u6062\u590d\u5931\u8d25\u7684\u4e0a\u4f20\u3002\u5982\u679c\u5206\u6bb5\u4e0a\u4f20\u7531\u4e8e\u8d85\u65f6\u800c\u5931\u8d25\uff0c\u6216\u8005\u901a\u8fc7\u6309 Ctrl+C \u624b\u52a8\u53d6\u6d88\uff0cAWS CLI \u5c06\u4f1a\u6e05\u9664\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\u5e76\u4e2d\u6b62\u4e0a\u4f20\u3002\u6b64\u8fc7\u7a0b\u53ef\u80fd\u8017\u65f6\u6570\u5206\u949f\u3002 \u5982\u679c\u8fdb\u7a0b\u88ab kill \u547d\u4ee4\u4e2d\u65ad\u6216\u8005\u7531\u4e8e\u7cfb\u7edf\u6545\u969c\u800c\u4e2d\u65ad\uff0c\u5219\u6b63\u5728\u8fdb\u884c\u7684\u5206\u6bb5\u4e0a\u4f20\u5c06\u4fdd\u7559\u5728 Amazon S3 \u4e2d\uff0c\u5fc5\u987b\u5728 AWS \u7ba1\u7406\u63a7\u5236\u53f0\u4e2d\u624b\u52a8\u6e05\u9664\uff0c\u6216\u8005\u4f7f\u7528 s3api abort-multipart-upload \u547d\u4ee4\u6765\u6e05\u9664\u3002 \u5173\u4e8e sync \u7684\u7528\u6cd5\uff0c\u8fd9\u91cc\u591a\u8bf4\u51e0\u53e5\uff0c\u56e0\u4e3a\u5c06\u6765\u6211\u4eec\u4f1a\u7ecf\u5e38\u6253\u4ea4\u9053\uff0c\u5176\u5e94\u7528\u4e3b\u8981\u6709\u4e09\u7c7b\uff1a \u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5230 S3 S3 \u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7edf S3 \u5230 Amazon S3 \u4f7f\u7528\u683c\u5f0f\uff1a aws s3 sync <source> <target> [--options] $ aws s3 sync . s3://my-bucket/path #\u5982\u679cpath\u4e0d\u5b58\u5728\u4f1a\u81ea\u52a8\u521b\u5efa upload: MySubdirectory/MyFile3.txt to s3://my-bucket/path/MySubdirectory/MyFile3.txt upload: MyFile2.txt to s3://my-bucket/path/MyFile2.txt upload: MyFile1.txt to s3://my-bucket/path/MyFile1.txt \u901a\u8fc7\u6dfb\u52a0 --delete \u9009\u9879\u6765\u4ece\u76ee\u6807\u4e2d\u5220\u9664\u6e90\u4e2d\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u6216\u5bf9\u8c61\u3002 // \u6d4b\u8bd51\uff1a\u5220\u9664\u672c\u5730\u7684\u6587\u4ef6MyFile1.txt $ rm ./MyFile1.txt // \u540c\u6b65\u4e0d\u52a0 --delete\uff0c\u6ca1\u53d8\u5316 $ aws s3 sync . s3://my-bucket/path // \u540c\u6b65\u52a0\u4e86--deletion\uff0c\u56e0\u4e3a\u6e90\u662f\u672c\u5730\uff0c\u76ee\u6807\u6876\u5185\u7684\u6587\u4ef6\u4e5f\u88ab\u5220\u9664 $ aws s3 sync . s3://my-bucket/path --delete delete: s3://my-bucket/path/MyFile1.txt // \u6d4b\u8bd52\uff1a\u5220\u9664\u6876\u5185\u7684\u6587\u4ef6MyFile3.txt $ aws s3 rm s3://my-bucket/path/MySubdirectory/MyFile3.txt delete: s3://my-bucket/path/MySubdirectory/MyFile3.txt // \u540c\u6b65\u52a0--deletion,\u8fd9\u65f6\u5019\u6e90\u662fs3\uff0c\u76ee\u6807\u662f\u672c\u5730\uff0c\u6240\u4ee5\u672c\u5730\u7684\u6587\u4ef6\u88ab\u5220\u9664 $ aws s3 sync s3://my-bucket/path . --delete delete: MySubdirectory\\MyFile3.txt \u901a\u8fc7\u6dfb\u52a0 --storage-class \u9009\u9879\u6765\u8bbe\u5b9a\u4e0a\u4f20\u6570\u636e\u7684\u5b58\u50a8\u7c7b\u522b\uff0c\u795e\u5668\uff01\u7279\u522b\u9002\u7528\u4e8e\u6211\u6709\u4e00\u5806\u9648\u829d\u9ebb\u70c2\u8c37\u5b50\u7684\u6570\u636e\u8981\u5f80\u4e91\u4e0a\u603c\u7684\uff0c\u76f4\u63a5\u8bbe\u5b9a \u5f52\u6863\u6a21\u5f0f \u5c31\u884c\u4e86\uff01 // \u5c06\u5f53\u524d\u76ee\u5f55\u6587\u4ef6\u4f20\u9001\u5230s3\uff0c\u5e76\u4ee5<string> \u6a21\u5f0f\u5b58\u50a8\uff0c\u9ed8\u8ba4\u662fSTANDARD\u6807\u51c6\u3002 $ aws s3 sync . s3://my-bucket/path --storage-class STANDARD $ aws s3 sync . s3://my-bucket/path --storage-class STANDARD_IA $ aws s3 sync . s3://my-bucket/path --storage-class ONE-ZONE_IA $ aws s3 sync . s3://my-bucket/path --storage-class INTELLIGENT_TIERING $ aws s3 sync . s3://my-bucket/path --storage-class GLACIER $ aws s3 sync . s3://my-bucket/path --storage-class DEEP_ARCHIVE $ aws s3 sync . s3://my-bucket/path --storage-class REDUCED_REDUNDANCY \u6709\u4e9b\u5b9e\u64cd\u8fc7\u7684\u540c\u5b66\u8bf4\u4e86\uff0c\u5982\u679c\u6211\u5f53\u524d\u76ee\u5f55\u4e0b\u6709\u7279\u5b9a\u6570\u636e\u4e0d\u60f3\u540c\u6b65\u600e\u4e48\u529e\u5462\uff1f \u522b\u614c\uff0c\u6211\u4eec\u6709 --exclude \u548c --include \uff0c\u6765\u7b5b\u9009\u8981\u5728\u540c\u6b65\u64cd\u4f5c\u671f\u95f4\u590d\u5236\u7684\u6587\u4ef6\u6216\u5bf9\u8c61\uff0c\u8bb0\u4f4finclude\u9009\u9879\u4e00\u5b9a\u662f\u548cexclude\u540c\u65f6\u51fa\u73b0\u7684\uff0c \u6309\u987a\u5e8f\u5e94\u7528 \uff0c\u81ea\u5df1\u4f53\u4f1a\u4e0b\u5427\u3002 \u5047\u8bbe\u5f53\u524d\u76ee\u5f55\u67093\u4e2a\u6587\u4ef6: MyFile1.txt MyFile2.rtf MyFile88.txt $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" --include \"MyFile*.txt\" upload: MyFile1.txt to s3://my-bucket/path/MyFile1.txt upload: MyFile88.txt to s3://my-bucket/path/MyFile88.txt upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" --include \"MyFile*.txt\" --exclude \"MyFile?.txt\" upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf upload: MyFile88.txt to s3://my-bucket/path/MyFile88.txt \u8fdb\u9636 \uff1a\u8fd9\u4e24\u4e2a\u9009\u9879\u8fd8\u53ef\u4ee5\u548c--delete\u914d\u5408\u4f7f\u7528\uff1a \u5047\u8bbe\u672c\u5730\u76ee\u5f55\u548c s3://my-bucket/path \u5df2\u7ecf\u540c\u6b65\uff0c\u5e76\u5404\u81ea\u5305\u542b3\u4e2a\u6587\u4ef6: MyFile1.txt MyFile2.rtf MyFile88.txt // \u5220\u9664\u6240\u6709\u672c\u5730\u7684 .txt\u6587\u4ef6 $ rm *.txt // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u4f46\u4e0d\u540c\u6b65\u5220\u9664\u7b26\u5408MyFile?.txt\u547d\u540d\u7684\u6587\u4ef6MyFile1.txt\uff0c\u6240\u4ee5\u53ea\u5220\u9664\u4e86MyFile88.txt $ aws s3 sync . s3://my-bucket/path --delete --exclude \"my-bucket/path/MyFile?.txt\" delete: s3://my-bucket/path/MyFile88.txt // \u5220\u9664s3\u4e0a\u7684MyFile2.rtf $ aws s3 rm s3://my-bucket/path/MyFile2.rtf // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u4f46\u4e0d\u5220\u9664MyFile2.rtf\uff0c\u6240\u4ee5\u53ea\u662f\u628a\u672c\u5730\u4e4b\u524d\u88ab\u5220\u6389\u7684MyFile1.txt\u6062\u590d\u5230\u4e86\u672c\u5730\uff08\u56e0\u4e3a\u5728\u4e0a\u4e00\u6b65\u6876\u91cc\u7684\u8fd9\u4e2a\u6587\u4ef6\u5e76\u6ca1\u6709\u88ab\u5220\u9664\uff09 $ aws s3 sync s3://my-bucket/path . --delete --exclude \"./MyFile2.rtf\" download: s3://my-bucket/path/MyFile1.txt to MyFile1.txt // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u672c\u5730\u7684MyFile2.rtf\u88ab\u5220\u9664\u4e86 $ aws s3 sync s3://my-bucket/path . --delete delete: MyFile2.rtf //\u672c\u5730\u76ee\u5f55\uff1a MyFile1.txt //s3\u6876\uff1a MyFile1.txt \u901a\u8fc7\u8bbe\u7f6e --acl \u6765\u8bbe\u5b9aaccess control list\u8bbf\u95ee\u6743\u9650\uff0c\u6709 private \u3001 public-read \u548c public-read-write \u503c\u3002 $ aws s3 sync . s3://my-bucket/path --acl public-read \u6574\u5408\u5230\u73b0\u6709\u4ee3\u7801 \u4f8b\u5982\uff1a os.system(\"aws s3 sync s3://god/ooxx/fq ./path/fq\") ...trim ...map ...gatk os.system(\"aws s3 sync ./path/bam s3://god/ooxx/bam --storage-class STANDARD_IA\") s3 SDK \u53c2\u8003\uff1a \u70b9\u6211 s3 api \u53c2\u8003\uff1a \u70b9\u6211 \u5fc3\u8d70\u5f97\u5feb\u4e86\uff0c\u4e16\u754c\u5c31\u6162\u4e86\u3002","title":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-\u547d\u4ee4\u884cCLI"},{"location":"blogs/2020-02-01-s3-data-cli/#s3-cli","text":"\u4e4b\u524d\u548c\u5927\u5bb6\u4ecb\u7ecd\u8fc7web\u754c\u9762\u4e0a\u4f20\u6570\u636e\u5230S3\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u7528\u60ef\u4e86\u547d\u4ee4\u884c\u7684\u751f\u4fe1\u4eba\u5458\u663e\u7136\u662f\u65e0\u6cd5\u6ee1\u8db3\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6765\u8fdb\u884cs3\u7684\u6570\u636e\u4f20\u8f93\uff0c\u4ee5\u4fbf\u5c06\u547d\u4ee4\u884c\u5199\u5165\u672c\u5730\u4ee3\u7801\u5b9e\u73b0\u81ea\u52a8\u5316\u6570\u636e\u4f20\u8f93\u3002 -- D.C","title":"\u5982\u4f55\u4e0a\u4f20\u6570\u636e\u5230S3\u670d\u52a1-\u547d\u4ee4\u884cCLI"},{"location":"blogs/2020-02-01-s3-data-cli/#_1","text":"\u5728\u4e0a\u4f20\u6570\u636e\u4e4b\u524d\uff0c\u9700\u8981\u5728\u672c\u5730\u670d\u52a1\u5668/\u672c\u5730\u7535\u8111\u5b89\u88c5aws cli\u5de5\u5177\u5305\uff1a \u9488\u5bf9Linix\uff1a curl \"https://d1vvhvl2y92vvt.cloudfront.net/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\" unzip awscliv2.zip sudo ./aws/install \u9488\u5bf9Mac\uff1a curl \"https://d1vvhvl2y92vvt.cloudfront.net/awscli-exe-macos.zip\" -o \"awscliv2.zip\" unzip awscliv2.zip sudo ./aws/install \u5b89\u88c5\u9009\u9879 \u8bf4\u660e --install-dir \u6216-i \u6b64\u9009\u9879\u6307\u5b9a\u8981\u5c06\u6240\u6709\u6587\u4ef6\u590d\u5236\u5230\u7684\u6587\u4ef6\u5939\u3002\u6b64\u793a\u4f8b\u5c06\u6587\u4ef6\u5b89\u88c5\u5230\u540d\u4e3a /usr/local/aws-cli \u7684\u6587\u4ef6\u5939\u3002 \u60a8\u5fc5\u987b\u5177\u6709\u5bf9 /usr/local \u7684\u5199\u5165\u6743\u9650\u624d\u80fd\u521b\u5efa\u6b64\u6587\u4ef6\u5939\u3002 \u9ed8\u8ba4\u503c\u4e3a /usr/local/aws-cli\u3002 --bin-dir \u6216-b \u6b64\u9009\u9879\u6307\u5b9a\u5c06\u5b89\u88c5\u6587\u4ef6\u5939\u4e2d\u7684\u4e3b aws \u7a0b\u5e8f\u7b26\u53f7\u94fe\u63a5\u5230\u6307\u5b9a\u8def\u5f84\u4e2d\u7684 aws2 \u6587\u4ef6\u3002\u6b64\u793a\u4f8b\u521b\u5efa\u7b26\u53f7\u94fe\u63a5 /usr/local/bin/aws2\u3002\u60a8\u5fc5\u987b\u5177\u6709\u5bf9\u6307\u5b9a\u6587\u4ef6\u5939\u7684\u5199\u5165\u6743\u9650\u3002 \u521b\u5efa\u6307\u5411\u8def\u5f84\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\u5939\u7684\u7b26\u53f7\u94fe\u63a5\u540e\uff0c\u65e0\u9700\u518d\u5c06\u5b89\u88c5\u76ee\u5f55\u6dfb\u52a0\u5230\u7528\u6237\u7684 $PATH \u53d8\u91cf\u4e2d\u3002 \u9ed8\u8ba4\u503c\u4e3a /usr/local/bin\u3002 \u786e\u8ba4\u672c\u5730\u5b89\u88c5\u6210\u529f\u3002 $ aws2 --version aws-cli/2.0.0dev0 Python/3.7.3 Linux/4.14.133-113.105.amzn2.x86_64 botocore/2.0.0dev0","title":"\u5b89\u88c5\u672c\u5730\u5ba2\u6237\u7aef"},{"location":"blogs/2020-02-01-s3-data-cli/#cli","text":"\u63a5\u7740\u8981\u914d\u7f6e\u672c\u5730\u7684credentials,\u6709\u70b9\u773c\u719f\u5427\uff1f\u6ca1\u9519\uff0c\u8fd9\u4e2a\u6865\u6bb5\u8fd9\u7bc7\u6587\u7ae0\u51fa\u73b0\u8fc7- \u5982\u4f55\u5e2eEC2\u6478\u5230S3\u4e0a\u7684\u6570\u636e \uff0c\u603b\u800c\u8a00\u4e4b\u5c31\u662f\u8ba9\u670d\u52a1\u5668\u5177\u6709\u5408\u6cd5\u8bbf\u95ee\u7684\u8eab\u4efd\u3002\u4e0b\u9762\u7684\u547d\u4ee4\u90fd\u662f aws \u5f00\u5934\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u8bbe\u7f6e alias \uff0c\u90a3\u5c31\u7528 aws2 \u5427\u3002 $ aws configure AWS Access Key ID [****************xxxx]: # \u8f93\u5165\u4f60\u7684AK key AWS Secret Access Key [****************xxxx]: # \u8f93\u5165\u4f60\u7684SK key Default region name [cn-northwest-1]: # \u5b81\u590f\uff1acn-northwest-1\uff0c\u5317\u4eac\uff1acn-north-1 Default output format [json]: # \u9ed8\u8ba4json \u6d4b\u8bd5\u4e0b\uff0c\u6210\u529f\u6478\u5230s3\u7684\u5c0f\u86ee\u8170\u3002 $aws s3 ls 2019-09-04 16:12:22 cloudtrail-awslogs 2019-09-21 21:35:26 config-bucket 2019-12-06 13:12:11 rawdata 2019-09-04 16:27:26 do-not-delete","title":"\u914d\u7f6e\u672c\u5730cli\u73af\u5883"},{"location":"blogs/2020-02-01-s3-data-cli/#aws-cli","text":"","title":"\u4f7f\u7528aws cli"},{"location":"blogs/2020-02-01-s3-data-cli/#aws-cliaws2-s3-help-s3","text":"\u6876\u547d\u4ee4 \u8bf4\u660e mb aws s3 mb s3://bucket-name \u521b\u5efa\u5b58\u50a8\u6876\uff0c\u5b58\u50a8\u6876\u540d\u79f0\u53ef\u4ee5\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u8fde\u5b57\u7b26\u548c\u70b9\u53f7\u3002\u5b58\u50a8\u6876\u540d\u79f0\u53ea\u80fd\u4ee5\u5b57\u6bcd\u6216\u6570\u5b57\u5f00\u5934\u548c\u7ed3\u5c3e\uff0c\u8fde\u5b57\u7b26\u6216\u70b9\u53f7\u540e\u4e0d\u80fd\u8ddf\u70b9\u53f7\u3002 ls aws s3 ls \u5217\u51fa\u60a8\u7684\u5b58\u50a8\u6876 aws s3 ls s3://bucket-name \u5217\u51fa\u5b58\u50a8\u6876\u4e0b\u7684\u5bf9\u8c61\u548c\u6587\u4ef6\u5939 rb aws s3 rb s3://bucket-name \u5220\u9664\u7a7a\u6876 aws s3 rb s3://bucket-name --force \u5220\u9664\u65e0\u7248\u672c\u63a7\u5236\u7684\u975e\u7a7a\u6876\u548c\u6876\u5185\u6240\u6709\u5185\u5bb9 \u5bf9\u8c61\u547d\u4ee4 \u8bf4\u660e cp aws s3 cp file.txt s3://my-bucket/ \u62f7\u8d1d\u6587\u4ef6\u5230S3\uff0c\u53cd\u4e4b\u4ea6\u7136 mv aws s3 cp file.txt s3://my-bucket/ \u79fb\u52a8\u672c\u5730\u6587\u4ef6\u5230S3\uff0c\u53cd\u4e4b\u4ea6\u7136 rm aws s3 rm s3://my-bucket/path/MySubdirectory/MyFile3.txt \u5220\u9664S3\u4e0a\u7684\u6587\u4ef6MyFile3.txt sync aws s3 sync . s3://my-bucket/path presign aws s3 presign s3://awsexamplebucket/test2.txt --expires-in 604800 \u4e3a\u67d0\u4e2a\u5bf9\u8c61\u521b\u5efa\u7279\u5b9a\u65f6\u95f4\uff08\u79d2\u4e3a\u5355\u4f4d\uff0c604800=1\u5468\uff09\u6709\u6548\u7684http\u8bbf\u95ee\u94fe\u63a5\uff0c\u4ee5\u4f9b\u4ed6\u4eba\u8bbf\u95ee\uff0c\u56fd\u5916\u968f\u610f\uff0c\u56fd\u5185\u8bf7\u5148\u5f00ICP \u4ee5\u4e0a\u547d\u4ee4\u5982cp\u3001mv \u6216 rm\u7528\u4e8e\u76ee\u5f55\u6216\u6587\u4ef6\u5939\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0 --recursive \u9009\u9879\u6765\u904d\u5386\u76ee\u5f55\u6811\uff0c\u5305\u62ec\u6240\u6709\u5b50\u76ee\u5f55\u3002 // \u5220\u9664s3://my-bucket/path \u76ee\u5f55\u548c\u5176\u4e0b\u6240\u6709\u5185\u5bb9 $ aws s3 rm s3://my-bucket/path --recursive [\u6ce8\u610f] \uff1a\u5982\u679c\u5bf9\u8c61\u5f88\u5927\uff0c\u6240\u6709\u6d89\u53ca\u5411S3 \u5b58\u50a8\u6876\uff08s3 cp\u3001s3 mv \u548c s3 sync\uff09\u4e0a\u4f20\u5bf9\u8c61\u7684\u9ad8\u7ea7\u547d\u4ee4\u90fd\u4f1a\u81ea\u52a8\u6267\u884c \u5206\u6bb5\u4e0a\u4f20 \u3002\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u65f6\uff0c\u65e0\u6cd5\u6062\u590d\u5931\u8d25\u7684\u4e0a\u4f20\u3002\u5982\u679c\u5206\u6bb5\u4e0a\u4f20\u7531\u4e8e\u8d85\u65f6\u800c\u5931\u8d25\uff0c\u6216\u8005\u901a\u8fc7\u6309 Ctrl+C \u624b\u52a8\u53d6\u6d88\uff0cAWS CLI \u5c06\u4f1a\u6e05\u9664\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\u5e76\u4e2d\u6b62\u4e0a\u4f20\u3002\u6b64\u8fc7\u7a0b\u53ef\u80fd\u8017\u65f6\u6570\u5206\u949f\u3002 \u5982\u679c\u8fdb\u7a0b\u88ab kill \u547d\u4ee4\u4e2d\u65ad\u6216\u8005\u7531\u4e8e\u7cfb\u7edf\u6545\u969c\u800c\u4e2d\u65ad\uff0c\u5219\u6b63\u5728\u8fdb\u884c\u7684\u5206\u6bb5\u4e0a\u4f20\u5c06\u4fdd\u7559\u5728 Amazon S3 \u4e2d\uff0c\u5fc5\u987b\u5728 AWS \u7ba1\u7406\u63a7\u5236\u53f0\u4e2d\u624b\u52a8\u6e05\u9664\uff0c\u6216\u8005\u4f7f\u7528 s3api abort-multipart-upload \u547d\u4ee4\u6765\u6e05\u9664\u3002","title":"\u63a5\u4e0b\u6765\u5c31\u8981\u5229\u7528\u672c\u5730\u7684aws cli\u547d\u4ee4\u4e0a\u4f20\u6570\u636e\u4e86\u3002\u901a\u8fc7aws2 s3 help \u53ef\u4ee5\u770b\u5230s3\u7684\u547d\u4ee4\u6a21\u5757\uff1a"},{"location":"blogs/2020-02-01-s3-data-cli/#sync","text":"\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5230 S3 S3 \u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7edf S3 \u5230 Amazon S3 \u4f7f\u7528\u683c\u5f0f\uff1a aws s3 sync <source> <target> [--options] $ aws s3 sync . s3://my-bucket/path #\u5982\u679cpath\u4e0d\u5b58\u5728\u4f1a\u81ea\u52a8\u521b\u5efa upload: MySubdirectory/MyFile3.txt to s3://my-bucket/path/MySubdirectory/MyFile3.txt upload: MyFile2.txt to s3://my-bucket/path/MyFile2.txt upload: MyFile1.txt to s3://my-bucket/path/MyFile1.txt \u901a\u8fc7\u6dfb\u52a0 --delete \u9009\u9879\u6765\u4ece\u76ee\u6807\u4e2d\u5220\u9664\u6e90\u4e2d\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u6216\u5bf9\u8c61\u3002 // \u6d4b\u8bd51\uff1a\u5220\u9664\u672c\u5730\u7684\u6587\u4ef6MyFile1.txt $ rm ./MyFile1.txt // \u540c\u6b65\u4e0d\u52a0 --delete\uff0c\u6ca1\u53d8\u5316 $ aws s3 sync . s3://my-bucket/path // \u540c\u6b65\u52a0\u4e86--deletion\uff0c\u56e0\u4e3a\u6e90\u662f\u672c\u5730\uff0c\u76ee\u6807\u6876\u5185\u7684\u6587\u4ef6\u4e5f\u88ab\u5220\u9664 $ aws s3 sync . s3://my-bucket/path --delete delete: s3://my-bucket/path/MyFile1.txt // \u6d4b\u8bd52\uff1a\u5220\u9664\u6876\u5185\u7684\u6587\u4ef6MyFile3.txt $ aws s3 rm s3://my-bucket/path/MySubdirectory/MyFile3.txt delete: s3://my-bucket/path/MySubdirectory/MyFile3.txt // \u540c\u6b65\u52a0--deletion,\u8fd9\u65f6\u5019\u6e90\u662fs3\uff0c\u76ee\u6807\u662f\u672c\u5730\uff0c\u6240\u4ee5\u672c\u5730\u7684\u6587\u4ef6\u88ab\u5220\u9664 $ aws s3 sync s3://my-bucket/path . --delete delete: MySubdirectory\\MyFile3.txt \u901a\u8fc7\u6dfb\u52a0 --storage-class \u9009\u9879\u6765\u8bbe\u5b9a\u4e0a\u4f20\u6570\u636e\u7684\u5b58\u50a8\u7c7b\u522b\uff0c\u795e\u5668\uff01\u7279\u522b\u9002\u7528\u4e8e\u6211\u6709\u4e00\u5806\u9648\u829d\u9ebb\u70c2\u8c37\u5b50\u7684\u6570\u636e\u8981\u5f80\u4e91\u4e0a\u603c\u7684\uff0c\u76f4\u63a5\u8bbe\u5b9a \u5f52\u6863\u6a21\u5f0f \u5c31\u884c\u4e86\uff01 // \u5c06\u5f53\u524d\u76ee\u5f55\u6587\u4ef6\u4f20\u9001\u5230s3\uff0c\u5e76\u4ee5<string> \u6a21\u5f0f\u5b58\u50a8\uff0c\u9ed8\u8ba4\u662fSTANDARD\u6807\u51c6\u3002 $ aws s3 sync . s3://my-bucket/path --storage-class STANDARD $ aws s3 sync . s3://my-bucket/path --storage-class STANDARD_IA $ aws s3 sync . s3://my-bucket/path --storage-class ONE-ZONE_IA $ aws s3 sync . s3://my-bucket/path --storage-class INTELLIGENT_TIERING $ aws s3 sync . s3://my-bucket/path --storage-class GLACIER $ aws s3 sync . s3://my-bucket/path --storage-class DEEP_ARCHIVE $ aws s3 sync . s3://my-bucket/path --storage-class REDUCED_REDUNDANCY \u6709\u4e9b\u5b9e\u64cd\u8fc7\u7684\u540c\u5b66\u8bf4\u4e86\uff0c\u5982\u679c\u6211\u5f53\u524d\u76ee\u5f55\u4e0b\u6709\u7279\u5b9a\u6570\u636e\u4e0d\u60f3\u540c\u6b65\u600e\u4e48\u529e\u5462\uff1f \u522b\u614c\uff0c\u6211\u4eec\u6709 --exclude \u548c --include \uff0c\u6765\u7b5b\u9009\u8981\u5728\u540c\u6b65\u64cd\u4f5c\u671f\u95f4\u590d\u5236\u7684\u6587\u4ef6\u6216\u5bf9\u8c61\uff0c\u8bb0\u4f4finclude\u9009\u9879\u4e00\u5b9a\u662f\u548cexclude\u540c\u65f6\u51fa\u73b0\u7684\uff0c \u6309\u987a\u5e8f\u5e94\u7528 \uff0c\u81ea\u5df1\u4f53\u4f1a\u4e0b\u5427\u3002 \u5047\u8bbe\u5f53\u524d\u76ee\u5f55\u67093\u4e2a\u6587\u4ef6: MyFile1.txt MyFile2.rtf MyFile88.txt $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" --include \"MyFile*.txt\" upload: MyFile1.txt to s3://my-bucket/path/MyFile1.txt upload: MyFile88.txt to s3://my-bucket/path/MyFile88.txt upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf $ aws s3 sync . s3://my-bucket/path --exclude \"*.txt\" --include \"MyFile*.txt\" --exclude \"MyFile?.txt\" upload: MyFile2.rtf to s3://my-bucket/path/MyFile2.rtf upload: MyFile88.txt to s3://my-bucket/path/MyFile88.txt \u8fdb\u9636 \uff1a\u8fd9\u4e24\u4e2a\u9009\u9879\u8fd8\u53ef\u4ee5\u548c--delete\u914d\u5408\u4f7f\u7528\uff1a \u5047\u8bbe\u672c\u5730\u76ee\u5f55\u548c s3://my-bucket/path \u5df2\u7ecf\u540c\u6b65\uff0c\u5e76\u5404\u81ea\u5305\u542b3\u4e2a\u6587\u4ef6: MyFile1.txt MyFile2.rtf MyFile88.txt // \u5220\u9664\u6240\u6709\u672c\u5730\u7684 .txt\u6587\u4ef6 $ rm *.txt // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u4f46\u4e0d\u540c\u6b65\u5220\u9664\u7b26\u5408MyFile?.txt\u547d\u540d\u7684\u6587\u4ef6MyFile1.txt\uff0c\u6240\u4ee5\u53ea\u5220\u9664\u4e86MyFile88.txt $ aws s3 sync . s3://my-bucket/path --delete --exclude \"my-bucket/path/MyFile?.txt\" delete: s3://my-bucket/path/MyFile88.txt // \u5220\u9664s3\u4e0a\u7684MyFile2.rtf $ aws s3 rm s3://my-bucket/path/MyFile2.rtf // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u4f46\u4e0d\u5220\u9664MyFile2.rtf\uff0c\u6240\u4ee5\u53ea\u662f\u628a\u672c\u5730\u4e4b\u524d\u88ab\u5220\u6389\u7684MyFile1.txt\u6062\u590d\u5230\u4e86\u672c\u5730\uff08\u56e0\u4e3a\u5728\u4e0a\u4e00\u6b65\u6876\u91cc\u7684\u8fd9\u4e2a\u6587\u4ef6\u5e76\u6ca1\u6709\u88ab\u5220\u9664\uff09 $ aws s3 sync s3://my-bucket/path . --delete --exclude \"./MyFile2.rtf\" download: s3://my-bucket/path/MyFile1.txt to MyFile1.txt // \u540c\u6b65\u5220\u9664\u6a21\u5f0f, \u672c\u5730\u7684MyFile2.rtf\u88ab\u5220\u9664\u4e86 $ aws s3 sync s3://my-bucket/path . --delete delete: MyFile2.rtf //\u672c\u5730\u76ee\u5f55\uff1a MyFile1.txt //s3\u6876\uff1a MyFile1.txt \u901a\u8fc7\u8bbe\u7f6e --acl \u6765\u8bbe\u5b9aaccess control list\u8bbf\u95ee\u6743\u9650\uff0c\u6709 private \u3001 public-read \u548c public-read-write \u503c\u3002 $ aws s3 sync . s3://my-bucket/path --acl public-read","title":"\u5173\u4e8esync\u7684\u7528\u6cd5\uff0c\u8fd9\u91cc\u591a\u8bf4\u51e0\u53e5\uff0c\u56e0\u4e3a\u5c06\u6765\u6211\u4eec\u4f1a\u7ecf\u5e38\u6253\u4ea4\u9053\uff0c\u5176\u5e94\u7528\u4e3b\u8981\u6709\u4e09\u7c7b\uff1a"},{"location":"blogs/2020-02-01-s3-data-cli/#_2","text":"\u4f8b\u5982\uff1a os.system(\"aws s3 sync s3://god/ooxx/fq ./path/fq\") ...trim ...map ...gatk os.system(\"aws s3 sync ./path/bam s3://god/ooxx/bam --storage-class STANDARD_IA\") s3 SDK \u53c2\u8003\uff1a \u70b9\u6211 s3 api \u53c2\u8003\uff1a \u70b9\u6211 \u5fc3\u8d70\u5f97\u5feb\u4e86\uff0c\u4e16\u754c\u5c31\u6162\u4e86\u3002","title":"\u6574\u5408\u5230\u73b0\u6709\u4ee3\u7801"},{"location":"blogs/2020-02-02-ebs-snapshot-cli/","text":"\u4f7f\u7528aws cli\u4e3aEBS\u81ea\u52a8\u521b\u5efa\u5feb\u7167 \u7528AWS CLI\u547d\u4ee4\u884c\u6765\u81ea\u52a8\u521b\u5efaEBS\u7684\u5feb\u7167\uff0c\u8fd9\u91cc\u7ed9\u5927\u5bb6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53c2\u8003\u793a\u4f8b\u3002 -- D.C \u53c2\u8003\u539f\u6587 aws cli\u547d\u4ee4\u521b\u5efa\u5feb\u7167 \u4f7f\u7528aws cli ec2\u547d\u4ee4\u4e2d\u7684create-snapshot\u5373\u53ef\u3002 \u8bed\u6cd5\uff1a create-snapshot [--description <value>] --volume-id <value> [--dry-run | --no-dry-run] [--cli-input-json <value>] [--generate-cli-skeleton <value>] \u5982\u7ed9EBS\u5377ID \u4e3a vol-1234567890abcdef \u521b\u5efa\u5feb\u7167\u5e76\u6dfb\u52a0\u63cf\u8ff0. $ aws ec2 create-snapshot --volume-id vol-1234567890abcdef --description \"This is my root volume snapshot.\" { \"Description\": \"This is my root volume snapshot.\", \"Tags\": [], \"VolumeId\": \"vol-1234567890abcdef0\", \"State\": \"pending\", \"VolumeSize\": 8, \"StartTime\": \"2014-02-28T21:06:01.000Z\", \"OwnerId\": \"012345678910\", \"SnapshotId\": \"snap-066877671789bd71b\" } \u7528\u811a\u672c\u81ea\u52a8\u7ba1\u7406\u5feb\u7167 EBS snapshot\u53ef\u4ee5\u76f4\u63a5\u505a\u5168\u91cf\u5907\u4efd\uff0c\u56e0\u4e3aEBS\u5feb\u7167\u7b56\u7565\u662f\u589e\u91cf\u5907\u4efd\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5220\u9664\u539f\u6765\u7684\u5feb\u7167\u3002 \u4ee5\u4e0b\u811a\u672c\u5b9e\u73b0\u5bf9ec2\u5b9e\u4f8b\u8f6e\u8be2\uff0c\u67e5\u8be2\u5230\u6bcf\u4e2aec2\u7684ebs\u5377\uff0c\u5e76\u83b7\u53d6\u5230\u6bcf\u4e2aec2\u7684tag\uff0c\u5c06\u6807\u7b7e\u7684tag\u6253\u7ed9\u505a\u7684\u5feb\u7167\u3002\u5168\u91cf\u5907\u4efd\u7b56\u7565\u5982\u4e0b\uff1a 1\u3001\u6bcf\u5468\u4e00\u6b21ebs\u5feb\u7167\uff0c\u6bcf\u4e2aebs\u4ec5\u4fdd\u7559\u4e24\u5468\uff08\u4e24\u4e2a\uff09\u5feb\u7167\uff1b 2\u3001\u6bcf\u4e2a\u5feb\u7167\u6253\u4e0a\u6807\u7b7e\uff0c\u6807\u7b7e\u4e3a ec2 Name\u6807\u7b7e+\u5377ID+\u5907\u4efd\u65f6\u95f4 3\u3001\u6bcf\u4e2a\u5feb\u7167\u63cf\u8ff0\u4e3a\uff1a \u5907\u4efd\u65f6\u95f4+UTC create snapshot for ec2 \u6807\u7b7e \u5377 ID by awscli\u7528\u6237 on host: \u6267\u884c\u547d\u4ee4\u7528\u6237@\u6267\u884c\u547d\u4ee4\u670d\u52a1\u5668\u540d \u3002 4\u3001\u5220\u9664\u5df2\u4e0d\u5b58\u5728\u5377\uff08\u5b9e\u4f8b\u5220\u9664\uff0c\u5377\u5220\u9664\uff09\u7684\u5386\u53f2\u81ea\u52a8\u5feb\u7167\uff0c\u4e0d\u5f71\u54cd\u624b\u52a8\u5feb\u7167\u3002 #!/bin/bash #create ec2 ebs snapshot per week. PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin #init awscli #yum install -y python-pip #pip install awscli #aws configure log_dir=/tmp/ec2-snapshot/ [ -d ${log_dir} ] || mkdir -p ${log_dir} aws_user=$(aws iam get-user | awk -F\\\" '/UserName/{print $4}') #\u83b7\u53d6\u5b9e\u4f8bid for instance_id in $(aws ec2 describe-instances | awk -F\\\" '/InstanceId/{print $4}') ; do #\u83b7\u53d6\u5b9e\u4f8b\u6807\u7b7e\u540d tag=$(aws ec2 describe-instances --instance-ids ${instance_id} | grep -C1 \"\\\"Key\\\": \\\"Name\\\"\" | awk -F\\\" '/Value/{print $4}') #\u901a\u8fc7\u5b9e\u4f8bid\u83b7\u53d6\u8be5\u5b9e\u4f8b\u6302\u8f7d\u7684\u5377id volumes=$(aws ec2 describe-instances --instance-ids ${instance_id} | awk -F\\\" '/VolumeId/{print $4}') #\u901a\u8fc7\u5377id\u521b\u5efa\u5feb\u7167 for volume in $volumes ; do aws ec2 create-snapshot \\ --volume-id $volume \\ --description \"$(date +%F\\ %T) UTC create snapshot for $tag $volume by $aws_user on host: $(whoami)@$(hostname)\" \\ &>> ${log_dir}create-snapshot-history.log #\u83b7\u53d6\u5feb\u7167id snap_shotId=$(tail -11 ${log_dir}create-snapshot-history.log | awk -F\\\" '/SnapshotId/{print $4}') sleep 10 #\u521b\u5efa\u5feb\u7167\u6807\u7b7e\u540d\u5b57\uff0c\u5b9e\u4f8b\u6807\u7b7e_\u65f6\u671f aws ec2 create-tags --resources ${snap_shotId} --tags Key=Name,Value=${tag}_${volume}_$(date +%Y%m%d) echo ${snap_shotId} >> ${log_dir}$volume.log #\u5224\u65ad\u6bcf\u4e2a\u5377\u7684\u5feb\u7167\u6570\uff0c\u5927\u4e8e3\u4e2a,\u5220\u9664\u8d85\u8fc73\u4e2a\u7684\u6700\u4e45\u7684\u5feb\u7167 num_snap=$(wc -l ${log_dir}$volume.log | awk '{print $1}') if [ ${num_snap} -gt 3 ] ;then old_snapshotid=$(head -$[${num_snap}-3] ${log_dir}$volume.log) for delid in ${old_snapshotid} ;do aws ec2 delete-snapshot --snapshot-id ${delid} 2>> ${log_dir}del-snapshot-error.log sed -i '/'\"$delid\"'/d' ${log_dir}$volume.log done fi done done #\u5220\u9664\u5df2\u4e0d\u5b58\u5728\u5377\u7684\u5386\u53f2\u81ea\u52a8\u5feb\u7167\uff0c\u4e0d\u5f71\u54cd\u624b\u52a8\u5feb\u7167 #\u83b7\u53d6\u73b0\u6709\u5377\u5217\u8868 vol_n=$(aws ec2 describe-instances | awk -F\\\" '/VolumeId/{print $4}') cd ${log_dir} for vol_log in vol-*.log ; do #\u5386\u53f2\u5377id vol_id=${vol_log%.log} #\u5224\u65ad\u5386\u53f2\u5377id\u662f\u5426\u5728\u73b0\u6709\u5377\u5217\u8868\u4e2d\uff0c\u4e0d\u5b58\u5728\u5219\u5220\u9664\u8fd9\u4e2a\u5377\u7684\u6240\u6709\u5feb\u7167 if [ \"${vol_n}\" == \"${vol_n/${vol_id}/#}\" ] ; then while read sanp_his ; do aws ec2 delete-snapshot --snapshot-id ${sanp_his} 2>> ${log_dir}del-snapshot-error.log done < ${vol_log} rm -f ${vol_log} fi done \u767b\u5f55ec2\uff0c\u6216\u8005\u914d\u7f6e\u8fc7aws configure\u7684\u672c\u5730\u670d\u52a1\u5668\uff0c\u8fd0\u884c\u811a\u672c\uff0c LOOK\uff01 \u5b66\u800c\u65f6\u4e60\u4e4b\uff0c\u9ad8\u624b\u5728\u6c11\u95f4\u3002","title":"\u4f7f\u7528aws cli\u4e3aEBS\u81ea\u52a8\u521b\u5efa\u5feb\u7167"},{"location":"blogs/2020-02-02-ebs-snapshot-cli/#aws-cliebs","text":"\u7528AWS CLI\u547d\u4ee4\u884c\u6765\u81ea\u52a8\u521b\u5efaEBS\u7684\u5feb\u7167\uff0c\u8fd9\u91cc\u7ed9\u5927\u5bb6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53c2\u8003\u793a\u4f8b\u3002 -- D.C \u53c2\u8003\u539f\u6587","title":"\u4f7f\u7528aws cli\u4e3aEBS\u81ea\u52a8\u521b\u5efa\u5feb\u7167"},{"location":"blogs/2020-02-02-ebs-snapshot-cli/#aws-cli","text":"\u4f7f\u7528aws cli ec2\u547d\u4ee4\u4e2d\u7684create-snapshot\u5373\u53ef\u3002 \u8bed\u6cd5\uff1a create-snapshot [--description <value>] --volume-id <value> [--dry-run | --no-dry-run] [--cli-input-json <value>] [--generate-cli-skeleton <value>] \u5982\u7ed9EBS\u5377ID \u4e3a vol-1234567890abcdef \u521b\u5efa\u5feb\u7167\u5e76\u6dfb\u52a0\u63cf\u8ff0. $ aws ec2 create-snapshot --volume-id vol-1234567890abcdef --description \"This is my root volume snapshot.\" { \"Description\": \"This is my root volume snapshot.\", \"Tags\": [], \"VolumeId\": \"vol-1234567890abcdef0\", \"State\": \"pending\", \"VolumeSize\": 8, \"StartTime\": \"2014-02-28T21:06:01.000Z\", \"OwnerId\": \"012345678910\", \"SnapshotId\": \"snap-066877671789bd71b\" }","title":"aws cli\u547d\u4ee4\u521b\u5efa\u5feb\u7167"},{"location":"blogs/2020-02-02-ebs-snapshot-cli/#_1","text":"EBS snapshot\u53ef\u4ee5\u76f4\u63a5\u505a\u5168\u91cf\u5907\u4efd\uff0c\u56e0\u4e3aEBS\u5feb\u7167\u7b56\u7565\u662f\u589e\u91cf\u5907\u4efd\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5220\u9664\u539f\u6765\u7684\u5feb\u7167\u3002 \u4ee5\u4e0b\u811a\u672c\u5b9e\u73b0\u5bf9ec2\u5b9e\u4f8b\u8f6e\u8be2\uff0c\u67e5\u8be2\u5230\u6bcf\u4e2aec2\u7684ebs\u5377\uff0c\u5e76\u83b7\u53d6\u5230\u6bcf\u4e2aec2\u7684tag\uff0c\u5c06\u6807\u7b7e\u7684tag\u6253\u7ed9\u505a\u7684\u5feb\u7167\u3002\u5168\u91cf\u5907\u4efd\u7b56\u7565\u5982\u4e0b\uff1a 1\u3001\u6bcf\u5468\u4e00\u6b21ebs\u5feb\u7167\uff0c\u6bcf\u4e2aebs\u4ec5\u4fdd\u7559\u4e24\u5468\uff08\u4e24\u4e2a\uff09\u5feb\u7167\uff1b 2\u3001\u6bcf\u4e2a\u5feb\u7167\u6253\u4e0a\u6807\u7b7e\uff0c\u6807\u7b7e\u4e3a ec2 Name\u6807\u7b7e+\u5377ID+\u5907\u4efd\u65f6\u95f4 3\u3001\u6bcf\u4e2a\u5feb\u7167\u63cf\u8ff0\u4e3a\uff1a \u5907\u4efd\u65f6\u95f4+UTC create snapshot for ec2 \u6807\u7b7e \u5377 ID by awscli\u7528\u6237 on host: \u6267\u884c\u547d\u4ee4\u7528\u6237@\u6267\u884c\u547d\u4ee4\u670d\u52a1\u5668\u540d \u3002 4\u3001\u5220\u9664\u5df2\u4e0d\u5b58\u5728\u5377\uff08\u5b9e\u4f8b\u5220\u9664\uff0c\u5377\u5220\u9664\uff09\u7684\u5386\u53f2\u81ea\u52a8\u5feb\u7167\uff0c\u4e0d\u5f71\u54cd\u624b\u52a8\u5feb\u7167\u3002 #!/bin/bash #create ec2 ebs snapshot per week. PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin #init awscli #yum install -y python-pip #pip install awscli #aws configure log_dir=/tmp/ec2-snapshot/ [ -d ${log_dir} ] || mkdir -p ${log_dir} aws_user=$(aws iam get-user | awk -F\\\" '/UserName/{print $4}') #\u83b7\u53d6\u5b9e\u4f8bid for instance_id in $(aws ec2 describe-instances | awk -F\\\" '/InstanceId/{print $4}') ; do #\u83b7\u53d6\u5b9e\u4f8b\u6807\u7b7e\u540d tag=$(aws ec2 describe-instances --instance-ids ${instance_id} | grep -C1 \"\\\"Key\\\": \\\"Name\\\"\" | awk -F\\\" '/Value/{print $4}') #\u901a\u8fc7\u5b9e\u4f8bid\u83b7\u53d6\u8be5\u5b9e\u4f8b\u6302\u8f7d\u7684\u5377id volumes=$(aws ec2 describe-instances --instance-ids ${instance_id} | awk -F\\\" '/VolumeId/{print $4}') #\u901a\u8fc7\u5377id\u521b\u5efa\u5feb\u7167 for volume in $volumes ; do aws ec2 create-snapshot \\ --volume-id $volume \\ --description \"$(date +%F\\ %T) UTC create snapshot for $tag $volume by $aws_user on host: $(whoami)@$(hostname)\" \\ &>> ${log_dir}create-snapshot-history.log #\u83b7\u53d6\u5feb\u7167id snap_shotId=$(tail -11 ${log_dir}create-snapshot-history.log | awk -F\\\" '/SnapshotId/{print $4}') sleep 10 #\u521b\u5efa\u5feb\u7167\u6807\u7b7e\u540d\u5b57\uff0c\u5b9e\u4f8b\u6807\u7b7e_\u65f6\u671f aws ec2 create-tags --resources ${snap_shotId} --tags Key=Name,Value=${tag}_${volume}_$(date +%Y%m%d) echo ${snap_shotId} >> ${log_dir}$volume.log #\u5224\u65ad\u6bcf\u4e2a\u5377\u7684\u5feb\u7167\u6570\uff0c\u5927\u4e8e3\u4e2a,\u5220\u9664\u8d85\u8fc73\u4e2a\u7684\u6700\u4e45\u7684\u5feb\u7167 num_snap=$(wc -l ${log_dir}$volume.log | awk '{print $1}') if [ ${num_snap} -gt 3 ] ;then old_snapshotid=$(head -$[${num_snap}-3] ${log_dir}$volume.log) for delid in ${old_snapshotid} ;do aws ec2 delete-snapshot --snapshot-id ${delid} 2>> ${log_dir}del-snapshot-error.log sed -i '/'\"$delid\"'/d' ${log_dir}$volume.log done fi done done #\u5220\u9664\u5df2\u4e0d\u5b58\u5728\u5377\u7684\u5386\u53f2\u81ea\u52a8\u5feb\u7167\uff0c\u4e0d\u5f71\u54cd\u624b\u52a8\u5feb\u7167 #\u83b7\u53d6\u73b0\u6709\u5377\u5217\u8868 vol_n=$(aws ec2 describe-instances | awk -F\\\" '/VolumeId/{print $4}') cd ${log_dir} for vol_log in vol-*.log ; do #\u5386\u53f2\u5377id vol_id=${vol_log%.log} #\u5224\u65ad\u5386\u53f2\u5377id\u662f\u5426\u5728\u73b0\u6709\u5377\u5217\u8868\u4e2d\uff0c\u4e0d\u5b58\u5728\u5219\u5220\u9664\u8fd9\u4e2a\u5377\u7684\u6240\u6709\u5feb\u7167 if [ \"${vol_n}\" == \"${vol_n/${vol_id}/#}\" ] ; then while read sanp_his ; do aws ec2 delete-snapshot --snapshot-id ${sanp_his} 2>> ${log_dir}del-snapshot-error.log done < ${vol_log} rm -f ${vol_log} fi done \u767b\u5f55ec2\uff0c\u6216\u8005\u914d\u7f6e\u8fc7aws configure\u7684\u672c\u5730\u670d\u52a1\u5668\uff0c\u8fd0\u884c\u811a\u672c\uff0c LOOK\uff01 \u5b66\u800c\u65f6\u4e60\u4e4b\uff0c\u9ad8\u624b\u5728\u6c11\u95f4\u3002","title":"\u7528\u811a\u672c\u81ea\u52a8\u7ba1\u7406\u5feb\u7167"},{"location":"blogs/2020-02-02-ec2-ebs-attach/","text":"\u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d\uff1f\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\u5e76\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\uff01 \u5728\u521b\u5efaEC2\u7684\u65f6\u5019\uff0c\u4f1a\u8ba9\u6211\u4eec\u9009\u62e9\u6302\u8f7d\u7684\u5b58\u50a8\uff0c\u9ed8\u8ba4\u662f\u4e00\u4e2aRoot\u76d8\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u6302\u8f7d\u66f4\u591a\u7684EBS\u76d8\u6765\u6ee1\u8db3\u6211\u4eec\u4e0d\u540c\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u6765\u5b66\u4e60\u4e0b\u5982\u4f55\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\uff0c\u5e76\u4e14\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\u5427\uff01 -- D.C \u521b\u5efaEC2\u6302\u8f7d\u591a\u5757\u78c1\u76d8 \u521b\u5efaec2\u7684step 4\uff0c\u6dfb\u52a0\u66f4\u591a\u78c1\u76d8\uff0c\u8fd9\u91cc\u7cfb\u7edf\u76d8\u8bbe\u7f6e\u4e3a30G\uff0c\u53e6\u5916\u6dfb\u52a0\u4e86\u4e24\u5757EBS\u5206\u522b\u4e3a80G\uff0c100G\uff0c\u4e00\u6b65\u6b65\u521b\u5efaec2\u3002 \u7b49ec2\u542f\u52a8\u6b63\u5e38\u8fd0\u884c\u540e\uff0c\u6211\u4eecssh\u5230ec2\uff0c\u67e5\u770b\u78c1\u76d8\u72b6\u6001 df -h ,\u53ef\u4ee5\u770b\u5230\u53ea\u6709\u4e00\u575730G\u7684\u7cfb\u7edf\u76d8\u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 408K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 \u63a5\u7740\uff0c\u7528 lsblk \u547d\u4ee4\u67e5\u770b\u53ef\u7528\u78c1\u76d8\u53ca\u5176\u6302\u8f7d\u70b9, \u6211\u4eec\u5c31\u77e5\u9053\u53e6\u5916\u4e24\u5757\u78c1\u76d8\u8bbe\u5907\u53eb xvdb \u548c xvdc \u3002 $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT xvda 202:0 0 30G 0 disk `-xvda1 202:1 0 30G 0 part / xvdb 202:16 0 80G 0 disk xvdc 202:32 0 100G 0 disk \u4f7f\u7528 file -s \u547d\u4ee4\u83b7\u53d6\u8bbe\u5907\u4fe1\u606f\uff0c\u4f8b\u5982\u5176\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3002\u5982\u679c\u8f93\u51fa\u4ec5\u663e\u793a data \uff08\u5982\u4ee5\u4e0b\u793a\u4f8b\u8f93\u51fa\uff09\uff0c\u5219\u8bf4\u660e\u8bbe\u5907\u4e0a\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u5c31\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u65b0\u52a0\u7684\u4e24\u5757\u78c1\u76d8\u90fd\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\u3002 $ sudo file -s /dev/xvda1 /dev/xvda1: SGI XFS filesystem data (blksz 4096, inosz 512, v2 dirs) $ sudo file -s /dev/xvdb /dev/xvdb: data $ sudo file -s /dev/xvdc /dev/xvdc: data \u4f7f\u7528 mkfs -t \u547d\u4ee4\u5728\u65b0\u52a0\u5377\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 $ sudo mkfs -t xfs /dev/xvdb meta-data=/dev/xvdb isize=512 agcount=4, agsize=5242880 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=20971520, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=10240, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 $ sudo mkfs -t xfs /dev/xvdc meta-data=/dev/xvdc isize=512 agcount=4, agsize=6553600 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=26214400, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=12800, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 Debug \uff1a\u5982\u679c\u63d0\u793a\u201c\u627e\u4e0d\u5230 mkfs.xfs\u201d\uff0c\u7528\u8fd9\u4e2a\u547d\u4ee4 sudo yum install xfsprogs \u5b89\u88c5XFS\uff0c\u7136\u540e\u518d\u8bd5\u3002 \u4f7f\u7528mkdir\u547d\u4ee4\u521b\u5efa\u5377\u7684\u6302\u8f7d\u70b9\u76ee\u5f55\u3002\u6bd4\u598280G\u7684\u5377 xvdb \u6211\u62ff\u6765\u653e\u6570\u636e\u5e93\uff0c\u90a3\u5c31\u521b\u5efa\u4e00\u4e2a /db \u7684\u76ee\u5f55;100G\u7684\u5377 xvdc \u6211\u62ff\u6765\u653e\u5f85\u5206\u6790\u7684\u57fa\u56e0\u6570\u636e\uff0c\u90a3\u5c31\u521b\u5efa /data \u3002 $ sudo mkdir /db $ sudo mkdir /data \u4f7f\u7528 mount \u547d\u4ee4\u6302\u8f7d\u76f8\u5e94\u7684\u5377,\u8fd9\u4e2a\u65f6\u5019\u662f\u6ca1\u6743\u9650\u5199\u5165\u7684\u54e6~\u600e\u4e48\u529e\uff1f\u52a0\u6743\u9650\uff01 $ sudo mount /dev/xvdb /db $ sudo mount /dev/xvdc /data $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 464K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 tmpfs 99M 0 99M 0% /run/user/0 /dev/xvdb 80G 114M 80G 1% /db /dev/xvdc 100G 135M 100G 1% /data \u5c06\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5939\u7684\u5c5e\u4e3b\u548c\u5c5e\u7ec4\u90fd\u6539\u4e3a ec2-user , \u6d4b\u8bd5\u5199\u5165\uff0c\u6210\u529f\uff01 $ sudo chown -R ec2-user.ec2-user /db $ sudo chown -R ec2-user.ec2-user /data $ ll drwxr-xr-x 2 ec2-user ec2-user 6 Feb 2 09:05 data drwxr-xr-x 2 ec2-user ec2-user 15 Feb 2 09:18 db $ touch /db/1 $ touch /data/1 \u8fd9\u6837\u5c31\u5b9e\u73b0\u6302\u8f7d\u5566\uff0c\u5982\u679c\u8fd9\u53f0\u5b9e\u4f8b\u4e00\u76f4\u5f00\u7740\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u6d17\u6d17\u7761\u4e86\u3002\u4f46\u662f\u5982\u679c\u5c06\u6765\u53ef\u80fd\u4f1a\u91cd\u542f\u8fd9\u4e2a\u5b9e\u4f8b\uff0c\u4e4b\u524d\u7684\u6302\u8f7d\u70b9\u662f\u4e0d\u4f1a\u81ea\u52a8\u4fdd\u7559\u7684\u3002\u8981\u5728\u91cd\u542f\u540e\u81ea\u52a8\u6302\u8f7d\u6b64 EBS \u5377\uff0c\u5404\u4f4d\u770b\u5b98\u8bf7\u5f80\u4e0b\u770b\u3002 \u91cd\u542f\u540e\u81ea\u52a8\u9644\u52a0\u9644\u52a0\u5377 \u8981\u5728\u6bcf\u6b21\u7cfb\u7edf\u91cd\u542f\u65f6\u9644\u52a0\u9644\u52a0\u7684 EBS \u5377\uff0c\u53ef\u5728 /etc/fstab \u6587\u4ef6\u4e2d\u4e3a\u8be5\u8bbe\u5907\u6dfb\u52a0\u4e00\u4e2a\u6761\u76ee\u3002\u6211\u4eec\u53ef\u4ee5\u5728 /etc/fstab \u4e2d\u4f7f\u7528\u8bbe\u5907\u540d\u79f0\uff08\u5982 /dev/xvdf\uff09\uff0c\u4f46\u5efa\u8bae\u6539\u4e3a\u4f7f\u7528\u8bbe\u5907\u7684 128 \u4f4d\u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26 (UUID)\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u4ee5\u66f4\u6539\uff0c\u4f46 UUID \u4f1a\u5728\u6574\u4e2a\u5206\u533a\u7684\u4f7f\u7528\u5bff\u547d\u671f\u95f4\u4fdd\u7559\u3002\u901a\u8fc7\u4f7f\u7528 UUID\uff0c\u5c31\u53ef\u4ee5\u51cf\u5c11\u7cfb\u7edf\u5728\u786c\u4ef6\u91cd\u65b0\u914d\u7f6e\u540e\u65e0\u6cd5\u542f\u52a8\u7684\u673a\u4f1a\u3002 \u521b\u5efa /etc/fstab \u6587\u4ef6\u7684\u5907\u4efd\uff0c\u4ee5\u4fbf\u6211\u4eec\u5728\u7f16\u8f91\u65f6\u8bef\u635f\u574f\u6216\u5220\u9664\u6b64\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u6062\u590d\u5230\u539f\u6765\u7684\u72b6\u6001\u3002 $ sudo cp /etc/fstab /etc/fstab.orig \u4f7f\u7528 blkid \u547d\u4ee4\u67e5\u627e\u8bbe\u5907\u7684 UUID\u3002\u5982\u679c\u662f ubuntu \u7cfb\u7edf\uff0c\u8bf7\u7528 lsblk \u547d\u4ee4\uff1a sudo lsblk -o +UUID \u3002 $ sudo blkid /dev/xvda1: LABEL=\"/\" UUID=\"966db7d5-c190-4987-b5a9-c60e4a9f4ed0\" TYPE=\"xfs\" PARTLABEL=\"Linux\" PARTUUID=\"f6ad119a-c111-4db5-85aa-9ce50ee2725b\" /dev/xvdb: UUID=\"2696c94b-99ed-4e8b-ab08-5f27fc5d6f55\" TYPE=\"xfs\" /dev/xvdc: UUID=\"b1c4720c-3d7e-464a-9eb7-b383678f511b\" TYPE=\"xfs\" \u7f16\u8f91 fstab , \u6dfb\u52a0\u6761\u76ee\u3002 $ sudo vim /etc/fstab //\u6dfb\u52a0\u5982\u4e0b\u6761\u76ee UUID=2696c94b-99ed-4e8b-ab08-5f27fc5d6f55 /db xfs defaults,nofail 0 2 UUID=b1c4720c-3d7e-464a-9eb7-b383678f511b /data xfs defaults,nofail 0 2 \u6b32\u77e5\u8be6\u60c5\uff0c\u8bf7\u6253\u547d\u4ee4 man fstab \u3002 \u6700\u540e\u68c0\u67e5\u6761\u76ee\u662f\u5426\u6709\u6548\u3002 $ sudo umount /db $ sudo umount /data $ sudo mount -a $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 448K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 /dev/xvdb 80G 114M 80G 1% /db /dev/xvdc 100G 135M 100G 1% /data reboot/stop start \u5b9e\u4f8b\uff0c\u67e5\u770b\u662f\u5426\u81ea\u52a8\u6302\u8f7d,\u6ca1\u95ee\u9898\uff01\uff08\u6ce8\u610f\u91cd\u542f\u4ee5\u540e \u516c\u7f51IP \u4f1a\u53d8\u54e6:-\uff09\u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 416K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / /dev/xvdc 100G 135M 100G 1% /data /dev/xvdb 80G 114M 80G 1% /db tmpfs 99M 0 99M 0% /run/user/1000 \u76f8\u4fe1\u56e0\u4e3a\u76f8\u4fe1\uff0c\u72ec\u884c\u56e0\u4e3a\u72ec\u884c\u3002","title":"\u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d\uff1f\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\u5e76\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\uff01"},{"location":"blogs/2020-02-02-ec2-ebs-attach/#ec2","text":"\u5728\u521b\u5efaEC2\u7684\u65f6\u5019\uff0c\u4f1a\u8ba9\u6211\u4eec\u9009\u62e9\u6302\u8f7d\u7684\u5b58\u50a8\uff0c\u9ed8\u8ba4\u662f\u4e00\u4e2aRoot\u76d8\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u6302\u8f7d\u66f4\u591a\u7684EBS\u76d8\u6765\u6ee1\u8db3\u6211\u4eec\u4e0d\u540c\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u6765\u5b66\u4e60\u4e0b\u5982\u4f55\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\uff0c\u5e76\u4e14\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\u5427\uff01 -- D.C","title":"\u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d\uff1f\u6302\u8f7d\u66f4\u591a\u78c1\u76d8\u5e76\u5b9e\u73b0\u81ea\u52a8\u6302\u8f7d\uff01"},{"location":"blogs/2020-02-02-ec2-ebs-attach/#ec2_1","text":"\u521b\u5efaec2\u7684step 4\uff0c\u6dfb\u52a0\u66f4\u591a\u78c1\u76d8\uff0c\u8fd9\u91cc\u7cfb\u7edf\u76d8\u8bbe\u7f6e\u4e3a30G\uff0c\u53e6\u5916\u6dfb\u52a0\u4e86\u4e24\u5757EBS\u5206\u522b\u4e3a80G\uff0c100G\uff0c\u4e00\u6b65\u6b65\u521b\u5efaec2\u3002 \u7b49ec2\u542f\u52a8\u6b63\u5e38\u8fd0\u884c\u540e\uff0c\u6211\u4eecssh\u5230ec2\uff0c\u67e5\u770b\u78c1\u76d8\u72b6\u6001 df -h ,\u53ef\u4ee5\u770b\u5230\u53ea\u6709\u4e00\u575730G\u7684\u7cfb\u7edf\u76d8\u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 408K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 \u63a5\u7740\uff0c\u7528 lsblk \u547d\u4ee4\u67e5\u770b\u53ef\u7528\u78c1\u76d8\u53ca\u5176\u6302\u8f7d\u70b9, \u6211\u4eec\u5c31\u77e5\u9053\u53e6\u5916\u4e24\u5757\u78c1\u76d8\u8bbe\u5907\u53eb xvdb \u548c xvdc \u3002 $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT xvda 202:0 0 30G 0 disk `-xvda1 202:1 0 30G 0 part / xvdb 202:16 0 80G 0 disk xvdc 202:32 0 100G 0 disk \u4f7f\u7528 file -s \u547d\u4ee4\u83b7\u53d6\u8bbe\u5907\u4fe1\u606f\uff0c\u4f8b\u5982\u5176\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3002\u5982\u679c\u8f93\u51fa\u4ec5\u663e\u793a data \uff08\u5982\u4ee5\u4e0b\u793a\u4f8b\u8f93\u51fa\uff09\uff0c\u5219\u8bf4\u660e\u8bbe\u5907\u4e0a\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u5c31\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u65b0\u52a0\u7684\u4e24\u5757\u78c1\u76d8\u90fd\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\u3002 $ sudo file -s /dev/xvda1 /dev/xvda1: SGI XFS filesystem data (blksz 4096, inosz 512, v2 dirs) $ sudo file -s /dev/xvdb /dev/xvdb: data $ sudo file -s /dev/xvdc /dev/xvdc: data \u4f7f\u7528 mkfs -t \u547d\u4ee4\u5728\u65b0\u52a0\u5377\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 $ sudo mkfs -t xfs /dev/xvdb meta-data=/dev/xvdb isize=512 agcount=4, agsize=5242880 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=20971520, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=10240, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 $ sudo mkfs -t xfs /dev/xvdc meta-data=/dev/xvdc isize=512 agcount=4, agsize=6553600 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=26214400, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=12800, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 Debug \uff1a\u5982\u679c\u63d0\u793a\u201c\u627e\u4e0d\u5230 mkfs.xfs\u201d\uff0c\u7528\u8fd9\u4e2a\u547d\u4ee4 sudo yum install xfsprogs \u5b89\u88c5XFS\uff0c\u7136\u540e\u518d\u8bd5\u3002 \u4f7f\u7528mkdir\u547d\u4ee4\u521b\u5efa\u5377\u7684\u6302\u8f7d\u70b9\u76ee\u5f55\u3002\u6bd4\u598280G\u7684\u5377 xvdb \u6211\u62ff\u6765\u653e\u6570\u636e\u5e93\uff0c\u90a3\u5c31\u521b\u5efa\u4e00\u4e2a /db \u7684\u76ee\u5f55;100G\u7684\u5377 xvdc \u6211\u62ff\u6765\u653e\u5f85\u5206\u6790\u7684\u57fa\u56e0\u6570\u636e\uff0c\u90a3\u5c31\u521b\u5efa /data \u3002 $ sudo mkdir /db $ sudo mkdir /data \u4f7f\u7528 mount \u547d\u4ee4\u6302\u8f7d\u76f8\u5e94\u7684\u5377,\u8fd9\u4e2a\u65f6\u5019\u662f\u6ca1\u6743\u9650\u5199\u5165\u7684\u54e6~\u600e\u4e48\u529e\uff1f\u52a0\u6743\u9650\uff01 $ sudo mount /dev/xvdb /db $ sudo mount /dev/xvdc /data $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 464K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 tmpfs 99M 0 99M 0% /run/user/0 /dev/xvdb 80G 114M 80G 1% /db /dev/xvdc 100G 135M 100G 1% /data \u5c06\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5939\u7684\u5c5e\u4e3b\u548c\u5c5e\u7ec4\u90fd\u6539\u4e3a ec2-user , \u6d4b\u8bd5\u5199\u5165\uff0c\u6210\u529f\uff01 $ sudo chown -R ec2-user.ec2-user /db $ sudo chown -R ec2-user.ec2-user /data $ ll drwxr-xr-x 2 ec2-user ec2-user 6 Feb 2 09:05 data drwxr-xr-x 2 ec2-user ec2-user 15 Feb 2 09:18 db $ touch /db/1 $ touch /data/1 \u8fd9\u6837\u5c31\u5b9e\u73b0\u6302\u8f7d\u5566\uff0c\u5982\u679c\u8fd9\u53f0\u5b9e\u4f8b\u4e00\u76f4\u5f00\u7740\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u6d17\u6d17\u7761\u4e86\u3002\u4f46\u662f\u5982\u679c\u5c06\u6765\u53ef\u80fd\u4f1a\u91cd\u542f\u8fd9\u4e2a\u5b9e\u4f8b\uff0c\u4e4b\u524d\u7684\u6302\u8f7d\u70b9\u662f\u4e0d\u4f1a\u81ea\u52a8\u4fdd\u7559\u7684\u3002\u8981\u5728\u91cd\u542f\u540e\u81ea\u52a8\u6302\u8f7d\u6b64 EBS \u5377\uff0c\u5404\u4f4d\u770b\u5b98\u8bf7\u5f80\u4e0b\u770b\u3002","title":"\u521b\u5efaEC2\u6302\u8f7d\u591a\u5757\u78c1\u76d8"},{"location":"blogs/2020-02-02-ec2-ebs-attach/#_1","text":"\u8981\u5728\u6bcf\u6b21\u7cfb\u7edf\u91cd\u542f\u65f6\u9644\u52a0\u9644\u52a0\u7684 EBS \u5377\uff0c\u53ef\u5728 /etc/fstab \u6587\u4ef6\u4e2d\u4e3a\u8be5\u8bbe\u5907\u6dfb\u52a0\u4e00\u4e2a\u6761\u76ee\u3002\u6211\u4eec\u53ef\u4ee5\u5728 /etc/fstab \u4e2d\u4f7f\u7528\u8bbe\u5907\u540d\u79f0\uff08\u5982 /dev/xvdf\uff09\uff0c\u4f46\u5efa\u8bae\u6539\u4e3a\u4f7f\u7528\u8bbe\u5907\u7684 128 \u4f4d\u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26 (UUID)\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u4ee5\u66f4\u6539\uff0c\u4f46 UUID \u4f1a\u5728\u6574\u4e2a\u5206\u533a\u7684\u4f7f\u7528\u5bff\u547d\u671f\u95f4\u4fdd\u7559\u3002\u901a\u8fc7\u4f7f\u7528 UUID\uff0c\u5c31\u53ef\u4ee5\u51cf\u5c11\u7cfb\u7edf\u5728\u786c\u4ef6\u91cd\u65b0\u914d\u7f6e\u540e\u65e0\u6cd5\u542f\u52a8\u7684\u673a\u4f1a\u3002 \u521b\u5efa /etc/fstab \u6587\u4ef6\u7684\u5907\u4efd\uff0c\u4ee5\u4fbf\u6211\u4eec\u5728\u7f16\u8f91\u65f6\u8bef\u635f\u574f\u6216\u5220\u9664\u6b64\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u6062\u590d\u5230\u539f\u6765\u7684\u72b6\u6001\u3002 $ sudo cp /etc/fstab /etc/fstab.orig \u4f7f\u7528 blkid \u547d\u4ee4\u67e5\u627e\u8bbe\u5907\u7684 UUID\u3002\u5982\u679c\u662f ubuntu \u7cfb\u7edf\uff0c\u8bf7\u7528 lsblk \u547d\u4ee4\uff1a sudo lsblk -o +UUID \u3002 $ sudo blkid /dev/xvda1: LABEL=\"/\" UUID=\"966db7d5-c190-4987-b5a9-c60e4a9f4ed0\" TYPE=\"xfs\" PARTLABEL=\"Linux\" PARTUUID=\"f6ad119a-c111-4db5-85aa-9ce50ee2725b\" /dev/xvdb: UUID=\"2696c94b-99ed-4e8b-ab08-5f27fc5d6f55\" TYPE=\"xfs\" /dev/xvdc: UUID=\"b1c4720c-3d7e-464a-9eb7-b383678f511b\" TYPE=\"xfs\" \u7f16\u8f91 fstab , \u6dfb\u52a0\u6761\u76ee\u3002 $ sudo vim /etc/fstab //\u6dfb\u52a0\u5982\u4e0b\u6761\u76ee UUID=2696c94b-99ed-4e8b-ab08-5f27fc5d6f55 /db xfs defaults,nofail 0 2 UUID=b1c4720c-3d7e-464a-9eb7-b383678f511b /data xfs defaults,nofail 0 2 \u6b32\u77e5\u8be6\u60c5\uff0c\u8bf7\u6253\u547d\u4ee4 man fstab \u3002 \u6700\u540e\u68c0\u67e5\u6761\u76ee\u662f\u5426\u6709\u6548\u3002 $ sudo umount /db $ sudo umount /data $ sudo mount -a $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 448K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / tmpfs 99M 0 99M 0% /run/user/1000 /dev/xvdb 80G 114M 80G 1% /db /dev/xvdc 100G 135M 100G 1% /data reboot/stop start \u5b9e\u4f8b\uff0c\u67e5\u770b\u662f\u5426\u81ea\u52a8\u6302\u8f7d,\u6ca1\u95ee\u9898\uff01\uff08\u6ce8\u610f\u91cd\u542f\u4ee5\u540e \u516c\u7f51IP \u4f1a\u53d8\u54e6:-\uff09\u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 475M 0 475M 0% /dev tmpfs 492M 0 492M 0% /dev/shm tmpfs 492M 416K 492M 1% /run tmpfs 492M 0 492M 0% /sys/fs/cgroup /dev/xvda1 30G 1.3G 29G 5% / /dev/xvdc 100G 135M 100G 1% /data /dev/xvdb 80G 114M 80G 1% /db tmpfs 99M 0 99M 0% /run/user/1000 \u76f8\u4fe1\u56e0\u4e3a\u76f8\u4fe1\uff0c\u72ec\u884c\u56e0\u4e3a\u72ec\u884c\u3002","title":"\u91cd\u542f\u540e\u81ea\u52a8\u9644\u52a0\u9644\u52a0\u5377"},{"location":"blogs/2020-02-02-vpc-endpoint-s3/","text":"\u52a0\u901f\uff01\u4e3aEC2\u548cS3\u4e4b\u95f4\u642d\u5efa\u7231\u7684\u6865\u6881 S3\u80fd\u4e3a\u6211\u4eec\u63d0\u4f9b\u5b89\u5168\u3001\u8010\u7528\u4e14\u5177\u5907\u9ad8\u5ea6\u53ef\u6269\u5c55\u80fd\u529b\u7684\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u3002Virtual Private Cloud\u5219\u7ed9\u6211\u4eec\u5728\u4e91\u7aef\u521b\u5efa\u51fa\u4e00\u5957AWS Cloud\u903b\u8f91\u9694\u79bb\u533a\uff0c\u5e76\u901a\u8fc7\u81ea\u5df1\u5b9a\u4e49\u7684\u865a\u62df\u7f51\u7edc\u5bf9\u5176\u8fdb\u884c\u5168\u9762\u63a7\u5236\u3002EC2\u670d\u52a1\u5668\u5c31\u662f\u5728VPC\u8fd9\u4e2a\u7f51\u7edc\u73af\u5883\u5185\u8fdb\u884c\u5de5\u4f5c\u548c\u53d7\u7ba1\u7406\u7684\u3002 \u5f53\u6211\u4eec\u521b\u5efaVPC\u65f6\uff0c\u9700\u8981\u5229\u7528\u5b89\u5168\u7ec4\u4e0e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08\u7b80\u79f0ACL\uff09\u5bf9\u8f93\u5165\u53ca\u8f93\u51fa\u6d41\u91cf\u8fdb\u884c\u63a7\u5236\u3002\u5728\u7ec8\u7aef\u8282\u70b9\uff08endpoint\uff09\u670d\u52a1\u51fa\u73b0\u4e4b\u524d\uff0c\u5982\u679c\u5927\u5bb6\u5e0c\u671b\u8ba9\u81ea\u5df1\u7684EC2\u5b9e\u4f8b\u6709\u80fd\u529b\u8bbf\u95ee\u516c\u6709\u8d44\u6e90\uff0c\u5219\u5fc5\u987b\u4f7f\u7528Internet Gateway\uff0c\u4e14\u53ef\u80fd\u9700\u8981\u5bf9\u90e8\u5206NAT\u5b9e\u4f8b\u8fdb\u884c\u7ba1\u7406\u3002\u800c\u73b0\u5728\uff0c\u66f4\u6613\u4e8e\u914d\u7f6e\u3001\u5177\u5907\u9ad8\u5ea6\u53ef\u9760\u6027\u7684Endpoints\u80fd\u591f\u4e3a\u6211\u4eec\u63d0\u4f9b\u6307\u5411S3\u7684\u5b89\u5168\u79c1\u6709\u8fde\u63a5\uff0c\u800c\u4e14\u6574\u4e2a\u6d41\u7a0b\u4e0d\u9700\u8981\u4efb\u4f55\u7f51\u5173\u6216\u8005NAT\u5b9e\u4f8b\u7684\u4ecb\u5165\u3002\u6ce8\u610f\uff0c\u8fd9\u662f\u79c1\u7f51\u3002 -- D.C Update: endpoint \u9488\u5bf9\u4e0d\u51fa\u7f51\u7684\u79c1\u6709\u5b50\u7f51\u5185\u7684\u5b9e\u4f8b\u8bbf\u95eeS3\u6216\u8005\u5176\u4ed6\u652f\u6301\u7684AWS\u670d\u52a1\uff0c\u800c\u65e0\u9700internet\u7f51\u5173\u3001NAT\u7f51\u5173\u3001VPN\u7b49\uff0c\u5c5e\u4e8e\u5185\u90e8\u7684\u8fde\u63a5\uff0c\u4e0d\u5177\u5907\u63d0\u5347\u8bbf\u95ee\u901f\u5ea6\u7684\u529f\u80fd\u3002 \u4ec0\u4e48\u662fVPC\uff1f Amazon Virtual Private Cloud (Amazon VPC),\u7b80\u5355\u7406\u89e3\uff0c\u5c31\u662f\u5728\u4e91\u4e0a\u5efa\u4e2a\u5927\u697c\uff0c\u5927\u697c\u91cc\u9762\u7684\u7f51\u7edc\u3001\u95e8\u7981\uff0c\u5b89\u68c0\u7b49\u90fd\u4e00\u5e94\u4ff1\u5168\uff0c\u6211\u4eec\u6839\u636e\u9700\u8981\u5728\u5927\u697c\u91cc\u9009\u62e9\u623f\u95f4\uff08\u521b\u5efaec2\uff09\u529e\u516c\uff0c\u8fd9\u4e2a\u623f\u95f4\u81ea\u5df1\u4e5f\u6709\u76f8\u5e94\u7684\u95e8\u7981\u7cfb\u7edf\u3002 VPC\u4e00\u4e2a\u91cd\u8981\u7684\u529f\u80fd\u662f\u4e3a\u5176\u4e2d\u7684\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u6bd4\u5982\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u5bf9\u6210\u767e\u4e0a\u5343\u7684EC2\u8fdb\u884c\u7edf\u4e00\u7684\u7f51\u7edc\u7ba1\u7406\u3002 \u521b\u5efa VPC endpoint \u56e0\u4e3a\u6211\u4eec\u8981\u8fde\u63a5\u7684EC2\u90fd\u662f\u5728VPC\u7684\u73af\u5883\u4e2d\uff0c\u5982\u679c\u7ed9EC2\u548cs3\u4e4b\u95f4\u5efa\u4e13\u5c5e\u516c\u8def\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5728VPC\u548cs3\u4e4b\u95f4\u521b\u5efa\u4e00\u4e2aendpoint\u5c31\u53ef\u4ee5\u4e86\u3002 \u767b\u5f55 aws\u7ba1\u7406\u63a7\u5236\u53f0 \uff0c\u641c\u7d22 VPC \uff0c\u70b9\u51fb\u8fdb\u5165\u3002\u7b80\u5355\u770b\u4e0bdashboard\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u7684 Endpoints \u3002 \u70b9\u51fb\u754c\u9762\u4e0a\u65b9\u7684 Create Endpoint ,\u8fdb\u5165\u9009\u62e9\u754c\u9762\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c Service category \u8fd9\u91cc\uff0c\u7cfb\u7edf\u81ea\u52a8\u5e2e\u6211\u4eec\u9009\u62e9\u4e86 AWS service ,\u800c Service Name \u8fd9\u513f\u9700\u8981\u6211\u4eec\u5177\u4f53\u9009\u62e9\u4e00\u9879aws\u7684\u670d\u52a1\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\uff0c\u4f60\u8981\u7ed9vpc\u5efa\u4e00\u6761\u4e13\u5c5e\u516c\u8def\u901a\u5230\u90a3\u91cc\u53bb\u5462\uff1f\u4f60\u5f97\u544a\u8bc9\u6211\u554a\uff0c\u6ca1\u9519\uff0c\u6211\u4eec\u8fd9\u91cc\u9009\u62e9s3\u670d\u52a1 com.amazonaws.cn-northwest-1.s3 \u3002 \u63a5\u7740\u9009\u62e9VPC\uff0c\u5f88\u7b80\u5355\uff0c\u6211\u8981\u8fde\u7684ec2\u5728\u54ea\u4e2avpc\u91cc\uff0c\u5c31\u9009\u90a3\u4e2aVPC\u3002\u4e4b\u540e\u9009\u4e2d\u8def\u7531\u8868\uff0c\u8fd9\u6837endpoint\u5c31\u4f1a\u5728\u6211\u9009\u4e2d\u7684\u8fd9\u4e2avpc\u7684\u8def\u7531\u8868\u91cc\u5199\u5165\u4e00\u6761 \u89c4\u5219 \uff1a Destination \u662fs3, Target \u662fendpoint\u3002 Policy \u8bbe\u7f6e\u4e3a Full Access ,\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684json\u683c\u5f0f\u5982\u4e0b\uff0c\u610f\u601d\u662fAllow\u6240\u6709\u7684action\uff0c\u9488\u5bf9\u6240\u6709resource\uff0c\u9002\u7528\u4e8e\u6240\u6709\u89d2\u8272\u3002\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u81ea\u5b9a\u4e49\u7b56\u7565\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u5982\u679c\u521b\u5efa\u597dendpoint\u4ee5\u540e\u6211\u4eec\u518d\u53bb\u4fee\u6539\u7b56\u7565\uff0c\u90a3\u4e48\u6240\u505a\u7684\u66f4\u6539\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u751f\u6548\u54e6\u3002 { \"Statement\": [ { \"Action\": \"*\", \"Effect\": \"Allow\", \"Resource\": \"*\", \"Principal\": \"*\" } ] } \u70b9\u51fb Create endpoint \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230Endpoint ID\u4e3a vpce-0c9f13443d1f8c0d0 \u7684\u7ec8\u7aef\u8282\u70b9\u5c31\u521b\u5efa\u597d\u4e86\u3002\u8fd9\u4e5f\u610f\u5473\u7740\uff0c\u5728 vpc-37a41d5e \u8fd9\u4e2aVPC\u91cc\u7684EC2\u4eec\u5c31\u53ef\u4ee5\u7545\u5feb\u5730\u548c\u4f4f\u5728s3\u91cc\u7684\u516c\u4e3b\u8c08\u573a\u604b\u7231\u4e86~ \u767b\u5f55ec2\uff0c\u611f\u53d7Endpoint\u5e26\u6765\u7684\u751c\u871c\u5427\uff01 \u61d2\u65e0\u6b62\u5883","title":"\u52a0\u901f\uff01\u4e3aEC2\u548cS3\u4e4b\u95f4\u642d\u5efa\u7231\u7684\u6865\u6881"},{"location":"blogs/2020-02-02-vpc-endpoint-s3/#ec2s3","text":"S3\u80fd\u4e3a\u6211\u4eec\u63d0\u4f9b\u5b89\u5168\u3001\u8010\u7528\u4e14\u5177\u5907\u9ad8\u5ea6\u53ef\u6269\u5c55\u80fd\u529b\u7684\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u3002Virtual Private Cloud\u5219\u7ed9\u6211\u4eec\u5728\u4e91\u7aef\u521b\u5efa\u51fa\u4e00\u5957AWS Cloud\u903b\u8f91\u9694\u79bb\u533a\uff0c\u5e76\u901a\u8fc7\u81ea\u5df1\u5b9a\u4e49\u7684\u865a\u62df\u7f51\u7edc\u5bf9\u5176\u8fdb\u884c\u5168\u9762\u63a7\u5236\u3002EC2\u670d\u52a1\u5668\u5c31\u662f\u5728VPC\u8fd9\u4e2a\u7f51\u7edc\u73af\u5883\u5185\u8fdb\u884c\u5de5\u4f5c\u548c\u53d7\u7ba1\u7406\u7684\u3002 \u5f53\u6211\u4eec\u521b\u5efaVPC\u65f6\uff0c\u9700\u8981\u5229\u7528\u5b89\u5168\u7ec4\u4e0e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08\u7b80\u79f0ACL\uff09\u5bf9\u8f93\u5165\u53ca\u8f93\u51fa\u6d41\u91cf\u8fdb\u884c\u63a7\u5236\u3002\u5728\u7ec8\u7aef\u8282\u70b9\uff08endpoint\uff09\u670d\u52a1\u51fa\u73b0\u4e4b\u524d\uff0c\u5982\u679c\u5927\u5bb6\u5e0c\u671b\u8ba9\u81ea\u5df1\u7684EC2\u5b9e\u4f8b\u6709\u80fd\u529b\u8bbf\u95ee\u516c\u6709\u8d44\u6e90\uff0c\u5219\u5fc5\u987b\u4f7f\u7528Internet Gateway\uff0c\u4e14\u53ef\u80fd\u9700\u8981\u5bf9\u90e8\u5206NAT\u5b9e\u4f8b\u8fdb\u884c\u7ba1\u7406\u3002\u800c\u73b0\u5728\uff0c\u66f4\u6613\u4e8e\u914d\u7f6e\u3001\u5177\u5907\u9ad8\u5ea6\u53ef\u9760\u6027\u7684Endpoints\u80fd\u591f\u4e3a\u6211\u4eec\u63d0\u4f9b\u6307\u5411S3\u7684\u5b89\u5168\u79c1\u6709\u8fde\u63a5\uff0c\u800c\u4e14\u6574\u4e2a\u6d41\u7a0b\u4e0d\u9700\u8981\u4efb\u4f55\u7f51\u5173\u6216\u8005NAT\u5b9e\u4f8b\u7684\u4ecb\u5165\u3002\u6ce8\u610f\uff0c\u8fd9\u662f\u79c1\u7f51\u3002 -- D.C Update: endpoint \u9488\u5bf9\u4e0d\u51fa\u7f51\u7684\u79c1\u6709\u5b50\u7f51\u5185\u7684\u5b9e\u4f8b\u8bbf\u95eeS3\u6216\u8005\u5176\u4ed6\u652f\u6301\u7684AWS\u670d\u52a1\uff0c\u800c\u65e0\u9700internet\u7f51\u5173\u3001NAT\u7f51\u5173\u3001VPN\u7b49\uff0c\u5c5e\u4e8e\u5185\u90e8\u7684\u8fde\u63a5\uff0c\u4e0d\u5177\u5907\u63d0\u5347\u8bbf\u95ee\u901f\u5ea6\u7684\u529f\u80fd\u3002","title":"\u52a0\u901f\uff01\u4e3aEC2\u548cS3\u4e4b\u95f4\u642d\u5efa\u7231\u7684\u6865\u6881"},{"location":"blogs/2020-02-02-vpc-endpoint-s3/#vpc","text":"Amazon Virtual Private Cloud (Amazon VPC),\u7b80\u5355\u7406\u89e3\uff0c\u5c31\u662f\u5728\u4e91\u4e0a\u5efa\u4e2a\u5927\u697c\uff0c\u5927\u697c\u91cc\u9762\u7684\u7f51\u7edc\u3001\u95e8\u7981\uff0c\u5b89\u68c0\u7b49\u90fd\u4e00\u5e94\u4ff1\u5168\uff0c\u6211\u4eec\u6839\u636e\u9700\u8981\u5728\u5927\u697c\u91cc\u9009\u62e9\u623f\u95f4\uff08\u521b\u5efaec2\uff09\u529e\u516c\uff0c\u8fd9\u4e2a\u623f\u95f4\u81ea\u5df1\u4e5f\u6709\u76f8\u5e94\u7684\u95e8\u7981\u7cfb\u7edf\u3002 VPC\u4e00\u4e2a\u91cd\u8981\u7684\u529f\u80fd\u662f\u4e3a\u5176\u4e2d\u7684\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u6bd4\u5982\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u5bf9\u6210\u767e\u4e0a\u5343\u7684EC2\u8fdb\u884c\u7edf\u4e00\u7684\u7f51\u7edc\u7ba1\u7406\u3002","title":"\u4ec0\u4e48\u662fVPC\uff1f"},{"location":"blogs/2020-02-02-vpc-endpoint-s3/#vpc-endpoint","text":"\u56e0\u4e3a\u6211\u4eec\u8981\u8fde\u63a5\u7684EC2\u90fd\u662f\u5728VPC\u7684\u73af\u5883\u4e2d\uff0c\u5982\u679c\u7ed9EC2\u548cs3\u4e4b\u95f4\u5efa\u4e13\u5c5e\u516c\u8def\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5728VPC\u548cs3\u4e4b\u95f4\u521b\u5efa\u4e00\u4e2aendpoint\u5c31\u53ef\u4ee5\u4e86\u3002 \u767b\u5f55 aws\u7ba1\u7406\u63a7\u5236\u53f0 \uff0c\u641c\u7d22 VPC \uff0c\u70b9\u51fb\u8fdb\u5165\u3002\u7b80\u5355\u770b\u4e0bdashboard\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u7684 Endpoints \u3002 \u70b9\u51fb\u754c\u9762\u4e0a\u65b9\u7684 Create Endpoint ,\u8fdb\u5165\u9009\u62e9\u754c\u9762\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c Service category \u8fd9\u91cc\uff0c\u7cfb\u7edf\u81ea\u52a8\u5e2e\u6211\u4eec\u9009\u62e9\u4e86 AWS service ,\u800c Service Name \u8fd9\u513f\u9700\u8981\u6211\u4eec\u5177\u4f53\u9009\u62e9\u4e00\u9879aws\u7684\u670d\u52a1\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\uff0c\u4f60\u8981\u7ed9vpc\u5efa\u4e00\u6761\u4e13\u5c5e\u516c\u8def\u901a\u5230\u90a3\u91cc\u53bb\u5462\uff1f\u4f60\u5f97\u544a\u8bc9\u6211\u554a\uff0c\u6ca1\u9519\uff0c\u6211\u4eec\u8fd9\u91cc\u9009\u62e9s3\u670d\u52a1 com.amazonaws.cn-northwest-1.s3 \u3002 \u63a5\u7740\u9009\u62e9VPC\uff0c\u5f88\u7b80\u5355\uff0c\u6211\u8981\u8fde\u7684ec2\u5728\u54ea\u4e2avpc\u91cc\uff0c\u5c31\u9009\u90a3\u4e2aVPC\u3002\u4e4b\u540e\u9009\u4e2d\u8def\u7531\u8868\uff0c\u8fd9\u6837endpoint\u5c31\u4f1a\u5728\u6211\u9009\u4e2d\u7684\u8fd9\u4e2avpc\u7684\u8def\u7531\u8868\u91cc\u5199\u5165\u4e00\u6761 \u89c4\u5219 \uff1a Destination \u662fs3, Target \u662fendpoint\u3002 Policy \u8bbe\u7f6e\u4e3a Full Access ,\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684json\u683c\u5f0f\u5982\u4e0b\uff0c\u610f\u601d\u662fAllow\u6240\u6709\u7684action\uff0c\u9488\u5bf9\u6240\u6709resource\uff0c\u9002\u7528\u4e8e\u6240\u6709\u89d2\u8272\u3002\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u81ea\u5b9a\u4e49\u7b56\u7565\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u5982\u679c\u521b\u5efa\u597dendpoint\u4ee5\u540e\u6211\u4eec\u518d\u53bb\u4fee\u6539\u7b56\u7565\uff0c\u90a3\u4e48\u6240\u505a\u7684\u66f4\u6539\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u751f\u6548\u54e6\u3002 { \"Statement\": [ { \"Action\": \"*\", \"Effect\": \"Allow\", \"Resource\": \"*\", \"Principal\": \"*\" } ] } \u70b9\u51fb Create endpoint \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230Endpoint ID\u4e3a vpce-0c9f13443d1f8c0d0 \u7684\u7ec8\u7aef\u8282\u70b9\u5c31\u521b\u5efa\u597d\u4e86\u3002\u8fd9\u4e5f\u610f\u5473\u7740\uff0c\u5728 vpc-37a41d5e \u8fd9\u4e2aVPC\u91cc\u7684EC2\u4eec\u5c31\u53ef\u4ee5\u7545\u5feb\u5730\u548c\u4f4f\u5728s3\u91cc\u7684\u516c\u4e3b\u8c08\u573a\u604b\u7231\u4e86~ \u767b\u5f55ec2\uff0c\u611f\u53d7Endpoint\u5e26\u6765\u7684\u751c\u871c\u5427\uff01 \u61d2\u65e0\u6b62\u5883","title":"\u521b\u5efa VPC endpoint"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/","text":"\u9ad8\u80fd\uff01\u5b9e\u73b0\u5168\u81ea\u52a8EBS\u5907\u4efd[\u4e2d\u56fd\u533a] \u6211\u4eec\u603b\u662f\u5e0c\u671b\u673a\u5668\u80fd\u4e3a\u4eba\u7c7b\u591a\u505a\u4e9b\u4e8b\u513f\uff0c\u518d\u591a\u505a\u4e9b\uff0c\u518d\u591a\u505a\u4e9b...\u73b0\u5728\u5229\u7528cloudwatch + \u65e0\u670d\u52a1\u5668\u5316\u51fd\u6570Lambda\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u6307\u5b9aec2\u5b9e\u4f8b\u78c1\u76d8\u7684\u5168\u81ea\u52a8\u5907\u4efd...\u901a\u8fc7\u8fd9\u4e2a\u6559\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u521d\u6b65\u611f\u53d7\u5230\u65e0\u670d\u52a1\u5668\u5316\uff08serverless\uff09\u7684\u9b45\u529b...\u61d2\u4eba\u798f\u97f3\uff0c\u5927\u795e\u5229\u5668\u3002 -- D.C \u5185\u5bb9\u8f83\u591a\uff0c\u8010\u5fc3\u52a0\u8f7d... \u8981\u5b9e\u73b0 \u5168\u81ea\u52a8 \u8fd9\u4e2a\u9a9a\u64cd\u4f5c\uff0c\u6211\u4eec\u4f1a\u7528\u5230\u4e24\u4e2aaws\u670d\u52a1\uff1a CloudWatch lambda \u903b\u8f91\u5173\u7cfb\u662f\uff1a CloudWatch -> lambda -> \u5907\u4efd/\u5220\u9664\u64cd\u4f5c \u4e3alambda\u521b\u5efaPolicy\u548cRole \u6211\u4eec\u77e5\u9053aws\u5bf9\u5b89\u5168\u662f\u63a7\u5236\u5f97\u5f88\u4e25\u7684\uff0c\u4ec0\u4e48\u670d\u52a1\u6709\u6743\u8c03\u7528\u4ec0\u4e48\u670d\u52a1\uff0c\u90a3\u662f\u8981\u7528Role\u91cc\u9762\u7684Policy\u6765\u89c4\u5b9a\u7684\u3002\u6240\u4ee5\u9996\u5148\u6211\u4eec\u5c31\u8981\u4e3alambda\u521b\u5efaPolicy\u548cRole\u3002 \u521b\u5efaPolicy\uff1a\u8fdb\u5165 IAM \u63a7\u5236\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 Policies , \u518d\u70b9\u51fb\u84dd\u8272\u6309\u94ae Create policy , \u70b9\u51fb\u6807\u7b7e\u5207\u6362\u5230 JSON , \u586b\u5165\u4ee5\u4e0b\u4ee3\u7801\uff0c\u70b9\u51fb Review policy \u3002 { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"logs:*\" ], \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": \"ec2:Describe*\", \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": [ \"ec2:*Snapshot*\" ], \"Resource\": [ \"*\" ] } ] } \u5c06\u8fd9\u4e2aPolicy\u547d\u540d\u4e3a Snapshot \uff0c\u63cf\u8ff0\u968f\u4fbf\u5199\u6bd4\u5982 used to access cw log + ec2 for lambda functions \uff0c\u70b9\u51fb Create policy \u3002 \u521b\u5efaRole\uff1a\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 Roles , \u70b9\u51fb\u53f3\u4fa7 Create role \uff0c \u9009\u4e2d AWS service \uff0c Lambda , \u70b9\u51fb Next:Permissions \u3002 \u63a5\u7740\u5728\u641c\u7d22\u6846\u641c\u7d22\u521a\u521a\u6211\u4eec\u521b\u5efa\u7684\u7b56\u7565 Snapshot , \u9009\u4e2d\uff0c\u70b9\u51fb Next Tags \u3002 \u63a5\u7740\u6253tag\u5e2e\u52a9\u65e5\u540e\u56de\u5fc6\uff0c\u968f\u4fbf\u6253\uff0c\u70b9\u51fb Next:Review \u3002 \u547d\u540d\u4e3a LambdaSnapshot , \u70b9\u51fb Create role \u3002 \u8fd9\u6837\uff0c\u4e00\u4e2a\u62e5\u6709\u8bbf\u95eeCloudWatch Log\u548c\u5bf9EC2\u64cd\u4f5c\u6743\u9650\u7684\u89d2\u8272\uff0c\u5c31\u4e3alambda\u521b\u5efa\u597d\u4e86\u3002 \u521b\u5efaLambda\u51fd\u6570 \u6240\u6709\u5bf9EC2\u7684\u4fe1\u606f\u83b7\u53d6\uff0c\u5224\u65ad\uff0c\u5bf9EBS\u7684\u5907\u4efd\uff0c\u5220\u9664\u8fc7\u671f\u5907\u4efd\u7b49\u7b49\u529f\u80fd\uff0c\u90fd\u662f\u901a\u8fc7aws\u7684\u65e0\u670d\u52a1\u5668\u5316\u670d\u52a1 lambda \u51fd\u6570\u6765\u5b8c\u6210\u7684\uff0c\u6211\u4eec\u4ee5\u540e\u4f1a\u7528\u7684\u8d8a\u6765\u8d8a\u591a\u7684\u3002 \u5728aws console\u641c\u7d22 lambda \uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 Functions , \u518d\u70b9\u51fb\u53f3\u4fa7\u7a97\u53e3\u7684 Create function \u3002 \u4fdd\u6301\u9ed8\u8ba4 Author from scratch , \u4e0b\u9762\u7684Function name\u5199\u5165 CreateSnapshot , Runtime \u9009\u62e9 Python 3.6 ,\u70b9\u51fb Create function \u63a5\u7740\u5c31\u8fdb\u5165\u5230\u5199\u51fd\u6570\u7684\u754c\u9762\uff0c\u628a\u4e0b\u9762\u7684\u4ee3\u7801\u8d34\u5230\u9ed8\u8ba4\u7684 lambda_function.py \u4e2d\u3002\u8fd9\u6bb5\u4ee3\u7801\u7684\u4f5c\u7528\u662f\u904d\u5386\u6240\u6709\u7684ec2\uff0c\u5982\u679c\u53d1\u73b0ec2\u4e0a\u6253\u7684tag\u7684key\u662f AutoBackup \u4e14value\u4e3a yes \u7684\uff0c\u5c31\u4e3a\u8fd9\u53f0EC2\u7684\u78c1\u76d8\u81ea\u52a8\u521b\u5efasnapshot\u3002 import json import urllib.parse import boto3 from datetime import datetime,timedelta print('Loading function') ec2 = boto3.resource('ec2') def lambda_handler(event, context): instances = ec2.instances.filter(Filters=[{'Name': 'tag:AutoBackup', 'Values': ['yes',]}]).all() for instance in instances: print(\"Find AutoSnapshot tagged intance:\", instance.id) for volume in instance.volumes.all(): print(\"Create snapshot for volume: \"+volume.id) ec2.create_snapshot(VolumeId=volume.id, Description=instance.private_dns_name+\" \"+volume.id) \u4e0b\u62c9\u5230 Execution role \u8fd9\u91cc\uff0c\u4fee\u6539 Existing role \u4e3a\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u89d2\u8272 LambdaSnapshot \uff0c\u8fd9\u6837\u4e00\u6765\u6211\u4eec\u521b\u5efa\u7684\u8fd9\u4e2alambda\u51fd\u6570\u5c31\u62e5\u6709\u4e86\u8bbf\u95eeCWL(CloudWatch Log) \u548cEC2\u7684\u6743\u9650\u4e86\u54e6\u3002\u70b9\u51fb Save \u4fdd\u5b58\u3002 \u540c\u7406\uff0c\u518d\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u540d\u5b57\u53eb PurgeSnapshot , Python 3.6 \uff0c\u89d2\u8272\u4e5f\u8bbe\u7f6e\u4e3a LambdaSnapshot \uff0c\u70b9\u51fb Save \u4fdd\u5b58\u3002 \u8fd9\u6bb5\u4ee3\u7801\u7684\u610f\u601d\u662f\u627e\u5230tag\u7684Key\u662f AutoBackup ,Value\u662f yes \u7684ec2\u673a\u5668\uff0c\u518d\u627e\u5230\u8fd9\u53f0ec2\u4e0a\u78c1\u76d8\u5bf9\u5e94\u7684snapshot\uff0c\u5224\u65ad\u662f\u5426\u8fc7\u671f\uff08\u662f\u5426\u8d85\u8fc710\u5206\u949f\uff09,\u8fc7\u671f\u5219\u5c06\u5176\u5220\u9664(Purge)\u3002 \u5982\u679c\u9700\u8981\u4fee\u6539Purge\u7684\u5468\u671f\uff0c\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4fee\u6539 timedelta \u51fd\u6570\u91cc\u9762\u7684\u53c2\u6570\uff0c\u6bd4\u5982\u8bf4:\u5982\u679c\u8981\u8bbe\u7f6ePurge 12\u4e2a\u5c0f\u65f6\u524d\u7684\u5feb\u7167\uff0c\u53ef\u4ee5\u628a minutes=10 \u6539\u6210 hours=12 \uff1b\u5982\u679c\u8981\u8bbe\u7f6ePurge 7\u5929\u524d\u7684\u5feb\u7167\uff0c\u53ef\u4ee5\u6539\u6210 days=7 \u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u6211\u8981\u6bcf\u5468\u5907\u4efd\u4e00\u6b21\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5220\u9664\u5468\u671f\u8bbe\u7f6e\u6210 days=8 \uff0c\u4fdd\u9669\u4e00\u70b9\u3002 import json import urllib.parse import boto3 from datetime import datetime,timedelta print('Loading function') ec2 = boto3.resource('ec2') def lambda_handler(event, context): instances = ec2.instances.filter(Filters=[{'Name': 'tag:AutoBackup', 'Values': ['yes',]}]).all() for instance in instances: print(\"Find AutoSnapshot tagged intance:\", instance.id) for volume in instance.volumes.all(): print(\"Find Volume:\" ,volume.id) snapshots = ec2.snapshots.filter(Filters=[{'Name': 'volume-id', 'Values': [volume.id]}]).all() for snapshot in snapshots: if (datetime.utcnow()-snapshot.start_time.replace(tzinfo=None))>timedelta(minutes=10): print (\"find old snapshot and delete: \", snapshot.id) snapshot.delete() else: print (\"newer snapshot: \", snapshot.id) \u8fd9\u6837\uff0c\u4e24\u4e2alambda\u51fd\u6570\u5c31\u521b\u5efa\u597d\u4e86\u3002 CloudWatch event\u8bbe\u5b9a\u5468\u671f\u89e6\u53d1 \u867d\u7136\u6211\u4eec\u8bbe\u5b9a\u4e86\u4e00\u2018\u5907\u2019\u4e00\u2018\u5220\u2019\u4e24\u4e2a\u51fd\u6570\uff0c\u4f46\u662f\u8fd8\u7f3a\u5c11\u4e00\u4e2a\u5468\u671f\u6027\u7684\u89e6\u53d1\u5668\uff0c\u7528\u6765\u89e6\u53d1\u8fd9\u4e24\u4e2a\u52a8\u4f5c\uff0c\u90a3\u4e48\u8c03\u7528CloudWatch Event\u8fd9\u4e2a\u670d\u52a1\u5c31\u5728\u5408\u9002\u4e0d\u8fc7\u5566\u3002 \u5728aws console\u641c\u7d22 cloudwatch \uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f Events \u4e0b\u7684 Rules \u3002\u8fd9\u91cc\u6211\u4eec\u8981\u65b0\u5efa\u4e24\u6761\u89c4\u5219\uff1a\u4e00\u6761\u662f\u7528\u6765\u5468\u671f\u89e6\u53d1\u201c\u5907\u4efd\u201d\uff0c\u4e00\u6761\u5219\u662f\u7528\u6765\u5468\u671f\u89e6\u53d1\u201c\u5220\u9664\u201d\u3002\u70b9\u51fb Create rule \u3002 \u9009\u4e2d Schedule , Fixed rate of 5 Minutes , \u610f\u601d\u662f\u6bcf5\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u6267\u884c\u4ec0\u4e48\u5462\uff1f\u53f3\u4fa7\u7684 Target - Add target , \u4e0b\u62c9\u83dc\u5355\u9009\u62e9 Lambda function , \u4e0b\u9762\u518d\u9009\u62e9 CreateSnapshot \u8fd9\u4e2a\u51fd\u6570\uff0c \u70b9\u51fb Configure details \u3002(\u6ce8\u610f\uff1a\u56e0\u4e3a\u8fd9\u91cc\u662f\u6d4b\u8bd5\u6240\u4ee5\u8bbe\u7f6e 5 \u5206\u949f\uff0c\u5982\u679c\u5b9e\u9645\u4f7f\u7528\uff0c\u53ef\u4ee5\u8bbe\u7f6e 7 Days) \u540d\u5b57\u547d\u540d\u4e3a AutoBackup , Description\u968f\u4fbf\u5199\u6bd4\u5982 AutoBackup for ec2 with AutoBackup tag which value is yes , \u70b9\u51fb Create rule \u3002 \u5982\u6cd5\u70ae\u5236\uff0c\u518d\u6dfb\u52a0\u4e00\u6761\u89c4\u5219\uff0c Fixed rate of 1 Minutes , lambda\u51fd\u6570\u9009\u62e9 PurgeSnapshot ,\u547d\u540d\u4e3a DeleteOldSnapshot ,Description\u968f\u4fbf\u5199\u6bd4\u5982 AutoDelete old snapshot of ec2 with AutoBackup tag which value is yes \u3002\uff08\u6ce8\u610f\uff1a\u56e0\u4e3a\u8fd9\u91cc\u662f\u6d4b\u8bd5\u6240\u4ee5\u8bbe\u7f6e 1 \u5206\u949f\uff0c\u5982\u679c\u5b9e\u9645\u4f7f\u7528\uff0c\u53ef\u4ee5\u8bbe\u7f6e 1 Days\uff09 \u8fd9\u6837\u5c31\u521b\u5efa\u4e86\u4e24\u4e2a\u5b9a\u671f\u89e6\u53d1\u89c4\u5219\u4e86\u3002 \u7ed9EC2\u7a7f\u4e0atag\u9a6c\u7532 \u4e07\u4e8b\u4ff1\u5907\uff0c\u53ea\u5dee\u9a6c\u7532\u4e86\u3002\u7ed9\u6211\u4eec\u8981\u81ea\u52a8\u5907\u4efd\u7684ec2\u6253\u4e0a\u6807\u7b7e\u5427\uff01 \u9009\u4e2dec2\uff0c\u70b9\u51fb Actions - Instance Settings - Add/Edit Tags \u3002 \u6dfb\u52a0tag, key \u4e3a AutoBackup \uff0cValue\u4e3a yes , \u70b9\u51fb Save \u3002 \u67e5\u770bEBS\u78c1\u76d8 \u6211\u4eec\u5148\u56de\u5fc6\u4e00\u4e0b\u6574\u4e2a\u8fc7\u7a0b\uff1a \u6bcf\u9694 5 \u5206\u949f,\u5bf9 AutoBackup \u6807\u7b7e\u503c\u4e3a yes \u7684ec2\u7684\u78c1\u76d8\u505a\u4e00\u6b21\u5907\u4efd\uff1b \u6bcf\u9694 1 \u5206\u949f,\u67e5\u770b AutoBackup \u6807\u7b7e\u503c\u4e3a yes \u7684ec2\u7684\u78c1\u76d8snapshot\uff0c\u5982\u679c\u662f 10 \u5206\u949f\u524d\u521b\u5efa\u7684\uff0c\u90a3\u5c31\u5c06\u5176\u5220\u9664\u3002 \u56de\u5230ec2\u63a7\u5236\u754c\u9762\uff0c\u8fdb\u5165EBS\u4e0b\u7684Snapshots,\u53ef\u4ee5\u770b\u5230\u6bcf\u9694 5 \u5206\u949f\uff0c\u7cfb\u7edf\u5c31\u4f1a\u81ea\u52a8\u5bf9\u6211\u6307\u5b9a\u7684ec2\u8fdb\u884c\u6253snapshot\u7684\u64cd\u4f5c\u3002 \u518d\u8fc7 10 \u5206\u949f\uff0c\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u7b2c\u4e00\u4e2a\u521b\u5efa\u7684snapshot\u5df2\u7ecf\u88ab\u5220\u9664\u4e86\u3002 CloudWatch Log\u67e5\u770b\u65e5\u5fd7 \u6211\u4eec\u53ef\u4ee5\u56de\u5230 CloudWatch \uff0c\u70b9\u51fb\u5de6\u4fa7 Logs \u4e0b\u9762\u7684 Log Groups ,\u53ef\u4ee5\u627e\u5230\u4e24\u4e2a\u5bf9\u5e94\u7684\u65e5\u5fd7\u6587\u4ef6\u5939\uff08\u59d1\u4e14\u8fd9\u4e48\u7406\u89e3\u5427 x_x \uff09\u3002 \u70b9\u51fb /aws/lambda/PurgeSnapshot \u8fdb\u53bb\uff0c\u70b9\u51fb\u65e5\u5fd7\u6587\u4ef6\u5c31\u53ef\u4ee5\u770b\u5230\u8be6\u7ec6\u7684\u4fe1\u606f\u54e6~ \u629b\u7816\u5f15\u7389 \u5404\u4f4d\u5ba2\u5b98\u8bf7\u626a\u5fc3\u81ea\u95ee\uff1a\u54ea\u4e2a\u5907\u4efd\u5468\u671f\u6700\u9002\u5408\u6211\u5462\uff1f\uff1f\uff1f \u6e29\u99a8\u63d0\u793a\uff0c\u6d89\u53ca\u4fee\u6539\u7684\u5730\u65b9\u6709\uff1a PurgeSnapshot\u4ee3\u7801\u91cc\u9762\u7684 timedelta(minutes=10) CloudWatch Event\u7684\u4e24\u6761Rule\u4e2d\u7684 Fixed rate of xxx \u4e3a\u4f60\u7684ec2\u6253\u4e0a\u6807\u7b7e AutoBackup \uff0c\u9700\u8981\u5b9a\u671f\u5907\u4efd\u7684\u4e3a yes ,\u4e0d\u9700\u8981\u7684\u4e3a no PS\uff1a lambda\u8c03\u7528\u7684\u6210\u672c\u7070\u5e38\u7070\u5e38\u4f4e\uff0c\u6bcf 100 \u4e07\u4e2a\u8bf7\u6c42 \u00a51.36, \u53ef\u5ffd\u7565\u4e0d\u8ba1! \u6210\u529f\uff0c\u5efa\u7acb\u5728\u4eba\u7684\u793e\u4f1a\u5c5e\u6027\u4e4b\u4e0a\u3002","title":"\u9ad8\u80fd\uff01\u5b9e\u73b0\u5168\u81ea\u52a8EBS\u5907\u4efd[\u4e2d\u56fd\u533a]"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#ebs","text":"\u6211\u4eec\u603b\u662f\u5e0c\u671b\u673a\u5668\u80fd\u4e3a\u4eba\u7c7b\u591a\u505a\u4e9b\u4e8b\u513f\uff0c\u518d\u591a\u505a\u4e9b\uff0c\u518d\u591a\u505a\u4e9b...\u73b0\u5728\u5229\u7528cloudwatch + \u65e0\u670d\u52a1\u5668\u5316\u51fd\u6570Lambda\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u6307\u5b9aec2\u5b9e\u4f8b\u78c1\u76d8\u7684\u5168\u81ea\u52a8\u5907\u4efd...\u901a\u8fc7\u8fd9\u4e2a\u6559\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u521d\u6b65\u611f\u53d7\u5230\u65e0\u670d\u52a1\u5668\u5316\uff08serverless\uff09\u7684\u9b45\u529b...\u61d2\u4eba\u798f\u97f3\uff0c\u5927\u795e\u5229\u5668\u3002 -- D.C \u5185\u5bb9\u8f83\u591a\uff0c\u8010\u5fc3\u52a0\u8f7d... \u8981\u5b9e\u73b0 \u5168\u81ea\u52a8 \u8fd9\u4e2a\u9a9a\u64cd\u4f5c\uff0c\u6211\u4eec\u4f1a\u7528\u5230\u4e24\u4e2aaws\u670d\u52a1\uff1a CloudWatch lambda \u903b\u8f91\u5173\u7cfb\u662f\uff1a CloudWatch -> lambda -> \u5907\u4efd/\u5220\u9664\u64cd\u4f5c","title":"\u9ad8\u80fd\uff01\u5b9e\u73b0\u5168\u81ea\u52a8EBS\u5907\u4efd[\u4e2d\u56fd\u533a]"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#lambdapolicyrole","text":"\u6211\u4eec\u77e5\u9053aws\u5bf9\u5b89\u5168\u662f\u63a7\u5236\u5f97\u5f88\u4e25\u7684\uff0c\u4ec0\u4e48\u670d\u52a1\u6709\u6743\u8c03\u7528\u4ec0\u4e48\u670d\u52a1\uff0c\u90a3\u662f\u8981\u7528Role\u91cc\u9762\u7684Policy\u6765\u89c4\u5b9a\u7684\u3002\u6240\u4ee5\u9996\u5148\u6211\u4eec\u5c31\u8981\u4e3alambda\u521b\u5efaPolicy\u548cRole\u3002 \u521b\u5efaPolicy\uff1a\u8fdb\u5165 IAM \u63a7\u5236\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 Policies , \u518d\u70b9\u51fb\u84dd\u8272\u6309\u94ae Create policy , \u70b9\u51fb\u6807\u7b7e\u5207\u6362\u5230 JSON , \u586b\u5165\u4ee5\u4e0b\u4ee3\u7801\uff0c\u70b9\u51fb Review policy \u3002 { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"logs:*\" ], \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": \"ec2:Describe*\", \"Resource\": \"*\" }, { \"Effect\": \"Allow\", \"Action\": [ \"ec2:*Snapshot*\" ], \"Resource\": [ \"*\" ] } ] } \u5c06\u8fd9\u4e2aPolicy\u547d\u540d\u4e3a Snapshot \uff0c\u63cf\u8ff0\u968f\u4fbf\u5199\u6bd4\u5982 used to access cw log + ec2 for lambda functions \uff0c\u70b9\u51fb Create policy \u3002 \u521b\u5efaRole\uff1a\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 Roles , \u70b9\u51fb\u53f3\u4fa7 Create role \uff0c \u9009\u4e2d AWS service \uff0c Lambda , \u70b9\u51fb Next:Permissions \u3002 \u63a5\u7740\u5728\u641c\u7d22\u6846\u641c\u7d22\u521a\u521a\u6211\u4eec\u521b\u5efa\u7684\u7b56\u7565 Snapshot , \u9009\u4e2d\uff0c\u70b9\u51fb Next Tags \u3002 \u63a5\u7740\u6253tag\u5e2e\u52a9\u65e5\u540e\u56de\u5fc6\uff0c\u968f\u4fbf\u6253\uff0c\u70b9\u51fb Next:Review \u3002 \u547d\u540d\u4e3a LambdaSnapshot , \u70b9\u51fb Create role \u3002 \u8fd9\u6837\uff0c\u4e00\u4e2a\u62e5\u6709\u8bbf\u95eeCloudWatch Log\u548c\u5bf9EC2\u64cd\u4f5c\u6743\u9650\u7684\u89d2\u8272\uff0c\u5c31\u4e3alambda\u521b\u5efa\u597d\u4e86\u3002","title":"\u4e3alambda\u521b\u5efaPolicy\u548cRole"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#lambda","text":"\u6240\u6709\u5bf9EC2\u7684\u4fe1\u606f\u83b7\u53d6\uff0c\u5224\u65ad\uff0c\u5bf9EBS\u7684\u5907\u4efd\uff0c\u5220\u9664\u8fc7\u671f\u5907\u4efd\u7b49\u7b49\u529f\u80fd\uff0c\u90fd\u662f\u901a\u8fc7aws\u7684\u65e0\u670d\u52a1\u5668\u5316\u670d\u52a1 lambda \u51fd\u6570\u6765\u5b8c\u6210\u7684\uff0c\u6211\u4eec\u4ee5\u540e\u4f1a\u7528\u7684\u8d8a\u6765\u8d8a\u591a\u7684\u3002 \u5728aws console\u641c\u7d22 lambda \uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 Functions , \u518d\u70b9\u51fb\u53f3\u4fa7\u7a97\u53e3\u7684 Create function \u3002 \u4fdd\u6301\u9ed8\u8ba4 Author from scratch , \u4e0b\u9762\u7684Function name\u5199\u5165 CreateSnapshot , Runtime \u9009\u62e9 Python 3.6 ,\u70b9\u51fb Create function \u63a5\u7740\u5c31\u8fdb\u5165\u5230\u5199\u51fd\u6570\u7684\u754c\u9762\uff0c\u628a\u4e0b\u9762\u7684\u4ee3\u7801\u8d34\u5230\u9ed8\u8ba4\u7684 lambda_function.py \u4e2d\u3002\u8fd9\u6bb5\u4ee3\u7801\u7684\u4f5c\u7528\u662f\u904d\u5386\u6240\u6709\u7684ec2\uff0c\u5982\u679c\u53d1\u73b0ec2\u4e0a\u6253\u7684tag\u7684key\u662f AutoBackup \u4e14value\u4e3a yes \u7684\uff0c\u5c31\u4e3a\u8fd9\u53f0EC2\u7684\u78c1\u76d8\u81ea\u52a8\u521b\u5efasnapshot\u3002 import json import urllib.parse import boto3 from datetime import datetime,timedelta print('Loading function') ec2 = boto3.resource('ec2') def lambda_handler(event, context): instances = ec2.instances.filter(Filters=[{'Name': 'tag:AutoBackup', 'Values': ['yes',]}]).all() for instance in instances: print(\"Find AutoSnapshot tagged intance:\", instance.id) for volume in instance.volumes.all(): print(\"Create snapshot for volume: \"+volume.id) ec2.create_snapshot(VolumeId=volume.id, Description=instance.private_dns_name+\" \"+volume.id) \u4e0b\u62c9\u5230 Execution role \u8fd9\u91cc\uff0c\u4fee\u6539 Existing role \u4e3a\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u89d2\u8272 LambdaSnapshot \uff0c\u8fd9\u6837\u4e00\u6765\u6211\u4eec\u521b\u5efa\u7684\u8fd9\u4e2alambda\u51fd\u6570\u5c31\u62e5\u6709\u4e86\u8bbf\u95eeCWL(CloudWatch Log) \u548cEC2\u7684\u6743\u9650\u4e86\u54e6\u3002\u70b9\u51fb Save \u4fdd\u5b58\u3002 \u540c\u7406\uff0c\u518d\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u540d\u5b57\u53eb PurgeSnapshot , Python 3.6 \uff0c\u89d2\u8272\u4e5f\u8bbe\u7f6e\u4e3a LambdaSnapshot \uff0c\u70b9\u51fb Save \u4fdd\u5b58\u3002 \u8fd9\u6bb5\u4ee3\u7801\u7684\u610f\u601d\u662f\u627e\u5230tag\u7684Key\u662f AutoBackup ,Value\u662f yes \u7684ec2\u673a\u5668\uff0c\u518d\u627e\u5230\u8fd9\u53f0ec2\u4e0a\u78c1\u76d8\u5bf9\u5e94\u7684snapshot\uff0c\u5224\u65ad\u662f\u5426\u8fc7\u671f\uff08\u662f\u5426\u8d85\u8fc710\u5206\u949f\uff09,\u8fc7\u671f\u5219\u5c06\u5176\u5220\u9664(Purge)\u3002 \u5982\u679c\u9700\u8981\u4fee\u6539Purge\u7684\u5468\u671f\uff0c\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4fee\u6539 timedelta \u51fd\u6570\u91cc\u9762\u7684\u53c2\u6570\uff0c\u6bd4\u5982\u8bf4:\u5982\u679c\u8981\u8bbe\u7f6ePurge 12\u4e2a\u5c0f\u65f6\u524d\u7684\u5feb\u7167\uff0c\u53ef\u4ee5\u628a minutes=10 \u6539\u6210 hours=12 \uff1b\u5982\u679c\u8981\u8bbe\u7f6ePurge 7\u5929\u524d\u7684\u5feb\u7167\uff0c\u53ef\u4ee5\u6539\u6210 days=7 \u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u6211\u8981\u6bcf\u5468\u5907\u4efd\u4e00\u6b21\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5220\u9664\u5468\u671f\u8bbe\u7f6e\u6210 days=8 \uff0c\u4fdd\u9669\u4e00\u70b9\u3002 import json import urllib.parse import boto3 from datetime import datetime,timedelta print('Loading function') ec2 = boto3.resource('ec2') def lambda_handler(event, context): instances = ec2.instances.filter(Filters=[{'Name': 'tag:AutoBackup', 'Values': ['yes',]}]).all() for instance in instances: print(\"Find AutoSnapshot tagged intance:\", instance.id) for volume in instance.volumes.all(): print(\"Find Volume:\" ,volume.id) snapshots = ec2.snapshots.filter(Filters=[{'Name': 'volume-id', 'Values': [volume.id]}]).all() for snapshot in snapshots: if (datetime.utcnow()-snapshot.start_time.replace(tzinfo=None))>timedelta(minutes=10): print (\"find old snapshot and delete: \", snapshot.id) snapshot.delete() else: print (\"newer snapshot: \", snapshot.id) \u8fd9\u6837\uff0c\u4e24\u4e2alambda\u51fd\u6570\u5c31\u521b\u5efa\u597d\u4e86\u3002","title":"\u521b\u5efaLambda\u51fd\u6570"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#cloudwatch-event","text":"\u867d\u7136\u6211\u4eec\u8bbe\u5b9a\u4e86\u4e00\u2018\u5907\u2019\u4e00\u2018\u5220\u2019\u4e24\u4e2a\u51fd\u6570\uff0c\u4f46\u662f\u8fd8\u7f3a\u5c11\u4e00\u4e2a\u5468\u671f\u6027\u7684\u89e6\u53d1\u5668\uff0c\u7528\u6765\u89e6\u53d1\u8fd9\u4e24\u4e2a\u52a8\u4f5c\uff0c\u90a3\u4e48\u8c03\u7528CloudWatch Event\u8fd9\u4e2a\u670d\u52a1\u5c31\u5728\u5408\u9002\u4e0d\u8fc7\u5566\u3002 \u5728aws console\u641c\u7d22 cloudwatch \uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u7136\u540e\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f Events \u4e0b\u7684 Rules \u3002\u8fd9\u91cc\u6211\u4eec\u8981\u65b0\u5efa\u4e24\u6761\u89c4\u5219\uff1a\u4e00\u6761\u662f\u7528\u6765\u5468\u671f\u89e6\u53d1\u201c\u5907\u4efd\u201d\uff0c\u4e00\u6761\u5219\u662f\u7528\u6765\u5468\u671f\u89e6\u53d1\u201c\u5220\u9664\u201d\u3002\u70b9\u51fb Create rule \u3002 \u9009\u4e2d Schedule , Fixed rate of 5 Minutes , \u610f\u601d\u662f\u6bcf5\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u6267\u884c\u4ec0\u4e48\u5462\uff1f\u53f3\u4fa7\u7684 Target - Add target , \u4e0b\u62c9\u83dc\u5355\u9009\u62e9 Lambda function , \u4e0b\u9762\u518d\u9009\u62e9 CreateSnapshot \u8fd9\u4e2a\u51fd\u6570\uff0c \u70b9\u51fb Configure details \u3002(\u6ce8\u610f\uff1a\u56e0\u4e3a\u8fd9\u91cc\u662f\u6d4b\u8bd5\u6240\u4ee5\u8bbe\u7f6e 5 \u5206\u949f\uff0c\u5982\u679c\u5b9e\u9645\u4f7f\u7528\uff0c\u53ef\u4ee5\u8bbe\u7f6e 7 Days) \u540d\u5b57\u547d\u540d\u4e3a AutoBackup , Description\u968f\u4fbf\u5199\u6bd4\u5982 AutoBackup for ec2 with AutoBackup tag which value is yes , \u70b9\u51fb Create rule \u3002 \u5982\u6cd5\u70ae\u5236\uff0c\u518d\u6dfb\u52a0\u4e00\u6761\u89c4\u5219\uff0c Fixed rate of 1 Minutes , lambda\u51fd\u6570\u9009\u62e9 PurgeSnapshot ,\u547d\u540d\u4e3a DeleteOldSnapshot ,Description\u968f\u4fbf\u5199\u6bd4\u5982 AutoDelete old snapshot of ec2 with AutoBackup tag which value is yes \u3002\uff08\u6ce8\u610f\uff1a\u56e0\u4e3a\u8fd9\u91cc\u662f\u6d4b\u8bd5\u6240\u4ee5\u8bbe\u7f6e 1 \u5206\u949f\uff0c\u5982\u679c\u5b9e\u9645\u4f7f\u7528\uff0c\u53ef\u4ee5\u8bbe\u7f6e 1 Days\uff09 \u8fd9\u6837\u5c31\u521b\u5efa\u4e86\u4e24\u4e2a\u5b9a\u671f\u89e6\u53d1\u89c4\u5219\u4e86\u3002","title":"CloudWatch event\u8bbe\u5b9a\u5468\u671f\u89e6\u53d1"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#ec2tag","text":"\u4e07\u4e8b\u4ff1\u5907\uff0c\u53ea\u5dee\u9a6c\u7532\u4e86\u3002\u7ed9\u6211\u4eec\u8981\u81ea\u52a8\u5907\u4efd\u7684ec2\u6253\u4e0a\u6807\u7b7e\u5427\uff01 \u9009\u4e2dec2\uff0c\u70b9\u51fb Actions - Instance Settings - Add/Edit Tags \u3002 \u6dfb\u52a0tag, key \u4e3a AutoBackup \uff0cValue\u4e3a yes , \u70b9\u51fb Save \u3002","title":"\u7ed9EC2\u7a7f\u4e0atag\u9a6c\u7532"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#ebs_1","text":"\u6211\u4eec\u5148\u56de\u5fc6\u4e00\u4e0b\u6574\u4e2a\u8fc7\u7a0b\uff1a \u6bcf\u9694 5 \u5206\u949f,\u5bf9 AutoBackup \u6807\u7b7e\u503c\u4e3a yes \u7684ec2\u7684\u78c1\u76d8\u505a\u4e00\u6b21\u5907\u4efd\uff1b \u6bcf\u9694 1 \u5206\u949f,\u67e5\u770b AutoBackup \u6807\u7b7e\u503c\u4e3a yes \u7684ec2\u7684\u78c1\u76d8snapshot\uff0c\u5982\u679c\u662f 10 \u5206\u949f\u524d\u521b\u5efa\u7684\uff0c\u90a3\u5c31\u5c06\u5176\u5220\u9664\u3002 \u56de\u5230ec2\u63a7\u5236\u754c\u9762\uff0c\u8fdb\u5165EBS\u4e0b\u7684Snapshots,\u53ef\u4ee5\u770b\u5230\u6bcf\u9694 5 \u5206\u949f\uff0c\u7cfb\u7edf\u5c31\u4f1a\u81ea\u52a8\u5bf9\u6211\u6307\u5b9a\u7684ec2\u8fdb\u884c\u6253snapshot\u7684\u64cd\u4f5c\u3002 \u518d\u8fc7 10 \u5206\u949f\uff0c\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u7b2c\u4e00\u4e2a\u521b\u5efa\u7684snapshot\u5df2\u7ecf\u88ab\u5220\u9664\u4e86\u3002","title":"\u67e5\u770bEBS\u78c1\u76d8"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#cloudwatch-log","text":"\u6211\u4eec\u53ef\u4ee5\u56de\u5230 CloudWatch \uff0c\u70b9\u51fb\u5de6\u4fa7 Logs \u4e0b\u9762\u7684 Log Groups ,\u53ef\u4ee5\u627e\u5230\u4e24\u4e2a\u5bf9\u5e94\u7684\u65e5\u5fd7\u6587\u4ef6\u5939\uff08\u59d1\u4e14\u8fd9\u4e48\u7406\u89e3\u5427 x_x \uff09\u3002 \u70b9\u51fb /aws/lambda/PurgeSnapshot \u8fdb\u53bb\uff0c\u70b9\u51fb\u65e5\u5fd7\u6587\u4ef6\u5c31\u53ef\u4ee5\u770b\u5230\u8be6\u7ec6\u7684\u4fe1\u606f\u54e6~","title":"CloudWatch Log\u67e5\u770b\u65e5\u5fd7"},{"location":"blogs/2020-02-03-ebs-cw-lambda-autobackup/#_1","text":"\u5404\u4f4d\u5ba2\u5b98\u8bf7\u626a\u5fc3\u81ea\u95ee\uff1a\u54ea\u4e2a\u5907\u4efd\u5468\u671f\u6700\u9002\u5408\u6211\u5462\uff1f\uff1f\uff1f \u6e29\u99a8\u63d0\u793a\uff0c\u6d89\u53ca\u4fee\u6539\u7684\u5730\u65b9\u6709\uff1a PurgeSnapshot\u4ee3\u7801\u91cc\u9762\u7684 timedelta(minutes=10) CloudWatch Event\u7684\u4e24\u6761Rule\u4e2d\u7684 Fixed rate of xxx \u4e3a\u4f60\u7684ec2\u6253\u4e0a\u6807\u7b7e AutoBackup \uff0c\u9700\u8981\u5b9a\u671f\u5907\u4efd\u7684\u4e3a yes ,\u4e0d\u9700\u8981\u7684\u4e3a no PS\uff1a lambda\u8c03\u7528\u7684\u6210\u672c\u7070\u5e38\u7070\u5e38\u4f4e\uff0c\u6bcf 100 \u4e07\u4e2a\u8bf7\u6c42 \u00a51.36, \u53ef\u5ffd\u7565\u4e0d\u8ba1! \u6210\u529f\uff0c\u5efa\u7acb\u5728\u4eba\u7684\u793e\u4f1a\u5c5e\u6027\u4e4b\u4e0a\u3002","title":"\u629b\u7816\u5f15\u7389"},{"location":"blogs/2020-02-03-modify-ec2-ebs/","text":"\u5982\u4f55\u8c03\u6574EC2\u914d\u7f6e\u548cEBS\u78c1\u76d8 \u5e94\u5f53\u6709\u4e00\u4e2a\u9009\u9879\u6216\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u63a8\u7ffb\u4e4b\u524d\u7684\u60f3\u6cd5\uff0c\u53bb\u5c1d\u8bd5\u66f4\u597d\u66f4\u5408\u7406\u7684\u4e1c\u897f\uff0c\u8fd9\u5c31\u662f\u4e91\u5e26\u7ed9\u6211\u4eec\u7684\u610f\u4e49\u3002 -- D.C \u8c03\u6574EC2\u914d\u7f6e \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u4e00\u53f0EC2\uff0c\u6d41\u7a0b\u4e5f\u5df2\u7ecf\u90e8\u7f72\u597d\u4e86\uff0c\u4f46\u662f\u6211\u53d1\u73b0\u914d\u7f6e\u592a\u4f4e/\u9ad8\u4e86\uff0c\u56e0\u4e3a\u67d0\u79cd\u504f\u6267\u7684\u539f\u56e0\uff0c\u6211\u5c31\u662f\u4e0d\u60f3\u521b\u5efa\u955c\u50cfami\u518d\u4ece\u8fd9\u4e2aami\u542f\u52a8\u4e00\u4e2a\u65b0\u7684ec2\uff0c\u5bf9\uff01\u6211\u5c31\u662f\u8981\u4fee\u6539\u539f\u6765\u90a3\u4e2a\uff0c\u600e\u4e48\u529e\u5462\uff1f \u7b2c\u4e00\u6b65\uff1a\u8fdb\u5165ec2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u4e2d\u6211\u4eec\u8981\u8c03\u6574\u7684ec2 instance\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance State - Stop \uff0c\u70b9\u51fb Yes, Stop \u3002 \u7b2c\u4e8c\u6b65\uff1a\u7b49ec2\u662fstop\u72b6\u6001\u4ee5\u540e\uff0c\u9009\u4e2d\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance Settings - Change Instance Type \uff0c \u51fa\u73b0\u5f39\u7a97\u3002 \u7b2c\u4e09\u6b65\uff1a\u9009\u62e9\u6211\u4eec\u60f3\u66f4\u6539\u7684\u914d\u7f6e\uff0c\u6bd4\u5982 m5.large , \u70b9\u51fb Apply \u3002\u968f\u540e\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance State - Start , \u542f\u52a8\u4e4b\u540e\u5c31\u662f m5.large \u7684\u914d\u7f6e\u4e86\u3002 \u8c03\u6574EBS\u76d8 \u5047\u8bbe\u6211\u4eec\u7ed9ec2\u9884\u8bbe\u7684\u76d8\u592a\u5c0f\uff0c\u9700\u8981\u6269\u5bb9\u600e\u4e48\u529e\u5462\uff1f\u6709\u4e24\u79cd\u65b9\u6848\uff1a \u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u78c1\u76d8\uff0cattach\u4e0a\u53bb\uff0c\u4e0d\u9700\u8981\u91cd\u542fec2\u3002 \u8c03\u6574\u73b0\u5728\u78c1\u76d8\u7684\u5927\u5c0f\uff0c\u9700\u8981\u91cd\u542fec2\u3002 1. \u91cd\u65b0\u521b\u5efa\u78c1\u76d8 \u5728ec2 \u63a7\u5236\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684EBS\u4e0b\u7684 Volumes ,\u53ef\u4ee5\u770b\u5230\u53f3\u4fa7\u6240\u6709\u7684\u78c1\u76d8\u5217\u8868\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Create Volume ,\u8fdb\u5165\u8bbe\u7f6e\u754c\u9762\u3002 \u9ed8\u8ba4SSD gp2\uff0c \u6211\u9700\u8981\u4e00\u5757100G\u7684\u78c1\u76d8\uff0c Availability Zone \u8fd9\u91cc\u6ce8\u610f\u4e0b\uff0c\u4f60\u7684ec2\u5728\u54ea\u4e2a\u53ef\u7528\u533a\uff0c\u8fd9\u5757\u78c1\u76d8\u5c31\u8981\u521b\u5efa\u5728\u90a3\u4e2a\u53ef\u7528\u533a\uff08\u53ef\u4ee5\u9009\u4e2dec2\uff0c\u67e5\u770b\u4e0b\u65b9\u7684 Description \u4fe1\u606f\u6765\u83b7\u77e5\u5b83\u6240\u5728\u7684\u53ef\u7528\u533a\u54e6~\uff09,\u8fd9\u91cc\u6211\u9009\u62e9 cn-northwest-1c , Snapshot\u4e0d\u9009\u62e9\uff0c\u56e0\u4e3a\u6211\u662f\u521b\u5efa\u65b0\u76d8\uff0c\u5f53\u7136\u5982\u679c\u4f60\u60f3\u5229\u7528\u4e4b\u524d\u6253\u7684snapshot\u6765\u6062\u590d\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u6bd4\u5982\u8bf4\u4fdd\u5b58\u6570\u636e\u5e93\u7684snapshot\u3002 \u597d\u4e86\uff0c\u78c1\u76d8\u521b\u5efa\u5b8c\u6bd5\uff0c\u70b9\u51fb Volume ID ,\u9009\u4e2d\u8fd9\u5757\u78c1\u76d8\uff0c\u70b9\u51fb\u4e0a\u65b9 Actions - Attach Volume \uff0c\u8df3\u51fa\u5f39\u7a97\u3002 \u9009\u4e2d\u5bf9\u5e94\u7684ec2\uff0c Device \u4f1a\u81ea\u52a8\u586b\u5145\uff0c\u70b9\u51fb Attach \u3002 \u767b\u5f55ec2\uff0c\u67e5\u770b\u547d\u4ee4 df -h \u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / \u53c2\u7167 \u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d \u8fd9\u7bc7\u6587\u7ae0\u8fdb\u884c\u547d\u4ee4\u884c\u8bbe\u7f6e\u3002 [\u6ce8\u610f] : \u4ee5\u4e0b\u547d\u4ee4\u7701\u7565\u4e86 \u91cd\u542f\u540e\u81ea\u52a8\u9644\u52a0\u9644\u52a0\u5377 \u7684\u547d\u4ee4\uff0c\u9700\u8981\u7684\u540c\u5b66\u8bf7\u5b8c\u6574\u53c2\u9605\u8fd9\u7bc7\u6587\u7ae0\u3002 $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT nvme0n1 259:0 0 50G 0 disk \u251c\u2500nvme0n1p1 259:1 0 50G 0 part / \u2514\u2500nvme0n1p128 259:2 0 1M 0 part nvme1n1 259:3 0 100G 0 disk $ sudo file -s /dev/nvme1n1 /dev/nvme1n1: data $ sudo yum install xfsprogs $ sudo mkfs -t xfs /dev/nvme1n1 meta-data=/dev/nvme1n1 isize=512 agcount=4, agsize=6553600 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=26214400, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=12800, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 $ sudo mkdir /data $ sudo mount /dev/nvme1n1 /data $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / /dev/nvme1n1 100G 135M 100G 1% /data $ sudo chown -R ec2-user.ec2-user /data $ touch /data/1.txt $ ls /data 1.txt 2. \u8c03\u6574\u73b0\u6709EBS\u78c1\u76d8 \u9009\u4e2d\u8fd9\u53f0ec2\uff0c\u67e5\u770b\u4e0b\u65b9\u7684 Description \u4fe1\u606f\uff0c\u627e\u5230\u5b83\u7684\u78c1\u76d8\u4fe1\u606f\uff0c\u70b9\u51fbEBS ID\u8fdb\u5165\u3002 \u70b9\u51fb\u4e0a\u65b9 Actions - Modify Volumn \u3002\u53ef\u4ee5\u770b\u5230\u539f\u6765\u662f50G\uff0c\u5c1d\u8bd5\u8f93\u516520G\u8bd5\u8bd5\u4f1a\u51fa\u73b0\u4ec0\u4e48\uff1f\u5bf9\u4e86\uff0c\u53ea\u80fd\u6539\u5927\u4e0d\u80fd\u6539\u5c0f\u54e6\uff01\u8fd9\u91cc\u6211\u6539\u6210100G\uff0c\u70b9\u51fb Modify \u3002 \u8df3\u51fa\u8bf4\u660e\u5f39\u7a97\uff0c\u70b9\u51fb Yes \u3002 \u767b\u5f55ec2\u770b\u770b\u5462\uff1f\u8fd8\u662f50G\uff01 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / [\u9009\u98791] \u91cd\u542fec2\u3002 [\u9009\u98792] \u4e0d\u91cd\u542f\u673a\u5668\uff0c\u767b\u5f55ec2\uff1a $ sudo yum install xfsprogs $ sudo xfs_growfs -d / \u518d\u770b\u770b\u5462\uff0cOK\uff01 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 99G 28G 72G 28% / \u6761\u6761\u5927\u8def\u901a\u7f57\u9a6c\u3002","title":"\u5982\u4f55\u8c03\u6574EC2\u914d\u7f6e\u548cEBS\u78c1\u76d8"},{"location":"blogs/2020-02-03-modify-ec2-ebs/#ec2ebs","text":"\u5e94\u5f53\u6709\u4e00\u4e2a\u9009\u9879\u6216\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u63a8\u7ffb\u4e4b\u524d\u7684\u60f3\u6cd5\uff0c\u53bb\u5c1d\u8bd5\u66f4\u597d\u66f4\u5408\u7406\u7684\u4e1c\u897f\uff0c\u8fd9\u5c31\u662f\u4e91\u5e26\u7ed9\u6211\u4eec\u7684\u610f\u4e49\u3002 -- D.C","title":"\u5982\u4f55\u8c03\u6574EC2\u914d\u7f6e\u548cEBS\u78c1\u76d8"},{"location":"blogs/2020-02-03-modify-ec2-ebs/#ec2","text":"\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u4e00\u53f0EC2\uff0c\u6d41\u7a0b\u4e5f\u5df2\u7ecf\u90e8\u7f72\u597d\u4e86\uff0c\u4f46\u662f\u6211\u53d1\u73b0\u914d\u7f6e\u592a\u4f4e/\u9ad8\u4e86\uff0c\u56e0\u4e3a\u67d0\u79cd\u504f\u6267\u7684\u539f\u56e0\uff0c\u6211\u5c31\u662f\u4e0d\u60f3\u521b\u5efa\u955c\u50cfami\u518d\u4ece\u8fd9\u4e2aami\u542f\u52a8\u4e00\u4e2a\u65b0\u7684ec2\uff0c\u5bf9\uff01\u6211\u5c31\u662f\u8981\u4fee\u6539\u539f\u6765\u90a3\u4e2a\uff0c\u600e\u4e48\u529e\u5462\uff1f \u7b2c\u4e00\u6b65\uff1a\u8fdb\u5165ec2\u7684\u63a7\u5236\u754c\u9762\uff0c\u9009\u4e2d\u6211\u4eec\u8981\u8c03\u6574\u7684ec2 instance\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance State - Stop \uff0c\u70b9\u51fb Yes, Stop \u3002 \u7b2c\u4e8c\u6b65\uff1a\u7b49ec2\u662fstop\u72b6\u6001\u4ee5\u540e\uff0c\u9009\u4e2d\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance Settings - Change Instance Type \uff0c \u51fa\u73b0\u5f39\u7a97\u3002 \u7b2c\u4e09\u6b65\uff1a\u9009\u62e9\u6211\u4eec\u60f3\u66f4\u6539\u7684\u914d\u7f6e\uff0c\u6bd4\u5982 m5.large , \u70b9\u51fb Apply \u3002\u968f\u540e\u70b9\u51fb\u4e0a\u65b9\u7684 Actions - Instance State - Start , \u542f\u52a8\u4e4b\u540e\u5c31\u662f m5.large \u7684\u914d\u7f6e\u4e86\u3002","title":"\u8c03\u6574EC2\u914d\u7f6e"},{"location":"blogs/2020-02-03-modify-ec2-ebs/#ebs","text":"\u5047\u8bbe\u6211\u4eec\u7ed9ec2\u9884\u8bbe\u7684\u76d8\u592a\u5c0f\uff0c\u9700\u8981\u6269\u5bb9\u600e\u4e48\u529e\u5462\uff1f\u6709\u4e24\u79cd\u65b9\u6848\uff1a \u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u78c1\u76d8\uff0cattach\u4e0a\u53bb\uff0c\u4e0d\u9700\u8981\u91cd\u542fec2\u3002 \u8c03\u6574\u73b0\u5728\u78c1\u76d8\u7684\u5927\u5c0f\uff0c\u9700\u8981\u91cd\u542fec2\u3002","title":"\u8c03\u6574EBS\u76d8"},{"location":"blogs/2020-02-03-modify-ec2-ebs/#1","text":"\u5728ec2 \u63a7\u5236\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684EBS\u4e0b\u7684 Volumes ,\u53ef\u4ee5\u770b\u5230\u53f3\u4fa7\u6240\u6709\u7684\u78c1\u76d8\u5217\u8868\uff0c\u70b9\u51fb\u4e0a\u65b9\u7684 Create Volume ,\u8fdb\u5165\u8bbe\u7f6e\u754c\u9762\u3002 \u9ed8\u8ba4SSD gp2\uff0c \u6211\u9700\u8981\u4e00\u5757100G\u7684\u78c1\u76d8\uff0c Availability Zone \u8fd9\u91cc\u6ce8\u610f\u4e0b\uff0c\u4f60\u7684ec2\u5728\u54ea\u4e2a\u53ef\u7528\u533a\uff0c\u8fd9\u5757\u78c1\u76d8\u5c31\u8981\u521b\u5efa\u5728\u90a3\u4e2a\u53ef\u7528\u533a\uff08\u53ef\u4ee5\u9009\u4e2dec2\uff0c\u67e5\u770b\u4e0b\u65b9\u7684 Description \u4fe1\u606f\u6765\u83b7\u77e5\u5b83\u6240\u5728\u7684\u53ef\u7528\u533a\u54e6~\uff09,\u8fd9\u91cc\u6211\u9009\u62e9 cn-northwest-1c , Snapshot\u4e0d\u9009\u62e9\uff0c\u56e0\u4e3a\u6211\u662f\u521b\u5efa\u65b0\u76d8\uff0c\u5f53\u7136\u5982\u679c\u4f60\u60f3\u5229\u7528\u4e4b\u524d\u6253\u7684snapshot\u6765\u6062\u590d\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u6bd4\u5982\u8bf4\u4fdd\u5b58\u6570\u636e\u5e93\u7684snapshot\u3002 \u597d\u4e86\uff0c\u78c1\u76d8\u521b\u5efa\u5b8c\u6bd5\uff0c\u70b9\u51fb Volume ID ,\u9009\u4e2d\u8fd9\u5757\u78c1\u76d8\uff0c\u70b9\u51fb\u4e0a\u65b9 Actions - Attach Volume \uff0c\u8df3\u51fa\u5f39\u7a97\u3002 \u9009\u4e2d\u5bf9\u5e94\u7684ec2\uff0c Device \u4f1a\u81ea\u52a8\u586b\u5145\uff0c\u70b9\u51fb Attach \u3002 \u767b\u5f55ec2\uff0c\u67e5\u770b\u547d\u4ee4 df -h \u3002 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / \u53c2\u7167 \u5982\u4f55\u8ba9 EC2 \u201c\u59bb\u59be\u6210\u7fa4\u201d \u8fd9\u7bc7\u6587\u7ae0\u8fdb\u884c\u547d\u4ee4\u884c\u8bbe\u7f6e\u3002 [\u6ce8\u610f] : \u4ee5\u4e0b\u547d\u4ee4\u7701\u7565\u4e86 \u91cd\u542f\u540e\u81ea\u52a8\u9644\u52a0\u9644\u52a0\u5377 \u7684\u547d\u4ee4\uff0c\u9700\u8981\u7684\u540c\u5b66\u8bf7\u5b8c\u6574\u53c2\u9605\u8fd9\u7bc7\u6587\u7ae0\u3002 $ lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT nvme0n1 259:0 0 50G 0 disk \u251c\u2500nvme0n1p1 259:1 0 50G 0 part / \u2514\u2500nvme0n1p128 259:2 0 1M 0 part nvme1n1 259:3 0 100G 0 disk $ sudo file -s /dev/nvme1n1 /dev/nvme1n1: data $ sudo yum install xfsprogs $ sudo mkfs -t xfs /dev/nvme1n1 meta-data=/dev/nvme1n1 isize=512 agcount=4, agsize=6553600 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=1, sparse=0 data = bsize=4096 blocks=26214400, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal log bsize=4096 blocks=12800, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 $ sudo mkdir /data $ sudo mount /dev/nvme1n1 /data $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / /dev/nvme1n1 100G 135M 100G 1% /data $ sudo chown -R ec2-user.ec2-user /data $ touch /data/1.txt $ ls /data 1.txt","title":"1. \u91cd\u65b0\u521b\u5efa\u78c1\u76d8"},{"location":"blogs/2020-02-03-modify-ec2-ebs/#2-ebs","text":"\u9009\u4e2d\u8fd9\u53f0ec2\uff0c\u67e5\u770b\u4e0b\u65b9\u7684 Description \u4fe1\u606f\uff0c\u627e\u5230\u5b83\u7684\u78c1\u76d8\u4fe1\u606f\uff0c\u70b9\u51fbEBS ID\u8fdb\u5165\u3002 \u70b9\u51fb\u4e0a\u65b9 Actions - Modify Volumn \u3002\u53ef\u4ee5\u770b\u5230\u539f\u6765\u662f50G\uff0c\u5c1d\u8bd5\u8f93\u516520G\u8bd5\u8bd5\u4f1a\u51fa\u73b0\u4ec0\u4e48\uff1f\u5bf9\u4e86\uff0c\u53ea\u80fd\u6539\u5927\u4e0d\u80fd\u6539\u5c0f\u54e6\uff01\u8fd9\u91cc\u6211\u6539\u6210100G\uff0c\u70b9\u51fb Modify \u3002 \u8df3\u51fa\u8bf4\u660e\u5f39\u7a97\uff0c\u70b9\u51fb Yes \u3002 \u767b\u5f55ec2\u770b\u770b\u5462\uff1f\u8fd8\u662f50G\uff01 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 50G 28G 22G 56% / [\u9009\u98791] \u91cd\u542fec2\u3002 [\u9009\u98792] \u4e0d\u91cd\u542f\u673a\u5668\uff0c\u767b\u5f55ec2\uff1a $ sudo yum install xfsprogs $ sudo xfs_growfs -d / \u518d\u770b\u770b\u5462\uff0cOK\uff01 $ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 3.8G 72K 3.8G 1% /dev tmpfs 3.8G 0 3.8G 0% /dev/shm /dev/nvme0n1p1 99G 28G 72G 28% / \u6761\u6761\u5927\u8def\u901a\u7f57\u9a6c\u3002","title":"2. \u8c03\u6574\u73b0\u6709EBS\u78c1\u76d8"},{"location":"blogs/2020-02-04-ec2-download-oss/","text":"\u76f4\u63a5\u4eceec2\u4e0b\u8f7d\u963f\u91cc\u4e91oss\u6570\u636e \u56fd\u5185\u4e0d\u5c11\u6d4b\u5e8f\u516c\u53f8\u90fd\u63d0\u4f9b\u963f\u91cc\u4e91\u7684oss\u4e0b\u8f7d\u94fe\u63a5\u6765\u4ea4\u4ed8\u6570\u636e\uff0c\u6211\u4eec\u4f1a\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u5206\u6790\uff0c\u4f46\u662f\u5982\u679c\u6211\u7528\u4e86aws\uff0c\u662f\u4e0d\u662f\u8fd8\u8981\u4ece\u672c\u5730\u4e0a\u4f20\u5230aws\u4e0a\uff0c\u90a3\u591a\u9ebb\u70e6\u3002\u5176\u5b9e\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4eceec2\u53bb\u62c9\u963f\u91cc\u7684\u6570\u636e\u5c31\u597d\u4e86\uff0c\u800c\u4e14\u901f\u5ea6\u6760\u6760\u7684\uff01\u5f53\u7136\u8fd9\u4e0d\u9650\u4e8e\u4e0b\u8f7d\u5916\u5305\u6570\u636e\uff0c\u5982\u679c\u9700\u8981\u4e91\u95f4\u6570\u636e\u8fc1\u79fb\uff0c\u4e5f\u662f\u6781\u597d\u7684\uff0c\u800c\u4e14\u8c8c\u4f3cali\u5bf9\u6d41\u91cf\u5e26\u5bbd\u662f\u6709\u9650\u5236\u7684\uff0c\u800caws\u5c31\u6bd4\u8f83\u5b9e\u5728\u90fd\u7ed9\u4f60\u90fd\u7ed9\u4f60\u3002 -- D.C \u540d\u8bcd\u89e3\u91ca\uff1aaws\u7684s3 \u5bf9\u5e94 \u963f\u91cc\u7684oss\uff0cec2 \u5bf9\u5e94 \u963f\u91cc\u7684ecs \u5b89\u88c5ossutil64\u5230ec2 \u63a5\u89e6\u8fc7\u963f\u91cc\u4e91\u7684\u90fd\u77e5\u9053\uff0cossutil64\u547d\u4ee4\u662f\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u7ba1\u7406OSS\u6570\u636e\u7684\u5de5\u5177\u3002\u8981\u4e0b\u8f7d\u963f\u91cc\u7684\u6570\u636e\uff0c\u6211\u4eec\u5c31\u5f97\u5148\u5b89\u88c5\u8fd9\u4e2a\u547d\u4ee4\u3002 \u521b\u5efa/\u767b\u5f55\u4e00\u53f0ec2\uff0c\u53ea\u8981\u4e0d\u662ft\u7cfb\u5217\u5c31\u884c\uff0c\u56e0\u4e3at\u7cfb\u5217\u7684\u5e26\u5bbd\u6709\u9650\u5236\u3002\u6bd4\u5982\u6211\u767b\u5f55\u7684\u662f\u4e00\u53f0 m5.large \u3002\u63a5\u7740 wget \u4e0b\u8f7d\u547d\u4ee4\uff0c chmod \u4fee\u6539\u6743\u9650\u3002(\u521b\u5efaec2\u524d\u5148\u77e5\u9053\u5f85\u4e0b\u8f7d\u6570\u636e\u6709\u591a\u5927\uff0c\u6765\u8bbe\u5b9a\u6211\u7684EBS\u76d8\u5927\u5c0f) $ wget http://gosspublic.alicdn.com/ossutil/1.6.10/ossutil64 --2020-02-04 15:05:54-- http://gosspublic.alicdn.com/ossutil/1.6.10/ossutil64 Resolving gosspublic.alicdn.com (gosspublic.alicdn.com)... 221.236.10.175, 117.34.40.113, 118.112.19.115, ... Connecting to gosspublic.alicdn.com (gosspublic.alicdn.com)|221.236.10.175|:80... connected. HTTP request sent, awaiting response... 200 OK Length: 10118253 (9.6M) [application/octet-stream] Saving to: 'ossutil64' 100%[====================================================================================================================>] 10,118,253 12.0MB/s in 0.8s 2020-02-04 15:05:55 (12.0 MB/s) - 'ossutil64' saved [10118253/10118253] $ chmod 755 ossutil64 $ ./ossutil64 -v ossutil version: v1.6.10 \u8fd0\u884cossutil64\u4e0b\u8f7d \u7528\u4ee5\u4e0b\u547d\u4ee4\u4e0b\u8f7doss\u6570\u636e\u5230ec2\u5f53\u524d\u8def\u5f84\u3002\u8fd0\u884c ./ossutil64 help cp \u67e5\u770b\u66f4\u591a\u8bf4\u660e\u3002 ./ossutil64 cp oss://bucketname/myfolder ./ -r -i <AccessKeyID> -k <AccessKeySecret> -e <endpoint> \u6709\u56db\u4e2a\u4fe1\u606f\u9700\u8981\u95ee\u60a8\u7684\u670d\u52a1\u5546\u62ff\u5230\uff1a \u6570\u636e\u5728oss\u4e0a\u7684\u5b8c\u6574\u8def\u5f84 <AccessKeyID> \u5bf9\u5e94 -i <AccessKeySecret> \u5bf9\u5e94 -k oss\u7684endpoint \u5bf9\u5e94 -e \u4e3e\u4f8b\uff1a $ ./ossutil64 cp oss://delivery-data/888/Project_s88_20Samples_20191104_123456 ./ -r -i ABCDEFG123456 -k 1a2b3c4d5e6fABCDE -e http://oss-cn-shanghai.aliyuncs.com \u4f60\u53ea\u6709\u4e00\u6b21\u673a\u4f1a\u6765\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u3002 \u9644\uff1a\u963f\u91cc\u4e91oss\u7684Region\u548cEndpoint\u5bf9\u7167\u8868 Region\u4e2d\u6587\u540d\u79f0 Region\u82f1\u6587\u8868\u793a \u5916\u7f51Endpoint \u4f20\u8f93\u52a0\u901fEndpoint ECS\u8bbf\u95ee\u7684\u5185\u7f51Endpoint \u652f\u6301HTTPS \u534e\u4e1c 1\uff08\u676d\u5dde\uff09 oss-cn-hangzhou oss-cn-hangzhou.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-hangzhou-internal.aliyuncs.com \u662f \u534e\u4e1c 2\uff08\u4e0a\u6d77\uff09 oss-cn-shanghai oss-cn-shanghai.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-shanghai-internal.aliyuncs.com \u662f \u534e\u5317 1\uff08\u9752\u5c9b\uff09 oss-cn-qingdao oss-cn-qingdao.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-qingdao-internal.aliyuncs.com \u662f \u534e\u5317 2\uff08\u5317\u4eac\uff09 oss-cn-beijing oss-cn-beijing.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-beijing-internal.aliyuncs.com \u662f \u534e\u5317 3\uff08\u5f20\u5bb6\u53e3\uff09 oss-cn-zhangjiakou oss-cn-zhangjiakou.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-zhangjiakou-internal.aliyuncs.com \u662f \u534e\u5317 5\uff08\u547c\u548c\u6d69\u7279\uff09 oss-cn-huhehaote oss-cn-huhehaote.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-huhehaote-internal.aliyuncs.com \u662f \u534e\u5357 1\uff08\u6df1\u5733\uff09 oss-cn-shenzhen oss-cn-shenzhen.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-shenzhen-internal.aliyuncs.com \u662f \u534e\u5357 2\uff08\u6cb3\u6e90\uff09 oss-cn-heyuan oss-cn-heyuan.aliyuncs.com \u65e0 oss-cn-heyuan-internal.aliyuncs.com \u662f \u897f\u5357 1\uff08\u6210\u90fd\uff09 oss-cn-chengdu oss-cn-chengdu.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-chengdu-internal.aliyuncs.com \u662f \u4e2d\u56fd\uff08\u9999\u6e2f\uff09 oss-cn-hongkong oss-cn-hongkong.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-hongkong-internal.aliyuncs.com \u662f \u7f8e\u56fd\u897f\u90e8 1 \uff08\u7845\u8c37\uff09 oss-us-west-1 oss-us-west-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-us-west-1-internal.aliyuncs.com \u662f \u7f8e\u56fd\u4e1c\u90e8 1 \uff08\u5f17\u5409\u5c3c\u4e9a\uff09 oss-us-east-1 oss-us-east-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-us-east-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 1 \uff08\u65b0\u52a0\u5761\uff09 oss-ap-southeast-1 oss-ap-southeast-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 2 \uff08\u6089\u5c3c\uff09 oss-ap-southeast-2 oss-ap-southeast-2.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-2-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 3 \uff08\u5409\u9686\u5761\uff09 oss-ap-southeast-3 oss-ap-southeast-3.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-3-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 5 \uff08\u96c5\u52a0\u8fbe\uff09 oss-ap-southeast-5 oss-ap-southeast-5.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-5-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5317 1 \uff08\u65e5\u672c\uff09 oss-ap-northeast-1 oss-ap-northeast-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-northeast-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u5357\u90e8 1 \uff08\u5b5f\u4e70\uff09 oss-ap-south-1 oss-ap-south-1.aliyuncs.com \u65e0 oss-ap-south-1-internal.aliyuncs.com \u662f \u6b27\u6d32\u4e2d\u90e8 1 \uff08\u6cd5\u5170\u514b\u798f\uff09 oss-eu-central-1 oss-eu-central-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-eu-central-1-internal.aliyuncs.com \u662f \u82f1\u56fd\uff08\u4f26\u6566\uff09 oss-eu-west-1 oss-eu-west-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-eu-west-1-internal.aliyuncs.com \u662f \u4e2d\u4e1c\u4e1c\u90e8 1 \uff08\u8fea\u62dc\uff09 oss-me-east-1 oss-me-east-1.aliyuncs.com \u65e0 oss-me-east-1-internal.aliyuncs.com \u662f","title":"\u76f4\u63a5\u4eceec2\u4e0b\u8f7d\u963f\u91cc\u4e91oss\u6570\u636e"},{"location":"blogs/2020-02-04-ec2-download-oss/#ec2oss","text":"\u56fd\u5185\u4e0d\u5c11\u6d4b\u5e8f\u516c\u53f8\u90fd\u63d0\u4f9b\u963f\u91cc\u4e91\u7684oss\u4e0b\u8f7d\u94fe\u63a5\u6765\u4ea4\u4ed8\u6570\u636e\uff0c\u6211\u4eec\u4f1a\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u5206\u6790\uff0c\u4f46\u662f\u5982\u679c\u6211\u7528\u4e86aws\uff0c\u662f\u4e0d\u662f\u8fd8\u8981\u4ece\u672c\u5730\u4e0a\u4f20\u5230aws\u4e0a\uff0c\u90a3\u591a\u9ebb\u70e6\u3002\u5176\u5b9e\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4eceec2\u53bb\u62c9\u963f\u91cc\u7684\u6570\u636e\u5c31\u597d\u4e86\uff0c\u800c\u4e14\u901f\u5ea6\u6760\u6760\u7684\uff01\u5f53\u7136\u8fd9\u4e0d\u9650\u4e8e\u4e0b\u8f7d\u5916\u5305\u6570\u636e\uff0c\u5982\u679c\u9700\u8981\u4e91\u95f4\u6570\u636e\u8fc1\u79fb\uff0c\u4e5f\u662f\u6781\u597d\u7684\uff0c\u800c\u4e14\u8c8c\u4f3cali\u5bf9\u6d41\u91cf\u5e26\u5bbd\u662f\u6709\u9650\u5236\u7684\uff0c\u800caws\u5c31\u6bd4\u8f83\u5b9e\u5728\u90fd\u7ed9\u4f60\u90fd\u7ed9\u4f60\u3002 -- D.C \u540d\u8bcd\u89e3\u91ca\uff1aaws\u7684s3 \u5bf9\u5e94 \u963f\u91cc\u7684oss\uff0cec2 \u5bf9\u5e94 \u963f\u91cc\u7684ecs","title":"\u76f4\u63a5\u4eceec2\u4e0b\u8f7d\u963f\u91cc\u4e91oss\u6570\u636e"},{"location":"blogs/2020-02-04-ec2-download-oss/#ossutil64ec2","text":"\u63a5\u89e6\u8fc7\u963f\u91cc\u4e91\u7684\u90fd\u77e5\u9053\uff0cossutil64\u547d\u4ee4\u662f\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u7ba1\u7406OSS\u6570\u636e\u7684\u5de5\u5177\u3002\u8981\u4e0b\u8f7d\u963f\u91cc\u7684\u6570\u636e\uff0c\u6211\u4eec\u5c31\u5f97\u5148\u5b89\u88c5\u8fd9\u4e2a\u547d\u4ee4\u3002 \u521b\u5efa/\u767b\u5f55\u4e00\u53f0ec2\uff0c\u53ea\u8981\u4e0d\u662ft\u7cfb\u5217\u5c31\u884c\uff0c\u56e0\u4e3at\u7cfb\u5217\u7684\u5e26\u5bbd\u6709\u9650\u5236\u3002\u6bd4\u5982\u6211\u767b\u5f55\u7684\u662f\u4e00\u53f0 m5.large \u3002\u63a5\u7740 wget \u4e0b\u8f7d\u547d\u4ee4\uff0c chmod \u4fee\u6539\u6743\u9650\u3002(\u521b\u5efaec2\u524d\u5148\u77e5\u9053\u5f85\u4e0b\u8f7d\u6570\u636e\u6709\u591a\u5927\uff0c\u6765\u8bbe\u5b9a\u6211\u7684EBS\u76d8\u5927\u5c0f) $ wget http://gosspublic.alicdn.com/ossutil/1.6.10/ossutil64 --2020-02-04 15:05:54-- http://gosspublic.alicdn.com/ossutil/1.6.10/ossutil64 Resolving gosspublic.alicdn.com (gosspublic.alicdn.com)... 221.236.10.175, 117.34.40.113, 118.112.19.115, ... Connecting to gosspublic.alicdn.com (gosspublic.alicdn.com)|221.236.10.175|:80... connected. HTTP request sent, awaiting response... 200 OK Length: 10118253 (9.6M) [application/octet-stream] Saving to: 'ossutil64' 100%[====================================================================================================================>] 10,118,253 12.0MB/s in 0.8s 2020-02-04 15:05:55 (12.0 MB/s) - 'ossutil64' saved [10118253/10118253] $ chmod 755 ossutil64 $ ./ossutil64 -v ossutil version: v1.6.10","title":"\u5b89\u88c5ossutil64\u5230ec2"},{"location":"blogs/2020-02-04-ec2-download-oss/#ossutil64","text":"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e0b\u8f7doss\u6570\u636e\u5230ec2\u5f53\u524d\u8def\u5f84\u3002\u8fd0\u884c ./ossutil64 help cp \u67e5\u770b\u66f4\u591a\u8bf4\u660e\u3002 ./ossutil64 cp oss://bucketname/myfolder ./ -r -i <AccessKeyID> -k <AccessKeySecret> -e <endpoint> \u6709\u56db\u4e2a\u4fe1\u606f\u9700\u8981\u95ee\u60a8\u7684\u670d\u52a1\u5546\u62ff\u5230\uff1a \u6570\u636e\u5728oss\u4e0a\u7684\u5b8c\u6574\u8def\u5f84 <AccessKeyID> \u5bf9\u5e94 -i <AccessKeySecret> \u5bf9\u5e94 -k oss\u7684endpoint \u5bf9\u5e94 -e \u4e3e\u4f8b\uff1a $ ./ossutil64 cp oss://delivery-data/888/Project_s88_20Samples_20191104_123456 ./ -r -i ABCDEFG123456 -k 1a2b3c4d5e6fABCDE -e http://oss-cn-shanghai.aliyuncs.com \u4f60\u53ea\u6709\u4e00\u6b21\u673a\u4f1a\u6765\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u3002 \u9644\uff1a\u963f\u91cc\u4e91oss\u7684Region\u548cEndpoint\u5bf9\u7167\u8868 Region\u4e2d\u6587\u540d\u79f0 Region\u82f1\u6587\u8868\u793a \u5916\u7f51Endpoint \u4f20\u8f93\u52a0\u901fEndpoint ECS\u8bbf\u95ee\u7684\u5185\u7f51Endpoint \u652f\u6301HTTPS \u534e\u4e1c 1\uff08\u676d\u5dde\uff09 oss-cn-hangzhou oss-cn-hangzhou.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-hangzhou-internal.aliyuncs.com \u662f \u534e\u4e1c 2\uff08\u4e0a\u6d77\uff09 oss-cn-shanghai oss-cn-shanghai.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-shanghai-internal.aliyuncs.com \u662f \u534e\u5317 1\uff08\u9752\u5c9b\uff09 oss-cn-qingdao oss-cn-qingdao.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-qingdao-internal.aliyuncs.com \u662f \u534e\u5317 2\uff08\u5317\u4eac\uff09 oss-cn-beijing oss-cn-beijing.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-beijing-internal.aliyuncs.com \u662f \u534e\u5317 3\uff08\u5f20\u5bb6\u53e3\uff09 oss-cn-zhangjiakou oss-cn-zhangjiakou.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-zhangjiakou-internal.aliyuncs.com \u662f \u534e\u5317 5\uff08\u547c\u548c\u6d69\u7279\uff09 oss-cn-huhehaote oss-cn-huhehaote.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-huhehaote-internal.aliyuncs.com \u662f \u534e\u5357 1\uff08\u6df1\u5733\uff09 oss-cn-shenzhen oss-cn-shenzhen.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-shenzhen-internal.aliyuncs.com \u662f \u534e\u5357 2\uff08\u6cb3\u6e90\uff09 oss-cn-heyuan oss-cn-heyuan.aliyuncs.com \u65e0 oss-cn-heyuan-internal.aliyuncs.com \u662f \u897f\u5357 1\uff08\u6210\u90fd\uff09 oss-cn-chengdu oss-cn-chengdu.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-chengdu-internal.aliyuncs.com \u662f \u4e2d\u56fd\uff08\u9999\u6e2f\uff09 oss-cn-hongkong oss-cn-hongkong.aliyuncs.com oss-accelerate.aliyuncs.com oss-cn-hongkong-internal.aliyuncs.com \u662f \u7f8e\u56fd\u897f\u90e8 1 \uff08\u7845\u8c37\uff09 oss-us-west-1 oss-us-west-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-us-west-1-internal.aliyuncs.com \u662f \u7f8e\u56fd\u4e1c\u90e8 1 \uff08\u5f17\u5409\u5c3c\u4e9a\uff09 oss-us-east-1 oss-us-east-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-us-east-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 1 \uff08\u65b0\u52a0\u5761\uff09 oss-ap-southeast-1 oss-ap-southeast-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 2 \uff08\u6089\u5c3c\uff09 oss-ap-southeast-2 oss-ap-southeast-2.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-2-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 3 \uff08\u5409\u9686\u5761\uff09 oss-ap-southeast-3 oss-ap-southeast-3.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-3-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5357 5 \uff08\u96c5\u52a0\u8fbe\uff09 oss-ap-southeast-5 oss-ap-southeast-5.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-southeast-5-internal.aliyuncs.com \u662f \u4e9a\u592a\u4e1c\u5317 1 \uff08\u65e5\u672c\uff09 oss-ap-northeast-1 oss-ap-northeast-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-ap-northeast-1-internal.aliyuncs.com \u662f \u4e9a\u592a\u5357\u90e8 1 \uff08\u5b5f\u4e70\uff09 oss-ap-south-1 oss-ap-south-1.aliyuncs.com \u65e0 oss-ap-south-1-internal.aliyuncs.com \u662f \u6b27\u6d32\u4e2d\u90e8 1 \uff08\u6cd5\u5170\u514b\u798f\uff09 oss-eu-central-1 oss-eu-central-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-eu-central-1-internal.aliyuncs.com \u662f \u82f1\u56fd\uff08\u4f26\u6566\uff09 oss-eu-west-1 oss-eu-west-1.aliyuncs.com oss-accelerate.aliyuncs.com oss-eu-west-1-internal.aliyuncs.com \u662f \u4e2d\u4e1c\u4e1c\u90e8 1 \uff08\u8fea\u62dc\uff09 oss-me-east-1 oss-me-east-1.aliyuncs.com \u65e0 oss-me-east-1-internal.aliyuncs.com \u662f","title":"\u8fd0\u884cossutil64\u4e0b\u8f7d"},{"location":"blogs/2020-02-04-tips/","text":"\u4e00\u4e9b\u5b9e\u7528\u7684\u547d\u4ee4(\u6301\u7eed\u66f4\u65b0) \u5176\u5b9e\u90fd\u662faws cli\u91cc\u9762\u7684\u5185\u5bb9\uff0caws doc\u4e0a\u4e5f\u90fd\u6709\uff0c\u6574\u7406\u4e00\u4e9b\u5e38\u7528\u7684\u4f5c\u4e3a\u5907\u5fd8\u3002 -- D.C s3 \u770b\u770bs3\u4e0a\u7528\u4e86\u591a\u5c11\u7a7a\u95f4 \u5217\u51fa\u6876\u7684\u5927\u5c0f\u548c\u6587\u4ef6\u6570\u91cf\u3002 \u683c\u5f0f\uff1a aws s3api list-objects --bucket BUCKETNAME --output json --query \"[sum(Contents[].Size), length(Contents[])]\" $ aws s3api list-objects --bucket mytestbucket --output json --query \"[sum(Contents[].Size), length(Contents[])]\" [ 201509112, # \u6876\u5185\u6587\u4ef6\u5927\u5c0f 8 # \u6876\u5185\u6587\u4ef6\u6570\u91cf ] \u5217\u51fa\u6876\u5185\u6bcf\u4e2a\u6587\u4ef6\u5927\u5c0f\u548c\u603b\u5360\u7528 \u683c\u5f0f\uff1a aws s3 ls --summarize --human-readable --recursive s3://YOUR_BUCKET_NAME $ aws s3 ls --summarize --human-readable --recursive s3://91package/ 2020-02-01 21:03:49 0 Bytes 1 2019-12-06 22:33:16 160.0 MiB AtomSetup-x64.exe 2019-12-06 22:33:43 836.2 MiB Docker Desktop Installer.exe 2019-12-18 23:38:36 87.3 MiB GitHubDesktopSetup.exe Total Objects: 4 Total Size: 1.1 GiB \u6839\u636e\u5173\u952e\u5b57\u67e5\u627e\u6876\u5185\u6587\u4ef6 $ aws s3api list-objects --bucket \u6876\u540d --query \"Contents[?contains(Key, '\u6587\u4ef6\u540d\u79f0')]\" $ aws s3 ls s3://xxx --recursive | grep xxx | cut -c 32- \u67e5\u627e\u67d0\u5929\u4fee\u6539\u8fc7\u7684\u6587\u4ef6 $ aws s3api list-objects --bucket <bucket name> --query \"Contents[?contains(LastModified) > '2017-08-03')]\" \u67e5\u627e\u67d0\u5929\u5230\u67d0\u5929\u65f6\u95f4\u6bb5\u5185\u4fee\u6539\u8fc7\u7684\u6587\u4ef6 $ aws s3api list-objects --bucket <bucket name> --query \"Contents[?LastModified > '2017-08-03T23' && LastModified < '2017-08-03T23:15']\" \u67e5\u627exxx\u6876\u5185\u6240\u6709\u6df1\u5ea6\u5f52\u6863\u7684\u540d\u5b57\u91cc\u6709pdf\u7684 aws s3api list-objects-v2 --bucket xxx\u6876 --query \"Contents[?StorageClass =='DEEP_ARCHIVE']\" --output text | awk '{print $2}' | grep 'pdf' \u547d\u4ee4\u884c\u5f52\u6863\u547d\u4ee4 \u65b9\u6cd51 - \u7528 cp \u547d\u4ee4,\u539f\u5730\u53d8\u8eab\u4e3a\u5f52\u6863\u7c7b\u578b aws s3 cp s3://exampe/ s3://exampe/ --storage-class GLACIER --recursive \u65b9\u6cd52 - \u7528 mv \u547d\u4ee4\uff0c\u8f6c\u79fb\u5230\u4e13\u95e8\u5f52\u6863\u7684\u6876 aws s3 mv s3://xxx/xxx/ s3://xxx/xxx/ --recursive --storage-class DEEP_ARCHIVE Storage Class: STANDARD | REDUCED_REDUNDANCY | STANDARD_IA | ONEZONE_IA | INTELLIGENT_TIERING | GLACIER | DEEP_ARCHIVE. Defaults to 'STANDARD' \u53d6\u56de\u5f52\u6863\u7684\u6587\u4ef6 \u8fd8\u539flovevideo\u6876\u91cc\u7684xxx.exe\uff0c\u4fdd\u755910\u5929\u3002 aws s3api restore-object --bucket lovevideo --key xxx.exe --restore-request Days=10 \u6062\u590dlovevideo\u6876\u91cc\u7684dir1\u4e0b\u7684example.obj\u6587\u4ef6\u5230standard\uff08\u65e0\u5197\u4f59\u7c7b\uff09\uff0c\u4fdd\u755925\u5929\u540e\u5220\u9664\uff0c\u539f\u5f52\u6863\u6587\u4ef6\u4e0d\u53d8\u3002 $ aws s3api restore-object --bucket lovevideo --key dir1/example.obj --restore-request '{\"Days\":25,\"GlacierJobParameters\":{\"Tier\":\"Standard\"}}' \u67e5\u770b\u8fd8\u539f\u72b6\u6001\uff1a $ aws s3api head-object --bucket lovevideo --key xxx.exe { \"AcceptRanges\": \"bytes\", \"Restore\": \"ongoing-request=\\\"true\\\"\", \"LastModified\": \"2020-05-22T07:08:51+00:00\", \"ContentLength\": 167780896, \"ETag\": \"\\\"a65d3003c998dawd8a9d8ae47a9ebc51-21\\\"\", \"ContentType\": \"application/x-msdownload\", \"Metadata\": {}, \"StorageClass\": \"DEEP_ARCHIVE\" } \u8fd8\u539f\u5b8c\u6210\u7684\u63d0\u793a\u4fe1\u606f\uff1a { \"Restore\": \"ongoing-request=\\\"false\\\", expiry-date=\\\"Sun, 13 Aug 2017 00:00:00 GMT\\\"\", ... \"StorageClass\": \"DEEP_ARCHIVE\", \"Metadata\": {} } \u8be6\u7ec6\u53c2\u8003 \u70b9\u6211 ec2 \u67e5\u770binstance\u4fe1\u606f aws ec2 describe-instances \u8f93\u51fa\u7684\u5185\u5bb9\u592a\u591a\uff0c\u540e\u9762\u7528\u7ba1\u9053\u52a0\u4e2a awk \u5427\u3002 \u5982\uff1a aws ec2 describe-instances | awk -F\\\" '/InstanceId/{print $4}' EKS k8s installing https://kubernetes.io/docs/tasks/tools/install-kubectl/#before-you-begin","title":"\u4e00\u4e9b\u5b9e\u7528\u7684\u547d\u4ee4(\u6301\u7eed\u66f4\u65b0)"},{"location":"blogs/2020-02-04-tips/#_1","text":"\u5176\u5b9e\u90fd\u662faws cli\u91cc\u9762\u7684\u5185\u5bb9\uff0caws doc\u4e0a\u4e5f\u90fd\u6709\uff0c\u6574\u7406\u4e00\u4e9b\u5e38\u7528\u7684\u4f5c\u4e3a\u5907\u5fd8\u3002 -- D.C","title":"\u4e00\u4e9b\u5b9e\u7528\u7684\u547d\u4ee4(\u6301\u7eed\u66f4\u65b0)"},{"location":"blogs/2020-02-04-tips/#s3","text":"","title":"s3"},{"location":"blogs/2020-02-04-tips/#s3_1","text":"\u5217\u51fa\u6876\u7684\u5927\u5c0f\u548c\u6587\u4ef6\u6570\u91cf\u3002 \u683c\u5f0f\uff1a aws s3api list-objects --bucket BUCKETNAME --output json --query \"[sum(Contents[].Size), length(Contents[])]\" $ aws s3api list-objects --bucket mytestbucket --output json --query \"[sum(Contents[].Size), length(Contents[])]\" [ 201509112, # \u6876\u5185\u6587\u4ef6\u5927\u5c0f 8 # \u6876\u5185\u6587\u4ef6\u6570\u91cf ] \u5217\u51fa\u6876\u5185\u6bcf\u4e2a\u6587\u4ef6\u5927\u5c0f\u548c\u603b\u5360\u7528 \u683c\u5f0f\uff1a aws s3 ls --summarize --human-readable --recursive s3://YOUR_BUCKET_NAME $ aws s3 ls --summarize --human-readable --recursive s3://91package/ 2020-02-01 21:03:49 0 Bytes 1 2019-12-06 22:33:16 160.0 MiB AtomSetup-x64.exe 2019-12-06 22:33:43 836.2 MiB Docker Desktop Installer.exe 2019-12-18 23:38:36 87.3 MiB GitHubDesktopSetup.exe Total Objects: 4 Total Size: 1.1 GiB \u6839\u636e\u5173\u952e\u5b57\u67e5\u627e\u6876\u5185\u6587\u4ef6 $ aws s3api list-objects --bucket \u6876\u540d --query \"Contents[?contains(Key, '\u6587\u4ef6\u540d\u79f0')]\" $ aws s3 ls s3://xxx --recursive | grep xxx | cut -c 32- \u67e5\u627e\u67d0\u5929\u4fee\u6539\u8fc7\u7684\u6587\u4ef6 $ aws s3api list-objects --bucket <bucket name> --query \"Contents[?contains(LastModified) > '2017-08-03')]\" \u67e5\u627e\u67d0\u5929\u5230\u67d0\u5929\u65f6\u95f4\u6bb5\u5185\u4fee\u6539\u8fc7\u7684\u6587\u4ef6 $ aws s3api list-objects --bucket <bucket name> --query \"Contents[?LastModified > '2017-08-03T23' && LastModified < '2017-08-03T23:15']\" \u67e5\u627exxx\u6876\u5185\u6240\u6709\u6df1\u5ea6\u5f52\u6863\u7684\u540d\u5b57\u91cc\u6709pdf\u7684 aws s3api list-objects-v2 --bucket xxx\u6876 --query \"Contents[?StorageClass =='DEEP_ARCHIVE']\" --output text | awk '{print $2}' | grep 'pdf' \u547d\u4ee4\u884c\u5f52\u6863\u547d\u4ee4 \u65b9\u6cd51 - \u7528 cp \u547d\u4ee4,\u539f\u5730\u53d8\u8eab\u4e3a\u5f52\u6863\u7c7b\u578b aws s3 cp s3://exampe/ s3://exampe/ --storage-class GLACIER --recursive \u65b9\u6cd52 - \u7528 mv \u547d\u4ee4\uff0c\u8f6c\u79fb\u5230\u4e13\u95e8\u5f52\u6863\u7684\u6876 aws s3 mv s3://xxx/xxx/ s3://xxx/xxx/ --recursive --storage-class DEEP_ARCHIVE Storage Class: STANDARD | REDUCED_REDUNDANCY | STANDARD_IA | ONEZONE_IA | INTELLIGENT_TIERING | GLACIER | DEEP_ARCHIVE. Defaults to 'STANDARD' \u53d6\u56de\u5f52\u6863\u7684\u6587\u4ef6 \u8fd8\u539flovevideo\u6876\u91cc\u7684xxx.exe\uff0c\u4fdd\u755910\u5929\u3002 aws s3api restore-object --bucket lovevideo --key xxx.exe --restore-request Days=10 \u6062\u590dlovevideo\u6876\u91cc\u7684dir1\u4e0b\u7684example.obj\u6587\u4ef6\u5230standard\uff08\u65e0\u5197\u4f59\u7c7b\uff09\uff0c\u4fdd\u755925\u5929\u540e\u5220\u9664\uff0c\u539f\u5f52\u6863\u6587\u4ef6\u4e0d\u53d8\u3002 $ aws s3api restore-object --bucket lovevideo --key dir1/example.obj --restore-request '{\"Days\":25,\"GlacierJobParameters\":{\"Tier\":\"Standard\"}}' \u67e5\u770b\u8fd8\u539f\u72b6\u6001\uff1a $ aws s3api head-object --bucket lovevideo --key xxx.exe { \"AcceptRanges\": \"bytes\", \"Restore\": \"ongoing-request=\\\"true\\\"\", \"LastModified\": \"2020-05-22T07:08:51+00:00\", \"ContentLength\": 167780896, \"ETag\": \"\\\"a65d3003c998dawd8a9d8ae47a9ebc51-21\\\"\", \"ContentType\": \"application/x-msdownload\", \"Metadata\": {}, \"StorageClass\": \"DEEP_ARCHIVE\" } \u8fd8\u539f\u5b8c\u6210\u7684\u63d0\u793a\u4fe1\u606f\uff1a { \"Restore\": \"ongoing-request=\\\"false\\\", expiry-date=\\\"Sun, 13 Aug 2017 00:00:00 GMT\\\"\", ... \"StorageClass\": \"DEEP_ARCHIVE\", \"Metadata\": {} } \u8be6\u7ec6\u53c2\u8003 \u70b9\u6211","title":"\u770b\u770bs3\u4e0a\u7528\u4e86\u591a\u5c11\u7a7a\u95f4"},{"location":"blogs/2020-02-04-tips/#ec2","text":"","title":"ec2"},{"location":"blogs/2020-02-04-tips/#instance","text":"aws ec2 describe-instances \u8f93\u51fa\u7684\u5185\u5bb9\u592a\u591a\uff0c\u540e\u9762\u7528\u7ba1\u9053\u52a0\u4e2a awk \u5427\u3002 \u5982\uff1a aws ec2 describe-instances | awk -F\\\" '/InstanceId/{print $4}'","title":"\u67e5\u770binstance\u4fe1\u606f"},{"location":"blogs/2020-02-04-tips/#eks","text":"","title":"EKS"},{"location":"blogs/2020-02-04-tips/#k8s-installing","text":"https://kubernetes.io/docs/tasks/tools/install-kubectl/#before-you-begin","title":"k8s installing"},{"location":"blogs/2020-02-05-monitor-ec2-mem/","text":"\u7528\u811a\u672c\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807 \u719f\u6089ec2\u754c\u9762\u7684\u540c\u5b66\u90fd\u77e5\u9053\uff0c\u9009\u4e2d\u67d0\u53f0ec2\uff0c\u4e0b\u9762\u6709\u4e2atab\u540d\u53ebmonitor\uff0c\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u6307\u6807\u5982cpu\uff0c\u78c1\u76d8\u8bfb\u5199\uff0c\u7f51\u7edc\u8fdb\u51fa\u7b49\uff0c\u4f46\u662f\u5374\u6ca1\u6709\u5185\u5b58\u5360\u7528\u76d1\u63a7\uff0c\u8fd9\u662f\u51fa\u4e8e\u5b89\u5168\u6027\u7684\u8003\u8651\uff0c\u6bd5\u7adf\u5185\u5b58\u4e2d\u53ef\u662f\u52a0\u8f7d\u7740\u6570\u636e\u7684\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u6211\u4eec\u4eb2\u81ea\u52a8\u624b\u5b9e\u73b0\u4e86\u3002 -- D.C \u5e94\u7528\u573a\u666f\uff1a\u5bf9\u4e8e\u521d\u6b21\u4f7f\u7528aws\u7684\u7ae5\u978b\u6765\u8bf4\uff0c\u5982\u679c\u6839\u636e\u624b\u5934\u7684\u5206\u6790\u6d41\u7a0b\u6765\u5224\u65ad\u6240\u9700\u7684\u8ba1\u7b97\u8d44\u6e90\uff0c\u4e5f\u8bb8\u662f\u4e00\u4e2a\u5934\u75bc\u7684\u4e8b\u60c5\u3002\u914d\u7f6e\u9009\u4f4e\u4e86\uff0c\u6d4b\u8bd5\u8dd1\u65ad\u6389\uff0c\u914d\u7f6e\u9009\u9ad8\u4e86\uff0c\u6d6a\u8d39\u591a\u4f59\u7684\u8ba1\u7b97\u8d44\u6e90\uff0c\u8d39\u94b1\uff01\u6240\u4ee5\u901a\u5e38\u7684\u505a\u6cd5\u662f\uff0c\u9009\u4e2a\u9002\u5f53\u504f\u5927\u7684\u914d\u7f6e\uff0c\u8dd1\u4e00\u904d\u6d41\u7a0b\uff0c\u518d\u56de\u5934\u770b\u6574\u4e2a\u5206\u6790\u8fc7\u7a0b\u4e2d\u7684CPU\u5360\u7528\u548c\u5185\u5b58\u5360\u7528\uff0c\u6765\u53cd\u63a8\u4e00\u4e2a\u5408\u9002\u7684\u914d\u7f6e\uff0c\u4f5c\u4e3a\u6211\u4eec\u4ee5\u540e\u5e38\u7528\u7684\u5206\u6790\u673a\u578b\u3002 \u90a3\u4e48cpu\u76d1\u63a7\u662f\u9ed8\u8ba4\u7684\uff0c\u6211\u5c31\u53ea\u8981\u5b9e\u73b0\u5185\u5b58\u76d1\u63a7\u4e86\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u603b\u7684\u76d1\u63a7\u6d41\uff1a \u521b\u5efaIAM Role - Role\u8d4b\u7ed9ec2- \u76d1\u63a7\u811a\u672c - \u65e5\u5fd7\u8f93\u51fa\u5230cloudwatch - \u67e5\u770b\u65e5\u5fd7 \u521b\u5efaIAM Role \u8fd9\u4e2aIAM\u89d2\u8272\u662f\u8981\u8d4b\u7ed9ec2\uff0c\u8ba9\u5b83\u6709\u6743\u9650\u628a\u76d1\u63a7\u4fe1\u606f\u7ed9\u5230CloudWatch\u3002 cloudwatch:PutMetricData cloudwatch:GetMetricStatistics cloudwatch:ListMetrics ec2:DescribeTags IAM\u63a7\u5236\u754c\u9762\u8fdb\u53bb\uff0c\u70b9\u51fb Policy \uff0c\u5982\u4e0b\u56fe\u65b0\u5efa\u4e00\u4e2apolicy\uff0c\u547d\u540d\u4e3a watch_ec2_mem \u3002 IAM\u63a7\u5236\u754c\u9762\u5de6\u4fa7\uff0c\u70b9\u51fb Role ,\u5982\u4e0b\u56fe\u65b0\u5efa\u4e00\u4e2a\u89d2\u8272\uff0c\u9009\u4e2d\u521a\u521a\u521b\u5efa\u7684\u7b56\u7565 watch_ec2_mem ,\u547d\u540d\u4e3a ec2_mem_cw \u3002 \u9009\u4e2dec2\u673a\u5668\uff0c\u70b9\u51fb Actions - Instance Settings - Attach/Replace IAM Role , \u9009\u4e2d\u4e0a\u4e00\u6b65\u65b0\u5efa\u7684Role\u9ec4\u9a6c\u7532\uff0c\u7ed9\u5b83\u7a7f\u4e0a\u3002 ec2\u4e0a\u5b89\u88c5\u76d1\u63a7\u811a\u672c \u8fde\u63a5\u5230\u8981\u76d1\u63a7\u7684ec2\u4e0a\uff0c\u5b89\u88c5\u5fc5\u8981\u7684\u7a0b\u5e8f\u5305\uff1a Linux sudo yum install -y perl-Switch perl-DateTime perl-Sys-Syslog perl-LWP-Protocol-https perl-Digest-SHA.x86_64 Ubuntu sudo apt-get update sudo apt-get install unzip sudo apt-get install libwww-perl libdatetime-perl \u4e0b\u8f7d\u3001\u89e3\u538b\u7f29\u5e76\u914d\u7f6e CloudWatch \u76d1\u63a7\u811a\u672c\u3002 $ curl https://aws-cloudwatch.s3.amazonaws.com/downloads/CloudWatchMonitoringScripts-1.2.2.zip -O % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 24225 100 24225 0 0 12736 0 0:00:01 0:00:01 --:--:-- 12729 unzip CloudWatchMonitoringScripts-1.2.2.zip && \\ rm CloudWatchMonitoringScripts-1.2.2.zip && \\ cd aws-scripts-mon \u76d1\u63a7\u811a\u672c\u7684\u7a0b\u5e8f\u5305\u4e2d\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\uff1a CloudWatchClient.pm \u2013 \u5171\u4eab Perl \u6a21\u5757\uff0c\u4ee5\u7b80\u5316\u4ece\u5176\u4ed6\u811a\u672c\u8c03\u7528 Amazon CloudWatch \u7684\u8fc7\u7a0b\u3002 mon-put-instance-data.pl \u2013 \u6536\u96c6 Amazon EC2 \u5b9e\u4f8b\u4e2d\u7684\u7cfb\u7edf\u6307\u6807\uff08\u5185\u5b58\u3001\u4ea4\u6362\u3001\u78c1\u76d8\u7a7a\u95f4\u5229\u7528\u7387\uff09\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\u3002 mon-get-instance-stats.pl \u2013 \u67e5\u8be2 Amazon CloudWatch \u5e76\u663e\u793a\u5728\u5176\u4e0a\u6267\u884c\u6b64\u811a\u672c\u7684 EC2 \u5b9e\u4f8b\u7684\u6700\u8fd1\u5229\u7528\u7387\u7edf\u8ba1\u6570\u636e\u3002 awscreds.template \u2013 AWS \u51ed\u636e\u7684\u6587\u4ef6\u6a21\u677f\uff0c\u50a8\u5b58\u60a8\u7684\u8bbf\u95ee\u5bc6\u94a5 ID \u548c\u79c1\u6709\u8bbf\u95ee\u5bc6\u94a5\u3002 LICENSE.txt \u2013 \u5305\u542b Apache 2.0 \u8bb8\u53ef\u8bc1\u7684\u6587\u672c\u6587\u4ef6\u3002 NOTICE.txt \u2013 \u7248\u6743\u58f0\u660e\u3002 \u8fd0\u884c\u76d1\u63a7\u811a\u672c Usage: mon-put-instance-data.pl , \u6b64\u811a\u672c\u4f1a\u6536\u96c6\u5f53\u524d\u7cfb\u7edf\u7684\u5185\u5b58\u3001\u4ea4\u6362\u548c\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u7387\u6570\u636e\u3002\u7136\u540e\u8fdc\u7a0b\u8c03\u7528 Amazon CloudWatch\uff0c\u4ee5\u81ea\u5b9a\u4e49\u6307\u6807\u7684\u5f62\u5f0f\u62a5\u544a\u6536\u96c6\u5230\u7684\u6570\u636e\u3002 \u540d\u79f0 \u63cf\u8ff0 --mem-util \u4ee5\u767e\u5206\u6bd4\u6536\u96c6\u548c\u53d1\u9001 MemoryUtilization \u6307\u6807\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --mem-used \u6536\u96c6\u548c\u53d1\u9001 MemoryUsed \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --mem-used-incl-cache-buff \u5982\u679c\u5305\u62ec\u6b64\u9009\u9879\uff0c\u5219\u5728\u62a5\u544a --mem-util\u3001--mem-used \u548c --mem-avail \u7684\u6307\u6807\u65f6\uff0c\u5f53\u524d\u7528\u4e8e\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u7684\u5185\u5b58\u5c06\u8ba1\u4e3a\u201c\u5df2\u7528\u201d\u3002 --mem-avail \u6536\u96c6\u548c\u53d1\u9001 MemoryAvailable \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --swap-util \u6536\u96c6\u548c\u53d1\u9001 SwapUtilization \u6307\u6807 (\u4ee5\u767e\u5206\u6bd4\u62a5\u544a)\u3002 --swap-used \u6536\u96c6\u548c\u53d1\u9001 SwapUsed \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002 --disk-path=PATH \u9009\u62e9\u8981\u62a5\u544a\u7684\u78c1\u76d8\u3002PATH \u53ef\u4ee5\u4e3a\u9700\u8981\u62a5\u544a\u7684\u6587\u4ef6\u7cfb\u7edf\u6307\u5b9a\u88c5\u5165\u70b9\u6216\u88c5\u5165\u70b9\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u3002\u5982\u9700\u9009\u62e9\u591a\u4e2a\u78c1\u76d8\uff0c\u8bf7\u4e3a\u6bcf\u4e2a\u78c1\u76d8\u5206\u522b\u6307\u5b9a --disk-path=PATH\u3002 \u8981\u4e3a\u88c5\u8f7d\u4e8e / \u548c /home \u4f4d\u7f6e\u7684\u6587\u4ef6\u7cfb\u7edf\u9009\u62e9\u78c1\u76d8\uff0c\u8bf7\u4f7f\u7528\u4e0b\u5217\u53c2\u6570\uff1a--disk-path=/ --disk-path=/home --disk-space-util \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceUtilization \u6307\u6807\u3002\u6307\u6807\u4ee5\u767e\u5206\u6bd4\u62a5\u544a\u3002\u8bf7\u6ce8\u610f\uff0c\u6b64\u811a\u672c\u8ba1\u7b97\u7684\u78c1\u76d8\u4f7f\u7528\u7387\u6307\u6807\u4e0e df -k -l \u547d\u4ee4\u8ba1\u7b97\u7684\u503c\u4e0d\u540c\u3002\u5982\u679c\u60a8\u8ba4\u4e3a df -k -l \u8ba1\u7b97\u7684\u503c\u66f4\u6709\u7528\uff0c\u5219\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u66f4\u6539\u8ba1\u7b97\u7ed3\u679c\u3002 --disk-space-used \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceUsed \u6307\u6807\u3002\u6307\u6807\u9ed8\u8ba4\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u53d7\u9650\u4e8e Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u4fdd\u7559\u78c1\u76d8\u7a7a\u95f4\uff0c\u5df2\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u53ef\u7528\u78c1\u76d8\u7a7a\u95f4\u53ef\u80fd\u65e0\u6cd5\u51c6\u786e\u76f8\u52a0\u5f97\u5230\u78c1\u76d8\u7a7a\u95f4\u603b\u91cf\u3002 --disk-space-avail \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceAvailable \u6307\u6807\u3002\u6307\u6807\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u53d7\u9650\u4e8e Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u4fdd\u7559\u78c1\u76d8\u7a7a\u95f4\uff0c\u5df2\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u53ef\u7528\u78c1\u76d8\u7a7a\u95f4\u53ef\u80fd\u65e0\u6cd5\u51c6\u786e\u76f8\u52a0\u5f97\u5230\u78c1\u76d8\u7a7a\u95f4\u603b\u91cf\u3002 --memory-units=UNITS \u6307\u5b9a\u62a5\u544a\u5185\u5b58\u4f7f\u7528\u7387\u6240\u91c7\u7528\u7684\u5355\u4f4d\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u5185\u5b58\u4ee5\u5146\u5b57\u8282\u62a5\u544a\u3002\u5355\u4f4d\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e00\u79cd\uff1a\u5b57\u8282\u3001\u5343\u5b57\u8282\u3001\u5146\u5b57\u8282\u3001\u5343\u5146\u5b57\u8282\u3002 --disk-space-units=UNITS \u6307\u5b9a\u62a5\u544a\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u7387\u6240\u91c7\u7528\u7684\u5355\u4f4d\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u78c1\u76d8\u7a7a\u95f4\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u5355\u4f4d\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e00\u79cd\uff1a\u5b57\u8282\u3001\u5343\u5b57\u8282\u3001\u5146\u5b57\u8282\u3001\u5343\u5146\u5b57\u8282\u3002 --aws-credential- file=PATH \u63d0\u4f9b\u5305\u542b AWS \u51ed\u8bc1\u7684\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u6b64\u53c2\u6570\u4e0d\u80fd\u4e0e --aws-access-key-id \u548c --aws-secret-key \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-access-key-id=VALUE \u6307\u5b9a\u7528\u4e8e\u8bc6\u522b\u53d1\u8d77\u4eba\u7684 AWS \u8bbf\u95ee\u5bc6\u94a5 ID\u3002\u5fc5\u987b\u4e0e --aws-secret-key \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-secret-key=VALUE \u6307\u5b9a\u7528\u4e8e\u7b7e\u7f72 CloudWatch \u8bf7\u6c42\u7684 AWS \u79d8\u5bc6\u8bbf\u95ee\u5bc6\u94a5\u3002\u5fc5\u987b\u4e0e --aws-access-key-id \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-iam-role=VALUE \u6307\u5b9a\u7528\u4e8e\u63d0\u4f9b AWS \u51ed\u8bc1\u7684 IAM \u89d2\u8272\u3002\u5fc5\u987b\u63d0\u4f9b =VALUE \u503c\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u51ed\u8bc1\uff0c\u5219\u4f1a\u5e94\u7528\u4e0e EC2 \u5b9e\u4f8b\u5173\u8054\u7684\u9ed8\u8ba4 IAM \u89d2\u8272\u3002\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a IAM \u89d2\u8272\u3002\u5982\u679c\u672a\u627e\u5230\u4efb\u4f55 IAM \u89d2\u8272\uff0c\u6216\u8005\u627e\u5230\u591a\u4e2a IAM \u89d2\u8272\uff0c\u5219\u811a\u672c\u4f1a\u8fd4\u56de\u4e00\u6761\u9519\u8bef\u4fe1\u606f\u3002 --aggregated[=only] \u4e3a\u5b9e\u4f8b\u7c7b\u578b\u3001AMI ID \u53ca\u533a\u57df\u6574\u4f53\u60c5\u51b5\u6dfb\u52a0\u805a\u5408\u6307\u6570\u3002=only \u503c\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u811a\u672c\u53ea\u62a5\u544a\u805a\u5408\u6307\u6807\u3002 --auto-scaling[=only] \u4e3a Auto Scaling \u7ec4\u6dfb\u52a0\u805a\u5408\u6307\u6807\u3002=only \u503c\u4e3a\u53ef\u9009\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u811a\u672c\u53ea\u4f1a\u62a5\u544a Auto Scaling \u6307\u6807\u3002\u4f7f\u7528\u811a\u672c\u4e0e IAM \u8d26\u6237\u6216\u89d2\u8272\u5173\u8054\u7684 IAM \u7b56\u7565\u5fc5\u987b\u6709\u6743\u8c03\u7528 EC2 \u64cd\u4f5c DescribeTags\u3002 --verify \u4f1a\u5bf9\u6536\u96c6\u6307\u6807\u7684\u811a\u672c\u6267\u884c\u4e00\u6b21\u8bd5\u8fd0\u884c\uff0c\u51c6\u5907\u5b8c\u6574 HTTP \u8bf7\u6c42\uff0c\u4f46\u662f\u4e0d\u4f1a\u8c03\u7528 CloudWatch \u4ee5\u62a5\u544a\u6570\u636e\u3002\u8be5\u9009\u9879\u8fd8\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u63d0\u4f9b\u51ed\u8bc1\u3002\u5728\u8be6\u7ec6\u6a21\u5f0f\u4e2d\u8fd0\u884c\u65f6\uff0c\u8be5\u9009\u9879\u8f93\u51fa\u7684\u6307\u6807\u4f1a\u53d1\u9001\u5230 CloudWatch\u3002 --from-cron \u4ece cron \u8c03\u7528\u811a\u672c\u65f6\uff0c\u8bf7\u4f7f\u7528\u8be5\u9009\u9879\u3002\u4f7f\u7528\u8be5\u9009\u9879\u65f6\uff0c\u4f1a\u963b\u6b62\u6240\u6709\u8bca\u65ad\u8f93\u51fa\uff0c\u4f46\u9519\u8bef\u6d88\u606f\u4f1a\u53d1\u9001\u5230\u7528\u6237\u8d26\u6237\u7684\u672c\u5730\u7cfb\u7edf\u65e5\u5fd7\u3002 --verbose \u663e\u793a\u811a\u672c\u6b63\u5728\u5904\u7406\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 --help \u663e\u793a\u4f7f\u7528\u7387\u4fe1\u606f\u3002 --version \u663e\u793a\u811a\u672c\u7684\u7248\u672c\u53f7\u3002 \u793a\u4f8b: \u6267\u884c\u7b80\u5355\u7684\u6d4b\u8bd5\u8fd0\u884c\u800c\u4e0d\u5c06\u6570\u636e\u53d1\u5e03\u5230 CloudWatch $./mon-put-instance-data.pl --mem-util --verify --verbose MemoryUtilization: 2.12321017949643 (Percent) No credential methods are specified. Trying default IAM role. Using IAM role <ec2_mem_cw> Endpoint: https://monitoring.cn-northwest-1.amazonaws.com.cn Payload: {\"MetricData\":[{\"Timestamp\":1580913053,\"Dimensions\":[{\"Value\":\"i-0c98d995ecb670e50\",\"Name\":\"InstanceId\"}],\"Value\":2.12321017949643,\"Unit\":\"Percent\",\"MetricName\":\"MemoryUtilization\"}],\"Namespace\":\"System/Linux\",\"__type\":\"com.amazonaws.cloudwatch.v2010_08_01#PutMetricDataInput\"} Verification completed successfully. No actual metrics sent to CloudWatch. \u6536\u96c6\u6240\u6709\u53ef\u7528\u5185\u5b58\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 CloudWatch\uff0c\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u8ba1\u4e3a\u201c\u5df2\u7528\u201d $./mon-put-instance-data.pl --mem-used-incl-cache-buff --mem-util --mem-used --mem-avail \u6536\u96c6 Auto Scaling \u7ec4\u7684\u805a\u5408\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\uff0c\u4f46\u4e0d\u62a5\u544a\u5355\u72ec\u7684\u5b9e\u4f8b\u6307\u6807\u3002 $./mon-put-instance-data.pl --mem-util --mem-used --mem-avail --auto-scaling=only \u6536\u96c6\u5b9e\u4f8b\u7c7b\u578b\u3001AMI ID \u548c\u533a\u57df\u7684\u805a\u5408\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\uff0c\u4f46\u4e0d\u62a5\u544a\u5355\u72ec\u7684\u5b9e\u4f8b\u6307\u6807 $./mon-put-instance-data.pl --mem-util --mem-used --mem-avail --aggregated=only [\u91cd\u8981] \u4e3a\u62a5\u544aCloudWatch\u7684\u6307\u6807\u5236\u5b9a cron \u8ba1\u5212\uff1a\u8fd0\u884c crontab -e \u547d\u4ee4\u5f00\u59cb\u7f16\u8f91 crontab\uff0c\u6dfb\u52a0\u4e0b\u5217\u547d\u4ee4\u4fdd\u5b58\u5e76\u9000\u51fa\uff0c\u6bcf 5 \u5206\u949f\u5c06 \u5185\u5b58\u548c\u78c1\u76d8 \u7a7a\u95f4\u4f7f\u7528\u7387\u62a5\u544a\u5230 CloudWatch\uff1a */5 * * * * ~/aws-scripts-mon/mon-put-instance-data.pl --mem-used-incl-cache-buff --mem-util --disk-space-util --disk-path=/ --from-cron Usage: mon-get-instance-stats.pl , \u6b64\u811a\u672c\u53ef\u67e5\u8be2\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4 CloudWatch \u4e2d\u6709\u5173\u5185\u5b58\u3001\u4ea4\u6362\u548c\u78c1\u76d8\u7a7a\u95f4\u6307\u6807\u7684\u7edf\u8ba1\u6570\u636e\uff0c\u6bd4\u5982\u6d4b\u8bd5\u6d41\u7a0b\u8dd1\u5b8c\u4ee5\u540e\uff0c\u8fd0\u884c\u6b64\u811a\u672c\u67e5\u770b\u7ed3\u679c\u3002 \u540d\u79f0 \u63cf\u8ff0 --recent-hours=N \u6307\u5b9a\u62a5\u544a\u4f9d\u636e\u7684\u6700\u8fd1\u5c0f\u65f6\u6570\uff0c\u7531 N \u8868\u793a\uff0c\u5176\u4e2d N \u662f\u4e00\u4e2a\u6574\u6570\u3002 --aws-credential-file=PATH \u63d0\u4f9b\u5305\u542b AWS \u51ed\u8bc1\u7684\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002 --aws-access-key-id=VALUE \u6307\u5b9a\u7528\u4e8e\u8bc6\u522b\u53d1\u8d77\u4eba\u7684 AWS \u8bbf\u95ee\u5bc6\u94a5 ID\u3002\u5fc5\u987b\u4e0e --aws-secret-key \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002 --aws-secret-key=VALUE \u6307\u5b9a\u7528\u4e8e\u7b7e\u7f72 CloudWatch \u8bf7\u6c42\u7684 AWS \u79d8\u5bc6\u8bbf\u95ee\u5bc6\u94a5\u3002\u5fc5\u987b\u4e0e --aws-access-key-id \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002 --aws-iam-role=VALUE \u6307\u5b9a\u7528\u4e8e\u63d0\u4f9b AWS \u51ed\u8bc1\u7684 IAM \u89d2\u8272\u3002\u5fc5\u987b\u63d0\u4f9b =VALUE \u503c\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u51ed\u8bc1\uff0c\u5219\u4f1a\u5e94\u7528\u4e0e EC2 \u5b9e\u4f8b\u5173\u8054\u7684\u9ed8\u8ba4 IAM \u89d2\u8272\u3002\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a IAM \u89d2\u8272\u3002\u5982\u679c\u672a\u627e\u5230\u4efb\u4f55 IAM \u89d2\u8272\uff0c\u6216\u8005\u627e\u5230\u591a\u4e2a IAM \u89d2\u8272\uff0c\u5219\u811a\u672c\u4f1a\u8fd4\u56de\u4e00\u6761\u9519\u8bef\u4fe1\u606f\u3002\u8bf7\u52ff\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file\u3001--aws-access-key-id \u6216 --aws-secret-key \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --verify \u6267\u884c\u811a\u672c\u7684\u6d4b\u8bd5\u8fd0\u884c\u3002\u8be5\u9009\u9879\u8fd8\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u63d0\u4f9b\u51ed\u8bc1\u3002 --verbose \u663e\u793a\u811a\u672c\u6b63\u5728\u5904\u7406\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 --help \u663e\u793a\u4f7f\u7528\u7387\u4fe1\u606f\u3002 --version \u663e\u793a\u811a\u672c\u7684\u7248\u672c\u53f7\u3002 \u793a\u4f8b\uff1a \u8981\u83b7\u5f97\u6700\u8fd1 12 \u5c0f\u65f6\u7684\u4f7f\u7528\u7387\u7edf\u8ba1\u6570\u636e\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a $./mon-get-instance-stats.pl --recent-hours=12 Instance i-0098d895ecb678e80 statistics for the last 12 hours. CPU Utilization Average: 0.01%, Minimum: 0.00%, Maximum: 3.00% Memory Utilization Average: 7.41%, Minimum: 7.41%, Maximum: 7.42% Swap Utilization Average: N/A, Minimum: N/A, Maximum: N/A Disk Space Utilization for /dev/nvme0n1p1 mounted on / Average: 2.63%, Minimum: 2.63%, Maximum: 2.63% \u65e5\u65e5\u4e0d\u8f8d\uff0c\u65b9\u5f97\u59cb\u7ec8\u3002","title":"\u7528\u811a\u672c\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807"},{"location":"blogs/2020-02-05-monitor-ec2-mem/#ec2","text":"\u719f\u6089ec2\u754c\u9762\u7684\u540c\u5b66\u90fd\u77e5\u9053\uff0c\u9009\u4e2d\u67d0\u53f0ec2\uff0c\u4e0b\u9762\u6709\u4e2atab\u540d\u53ebmonitor\uff0c\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u6307\u6807\u5982cpu\uff0c\u78c1\u76d8\u8bfb\u5199\uff0c\u7f51\u7edc\u8fdb\u51fa\u7b49\uff0c\u4f46\u662f\u5374\u6ca1\u6709\u5185\u5b58\u5360\u7528\u76d1\u63a7\uff0c\u8fd9\u662f\u51fa\u4e8e\u5b89\u5168\u6027\u7684\u8003\u8651\uff0c\u6bd5\u7adf\u5185\u5b58\u4e2d\u53ef\u662f\u52a0\u8f7d\u7740\u6570\u636e\u7684\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u6211\u4eec\u4eb2\u81ea\u52a8\u624b\u5b9e\u73b0\u4e86\u3002 -- D.C \u5e94\u7528\u573a\u666f\uff1a\u5bf9\u4e8e\u521d\u6b21\u4f7f\u7528aws\u7684\u7ae5\u978b\u6765\u8bf4\uff0c\u5982\u679c\u6839\u636e\u624b\u5934\u7684\u5206\u6790\u6d41\u7a0b\u6765\u5224\u65ad\u6240\u9700\u7684\u8ba1\u7b97\u8d44\u6e90\uff0c\u4e5f\u8bb8\u662f\u4e00\u4e2a\u5934\u75bc\u7684\u4e8b\u60c5\u3002\u914d\u7f6e\u9009\u4f4e\u4e86\uff0c\u6d4b\u8bd5\u8dd1\u65ad\u6389\uff0c\u914d\u7f6e\u9009\u9ad8\u4e86\uff0c\u6d6a\u8d39\u591a\u4f59\u7684\u8ba1\u7b97\u8d44\u6e90\uff0c\u8d39\u94b1\uff01\u6240\u4ee5\u901a\u5e38\u7684\u505a\u6cd5\u662f\uff0c\u9009\u4e2a\u9002\u5f53\u504f\u5927\u7684\u914d\u7f6e\uff0c\u8dd1\u4e00\u904d\u6d41\u7a0b\uff0c\u518d\u56de\u5934\u770b\u6574\u4e2a\u5206\u6790\u8fc7\u7a0b\u4e2d\u7684CPU\u5360\u7528\u548c\u5185\u5b58\u5360\u7528\uff0c\u6765\u53cd\u63a8\u4e00\u4e2a\u5408\u9002\u7684\u914d\u7f6e\uff0c\u4f5c\u4e3a\u6211\u4eec\u4ee5\u540e\u5e38\u7528\u7684\u5206\u6790\u673a\u578b\u3002 \u90a3\u4e48cpu\u76d1\u63a7\u662f\u9ed8\u8ba4\u7684\uff0c\u6211\u5c31\u53ea\u8981\u5b9e\u73b0\u5185\u5b58\u76d1\u63a7\u4e86\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u603b\u7684\u76d1\u63a7\u6d41\uff1a \u521b\u5efaIAM Role - Role\u8d4b\u7ed9ec2- \u76d1\u63a7\u811a\u672c - \u65e5\u5fd7\u8f93\u51fa\u5230cloudwatch - \u67e5\u770b\u65e5\u5fd7","title":"\u7528\u811a\u672c\u76d1\u63a7EC2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807"},{"location":"blogs/2020-02-05-monitor-ec2-mem/#iam-role","text":"\u8fd9\u4e2aIAM\u89d2\u8272\u662f\u8981\u8d4b\u7ed9ec2\uff0c\u8ba9\u5b83\u6709\u6743\u9650\u628a\u76d1\u63a7\u4fe1\u606f\u7ed9\u5230CloudWatch\u3002 cloudwatch:PutMetricData cloudwatch:GetMetricStatistics cloudwatch:ListMetrics ec2:DescribeTags IAM\u63a7\u5236\u754c\u9762\u8fdb\u53bb\uff0c\u70b9\u51fb Policy \uff0c\u5982\u4e0b\u56fe\u65b0\u5efa\u4e00\u4e2apolicy\uff0c\u547d\u540d\u4e3a watch_ec2_mem \u3002 IAM\u63a7\u5236\u754c\u9762\u5de6\u4fa7\uff0c\u70b9\u51fb Role ,\u5982\u4e0b\u56fe\u65b0\u5efa\u4e00\u4e2a\u89d2\u8272\uff0c\u9009\u4e2d\u521a\u521a\u521b\u5efa\u7684\u7b56\u7565 watch_ec2_mem ,\u547d\u540d\u4e3a ec2_mem_cw \u3002 \u9009\u4e2dec2\u673a\u5668\uff0c\u70b9\u51fb Actions - Instance Settings - Attach/Replace IAM Role , \u9009\u4e2d\u4e0a\u4e00\u6b65\u65b0\u5efa\u7684Role\u9ec4\u9a6c\u7532\uff0c\u7ed9\u5b83\u7a7f\u4e0a\u3002","title":"\u521b\u5efaIAM Role"},{"location":"blogs/2020-02-05-monitor-ec2-mem/#ec2_1","text":"\u8fde\u63a5\u5230\u8981\u76d1\u63a7\u7684ec2\u4e0a\uff0c\u5b89\u88c5\u5fc5\u8981\u7684\u7a0b\u5e8f\u5305\uff1a Linux sudo yum install -y perl-Switch perl-DateTime perl-Sys-Syslog perl-LWP-Protocol-https perl-Digest-SHA.x86_64 Ubuntu sudo apt-get update sudo apt-get install unzip sudo apt-get install libwww-perl libdatetime-perl \u4e0b\u8f7d\u3001\u89e3\u538b\u7f29\u5e76\u914d\u7f6e CloudWatch \u76d1\u63a7\u811a\u672c\u3002 $ curl https://aws-cloudwatch.s3.amazonaws.com/downloads/CloudWatchMonitoringScripts-1.2.2.zip -O % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 24225 100 24225 0 0 12736 0 0:00:01 0:00:01 --:--:-- 12729 unzip CloudWatchMonitoringScripts-1.2.2.zip && \\ rm CloudWatchMonitoringScripts-1.2.2.zip && \\ cd aws-scripts-mon \u76d1\u63a7\u811a\u672c\u7684\u7a0b\u5e8f\u5305\u4e2d\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\uff1a CloudWatchClient.pm \u2013 \u5171\u4eab Perl \u6a21\u5757\uff0c\u4ee5\u7b80\u5316\u4ece\u5176\u4ed6\u811a\u672c\u8c03\u7528 Amazon CloudWatch \u7684\u8fc7\u7a0b\u3002 mon-put-instance-data.pl \u2013 \u6536\u96c6 Amazon EC2 \u5b9e\u4f8b\u4e2d\u7684\u7cfb\u7edf\u6307\u6807\uff08\u5185\u5b58\u3001\u4ea4\u6362\u3001\u78c1\u76d8\u7a7a\u95f4\u5229\u7528\u7387\uff09\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\u3002 mon-get-instance-stats.pl \u2013 \u67e5\u8be2 Amazon CloudWatch \u5e76\u663e\u793a\u5728\u5176\u4e0a\u6267\u884c\u6b64\u811a\u672c\u7684 EC2 \u5b9e\u4f8b\u7684\u6700\u8fd1\u5229\u7528\u7387\u7edf\u8ba1\u6570\u636e\u3002 awscreds.template \u2013 AWS \u51ed\u636e\u7684\u6587\u4ef6\u6a21\u677f\uff0c\u50a8\u5b58\u60a8\u7684\u8bbf\u95ee\u5bc6\u94a5 ID \u548c\u79c1\u6709\u8bbf\u95ee\u5bc6\u94a5\u3002 LICENSE.txt \u2013 \u5305\u542b Apache 2.0 \u8bb8\u53ef\u8bc1\u7684\u6587\u672c\u6587\u4ef6\u3002 NOTICE.txt \u2013 \u7248\u6743\u58f0\u660e\u3002","title":"ec2\u4e0a\u5b89\u88c5\u76d1\u63a7\u811a\u672c"},{"location":"blogs/2020-02-05-monitor-ec2-mem/#_1","text":"Usage: mon-put-instance-data.pl , \u6b64\u811a\u672c\u4f1a\u6536\u96c6\u5f53\u524d\u7cfb\u7edf\u7684\u5185\u5b58\u3001\u4ea4\u6362\u548c\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u7387\u6570\u636e\u3002\u7136\u540e\u8fdc\u7a0b\u8c03\u7528 Amazon CloudWatch\uff0c\u4ee5\u81ea\u5b9a\u4e49\u6307\u6807\u7684\u5f62\u5f0f\u62a5\u544a\u6536\u96c6\u5230\u7684\u6570\u636e\u3002 \u540d\u79f0 \u63cf\u8ff0 --mem-util \u4ee5\u767e\u5206\u6bd4\u6536\u96c6\u548c\u53d1\u9001 MemoryUtilization \u6307\u6807\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --mem-used \u6536\u96c6\u548c\u53d1\u9001 MemoryUsed \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --mem-used-incl-cache-buff \u5982\u679c\u5305\u62ec\u6b64\u9009\u9879\uff0c\u5219\u5728\u62a5\u544a --mem-util\u3001--mem-used \u548c --mem-avail \u7684\u6307\u6807\u65f6\uff0c\u5f53\u524d\u7528\u4e8e\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u7684\u5185\u5b58\u5c06\u8ba1\u4e3a\u201c\u5df2\u7528\u201d\u3002 --mem-avail \u6536\u96c6\u548c\u53d1\u9001 MemoryAvailable \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002\u6b64\u6307\u6807\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u548c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5982\u679c\u60a8\u6307\u5b9a --mem-used-incl-cache-buff \u9009\u9879\uff0c\u5219\u8fd8\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u5305\u62ec\u5728\u5df2\u7528\u5185\u5b58\u4e2d\u3002 --swap-util \u6536\u96c6\u548c\u53d1\u9001 SwapUtilization \u6307\u6807 (\u4ee5\u767e\u5206\u6bd4\u62a5\u544a)\u3002 --swap-used \u6536\u96c6\u548c\u53d1\u9001 SwapUsed \u6307\u6807 (\u4ee5\u5146\u5b57\u8282\u62a5\u544a)\u3002 --disk-path=PATH \u9009\u62e9\u8981\u62a5\u544a\u7684\u78c1\u76d8\u3002PATH \u53ef\u4ee5\u4e3a\u9700\u8981\u62a5\u544a\u7684\u6587\u4ef6\u7cfb\u7edf\u6307\u5b9a\u88c5\u5165\u70b9\u6216\u88c5\u5165\u70b9\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u3002\u5982\u9700\u9009\u62e9\u591a\u4e2a\u78c1\u76d8\uff0c\u8bf7\u4e3a\u6bcf\u4e2a\u78c1\u76d8\u5206\u522b\u6307\u5b9a --disk-path=PATH\u3002 \u8981\u4e3a\u88c5\u8f7d\u4e8e / \u548c /home \u4f4d\u7f6e\u7684\u6587\u4ef6\u7cfb\u7edf\u9009\u62e9\u78c1\u76d8\uff0c\u8bf7\u4f7f\u7528\u4e0b\u5217\u53c2\u6570\uff1a--disk-path=/ --disk-path=/home --disk-space-util \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceUtilization \u6307\u6807\u3002\u6307\u6807\u4ee5\u767e\u5206\u6bd4\u62a5\u544a\u3002\u8bf7\u6ce8\u610f\uff0c\u6b64\u811a\u672c\u8ba1\u7b97\u7684\u78c1\u76d8\u4f7f\u7528\u7387\u6307\u6807\u4e0e df -k -l \u547d\u4ee4\u8ba1\u7b97\u7684\u503c\u4e0d\u540c\u3002\u5982\u679c\u60a8\u8ba4\u4e3a df -k -l \u8ba1\u7b97\u7684\u503c\u66f4\u6709\u7528\uff0c\u5219\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u66f4\u6539\u8ba1\u7b97\u7ed3\u679c\u3002 --disk-space-used \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceUsed \u6307\u6807\u3002\u6307\u6807\u9ed8\u8ba4\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u53d7\u9650\u4e8e Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u4fdd\u7559\u78c1\u76d8\u7a7a\u95f4\uff0c\u5df2\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u53ef\u7528\u78c1\u76d8\u7a7a\u95f4\u53ef\u80fd\u65e0\u6cd5\u51c6\u786e\u76f8\u52a0\u5f97\u5230\u78c1\u76d8\u7a7a\u95f4\u603b\u91cf\u3002 --disk-space-avail \u6536\u96c6\u548c\u53d1\u9001\u9009\u5b9a\u78c1\u76d8\u7684 DiskSpaceAvailable \u6307\u6807\u3002\u6307\u6807\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u53d7\u9650\u4e8e Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u4fdd\u7559\u78c1\u76d8\u7a7a\u95f4\uff0c\u5df2\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u53ef\u7528\u78c1\u76d8\u7a7a\u95f4\u53ef\u80fd\u65e0\u6cd5\u51c6\u786e\u76f8\u52a0\u5f97\u5230\u78c1\u76d8\u7a7a\u95f4\u603b\u91cf\u3002 --memory-units=UNITS \u6307\u5b9a\u62a5\u544a\u5185\u5b58\u4f7f\u7528\u7387\u6240\u91c7\u7528\u7684\u5355\u4f4d\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u5185\u5b58\u4ee5\u5146\u5b57\u8282\u62a5\u544a\u3002\u5355\u4f4d\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e00\u79cd\uff1a\u5b57\u8282\u3001\u5343\u5b57\u8282\u3001\u5146\u5b57\u8282\u3001\u5343\u5146\u5b57\u8282\u3002 --disk-space-units=UNITS \u6307\u5b9a\u62a5\u544a\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u7387\u6240\u91c7\u7528\u7684\u5355\u4f4d\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u78c1\u76d8\u7a7a\u95f4\u4ee5\u5343\u5146\u5b57\u8282\u62a5\u544a\u3002\u5355\u4f4d\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e00\u79cd\uff1a\u5b57\u8282\u3001\u5343\u5b57\u8282\u3001\u5146\u5b57\u8282\u3001\u5343\u5146\u5b57\u8282\u3002 --aws-credential- file=PATH \u63d0\u4f9b\u5305\u542b AWS \u51ed\u8bc1\u7684\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u6b64\u53c2\u6570\u4e0d\u80fd\u4e0e --aws-access-key-id \u548c --aws-secret-key \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-access-key-id=VALUE \u6307\u5b9a\u7528\u4e8e\u8bc6\u522b\u53d1\u8d77\u4eba\u7684 AWS \u8bbf\u95ee\u5bc6\u94a5 ID\u3002\u5fc5\u987b\u4e0e --aws-secret-key \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-secret-key=VALUE \u6307\u5b9a\u7528\u4e8e\u7b7e\u7f72 CloudWatch \u8bf7\u6c42\u7684 AWS \u79d8\u5bc6\u8bbf\u95ee\u5bc6\u94a5\u3002\u5fc5\u987b\u4e0e --aws-access-key-id \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --aws-iam-role=VALUE \u6307\u5b9a\u7528\u4e8e\u63d0\u4f9b AWS \u51ed\u8bc1\u7684 IAM \u89d2\u8272\u3002\u5fc5\u987b\u63d0\u4f9b =VALUE \u503c\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u51ed\u8bc1\uff0c\u5219\u4f1a\u5e94\u7528\u4e0e EC2 \u5b9e\u4f8b\u5173\u8054\u7684\u9ed8\u8ba4 IAM \u89d2\u8272\u3002\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a IAM \u89d2\u8272\u3002\u5982\u679c\u672a\u627e\u5230\u4efb\u4f55 IAM \u89d2\u8272\uff0c\u6216\u8005\u627e\u5230\u591a\u4e2a IAM \u89d2\u8272\uff0c\u5219\u811a\u672c\u4f1a\u8fd4\u56de\u4e00\u6761\u9519\u8bef\u4fe1\u606f\u3002 --aggregated[=only] \u4e3a\u5b9e\u4f8b\u7c7b\u578b\u3001AMI ID \u53ca\u533a\u57df\u6574\u4f53\u60c5\u51b5\u6dfb\u52a0\u805a\u5408\u6307\u6570\u3002=only \u503c\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u811a\u672c\u53ea\u62a5\u544a\u805a\u5408\u6307\u6807\u3002 --auto-scaling[=only] \u4e3a Auto Scaling \u7ec4\u6dfb\u52a0\u805a\u5408\u6307\u6807\u3002=only \u503c\u4e3a\u53ef\u9009\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u811a\u672c\u53ea\u4f1a\u62a5\u544a Auto Scaling \u6307\u6807\u3002\u4f7f\u7528\u811a\u672c\u4e0e IAM \u8d26\u6237\u6216\u89d2\u8272\u5173\u8054\u7684 IAM \u7b56\u7565\u5fc5\u987b\u6709\u6743\u8c03\u7528 EC2 \u64cd\u4f5c DescribeTags\u3002 --verify \u4f1a\u5bf9\u6536\u96c6\u6307\u6807\u7684\u811a\u672c\u6267\u884c\u4e00\u6b21\u8bd5\u8fd0\u884c\uff0c\u51c6\u5907\u5b8c\u6574 HTTP \u8bf7\u6c42\uff0c\u4f46\u662f\u4e0d\u4f1a\u8c03\u7528 CloudWatch \u4ee5\u62a5\u544a\u6570\u636e\u3002\u8be5\u9009\u9879\u8fd8\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u63d0\u4f9b\u51ed\u8bc1\u3002\u5728\u8be6\u7ec6\u6a21\u5f0f\u4e2d\u8fd0\u884c\u65f6\uff0c\u8be5\u9009\u9879\u8f93\u51fa\u7684\u6307\u6807\u4f1a\u53d1\u9001\u5230 CloudWatch\u3002 --from-cron \u4ece cron \u8c03\u7528\u811a\u672c\u65f6\uff0c\u8bf7\u4f7f\u7528\u8be5\u9009\u9879\u3002\u4f7f\u7528\u8be5\u9009\u9879\u65f6\uff0c\u4f1a\u963b\u6b62\u6240\u6709\u8bca\u65ad\u8f93\u51fa\uff0c\u4f46\u9519\u8bef\u6d88\u606f\u4f1a\u53d1\u9001\u5230\u7528\u6237\u8d26\u6237\u7684\u672c\u5730\u7cfb\u7edf\u65e5\u5fd7\u3002 --verbose \u663e\u793a\u811a\u672c\u6b63\u5728\u5904\u7406\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 --help \u663e\u793a\u4f7f\u7528\u7387\u4fe1\u606f\u3002 --version \u663e\u793a\u811a\u672c\u7684\u7248\u672c\u53f7\u3002 \u793a\u4f8b: \u6267\u884c\u7b80\u5355\u7684\u6d4b\u8bd5\u8fd0\u884c\u800c\u4e0d\u5c06\u6570\u636e\u53d1\u5e03\u5230 CloudWatch $./mon-put-instance-data.pl --mem-util --verify --verbose MemoryUtilization: 2.12321017949643 (Percent) No credential methods are specified. Trying default IAM role. Using IAM role <ec2_mem_cw> Endpoint: https://monitoring.cn-northwest-1.amazonaws.com.cn Payload: {\"MetricData\":[{\"Timestamp\":1580913053,\"Dimensions\":[{\"Value\":\"i-0c98d995ecb670e50\",\"Name\":\"InstanceId\"}],\"Value\":2.12321017949643,\"Unit\":\"Percent\",\"MetricName\":\"MemoryUtilization\"}],\"Namespace\":\"System/Linux\",\"__type\":\"com.amazonaws.cloudwatch.v2010_08_01#PutMetricDataInput\"} Verification completed successfully. No actual metrics sent to CloudWatch. \u6536\u96c6\u6240\u6709\u53ef\u7528\u5185\u5b58\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 CloudWatch\uff0c\u5c06\u7f13\u5b58\u548c\u7f13\u51b2\u533a\u5185\u5b58\u8ba1\u4e3a\u201c\u5df2\u7528\u201d $./mon-put-instance-data.pl --mem-used-incl-cache-buff --mem-util --mem-used --mem-avail \u6536\u96c6 Auto Scaling \u7ec4\u7684\u805a\u5408\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\uff0c\u4f46\u4e0d\u62a5\u544a\u5355\u72ec\u7684\u5b9e\u4f8b\u6307\u6807\u3002 $./mon-put-instance-data.pl --mem-util --mem-used --mem-avail --auto-scaling=only \u6536\u96c6\u5b9e\u4f8b\u7c7b\u578b\u3001AMI ID \u548c\u533a\u57df\u7684\u805a\u5408\u6307\u6807\u5e76\u5c06\u5176\u53d1\u9001\u5230 Amazon CloudWatch\uff0c\u4f46\u4e0d\u62a5\u544a\u5355\u72ec\u7684\u5b9e\u4f8b\u6307\u6807 $./mon-put-instance-data.pl --mem-util --mem-used --mem-avail --aggregated=only [\u91cd\u8981] \u4e3a\u62a5\u544aCloudWatch\u7684\u6307\u6807\u5236\u5b9a cron \u8ba1\u5212\uff1a\u8fd0\u884c crontab -e \u547d\u4ee4\u5f00\u59cb\u7f16\u8f91 crontab\uff0c\u6dfb\u52a0\u4e0b\u5217\u547d\u4ee4\u4fdd\u5b58\u5e76\u9000\u51fa\uff0c\u6bcf 5 \u5206\u949f\u5c06 \u5185\u5b58\u548c\u78c1\u76d8 \u7a7a\u95f4\u4f7f\u7528\u7387\u62a5\u544a\u5230 CloudWatch\uff1a */5 * * * * ~/aws-scripts-mon/mon-put-instance-data.pl --mem-used-incl-cache-buff --mem-util --disk-space-util --disk-path=/ --from-cron Usage: mon-get-instance-stats.pl , \u6b64\u811a\u672c\u53ef\u67e5\u8be2\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4 CloudWatch \u4e2d\u6709\u5173\u5185\u5b58\u3001\u4ea4\u6362\u548c\u78c1\u76d8\u7a7a\u95f4\u6307\u6807\u7684\u7edf\u8ba1\u6570\u636e\uff0c\u6bd4\u5982\u6d4b\u8bd5\u6d41\u7a0b\u8dd1\u5b8c\u4ee5\u540e\uff0c\u8fd0\u884c\u6b64\u811a\u672c\u67e5\u770b\u7ed3\u679c\u3002 \u540d\u79f0 \u63cf\u8ff0 --recent-hours=N \u6307\u5b9a\u62a5\u544a\u4f9d\u636e\u7684\u6700\u8fd1\u5c0f\u65f6\u6570\uff0c\u7531 N \u8868\u793a\uff0c\u5176\u4e2d N \u662f\u4e00\u4e2a\u6574\u6570\u3002 --aws-credential-file=PATH \u63d0\u4f9b\u5305\u542b AWS \u51ed\u8bc1\u7684\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002 --aws-access-key-id=VALUE \u6307\u5b9a\u7528\u4e8e\u8bc6\u522b\u53d1\u8d77\u4eba\u7684 AWS \u8bbf\u95ee\u5bc6\u94a5 ID\u3002\u5fc5\u987b\u4e0e --aws-secret-key \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002 --aws-secret-key=VALUE \u6307\u5b9a\u7528\u4e8e\u7b7e\u7f72 CloudWatch \u8bf7\u6c42\u7684 AWS \u79d8\u5bc6\u8bbf\u95ee\u5bc6\u94a5\u3002\u5fc5\u987b\u4e0e --aws-access-key-id \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\u4e0d\u8981\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file \u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002 --aws-iam-role=VALUE \u6307\u5b9a\u7528\u4e8e\u63d0\u4f9b AWS \u51ed\u8bc1\u7684 IAM \u89d2\u8272\u3002\u5fc5\u987b\u63d0\u4f9b =VALUE \u503c\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u51ed\u8bc1\uff0c\u5219\u4f1a\u5e94\u7528\u4e0e EC2 \u5b9e\u4f8b\u5173\u8054\u7684\u9ed8\u8ba4 IAM \u89d2\u8272\u3002\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a IAM \u89d2\u8272\u3002\u5982\u679c\u672a\u627e\u5230\u4efb\u4f55 IAM \u89d2\u8272\uff0c\u6216\u8005\u627e\u5230\u591a\u4e2a IAM \u89d2\u8272\uff0c\u5219\u811a\u672c\u4f1a\u8fd4\u56de\u4e00\u6761\u9519\u8bef\u4fe1\u606f\u3002\u8bf7\u52ff\u5c06\u8be5\u9009\u9879\u4e0e --aws-credential-file\u3001--aws-access-key-id \u6216 --aws-secret-key \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\u3002 --verify \u6267\u884c\u811a\u672c\u7684\u6d4b\u8bd5\u8fd0\u884c\u3002\u8be5\u9009\u9879\u8fd8\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u63d0\u4f9b\u51ed\u8bc1\u3002 --verbose \u663e\u793a\u811a\u672c\u6b63\u5728\u5904\u7406\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 --help \u663e\u793a\u4f7f\u7528\u7387\u4fe1\u606f\u3002 --version \u663e\u793a\u811a\u672c\u7684\u7248\u672c\u53f7\u3002 \u793a\u4f8b\uff1a \u8981\u83b7\u5f97\u6700\u8fd1 12 \u5c0f\u65f6\u7684\u4f7f\u7528\u7387\u7edf\u8ba1\u6570\u636e\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a $./mon-get-instance-stats.pl --recent-hours=12 Instance i-0098d895ecb678e80 statistics for the last 12 hours. CPU Utilization Average: 0.01%, Minimum: 0.00%, Maximum: 3.00% Memory Utilization Average: 7.41%, Minimum: 7.41%, Maximum: 7.42% Swap Utilization Average: N/A, Minimum: N/A, Maximum: N/A Disk Space Utilization for /dev/nvme0n1p1 mounted on / Average: 2.63%, Minimum: 2.63%, Maximum: 2.63% \u65e5\u65e5\u4e0d\u8f8d\uff0c\u65b9\u5f97\u59cb\u7ec8\u3002","title":"\u8fd0\u884c\u76d1\u63a7\u811a\u672c"},{"location":"blogs/2020-02-06-cwagent-monitor-ec2-mem/","text":"[\u63a8\u8350] \u7528CW\u4ee3\u7406\u76d1\u63a7ec2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807 \u4e0a\u4e00\u7bc7\u4ecb\u7ecd\u4e86\u5982\u4f55\u5728ec2\u4e0a\u4e0b\u8f7d\u811a\u672c\uff0c\u901a\u8fc7\u8fd0\u884c\u4e24\u4e2aperl\u6587\u4ef6\u6765\u76d1\u63a7\u7279\u5b9aec2\u7684\u5185\u5b58\u5360\u7528\u60c5\u51b5\uff0c\u4eca\u5929\u548c\u5927\u5bb6\u4e00\u8d77\u5b66\u4e60\u4e0b\u5982\u4f55\u7528\u5b98\u65b9\u63a8\u8350\u7684\u65b9\u5f0f-\u5b89\u88c5cloudwatch\u4ee3\u7406\uff08\u4ee5\u4e0b\u7b80\u79f0CW\uff09\u6765\u5b9e\u73b0\u5bf9 ec2 \u5185\u5b58\u548c\u78c1\u76d8\u5360\u7528\u7684\u76d1(\u7aa5)\u63a7(\u63a2)\u3002 -- D.C \u8001\u89c4\u77e9:\u7ed9EC2\u521b\u5efaIAM Role \u8fdb\u5165IAM\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 Roles , \u518d\u70b9\u51fb\u53f3\u4fa7\u7a97\u53e3\u7684 Create role , use case \u9009\u62e9 EC2 , \u70b9\u51fb Next:Permissions , \u641c\u7d22\u5e76\u9009\u4e2d CloudWatchAgentServerPolicy , \u4e00\u8def\u70b9\u4e0b\u4e00\u6b65\uff0c\u547d\u540d\u4e3a CloudWatchAgentServerRole \u3002 \u9009\u4e2d\u5bf9\u5e94\u7684EC2\uff0c\u70b9\u51fb Actions - Instance Settings - Attach/Replace IAM Role , \u9009\u62e9 CloudWatchAgentServerRole \uff0c\u70b9\u51fb Apply \u3002 \u8fd9\u91cc\u63d0\u4e00\u53e5\uff1a\u5982\u679c\u6211\u4eec\u539f\u672c\u7528iam role\u6765\u63a7\u5236ec2\u5bf9s3\u7684\u8bbf\u95ee\uff0c\u4e14\u6ca1\u6709\u5728ec2\u4e0a\u8bbe\u7f6eAKSK\u4fe1\u606f\uff0c\u90a3\u4e48\u66ff\u6362\u6389role\u4e4b\u540e\uff0cec2\u8bbf\u95ees3\u5c31\u4f1a\u6709\u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u65b9\u68481. \u5728\u89d2\u8272 CloudWatchAgentServerRole \u4e0a\u518d\u52a0attach\u4e00\u6761Policy\u5982 AmazonS3ReadOnlyAccess \u6216 AmazonS3FullAccess \u5c31\u53ef\u4ee5\u4e86\u3002 \u65b9\u68482. \u5728ec2\u4e0a\u8bbe\u7f6e aws configure \u7684\u5168\u90e8\u4fe1\u606f\uff08\u5305\u62ecAKSK\u4fe1\u606f\uff0c\u4e0d\u63a8\u8350\uff09\u3002 \u767b\u5f55ec2\u5b89\u88c5CW\u4ee3\u7406 \u767b\u5f55ec2\uff0c\u4e0b\u8f7dCW\u4ee3\u7406\u5305(57M)\u3002 Linux: wget https://s3.amazonaws.com/amazoncloudwatch-agent/amazon_linux/amd64/latest/amazon-cloudwatch-agent.rpm \u5982\u679c\u4e0b\u8f7d\u901f\u5ea6\u592a\u6162\u53ef\u4ee5wget\u8fd9\u4e2a\u94fe\u63a5\uff1a https://publicuse.s3.cn-northwest-1.amazonaws.com.cn/amazon-cloudwatch-agent.rpm \u6216\u8005 Baidu\u4e91\u76d8 \u4e0b\u8f7d\u518d\u4e0a\u4f20\u5230ec2\u3002 \u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7406\u94fe\u63a5\uff1a Centos: https://s3.amazonaws.com/amazoncloudwatch-agent/centos/amd64/latest/amazon-cloudwatch-agent.rpm Ubuntu: https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb \u5b89\u88c5\u4ee3\u7406\u5305\u5e76\u8fd0\u884c\u76d1\u63a7\u547d\u4ee4\uff0c\u53ea\u8981\u6ca1\u6709error\u5c31\u6210\u3002 $ sudo rpm -U ./amazon-cloudwatch-agent.rpm $ sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -s /opt/aws/amazon-cloudwatch-agent/bin/config-downloader --output-dir /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d --download-source default --mode ec2 --config /opt/aws/amazon-cloudwatch-agent/etc/common-config.toml --multi-config default Successfully fetched the config and saved in /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d/default.tmp Start configuration validation... /opt/aws/amazon-cloudwatch-agent/bin/config-translator --input /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json --input-dir /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d --output /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.toml --mode ec2 --config /opt/aws/amazon-cloudwatch-agent/etc/common-config.toml --multi-config default 2020/02/06 08:16:03 Reading json config file path: /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d/default.tmp ... Valid Json input schema. I! Detecting runasuser... No csm configuration found. No log configuration found. Configuration validation first phase succeeded /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent -schematest -config /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.toml Configuration validation second phase succeeded Configuration validation succeeded Created symlink from /etc/systemd/system/multi-user.target.wants/amazon-cloudwatch-agent.service to /etc/systemd/system/amazon-cloudwatch-agent.service. Redirecting to /bin/systemctl restart amazon-cloudwatch-agent.service \u5173\u4e8eamazon-cloudwatch-agent-ctl\u811a\u672c\u4f7f\u7528\u8bf4\u660e\uff1a usage: amazon-cloudwatch-agent-ctl -a stop|start|status|fetch-config|append-config|remove-config [-m ec2|onPremise|auto] [-c default|ssm:<parameter-store-name>|file:<file-path>] [-s] e.g. 1. apply a SSM parameter store config on EC2 instance and restart the agent afterwards: amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -c ssm:AmazonCloudWatch-Config.json -s 2. append a local json config file on onPremise host and restart the agent afterwards: amazon-cloudwatch-agent-ctl -a append-config -m onPremise -c file:/tmp/config.json -s 3. query agent status: amazon-cloudwatch-agent-ctl -a status -a: action stop: stop the agent process. start: start the agent process. status: get the status of the agent process. fetch-config: use this json config as the agent's only configuration. append-config: append json config with the existing json configs if any. remove-config: remove json config based on the location (ssm parameter store name, file name) -m: mode ec2: indicate this is on ec2 host. onPremise: indicate this is on onPremise host. auto: use ec2 metadata to determine the environment, may not be accurate if ec2 metadata is not available for some reason on EC2. -c: configuration default: default configuration for quick trial. ssm:<parameter-store-name>: ssm parameter store name file:<file-path>: file path on the host -s: optionally restart after configuring the agent configuration this parameter is used for 'fetch-config', 'append-config', 'remove-config' action only. vim\u65b0\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7684bash\u811a\u672c testmem.sh \uff0c\u6d88\u80171g\u5185\u5b581\u4e2a\u5c0f\u65f6\uff0c\u540e\u9762\u4f1a\u7528\u5230\u3002 \u6d4b\u8bd5\u5185\u5b58\u5c0f\u811a\u672c\uff1a #!/bin/bash mkdir /tmp/memory mount -t tmpfs -o size=1024M tmpfs /tmp/memory dd if=/dev/zero of=/tmp/memory/block sleep 3600 rm /tmp/memory/block umount /tmp/memory rmdir /tmp/memory \u8fdb\u5165CW\u67e5\u770b\u76d1\u63a7 \u5728aws\u4e3b\u9875\u9762\u4e0a\u65b9\u7684 Service \u7684\u641c\u7d22\u6846\u5185\u641c CloudWatch \uff0c\u8fdb\u5230CW\u754c\u9762\u4ee5\u540e\u70b9\u51fb\u5de6\u4fa7\u7684 Metrics \u3002 [\u9009\u98791] \u53ef\u4ee5\u770b\u5230\u53f3\u4fa7\u754c\u9762\u51fa\u73b0\u4e86 CWAgent \uff0c\u70b9\u51fb\u8fdb\u53bb\u540e\uff0c\u9009\u62e9\u62e9 ImageId,InstanceId, InstanceTypeGraph search \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u5185\u5b58\u7684ec2\u5217\u8868\u3002\u9009\u62e9 ImageId, InstanceId, InstanceType, device, fstype, path \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u78c1\u76d8\u7684ec2\u5217\u8868\u3002 [\u9009\u98792] \u5c06\u6211\u4eec\u8981\u76d1\u63a7\u7684 ec2 \u7684 id \u8f93\u5165\u5230\u641c\u7d22\u6846\uff0c\u56de\u8f66\uff0c\u4e5f\u80fd\u5feb\u901f\u627e\u5230\u548c\u8fd9\u53f0\u673a\u5668\u6709\u5173\u7684\u76d1\u63a7\u6307\u6807\uff0c\u70b9\u51fb CWAgent > ImageId, InstanceId, InstanceType ,\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u5185\u5b58\u7684ec2\u5217\u8868\u3002\u9009\u62e9 CWAgent >ImageId, InstanceId, InstanceType, device, fstype, path \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u78c1\u76d8\u7684ec2\u5217\u8868\u3002 \u9009\u4e2d\u5bf9\u5e94\u7684ec2\uff0c\u6211\u4eec\u5c31\u80fd\u4ece\u4e0a\u9762\u7684\u56fe\u4e2d\u770b\u5230\u5185\u5b58/\u78c1\u76d8\u76d1\u63a7\u7684\u52a8\u6001\u66f2\u7ebf\u4e86\u3002 \u8fd9\u4e2a\u65f6\u5019\u56de\u5230ec2\uff0c\u8fd0\u884c\u6d4b\u8bd5\u811a\u672c testmem.sh ,\u518d\u56de\u5230 CW \u67e5\u770b\u5185\u5b58\u76d1\u63a7\u7684\u53d8\u5316\u3002 $ sudo bash testmem.sh & [1] 3337 2097153+0 records in 2097152+0 records out 1073741824 bytes (1.1 GB) copied, 2.78481 s, 386 MB/s \u575a\u6301\u5f88\u91cd\u8981\uff0c\u82e5\u975e\u4e0d\u5f97\u5df2\uff0c\u4e0d\u8981\u653e\u5f03\uff01","title":"[\u63a8\u8350] \u7528CW\u4ee3\u7406\u76d1\u63a7ec2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807"},{"location":"blogs/2020-02-06-cwagent-monitor-ec2-mem/#cwec2","text":"\u4e0a\u4e00\u7bc7\u4ecb\u7ecd\u4e86\u5982\u4f55\u5728ec2\u4e0a\u4e0b\u8f7d\u811a\u672c\uff0c\u901a\u8fc7\u8fd0\u884c\u4e24\u4e2aperl\u6587\u4ef6\u6765\u76d1\u63a7\u7279\u5b9aec2\u7684\u5185\u5b58\u5360\u7528\u60c5\u51b5\uff0c\u4eca\u5929\u548c\u5927\u5bb6\u4e00\u8d77\u5b66\u4e60\u4e0b\u5982\u4f55\u7528\u5b98\u65b9\u63a8\u8350\u7684\u65b9\u5f0f-\u5b89\u88c5cloudwatch\u4ee3\u7406\uff08\u4ee5\u4e0b\u7b80\u79f0CW\uff09\u6765\u5b9e\u73b0\u5bf9 ec2 \u5185\u5b58\u548c\u78c1\u76d8\u5360\u7528\u7684\u76d1(\u7aa5)\u63a7(\u63a2)\u3002 -- D.C","title":"[\u63a8\u8350] \u7528CW\u4ee3\u7406\u76d1\u63a7ec2\u7684\u5185\u5b58\u548c\u78c1\u76d8\u6307\u6807"},{"location":"blogs/2020-02-06-cwagent-monitor-ec2-mem/#ec2iam-role","text":"\u8fdb\u5165IAM\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 Roles , \u518d\u70b9\u51fb\u53f3\u4fa7\u7a97\u53e3\u7684 Create role , use case \u9009\u62e9 EC2 , \u70b9\u51fb Next:Permissions , \u641c\u7d22\u5e76\u9009\u4e2d CloudWatchAgentServerPolicy , \u4e00\u8def\u70b9\u4e0b\u4e00\u6b65\uff0c\u547d\u540d\u4e3a CloudWatchAgentServerRole \u3002 \u9009\u4e2d\u5bf9\u5e94\u7684EC2\uff0c\u70b9\u51fb Actions - Instance Settings - Attach/Replace IAM Role , \u9009\u62e9 CloudWatchAgentServerRole \uff0c\u70b9\u51fb Apply \u3002 \u8fd9\u91cc\u63d0\u4e00\u53e5\uff1a\u5982\u679c\u6211\u4eec\u539f\u672c\u7528iam role\u6765\u63a7\u5236ec2\u5bf9s3\u7684\u8bbf\u95ee\uff0c\u4e14\u6ca1\u6709\u5728ec2\u4e0a\u8bbe\u7f6eAKSK\u4fe1\u606f\uff0c\u90a3\u4e48\u66ff\u6362\u6389role\u4e4b\u540e\uff0cec2\u8bbf\u95ees3\u5c31\u4f1a\u6709\u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u65b9\u68481. \u5728\u89d2\u8272 CloudWatchAgentServerRole \u4e0a\u518d\u52a0attach\u4e00\u6761Policy\u5982 AmazonS3ReadOnlyAccess \u6216 AmazonS3FullAccess \u5c31\u53ef\u4ee5\u4e86\u3002 \u65b9\u68482. \u5728ec2\u4e0a\u8bbe\u7f6e aws configure \u7684\u5168\u90e8\u4fe1\u606f\uff08\u5305\u62ecAKSK\u4fe1\u606f\uff0c\u4e0d\u63a8\u8350\uff09\u3002","title":"\u8001\u89c4\u77e9:\u7ed9EC2\u521b\u5efaIAM Role"},{"location":"blogs/2020-02-06-cwagent-monitor-ec2-mem/#ec2cw","text":"\u767b\u5f55ec2\uff0c\u4e0b\u8f7dCW\u4ee3\u7406\u5305(57M)\u3002 Linux: wget https://s3.amazonaws.com/amazoncloudwatch-agent/amazon_linux/amd64/latest/amazon-cloudwatch-agent.rpm \u5982\u679c\u4e0b\u8f7d\u901f\u5ea6\u592a\u6162\u53ef\u4ee5wget\u8fd9\u4e2a\u94fe\u63a5\uff1a https://publicuse.s3.cn-northwest-1.amazonaws.com.cn/amazon-cloudwatch-agent.rpm \u6216\u8005 Baidu\u4e91\u76d8 \u4e0b\u8f7d\u518d\u4e0a\u4f20\u5230ec2\u3002 \u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7406\u94fe\u63a5\uff1a Centos: https://s3.amazonaws.com/amazoncloudwatch-agent/centos/amd64/latest/amazon-cloudwatch-agent.rpm Ubuntu: https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb \u5b89\u88c5\u4ee3\u7406\u5305\u5e76\u8fd0\u884c\u76d1\u63a7\u547d\u4ee4\uff0c\u53ea\u8981\u6ca1\u6709error\u5c31\u6210\u3002 $ sudo rpm -U ./amazon-cloudwatch-agent.rpm $ sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -s /opt/aws/amazon-cloudwatch-agent/bin/config-downloader --output-dir /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d --download-source default --mode ec2 --config /opt/aws/amazon-cloudwatch-agent/etc/common-config.toml --multi-config default Successfully fetched the config and saved in /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d/default.tmp Start configuration validation... /opt/aws/amazon-cloudwatch-agent/bin/config-translator --input /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json --input-dir /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d --output /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.toml --mode ec2 --config /opt/aws/amazon-cloudwatch-agent/etc/common-config.toml --multi-config default 2020/02/06 08:16:03 Reading json config file path: /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.d/default.tmp ... Valid Json input schema. I! Detecting runasuser... No csm configuration found. No log configuration found. Configuration validation first phase succeeded /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent -schematest -config /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.toml Configuration validation second phase succeeded Configuration validation succeeded Created symlink from /etc/systemd/system/multi-user.target.wants/amazon-cloudwatch-agent.service to /etc/systemd/system/amazon-cloudwatch-agent.service. Redirecting to /bin/systemctl restart amazon-cloudwatch-agent.service \u5173\u4e8eamazon-cloudwatch-agent-ctl\u811a\u672c\u4f7f\u7528\u8bf4\u660e\uff1a usage: amazon-cloudwatch-agent-ctl -a stop|start|status|fetch-config|append-config|remove-config [-m ec2|onPremise|auto] [-c default|ssm:<parameter-store-name>|file:<file-path>] [-s] e.g. 1. apply a SSM parameter store config on EC2 instance and restart the agent afterwards: amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -c ssm:AmazonCloudWatch-Config.json -s 2. append a local json config file on onPremise host and restart the agent afterwards: amazon-cloudwatch-agent-ctl -a append-config -m onPremise -c file:/tmp/config.json -s 3. query agent status: amazon-cloudwatch-agent-ctl -a status -a: action stop: stop the agent process. start: start the agent process. status: get the status of the agent process. fetch-config: use this json config as the agent's only configuration. append-config: append json config with the existing json configs if any. remove-config: remove json config based on the location (ssm parameter store name, file name) -m: mode ec2: indicate this is on ec2 host. onPremise: indicate this is on onPremise host. auto: use ec2 metadata to determine the environment, may not be accurate if ec2 metadata is not available for some reason on EC2. -c: configuration default: default configuration for quick trial. ssm:<parameter-store-name>: ssm parameter store name file:<file-path>: file path on the host -s: optionally restart after configuring the agent configuration this parameter is used for 'fetch-config', 'append-config', 'remove-config' action only. vim\u65b0\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7684bash\u811a\u672c testmem.sh \uff0c\u6d88\u80171g\u5185\u5b581\u4e2a\u5c0f\u65f6\uff0c\u540e\u9762\u4f1a\u7528\u5230\u3002 \u6d4b\u8bd5\u5185\u5b58\u5c0f\u811a\u672c\uff1a #!/bin/bash mkdir /tmp/memory mount -t tmpfs -o size=1024M tmpfs /tmp/memory dd if=/dev/zero of=/tmp/memory/block sleep 3600 rm /tmp/memory/block umount /tmp/memory rmdir /tmp/memory","title":"\u767b\u5f55ec2\u5b89\u88c5CW\u4ee3\u7406"},{"location":"blogs/2020-02-06-cwagent-monitor-ec2-mem/#cw","text":"\u5728aws\u4e3b\u9875\u9762\u4e0a\u65b9\u7684 Service \u7684\u641c\u7d22\u6846\u5185\u641c CloudWatch \uff0c\u8fdb\u5230CW\u754c\u9762\u4ee5\u540e\u70b9\u51fb\u5de6\u4fa7\u7684 Metrics \u3002 [\u9009\u98791] \u53ef\u4ee5\u770b\u5230\u53f3\u4fa7\u754c\u9762\u51fa\u73b0\u4e86 CWAgent \uff0c\u70b9\u51fb\u8fdb\u53bb\u540e\uff0c\u9009\u62e9\u62e9 ImageId,InstanceId, InstanceTypeGraph search \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u5185\u5b58\u7684ec2\u5217\u8868\u3002\u9009\u62e9 ImageId, InstanceId, InstanceType, device, fstype, path \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u78c1\u76d8\u7684ec2\u5217\u8868\u3002 [\u9009\u98792] \u5c06\u6211\u4eec\u8981\u76d1\u63a7\u7684 ec2 \u7684 id \u8f93\u5165\u5230\u641c\u7d22\u6846\uff0c\u56de\u8f66\uff0c\u4e5f\u80fd\u5feb\u901f\u627e\u5230\u548c\u8fd9\u53f0\u673a\u5668\u6709\u5173\u7684\u76d1\u63a7\u6307\u6807\uff0c\u70b9\u51fb CWAgent > ImageId, InstanceId, InstanceType ,\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u5185\u5b58\u7684ec2\u5217\u8868\u3002\u9009\u62e9 CWAgent >ImageId, InstanceId, InstanceType, device, fstype, path \uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u78c1\u76d8\u7684ec2\u5217\u8868\u3002 \u9009\u4e2d\u5bf9\u5e94\u7684ec2\uff0c\u6211\u4eec\u5c31\u80fd\u4ece\u4e0a\u9762\u7684\u56fe\u4e2d\u770b\u5230\u5185\u5b58/\u78c1\u76d8\u76d1\u63a7\u7684\u52a8\u6001\u66f2\u7ebf\u4e86\u3002 \u8fd9\u4e2a\u65f6\u5019\u56de\u5230ec2\uff0c\u8fd0\u884c\u6d4b\u8bd5\u811a\u672c testmem.sh ,\u518d\u56de\u5230 CW \u67e5\u770b\u5185\u5b58\u76d1\u63a7\u7684\u53d8\u5316\u3002 $ sudo bash testmem.sh & [1] 3337 2097153+0 records in 2097152+0 records out 1073741824 bytes (1.1 GB) copied, 2.78481 s, 386 MB/s \u575a\u6301\u5f88\u91cd\u8981\uff0c\u82e5\u975e\u4e0d\u5f97\u5df2\uff0c\u4e0d\u8981\u653e\u5f03\uff01","title":"\u8fdb\u5165CW\u67e5\u770b\u76d1\u63a7"},{"location":"blogs/2020-02-09-aws-public-dataset/","text":"\u798f\u97f3\uff01\u7528\u597dAWS\u516c\u5f00\u6570\u636e\u96c6 aws \u63d0\u4f9b\u4e86\u4e00\u4e2as3\u5b58\u50a8\u7a7a\u95f4\uff0c\u7ed9\u90a3\u4e9b\u5f00\u653e\u516c\u5171\u4e0b\u8f7d\u7684\u8d44\u6e90\uff0c\u5e76\u4e14\u5b58\u50a8\u8d39\u7528\u662f\u514d\u8d39\u7684\uff01\u6bd4\u5982\u6211\u4eec\u751f\u4fe1\u5e38\u7528\u7684NCBI SRA\uff0cENCODE, 1000g\uff0cNIH\u7684\u4eba\u7c7b\u5fae\u751f\u7269\u7ec4\u8ba1\u5212\u6570\u636e\uff0cnanopore reference, \u6c34\u7a3b\u57fa\u56e0\u7ec43000 Rice Genomics, TCGA,ICGC\u6570\u636e\u7b49\uff0c\u6709\u4e86\u8fd9\u4e9b\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u6ca1\u9519\uff0c\u5982\u679c\u6211\u662f\u4e00\u540daws\u7528\u6237\uff0c\u6211\u5c31\u4e0d\u9700\u8981\u518d\u53bb\u4e0b\u8f7d\u6570\u636e\u5566\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u7f51\u901f\u90a3\u4e2a\u6162\u5450~ \u6211\u53ea\u9700\u8981\u77e5\u9053\u6570\u636e\u6240\u5728\u7684aws\u7684\u4f4d\u7f6e\uff0c\u901a\u8fc7aws\u5185\u7f51\u628a\u60f3\u8981\u7684\u6570\u636e\u76f4\u63a5\u62c9\u5230\u6211\u8981\u505a\u5206\u6790\u7684\u673a\u5668\u4e0a\u5c31\u53ef\u4ee5\uff0c\u901f\u5ea6\u98de\u8d77\uff01 --- D.C AWS public dataset \u4ec0\u4e48\u662f\u516c\u5f00\u6570\u636e\u96c6 \u573a\u666f\uff1a\u5728\u505a\u6570\u636e\u5206\u6790\u65f6\uff0c\u4e00\u4e2a\u56f0\u96be\u662f\u6d77\u91cf\u7684\u6570\u636e\u672c\u5730\u5b58\u50a8\u56f0\u96be\uff0c\u800c\u4e14\u4e0b\u8f7d\u8017\u8d39\u7684\u65f6\u95f4\u6781\u957f\u3002\u4f8b\u59821T\u6570\u636e\uff0c\u5982\u679c\u4e0b\u8f7d\u7f51\u901f\u662f3MBps\uff08\u76ee\u524d\u4e2d\u56fd\u7684\u5e73\u5747\u5bbd\u5e26\u901f\u5ea6\uff09\uff0c\u90a3\u89814\u5929\u624d\u80fd\u4e0b\u8f7d\u5b8c\u3002\u6709\u4e9b\u6570\u636e\u96c6\u6709\u51e0\u5341T\uff0c\u90a3\u5149\u4e0b\u8f7d\u5c31\u8981\u51e0\u4e2a\u6708\u3002 AWS\u4e91\u670d\u52a1\u5e73\u53f0\u4e0a\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u56f0\u96be\u63d0\u4f9b\u4e86\u5f88\u591a\u5e38\u7528\u7684\u5927\u89c4\u6a21\u6570\u636e\u96c6 Public Data Sets https://aws.amazon.com/datasets \uff0c\u65e0\u9700\u4e0b\u8f7d\u5373\u53ef\u5728\u4e9a\u9a6c\u900aAWS EC2\u4e0a\u4f7f\u7528\u3002 \u76ee\u7684\u662f\uff1a \u901a\u8fc7\u63d0\u4f9b\u516c\u5f00\u6570\u636e\u7528\u4e8eAWS\u5206\u6790\uff0c\u5b9e\u73b0\u6570\u636e\u8bbf\u95ee\u7684\u6c11\u4e3b\u5316\u3002 \u5f00\u53d1\u65b0\u7684\u57fa\u4e8e\u4e91\u7684\u6280\u672f\u3001\u683c\u5f0f\u548c\u5de5\u5177\uff0c\u964d\u4f4e\u4f7f\u7528\u6570\u636e\u7684\u6210\u672c\u3002 \u9f13\u52b1\u5e76\u53d1\u5c55\u4ece\u5171\u4eab\u6570\u636e\u96c6\u4e2d\u53d7\u76ca\u7684\u7528\u6237\u793e\u533a\u3002 \u6311\u5176\u4e2d\u4e24\u4e2a\u6570\u636e\u4ecb\u7ecd\u4e0b\uff1a TCGA\uff08\u764c\u75c7\u57fa\u56e0\u7ec4\u5730\u56fe\u96c6\uff09\u8bed\u6599\u5e93\u56ca\u62ec\u4e86\u4ece\u6570\u4ee5\u5343\u8ba1\u7684\u764c\u75c7\u60a3\u8005\u5904\u6536\u96c6\u6765\u7684\u539f\u59cb\u548c\u52a0\u5de5\u8fc7\u7684\u57fa\u56e0\u7ec4\uff0c\u8f6c\u5f55\u57fa\u56e0\u7ec4\uff0c\u548c\u8868\u89c2\u57fa\u56e0\u7ec4\u6570\u636e\uff0c\u73b0\u5728\u5728 AWS S3 \u4e0a\u5bf9 Cancer Genomics Cloud\uff08CGC\uff09 \u7684\u7528\u6237\u514d\u8d39\u5f00\u653e\u3002 Cancer Genomics Cloud \u662f\u4e00\u4e2a\u8bd5\u70b9\u4e91\u9879\u76ee\uff0c\u7531\u7f8e\u56fd\u56fd\u5bb6\u764c\u75c7\u7814\u7a76\u6240\u8d44\u52a9\uff0c\u5728 Seven Bridges Genomics \u5e73\u53f0\u4e0a\u8fd0\u884c\u3002 ICGC\uff08\u56fd\u9645\u80bf\u7624\u57fa\u56e0\u7ec4\u534f\u4f5c\u7ec4\uff09\u6cdb\u764c\u75c7\u6570\u636e\u96c6\u56e0 PCAWG\uff08\u5168\u57fa\u56e0\u7ec4\u6cdb\u764c\u75c7\u5206\u6790\uff09\u7814\u7a76\u4ea7\u751f\uff0c\u73b0\u5728\u5728 AWS \u4e0a\u4e5f\u53ef\u7528\uff0c\u4f7f\u764c\u75c7\u7814\u7a76\u8005\u53ef\u4ee5\u8bbf\u95ee 2400 \u591a\u7ec4\u88ab\u6301\u7eed\u5206\u6790\u7684\u57fa\u56e0\u7ec4\uff0c\u8fd9\u4e9b\u57fa\u56e0\u7ec4\u5bf9\u5e94\u4e8e 1100 \u591a\u4f4d\u72ec\u7279\u7684 ICGC \u6350\u8d60\u8005\u3002\u8fd9\u4e9b\u6570\u636e\u4e5f\u5c06\u5728 AWS S3 \u4e0a\u5bf9\u90a3\u4e9b\u7b26\u5408 ICGC \u6570\u636e\u5171\u4eab\u7b56\u7565\uff0c\u53d7\u5230\u4fe1\u4efb\u7684\u7814\u7a76\u8005\u514d\u8d39\u5f00\u653e\u3002 \u5982\u4f55\u4f7f\u7528\u6570\u636e\u96c6 AWS public dataset \u6253\u5f00\u540e\uff0c\u9009\u4e2d\u6211\u8981\u4f7f\u7528\u7684\u6570\u636e\u96c6\uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u53ef\u4ee5\u770b\u5230\u5173\u4e8e\u8fd9\u4e2a\u6570\u636e\u96c6\u7684\u5b8c\u6574 \u63cf\u8ff0 \uff0c \u6388\u6743 \uff0c \u6587\u6863 \uff0c \u8054\u7cfb\u65b9\u5f0f \uff0c\u4ee5\u53ca \u4f7f\u7528\u6848\u4f8b \uff0c\u53f3\u4fa7\u8fd8\u6709\u8fd9\u4e2a\u6570\u636e\u8d44\u6e90\u5728aws\u7684\u8d44\u6e90\u540d\u79f0\uff08 ARN \uff09 arn:aws:s3:::1000genomes \uff0c\u548c\u6240\u5728\u7684\u533a\u57df us-east-1 \u3002 \u4e00\u822c\u5462\u6211\u4f1a\u70b9\u51fb\u6587\u6863\u8fdb\u53bb\u770b\u4e00\u773c\u5b83\u7684readme\uff0c\u786e\u8ba4\u6ca1\u9519\u8fc7\u4ec0\u4e48\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff0c\u7136\u540e\u767b\u5f55\u5230\u6211\u7684EC2\uff0c\u6839\u636eARN\u6211\u77e5\u9053\uff0c\u8fd9\u4e2a\u6570\u636e\u653e\u5728s3\u7684\u4e00\u4e2a\u540d\u4e3a 1000genomes \u7684\u6876\u91cc\uff0c\u7528aws cli\u547d\u4ee4\u8fdb\u53bb\u770b\u770b\u5427\u3002 $ aws s3 ls s3://1000genomes PRE 1000G_2504_high_coverage/ PRE alignment_indices/ PRE changelog_details/ PRE complete_genomics_indices/ PRE data/ PRE hgsv_sv_discovery/ PRE phase1/ PRE phase3/ PRE pilot_data/ PRE release/ PRE sequence_indices/ PRE technical/ 2015-09-08 21:16:09 1663 20131219.populations.tsv 2015-09-08 21:17:01 97 20131219.superpopulations.tsv 2015-09-08 15:01:44 257098 CHANGELOG 2014-09-02 15:39:53 15977 README.alignment_data 2014-01-30 11:13:29 5289 README.analysis_history 2014-01-31 03:44:08 5967 README.complete_genomics_data 2014-08-29 00:22:38 563 README.crams 2013-08-06 16:11:58 935 README.ebi_aspera_info 2013-08-06 16:11:58 8408 README.ftp_structure 2014-09-02 21:19:43 2082 README.pilot_data 2014-09-03 12:33:15 1938 README.populations 2013-08-06 16:11:58 7857 README.sequence_data 2015-06-18 18:28:31 672 README_missing_files_20150612 2015-06-03 19:43:32 136 README_phase3_alignments_sequence_20150526 2015-06-18 16:34:45 273 README_phase3_data_move_20150612 2014-09-03 12:34:30 3579471 alignment.index 2014-09-03 12:32:59 54743580 analysis.sequence.index 2014-09-03 12:34:57 3549051 exome.alignment.index 2014-09-03 12:35:15 67069489 sequence.index \u627e\u5230\u6211\u60f3\u8981\u7684\u6570\u636e\uff0c\u76f4\u63a5\u7528\u547d\u4ee4 aws sync s3://1000genomes/path/to/data ~/ref/1000g/ \u62c9\u5230\u81ea\u5df1\u673a\u5668\u4e0a\u5206\u6790\u5c31OK\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf\u5462\uff1f $ aws s3 sync s3://1000genomes/1000G_2504_high_coverage ./ Completed 320.2 MiB/~76.9 GiB (152.0 MiB/s) with ~5 file(s) remaining (calculating...) \u5982\u679c\u6211\u8fd8\u662f\u4e0d\u4f1a\u7528\uff0c\u6ca1\u5173\u7cfb\uff0c\u770b\u770b \u4f7f\u7528\u8bf4\u660e \uff0c\u91cc\u9762\u5305\u62ec\u5f88\u591a\u6559\u7a0b\u548c\u5de5\u5177\u96c6\u3002 Usage examples for all datasets \u5982\u4f55\u516c\u5e03\u6211\u7684\u6570\u636e\u96c6 \u5982\u679c\u6211\u624b\u91cc\u6709\u8bad\u7ec3\u597d\u7684\u6a21\u578b\uff0c\u6709\u81ea\u5df1\u6574\u7406\u7684\u5f88\u597d\u7528\u7684\u6570\u636e\u5e93\uff0c\u6216\u8005\u662f\u4efb\u4f55\u6211\u89c9\u5f97\u522b\u4eba\u7528\u5f97\u4e0a\u7684\uff0c\u80fd\u6539\u53d8\u4eba\u7c7b\u547d\u8fd0\u7684\u7b49\u7b49\u6570\u636e\uff0c\u6211\u90fd\u53ef\u4ee5\u7533\u8bf7\u5c06\u6211\u7684\u6570\u636e\u96c6\u653e\u5230aws\u7684\u8fd9\u4e2a\u516c\u5f00\u6570\u636e\u96c6\u5e73\u53f0\u4e0a\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u5168\u4e16\u754c\u7684\u7528\u6237\u90fd\u80fd\u770b\u5230\uff0c\u7528\u5230\u6211\u516c\u5f00\u7684\u6570\u636e\u96c6\uff0c\u53bb\u4e0d\u65ad\u7684\u4f20\u64ad\uff0c\u4e30\u5bcc\uff0c\u5b8c\u5584\u8fd9\u4e2a\u6570\u636e\u96c6\uff0c\u96c6\u5168\u7403\u667a\u6167\u5c06\u4e00\u4e2a\u4e8b\u60c5\u505a\u5230\u6781\u81f4\uff0c\u8fd9\u5c31\u662f\u5f00\u6e90\u7684\u7ec8\u6781\u5965\u4e49\u3002 \u5f53\u7136\uff0c\u65e2\u7136\u662f\u514d\u8d39\u7684\uff0caws\u81ea\u7136\u4e5f\u6709\u81ea\u5df1\u7684\u4e00\u5957\u5ba1\u6838\u6807\u51c6\uff0c\u8981\u901a\u8fc7AWS\u516c\u5171\u6570\u636e\u96c6\u7a0b\u5e8f\u5171\u4eab\u6570\u636e\u96c6\uff0c\u5c31\u5fc5\u987b\u540c\u610fAWS\u516c\u5171\u6570\u636e\u96c6\u7a0b\u5e8f\u7684\u6761\u6b3e\u548c\u6761\u4ef6\uff0c\u8fd9\u4e9b\u6761\u6b3e\u548c\u6761\u4ef6\u53ef\u4ece \u8fd9\u4e2a\u7f51\u5740 \u83b7\u5f97\u3002 \u7533\u8bf7\u4eba\u9700\u8981\u586b\u5199\u4e00\u4e9b\u8868\u683c\u63d0\u4ea4 \u7533\u8bf7 \uff0c\u7b49\u5f85\u5ba1\u6838\u4ee5\u901a\u8fc7\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u4e0a\u4f20\u6570\u636e\u4e86\u3002 \u5f53\u7136\u6700\u9760\u8c31\u7684\u662f\u627e\u5230aws\u7684\u4eba\uff0c\u8ba9\u4ed6\u6765\u7ed9\u6307\u5bfc\u6211\u600e\u4e48\u7533\u8bf7\uff0c\u8fd9\u6837\u6700\u9ad8\u6548\u3002 \u9700\u8981\u6ce8\u610f\u7684 aws\u516c\u5f00\u6570\u636e\u96c6\u5206\u56fd\u5185\u548c\u56fd\u5916\uff0c\u8bb0\u5f97\u770b\u6e05\u695a\uff0c\u53ef\u4e0d\u8981\u547d\u4ee4\u6572\u4e86\u534a\u5929\u624d\u53d1\u73b0\u662f\u56fd\u5185\u7684\u673a\u5668\u5728\u8bbf\u95ee\u56fd\u5916\u7684\u6570\u636e\u96c6\u3002 \u516c\u5f00\u6570\u636e\u96c6\u662f\u514d\u8d39\u7684\uff0c\u7f51\u7ad9\u4e0a\u5f88\u591a\u6570\u636e\u90fd\u662f\u76f4\u63a5\u5c31\u80fd\u4e0b\u8f7d\u7684\u3002\u4f46\u662f\u5982\u679c\u6211\u662f\u6570\u636e\u63d0\u4f9b\u65b9\uff0c\u6211\u60f3\u5bf9\u5206\u4eab\u5b9e\u73b0\u4e00\u4e9b\u63a7\u5236\uff0c\u6bd4\u5982\u8bf4\u522b\u4eba\u60f3\u7528\u6211\u7684\u6570\u636e\u9700\u8981\u6211\u6388\u6743\uff0c\u5f53\u7136\uff0c\u8fd8\u662f\u514d\u8d39\u4f7f\u7528\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 aws \u6bcf3\u4e2a\u6708\u5bf9\u6570\u636e\u96c6\u7684\u7533\u8bf7\u8fdb\u884c\u4e00\u6b21\u8bc4\u4f30\uff0c\u6bcf\u4e2a\u5b63\u5ea6\u7684\u622a\u81f3\u65e5\u671f\u662f3.31\uff0c6.30\uff0c9.30\uff0c12.31\uff0c\u6216\u8005\u662f\u8fd9\u5929\u7684\u4e0b\u4e00\u4e2a\u5de5\u4f5c\u65e5\u3002\u5982\u679c\u60f3\u4e0a\u4f20\u81ea\u5df1\u7684\u6570\u636e\u96c6\u7684\u8bdd\uff0c\u5efa\u8bae\u63d0\u524d\u51c6\u5907\u3002 \u516c\u5f00\u6570\u636e\u96c6\u7684\u514d\u8d39\uff0c\u5305\u62ec\u6570\u636e\u5b58\u50a8\u8d39\u548c\u6570\u636e\u4f20\u8f93\u8d39\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u652f\u4ed8\u4efb\u4f55\u8d39\u7528\u3002 \u738b\u6743\u6ca1\u6709\u6c38\u6052\u3002 \u4e00\u4e9b\u6709\u610f\u601d\u7684\u6570\u636e\u96c6 1980 US Census \u7f8e\u56fd1980\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 1980 US Census 1990 US Census \u7f8e\u56fd1990\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 1990 US Census 2000 US Census \u7f8e\u56fd2000\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 2000 US Census 2003-2006 US Economic Data \u7f8e\u56fd2003-2006\u7ecf\u6d4e\u6570\u636e US Economic Data for years 2003 to 2006 2008 TIGER/Line Shapefiles \u7f8e\u56fd2000\u5e74\u4eba\u53e3\u666e\u67e5\u4e0e\u8be6\u7ec6\u7684\u653f\u533a\u5212\u5206 Census 2000 and Current United States shapefiles 3D Version of the PubChem Library PubSem\u6709\u673a\u5c0f\u5206\u5b50\u751f\u7269\u6d3b\u6027\u6570\u636e\u4e09\u7ef4\u7248 3D Version of the PubChem Library AnthroKids \u2013 Anthropometric Data of Children 70\u5e74\u4ee3\u7684\u513f\u7ae5\u4eba\u4f53\u6d4b\u91cf\u6570\u636e Anthropometric data on children from two studies in 1975 and 1977 Apache Software Foundation Public Mail Archives Apache\u57fa\u91d1\u4f1a\u7684\u52302011\u5e74\u4e3a\u6b62\u7684\u90ae\u4ef6\u5217\u8868 A collection of all publicly available Apache Software Foundation mail archives as of July 11, 2011 Business and Industry Summary Data \u7f8e\u56fd\u5de5\u5546\u4e1a\u6570\u636e US Business and Industry Summary Data C57BL/6J by C3H/HeJ Mouse Cross (Sage Bionetworks) \u8001\u9f20\u6742\u4ea4\u6570\u636e C57BL/6J by C3H/HeJ mouse cross from the Jake Lusis lab at UCLA Common Crawl Corpus 50\u4ebf\u7f51\u9875 A corpus of web crawl data composed of over 5 billion web pages. This data set is freely available on Amazon S3 and is released under the Common Crawl Terms of Use. Daily Global Weather Measurements, 1929-2009 (NCDC, GSOD) 80\u5e74\u7684\u6309\u65e5\u5168\u7403\u5929\u6c14\u6570\u636e A collection of daily weather measurements (temperature, wind speed, humidity, pressure, &c.) from 9000+ weather stations around the world. DBpedia 3.5.1 DBpedia\u7ed3\u6784\u5316\u77e5\u8bc6\u5e93 DBpedia is a community effort to extract structured information from Wikipedia and to make this information available on the Web Denisova Genome \u4e39\u5c3c\u7d22\u74e6\u4eba\u57fa\u56e0\u7ec4 The high-coverage genome sequence of a Denisovan individual sequenced to ~30x coverage on the Illumina platform. Together with their sister group the Neandertals, Denisovans are the most closely related extinct relatives of currently living humans. Enron Email Data \u5b89\u7136\u7535\u5b50\u90ae\u4ef6\u6570\u636e Enron email data publicly released as part of FERC\u2019s Western Energy Markets investigation converted to industry standard formats by EDRM. The data set consists of 1,227,255 emails with 493,384 attachments covering 151 custodians. The email is provided in Microsoft PST, IETF MIME, and EDRM XML formats. Ensembl \u2013 FASTA Database Files Ensembl\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u8f6c\u5f55\u4e0e\u7ffb\u8bd1\u6a21\u578b Ensembl sequence databases of transcript and translation models Ensembl Annotated Human Genome Data (FASTA Release 73) \u4eba\u7c7b\u4e0e\u5176\u4ed650\u4e2a\u7269\u79cd\u7684\u57fa\u56e0\u5e8f\u5217 The Ensembl project produces genome databases for human as well as over 50 other species, and makes this information freely available. Ensembl Annotated Human Genome Data (MySQL Release 73) \u4eba\u7c7b\u4e0e\u5176\u4ed650\u4e2a\u7269\u79cd\u7684\u57fa\u56e0\u5e8f\u5217\uff0cMySQL\u7248 The Ensembl project produces genome databases for human as well as over 50 other species, and makes this information freely available. Federal Contracts from the Federal Procurement Data Center (USASpending.gov) \u7f8e\u56fd\u8054\u90a6\u653f\u5e9c\u7684\u5408\u540c A data dump of all federal contracts from the Federal Procurement Data Center found at USASpending.gov. Federal Reserve Economic Data \u2013 Fred \u7f8e\u8054\u50a8\u7ecf\u6d4e\u6570\u636e\u65f6\u95f4\u5e8f\u5217 Database of 20,059 U.S. economic time series. Freebase Data Dump Freebase\u77e5\u8bc6\u56fe\u8c31 Freebase is an open database of the world\u2019s information, covering millions of topics in hundreds of categories Freebase Quad Dump Freebase\u77e5\u8bc6\u56fe\u8c31\u56db\u5143\u7ec4\u683c\u5f0f A data dump of all the current facts and assertions in Freebase Freebase Simple Topic Dump Freebase\u77e5\u8bc6\u56fe\u8c31\u7b80\u5316\u7684\u4e3b\u9898\u6570\u636e A data dump of the basic identifying facts about every topic in Freebase GenBank \u57fa\u56e0\u94f6\u884c\u5e8f\u5217\u6570\u636e\u5e93 An annotated collection of all publicly available DNA sequences including more than 85.7B bases and 82.8M sequence records. Google Books Ngrams \u8c37\u6b4c\u56fe\u4e66\u7684ngram\u8bed\u8a00\u6a21\u578b A data set containing Google Books n-gram corpuses. This data set is freely available on Amazon S3 in a Hadoop friendly file format and is licensed under a Creative Commons Attribution 3.0 Unported License. The original dataset is available from http://books.google.com/ngrams/. Human Liver Cohort (Sage Bionetworks) \u4eba\u7c7b\u809d\u810f\u57fa\u56e0\u8868\u8fbe Human Liver Cohort characterizing gene expression in liver samples Human Microbiome Project \u4eba\u4f53\u5fae\u751f\u7269\u7fa4\u6570\u636e Human Microbiome Project Data Set Illumina \u2013 Jay Flatley (CEO of Illumina) Human Genome Data Set \u4eba\u4f53\u57fa\u56e0\u7ec4\u6570\u636e Jay Flatley (CEO of Illumina) human genome data set. Influenza Virus (including updated Swine Flu sequences) \u6d41\u611f\u75c5\u6bd2\u6570\u636e NCBI Influenza Resource Center Data. Japan Census Data \u65e5\u672c\u4eba\u53e3\u7edf\u8ba1\u6570\u636e Multiple data sets including: (1) Population Census of Japan (1995, 2000, 2005, 2010), (2) Establishment and Enterprise Census of Japan (1999, 2001, 2004, 2006), and (3) Economic Census of Japan (2009). Labor Statistics Databases \u7f8e\u56fd\u52b3\u5de5\u90e8\u7684\u7edf\u8ba1\u6570\u636e Various Labor Statistics M-Lab dataset: Network Diagnostic Tool (NDT) 2009\u5e74\u4e92\u8054\u7f51\u6027\u80fd\uff08\u5982\u7f51\u901f\uff09\u8bca\u65ad\u6570\u636e NDT test results created through Measurement Lab (M-Lab) between February 2009 and September 2009 M-Lab dataset: Network Path and Application Diagnosis tool (NPAD) 2009\u5e74\u4e92\u8054\u7f51\u8def\u7531\uff0c\u5305\u5934\u7b49\u6d4b\u8bd5\u6570\u636e NPAD test results created through Measurement Lab (M-Lab) between February 2009 and September 2009 Marvel Universe Social Graph \u4e00\u4e2a\u865a\u62df\u7684\u793e\u4ea4\u7f51\u7edc\u5173\u7cfb\u56fe This dataset is an example of a social collaboration network based on the characters in The Marvel Universe, that is, the artificial world that takes place in the universe of the Marvel comic books. Material Safety Data Sheets \u6750\u6599\u5b89\u5168\u6570\u636e 230,000 Material Safety Data Sheets. Million Song Dataset \u767e\u4e07\u6b4c\u66f2\u6570\u636e The Million Songs Collection is a collection of 28 datasets containing audio features and metadata for a million contemporary popular music tracks. Million Song Sample Dataset \u767e\u4e07\u6b4c\u66f2\u6570\u636e\u5e93\u76841\u4e07\u5b50\u96c6 This is a 10,000 song subset of audio features and metadata from the Million Songs collection \u2013 a collection of 28 datasets containing audio features and metadata for a million contemporary popular music tracks. Model Organism Encyclopedia of DNA Elements (modENCODE) \u6a21\u5f0f\u751f\u7269\u751f\u547d\u767e\u79d1\u5168\u4e66 A collection of data from the modENCODE project ( http://www.modencode.org ) NASA NEX NASA\u7684\u5730\u7403\u536b\u661f\u5730\u56fe\u4e0e\u6c14\u5019\u53d8\u8fc1 Three NASA NEX datasets are now available, including climate projections and satellite images of Earth. OpenStreetMap Rendering Database \u5f00\u6e90\u7684\u5168\u7403\u5730\u56fe\u6570\u636e A PostGIS 8.3 data cluster of all OpenStreetMap data for the planet. Petroleum Public Data Set (working Title) \u77f3\u6cb9\u6570\u636e Public-domain data for the oil & gas industry, assembled from the contributions of participating agencies in the United States, Canada and around the world. This data provides industry stakeholders with an opportunity to focus their efforts on the analysis and interpretation of this data without concern for the trivial and time-consuming tasks of locating, downloading, reformatting and integrating the data prior to value-added work being performed. PubChem Library \u6709\u673a\u5c0f\u5206\u5b50\u751f\u7269\u6d3b\u6027\u6570\u636e A data set of information on the biological activities of small molecules. Sloan Digital Sky Survey DR6 Subset \u65af\u9686\u6570\u5b57\u5316\u5de1\u5929 The Sloan Digital Sky Survey is the most ambitious astronomical survey ever undertaken. The Cannabis Sativa Genome \u5927\u9ebb\u57fa\u56e0 Whole Genome Shotgun Sequencing of the Cannabis Sativa Cultivar \u201cChemdawg\u201d The WestburyLab USENET corpus 4\u4e07\u591a\u4e2aUSENET\u65b0\u95fb\u7ec4\u6570\u636e The WestburyLab USENET corpus is an anonymized compilation of postings from 47,860 English-language newsgroups from 2005-2010. Transportation Databases \u7f8e\u56fd\u4ea4\u901a\u90e8\u7684\u822a\u7a7a\uff0c\u822a\u6d77\uff0c\u516c\u8def\uff0c\u94c1\u8def\uff0c\u7ba1\u9053\uff0c\u81ea\u884c\u8f66\u7b49\u7edf\u8ba1\u6570\u636e Various transportation statistics Twilio/Wigle.net Street Vector Data Set \u5b8c\u6574\u7684\u7f8e\u56fd\u8857\u9053\u540d\u4e0e\u5730\u5740 Twilio/Wigle.net database of mapped US street names and address ranges. Unigene NCBI\u7684\u8f6c\u5f55\u7ec4\u6570\u636e\u5e93 UniGene: An Organized View of the Transcriptome. University of Florida Sparse Matrix Collection \u4f5b\u7f57\u91cc\u8fbe\u5927\u5b66\u7684\u7a00\u758f\u77e9\u9635\u6570\u636e\u96c6 The University of Florida Sparse Matrix Collection is a large, widely available, and actively growing set of sparse matrices that arise in real applications. Wikipedia Extraction (WEX) \u7ef4\u57fa\u767e\u79d1\u7528Freebase\u589e\u5f3a\u8fc7\u7684\u7ed3\u6784\u5316\u6570\u636e A processed dump of the English language Wikipedia Wikipedia Page Traffic Statistic V3 \u7ef4\u57fa\u767e\u79d12011\u5e743\u4e2a\u6708\u7684\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf This dataset contains a 150 GB sample of the data used to power trendingtopics.org . It includes a full 3 months of hourly page traffic statistics from Wikipedia (1/1/2011-3/31/2011). Wikipedia Page Traffic Statistics \u7ef4\u57fa\u767e\u79d12009\u5e747\u4e2a\u6708\u7684\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf Contains 7 months of hourly pageview statistics for all articles in Wikipedia Wikipedia Traffic Statistics V2 \u7ef4\u57fa\u767e\u79d12009-2010\u5e7416\u4e2a\u6708\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf Contains 16 months of hourly pageview statistics for all articles in Wikipedia Wikipedia XML Data \u7ef4\u57fa\u767e\u79d12009\u7248\uff0cXML\u683c\u5f0f A complete copy of all Wikimedia wikis, in the form of wikitext source and metadata embedded in XML. YRI Trio Dataset \u4e09\u4e2a\u7ea6\u9c81\u5df4\u4eba\u7684\u5b8c\u6574\u57fa\u56e0\u7ec4 Complete genome sequence data for three Yoruba individuals from Ibadan, Nigeria","title":"\u798f\u97f3\uff01\u7528\u597dAWS\u516c\u5f00\u6570\u636e\u96c6"},{"location":"blogs/2020-02-09-aws-public-dataset/#aws","text":"aws \u63d0\u4f9b\u4e86\u4e00\u4e2as3\u5b58\u50a8\u7a7a\u95f4\uff0c\u7ed9\u90a3\u4e9b\u5f00\u653e\u516c\u5171\u4e0b\u8f7d\u7684\u8d44\u6e90\uff0c\u5e76\u4e14\u5b58\u50a8\u8d39\u7528\u662f\u514d\u8d39\u7684\uff01\u6bd4\u5982\u6211\u4eec\u751f\u4fe1\u5e38\u7528\u7684NCBI SRA\uff0cENCODE, 1000g\uff0cNIH\u7684\u4eba\u7c7b\u5fae\u751f\u7269\u7ec4\u8ba1\u5212\u6570\u636e\uff0cnanopore reference, \u6c34\u7a3b\u57fa\u56e0\u7ec43000 Rice Genomics, TCGA,ICGC\u6570\u636e\u7b49\uff0c\u6709\u4e86\u8fd9\u4e9b\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u6ca1\u9519\uff0c\u5982\u679c\u6211\u662f\u4e00\u540daws\u7528\u6237\uff0c\u6211\u5c31\u4e0d\u9700\u8981\u518d\u53bb\u4e0b\u8f7d\u6570\u636e\u5566\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u7f51\u901f\u90a3\u4e2a\u6162\u5450~ \u6211\u53ea\u9700\u8981\u77e5\u9053\u6570\u636e\u6240\u5728\u7684aws\u7684\u4f4d\u7f6e\uff0c\u901a\u8fc7aws\u5185\u7f51\u628a\u60f3\u8981\u7684\u6570\u636e\u76f4\u63a5\u62c9\u5230\u6211\u8981\u505a\u5206\u6790\u7684\u673a\u5668\u4e0a\u5c31\u53ef\u4ee5\uff0c\u901f\u5ea6\u98de\u8d77\uff01 --- D.C AWS public dataset","title":"\u798f\u97f3\uff01\u7528\u597dAWS\u516c\u5f00\u6570\u636e\u96c6"},{"location":"blogs/2020-02-09-aws-public-dataset/#_1","text":"\u573a\u666f\uff1a\u5728\u505a\u6570\u636e\u5206\u6790\u65f6\uff0c\u4e00\u4e2a\u56f0\u96be\u662f\u6d77\u91cf\u7684\u6570\u636e\u672c\u5730\u5b58\u50a8\u56f0\u96be\uff0c\u800c\u4e14\u4e0b\u8f7d\u8017\u8d39\u7684\u65f6\u95f4\u6781\u957f\u3002\u4f8b\u59821T\u6570\u636e\uff0c\u5982\u679c\u4e0b\u8f7d\u7f51\u901f\u662f3MBps\uff08\u76ee\u524d\u4e2d\u56fd\u7684\u5e73\u5747\u5bbd\u5e26\u901f\u5ea6\uff09\uff0c\u90a3\u89814\u5929\u624d\u80fd\u4e0b\u8f7d\u5b8c\u3002\u6709\u4e9b\u6570\u636e\u96c6\u6709\u51e0\u5341T\uff0c\u90a3\u5149\u4e0b\u8f7d\u5c31\u8981\u51e0\u4e2a\u6708\u3002 AWS\u4e91\u670d\u52a1\u5e73\u53f0\u4e0a\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u56f0\u96be\u63d0\u4f9b\u4e86\u5f88\u591a\u5e38\u7528\u7684\u5927\u89c4\u6a21\u6570\u636e\u96c6 Public Data Sets https://aws.amazon.com/datasets \uff0c\u65e0\u9700\u4e0b\u8f7d\u5373\u53ef\u5728\u4e9a\u9a6c\u900aAWS EC2\u4e0a\u4f7f\u7528\u3002 \u76ee\u7684\u662f\uff1a \u901a\u8fc7\u63d0\u4f9b\u516c\u5f00\u6570\u636e\u7528\u4e8eAWS\u5206\u6790\uff0c\u5b9e\u73b0\u6570\u636e\u8bbf\u95ee\u7684\u6c11\u4e3b\u5316\u3002 \u5f00\u53d1\u65b0\u7684\u57fa\u4e8e\u4e91\u7684\u6280\u672f\u3001\u683c\u5f0f\u548c\u5de5\u5177\uff0c\u964d\u4f4e\u4f7f\u7528\u6570\u636e\u7684\u6210\u672c\u3002 \u9f13\u52b1\u5e76\u53d1\u5c55\u4ece\u5171\u4eab\u6570\u636e\u96c6\u4e2d\u53d7\u76ca\u7684\u7528\u6237\u793e\u533a\u3002 \u6311\u5176\u4e2d\u4e24\u4e2a\u6570\u636e\u4ecb\u7ecd\u4e0b\uff1a TCGA\uff08\u764c\u75c7\u57fa\u56e0\u7ec4\u5730\u56fe\u96c6\uff09\u8bed\u6599\u5e93\u56ca\u62ec\u4e86\u4ece\u6570\u4ee5\u5343\u8ba1\u7684\u764c\u75c7\u60a3\u8005\u5904\u6536\u96c6\u6765\u7684\u539f\u59cb\u548c\u52a0\u5de5\u8fc7\u7684\u57fa\u56e0\u7ec4\uff0c\u8f6c\u5f55\u57fa\u56e0\u7ec4\uff0c\u548c\u8868\u89c2\u57fa\u56e0\u7ec4\u6570\u636e\uff0c\u73b0\u5728\u5728 AWS S3 \u4e0a\u5bf9 Cancer Genomics Cloud\uff08CGC\uff09 \u7684\u7528\u6237\u514d\u8d39\u5f00\u653e\u3002 Cancer Genomics Cloud \u662f\u4e00\u4e2a\u8bd5\u70b9\u4e91\u9879\u76ee\uff0c\u7531\u7f8e\u56fd\u56fd\u5bb6\u764c\u75c7\u7814\u7a76\u6240\u8d44\u52a9\uff0c\u5728 Seven Bridges Genomics \u5e73\u53f0\u4e0a\u8fd0\u884c\u3002 ICGC\uff08\u56fd\u9645\u80bf\u7624\u57fa\u56e0\u7ec4\u534f\u4f5c\u7ec4\uff09\u6cdb\u764c\u75c7\u6570\u636e\u96c6\u56e0 PCAWG\uff08\u5168\u57fa\u56e0\u7ec4\u6cdb\u764c\u75c7\u5206\u6790\uff09\u7814\u7a76\u4ea7\u751f\uff0c\u73b0\u5728\u5728 AWS \u4e0a\u4e5f\u53ef\u7528\uff0c\u4f7f\u764c\u75c7\u7814\u7a76\u8005\u53ef\u4ee5\u8bbf\u95ee 2400 \u591a\u7ec4\u88ab\u6301\u7eed\u5206\u6790\u7684\u57fa\u56e0\u7ec4\uff0c\u8fd9\u4e9b\u57fa\u56e0\u7ec4\u5bf9\u5e94\u4e8e 1100 \u591a\u4f4d\u72ec\u7279\u7684 ICGC \u6350\u8d60\u8005\u3002\u8fd9\u4e9b\u6570\u636e\u4e5f\u5c06\u5728 AWS S3 \u4e0a\u5bf9\u90a3\u4e9b\u7b26\u5408 ICGC \u6570\u636e\u5171\u4eab\u7b56\u7565\uff0c\u53d7\u5230\u4fe1\u4efb\u7684\u7814\u7a76\u8005\u514d\u8d39\u5f00\u653e\u3002","title":"\u4ec0\u4e48\u662f\u516c\u5f00\u6570\u636e\u96c6"},{"location":"blogs/2020-02-09-aws-public-dataset/#_2","text":"AWS public dataset \u6253\u5f00\u540e\uff0c\u9009\u4e2d\u6211\u8981\u4f7f\u7528\u7684\u6570\u636e\u96c6\uff0c\u70b9\u51fb\u8fdb\u5165\uff0c\u53ef\u4ee5\u770b\u5230\u5173\u4e8e\u8fd9\u4e2a\u6570\u636e\u96c6\u7684\u5b8c\u6574 \u63cf\u8ff0 \uff0c \u6388\u6743 \uff0c \u6587\u6863 \uff0c \u8054\u7cfb\u65b9\u5f0f \uff0c\u4ee5\u53ca \u4f7f\u7528\u6848\u4f8b \uff0c\u53f3\u4fa7\u8fd8\u6709\u8fd9\u4e2a\u6570\u636e\u8d44\u6e90\u5728aws\u7684\u8d44\u6e90\u540d\u79f0\uff08 ARN \uff09 arn:aws:s3:::1000genomes \uff0c\u548c\u6240\u5728\u7684\u533a\u57df us-east-1 \u3002 \u4e00\u822c\u5462\u6211\u4f1a\u70b9\u51fb\u6587\u6863\u8fdb\u53bb\u770b\u4e00\u773c\u5b83\u7684readme\uff0c\u786e\u8ba4\u6ca1\u9519\u8fc7\u4ec0\u4e48\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff0c\u7136\u540e\u767b\u5f55\u5230\u6211\u7684EC2\uff0c\u6839\u636eARN\u6211\u77e5\u9053\uff0c\u8fd9\u4e2a\u6570\u636e\u653e\u5728s3\u7684\u4e00\u4e2a\u540d\u4e3a 1000genomes \u7684\u6876\u91cc\uff0c\u7528aws cli\u547d\u4ee4\u8fdb\u53bb\u770b\u770b\u5427\u3002 $ aws s3 ls s3://1000genomes PRE 1000G_2504_high_coverage/ PRE alignment_indices/ PRE changelog_details/ PRE complete_genomics_indices/ PRE data/ PRE hgsv_sv_discovery/ PRE phase1/ PRE phase3/ PRE pilot_data/ PRE release/ PRE sequence_indices/ PRE technical/ 2015-09-08 21:16:09 1663 20131219.populations.tsv 2015-09-08 21:17:01 97 20131219.superpopulations.tsv 2015-09-08 15:01:44 257098 CHANGELOG 2014-09-02 15:39:53 15977 README.alignment_data 2014-01-30 11:13:29 5289 README.analysis_history 2014-01-31 03:44:08 5967 README.complete_genomics_data 2014-08-29 00:22:38 563 README.crams 2013-08-06 16:11:58 935 README.ebi_aspera_info 2013-08-06 16:11:58 8408 README.ftp_structure 2014-09-02 21:19:43 2082 README.pilot_data 2014-09-03 12:33:15 1938 README.populations 2013-08-06 16:11:58 7857 README.sequence_data 2015-06-18 18:28:31 672 README_missing_files_20150612 2015-06-03 19:43:32 136 README_phase3_alignments_sequence_20150526 2015-06-18 16:34:45 273 README_phase3_data_move_20150612 2014-09-03 12:34:30 3579471 alignment.index 2014-09-03 12:32:59 54743580 analysis.sequence.index 2014-09-03 12:34:57 3549051 exome.alignment.index 2014-09-03 12:35:15 67069489 sequence.index \u627e\u5230\u6211\u60f3\u8981\u7684\u6570\u636e\uff0c\u76f4\u63a5\u7528\u547d\u4ee4 aws sync s3://1000genomes/path/to/data ~/ref/1000g/ \u62c9\u5230\u81ea\u5df1\u673a\u5668\u4e0a\u5206\u6790\u5c31OK\uff0c\u662f\u4e0d\u662f\u5f88\u65b9\u4fbf\u5462\uff1f $ aws s3 sync s3://1000genomes/1000G_2504_high_coverage ./ Completed 320.2 MiB/~76.9 GiB (152.0 MiB/s) with ~5 file(s) remaining (calculating...) \u5982\u679c\u6211\u8fd8\u662f\u4e0d\u4f1a\u7528\uff0c\u6ca1\u5173\u7cfb\uff0c\u770b\u770b \u4f7f\u7528\u8bf4\u660e \uff0c\u91cc\u9762\u5305\u62ec\u5f88\u591a\u6559\u7a0b\u548c\u5de5\u5177\u96c6\u3002 Usage examples for all datasets","title":"\u5982\u4f55\u4f7f\u7528\u6570\u636e\u96c6"},{"location":"blogs/2020-02-09-aws-public-dataset/#_3","text":"\u5982\u679c\u6211\u624b\u91cc\u6709\u8bad\u7ec3\u597d\u7684\u6a21\u578b\uff0c\u6709\u81ea\u5df1\u6574\u7406\u7684\u5f88\u597d\u7528\u7684\u6570\u636e\u5e93\uff0c\u6216\u8005\u662f\u4efb\u4f55\u6211\u89c9\u5f97\u522b\u4eba\u7528\u5f97\u4e0a\u7684\uff0c\u80fd\u6539\u53d8\u4eba\u7c7b\u547d\u8fd0\u7684\u7b49\u7b49\u6570\u636e\uff0c\u6211\u90fd\u53ef\u4ee5\u7533\u8bf7\u5c06\u6211\u7684\u6570\u636e\u96c6\u653e\u5230aws\u7684\u8fd9\u4e2a\u516c\u5f00\u6570\u636e\u96c6\u5e73\u53f0\u4e0a\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u5168\u4e16\u754c\u7684\u7528\u6237\u90fd\u80fd\u770b\u5230\uff0c\u7528\u5230\u6211\u516c\u5f00\u7684\u6570\u636e\u96c6\uff0c\u53bb\u4e0d\u65ad\u7684\u4f20\u64ad\uff0c\u4e30\u5bcc\uff0c\u5b8c\u5584\u8fd9\u4e2a\u6570\u636e\u96c6\uff0c\u96c6\u5168\u7403\u667a\u6167\u5c06\u4e00\u4e2a\u4e8b\u60c5\u505a\u5230\u6781\u81f4\uff0c\u8fd9\u5c31\u662f\u5f00\u6e90\u7684\u7ec8\u6781\u5965\u4e49\u3002 \u5f53\u7136\uff0c\u65e2\u7136\u662f\u514d\u8d39\u7684\uff0caws\u81ea\u7136\u4e5f\u6709\u81ea\u5df1\u7684\u4e00\u5957\u5ba1\u6838\u6807\u51c6\uff0c\u8981\u901a\u8fc7AWS\u516c\u5171\u6570\u636e\u96c6\u7a0b\u5e8f\u5171\u4eab\u6570\u636e\u96c6\uff0c\u5c31\u5fc5\u987b\u540c\u610fAWS\u516c\u5171\u6570\u636e\u96c6\u7a0b\u5e8f\u7684\u6761\u6b3e\u548c\u6761\u4ef6\uff0c\u8fd9\u4e9b\u6761\u6b3e\u548c\u6761\u4ef6\u53ef\u4ece \u8fd9\u4e2a\u7f51\u5740 \u83b7\u5f97\u3002 \u7533\u8bf7\u4eba\u9700\u8981\u586b\u5199\u4e00\u4e9b\u8868\u683c\u63d0\u4ea4 \u7533\u8bf7 \uff0c\u7b49\u5f85\u5ba1\u6838\u4ee5\u901a\u8fc7\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u4e0a\u4f20\u6570\u636e\u4e86\u3002 \u5f53\u7136\u6700\u9760\u8c31\u7684\u662f\u627e\u5230aws\u7684\u4eba\uff0c\u8ba9\u4ed6\u6765\u7ed9\u6307\u5bfc\u6211\u600e\u4e48\u7533\u8bf7\uff0c\u8fd9\u6837\u6700\u9ad8\u6548\u3002","title":"\u5982\u4f55\u516c\u5e03\u6211\u7684\u6570\u636e\u96c6"},{"location":"blogs/2020-02-09-aws-public-dataset/#_4","text":"aws\u516c\u5f00\u6570\u636e\u96c6\u5206\u56fd\u5185\u548c\u56fd\u5916\uff0c\u8bb0\u5f97\u770b\u6e05\u695a\uff0c\u53ef\u4e0d\u8981\u547d\u4ee4\u6572\u4e86\u534a\u5929\u624d\u53d1\u73b0\u662f\u56fd\u5185\u7684\u673a\u5668\u5728\u8bbf\u95ee\u56fd\u5916\u7684\u6570\u636e\u96c6\u3002 \u516c\u5f00\u6570\u636e\u96c6\u662f\u514d\u8d39\u7684\uff0c\u7f51\u7ad9\u4e0a\u5f88\u591a\u6570\u636e\u90fd\u662f\u76f4\u63a5\u5c31\u80fd\u4e0b\u8f7d\u7684\u3002\u4f46\u662f\u5982\u679c\u6211\u662f\u6570\u636e\u63d0\u4f9b\u65b9\uff0c\u6211\u60f3\u5bf9\u5206\u4eab\u5b9e\u73b0\u4e00\u4e9b\u63a7\u5236\uff0c\u6bd4\u5982\u8bf4\u522b\u4eba\u60f3\u7528\u6211\u7684\u6570\u636e\u9700\u8981\u6211\u6388\u6743\uff0c\u5f53\u7136\uff0c\u8fd8\u662f\u514d\u8d39\u4f7f\u7528\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 aws \u6bcf3\u4e2a\u6708\u5bf9\u6570\u636e\u96c6\u7684\u7533\u8bf7\u8fdb\u884c\u4e00\u6b21\u8bc4\u4f30\uff0c\u6bcf\u4e2a\u5b63\u5ea6\u7684\u622a\u81f3\u65e5\u671f\u662f3.31\uff0c6.30\uff0c9.30\uff0c12.31\uff0c\u6216\u8005\u662f\u8fd9\u5929\u7684\u4e0b\u4e00\u4e2a\u5de5\u4f5c\u65e5\u3002\u5982\u679c\u60f3\u4e0a\u4f20\u81ea\u5df1\u7684\u6570\u636e\u96c6\u7684\u8bdd\uff0c\u5efa\u8bae\u63d0\u524d\u51c6\u5907\u3002 \u516c\u5f00\u6570\u636e\u96c6\u7684\u514d\u8d39\uff0c\u5305\u62ec\u6570\u636e\u5b58\u50a8\u8d39\u548c\u6570\u636e\u4f20\u8f93\u8d39\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u652f\u4ed8\u4efb\u4f55\u8d39\u7528\u3002 \u738b\u6743\u6ca1\u6709\u6c38\u6052\u3002","title":"\u9700\u8981\u6ce8\u610f\u7684"},{"location":"blogs/2020-02-09-aws-public-dataset/#_5","text":"1980 US Census \u7f8e\u56fd1980\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 1980 US Census 1990 US Census \u7f8e\u56fd1990\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 1990 US Census 2000 US Census \u7f8e\u56fd2000\u5e74\u4eba\u53e3\u666e\u67e5\u6570\u636e Data from the 2000 US Census 2003-2006 US Economic Data \u7f8e\u56fd2003-2006\u7ecf\u6d4e\u6570\u636e US Economic Data for years 2003 to 2006 2008 TIGER/Line Shapefiles \u7f8e\u56fd2000\u5e74\u4eba\u53e3\u666e\u67e5\u4e0e\u8be6\u7ec6\u7684\u653f\u533a\u5212\u5206 Census 2000 and Current United States shapefiles 3D Version of the PubChem Library PubSem\u6709\u673a\u5c0f\u5206\u5b50\u751f\u7269\u6d3b\u6027\u6570\u636e\u4e09\u7ef4\u7248 3D Version of the PubChem Library AnthroKids \u2013 Anthropometric Data of Children 70\u5e74\u4ee3\u7684\u513f\u7ae5\u4eba\u4f53\u6d4b\u91cf\u6570\u636e Anthropometric data on children from two studies in 1975 and 1977 Apache Software Foundation Public Mail Archives Apache\u57fa\u91d1\u4f1a\u7684\u52302011\u5e74\u4e3a\u6b62\u7684\u90ae\u4ef6\u5217\u8868 A collection of all publicly available Apache Software Foundation mail archives as of July 11, 2011 Business and Industry Summary Data \u7f8e\u56fd\u5de5\u5546\u4e1a\u6570\u636e US Business and Industry Summary Data C57BL/6J by C3H/HeJ Mouse Cross (Sage Bionetworks) \u8001\u9f20\u6742\u4ea4\u6570\u636e C57BL/6J by C3H/HeJ mouse cross from the Jake Lusis lab at UCLA Common Crawl Corpus 50\u4ebf\u7f51\u9875 A corpus of web crawl data composed of over 5 billion web pages. This data set is freely available on Amazon S3 and is released under the Common Crawl Terms of Use. Daily Global Weather Measurements, 1929-2009 (NCDC, GSOD) 80\u5e74\u7684\u6309\u65e5\u5168\u7403\u5929\u6c14\u6570\u636e A collection of daily weather measurements (temperature, wind speed, humidity, pressure, &c.) from 9000+ weather stations around the world. DBpedia 3.5.1 DBpedia\u7ed3\u6784\u5316\u77e5\u8bc6\u5e93 DBpedia is a community effort to extract structured information from Wikipedia and to make this information available on the Web Denisova Genome \u4e39\u5c3c\u7d22\u74e6\u4eba\u57fa\u56e0\u7ec4 The high-coverage genome sequence of a Denisovan individual sequenced to ~30x coverage on the Illumina platform. Together with their sister group the Neandertals, Denisovans are the most closely related extinct relatives of currently living humans. Enron Email Data \u5b89\u7136\u7535\u5b50\u90ae\u4ef6\u6570\u636e Enron email data publicly released as part of FERC\u2019s Western Energy Markets investigation converted to industry standard formats by EDRM. The data set consists of 1,227,255 emails with 493,384 attachments covering 151 custodians. The email is provided in Microsoft PST, IETF MIME, and EDRM XML formats. Ensembl \u2013 FASTA Database Files Ensembl\u771f\u6838\u751f\u7269\u57fa\u56e0\u7ec4\u8f6c\u5f55\u4e0e\u7ffb\u8bd1\u6a21\u578b Ensembl sequence databases of transcript and translation models Ensembl Annotated Human Genome Data (FASTA Release 73) \u4eba\u7c7b\u4e0e\u5176\u4ed650\u4e2a\u7269\u79cd\u7684\u57fa\u56e0\u5e8f\u5217 The Ensembl project produces genome databases for human as well as over 50 other species, and makes this information freely available. Ensembl Annotated Human Genome Data (MySQL Release 73) \u4eba\u7c7b\u4e0e\u5176\u4ed650\u4e2a\u7269\u79cd\u7684\u57fa\u56e0\u5e8f\u5217\uff0cMySQL\u7248 The Ensembl project produces genome databases for human as well as over 50 other species, and makes this information freely available. Federal Contracts from the Federal Procurement Data Center (USASpending.gov) \u7f8e\u56fd\u8054\u90a6\u653f\u5e9c\u7684\u5408\u540c A data dump of all federal contracts from the Federal Procurement Data Center found at USASpending.gov. Federal Reserve Economic Data \u2013 Fred \u7f8e\u8054\u50a8\u7ecf\u6d4e\u6570\u636e\u65f6\u95f4\u5e8f\u5217 Database of 20,059 U.S. economic time series. Freebase Data Dump Freebase\u77e5\u8bc6\u56fe\u8c31 Freebase is an open database of the world\u2019s information, covering millions of topics in hundreds of categories Freebase Quad Dump Freebase\u77e5\u8bc6\u56fe\u8c31\u56db\u5143\u7ec4\u683c\u5f0f A data dump of all the current facts and assertions in Freebase Freebase Simple Topic Dump Freebase\u77e5\u8bc6\u56fe\u8c31\u7b80\u5316\u7684\u4e3b\u9898\u6570\u636e A data dump of the basic identifying facts about every topic in Freebase GenBank \u57fa\u56e0\u94f6\u884c\u5e8f\u5217\u6570\u636e\u5e93 An annotated collection of all publicly available DNA sequences including more than 85.7B bases and 82.8M sequence records. Google Books Ngrams \u8c37\u6b4c\u56fe\u4e66\u7684ngram\u8bed\u8a00\u6a21\u578b A data set containing Google Books n-gram corpuses. This data set is freely available on Amazon S3 in a Hadoop friendly file format and is licensed under a Creative Commons Attribution 3.0 Unported License. The original dataset is available from http://books.google.com/ngrams/. Human Liver Cohort (Sage Bionetworks) \u4eba\u7c7b\u809d\u810f\u57fa\u56e0\u8868\u8fbe Human Liver Cohort characterizing gene expression in liver samples Human Microbiome Project \u4eba\u4f53\u5fae\u751f\u7269\u7fa4\u6570\u636e Human Microbiome Project Data Set Illumina \u2013 Jay Flatley (CEO of Illumina) Human Genome Data Set \u4eba\u4f53\u57fa\u56e0\u7ec4\u6570\u636e Jay Flatley (CEO of Illumina) human genome data set. Influenza Virus (including updated Swine Flu sequences) \u6d41\u611f\u75c5\u6bd2\u6570\u636e NCBI Influenza Resource Center Data. Japan Census Data \u65e5\u672c\u4eba\u53e3\u7edf\u8ba1\u6570\u636e Multiple data sets including: (1) Population Census of Japan (1995, 2000, 2005, 2010), (2) Establishment and Enterprise Census of Japan (1999, 2001, 2004, 2006), and (3) Economic Census of Japan (2009). Labor Statistics Databases \u7f8e\u56fd\u52b3\u5de5\u90e8\u7684\u7edf\u8ba1\u6570\u636e Various Labor Statistics M-Lab dataset: Network Diagnostic Tool (NDT) 2009\u5e74\u4e92\u8054\u7f51\u6027\u80fd\uff08\u5982\u7f51\u901f\uff09\u8bca\u65ad\u6570\u636e NDT test results created through Measurement Lab (M-Lab) between February 2009 and September 2009 M-Lab dataset: Network Path and Application Diagnosis tool (NPAD) 2009\u5e74\u4e92\u8054\u7f51\u8def\u7531\uff0c\u5305\u5934\u7b49\u6d4b\u8bd5\u6570\u636e NPAD test results created through Measurement Lab (M-Lab) between February 2009 and September 2009 Marvel Universe Social Graph \u4e00\u4e2a\u865a\u62df\u7684\u793e\u4ea4\u7f51\u7edc\u5173\u7cfb\u56fe This dataset is an example of a social collaboration network based on the characters in The Marvel Universe, that is, the artificial world that takes place in the universe of the Marvel comic books. Material Safety Data Sheets \u6750\u6599\u5b89\u5168\u6570\u636e 230,000 Material Safety Data Sheets. Million Song Dataset \u767e\u4e07\u6b4c\u66f2\u6570\u636e The Million Songs Collection is a collection of 28 datasets containing audio features and metadata for a million contemporary popular music tracks. Million Song Sample Dataset \u767e\u4e07\u6b4c\u66f2\u6570\u636e\u5e93\u76841\u4e07\u5b50\u96c6 This is a 10,000 song subset of audio features and metadata from the Million Songs collection \u2013 a collection of 28 datasets containing audio features and metadata for a million contemporary popular music tracks. Model Organism Encyclopedia of DNA Elements (modENCODE) \u6a21\u5f0f\u751f\u7269\u751f\u547d\u767e\u79d1\u5168\u4e66 A collection of data from the modENCODE project ( http://www.modencode.org ) NASA NEX NASA\u7684\u5730\u7403\u536b\u661f\u5730\u56fe\u4e0e\u6c14\u5019\u53d8\u8fc1 Three NASA NEX datasets are now available, including climate projections and satellite images of Earth. OpenStreetMap Rendering Database \u5f00\u6e90\u7684\u5168\u7403\u5730\u56fe\u6570\u636e A PostGIS 8.3 data cluster of all OpenStreetMap data for the planet. Petroleum Public Data Set (working Title) \u77f3\u6cb9\u6570\u636e Public-domain data for the oil & gas industry, assembled from the contributions of participating agencies in the United States, Canada and around the world. This data provides industry stakeholders with an opportunity to focus their efforts on the analysis and interpretation of this data without concern for the trivial and time-consuming tasks of locating, downloading, reformatting and integrating the data prior to value-added work being performed. PubChem Library \u6709\u673a\u5c0f\u5206\u5b50\u751f\u7269\u6d3b\u6027\u6570\u636e A data set of information on the biological activities of small molecules. Sloan Digital Sky Survey DR6 Subset \u65af\u9686\u6570\u5b57\u5316\u5de1\u5929 The Sloan Digital Sky Survey is the most ambitious astronomical survey ever undertaken. The Cannabis Sativa Genome \u5927\u9ebb\u57fa\u56e0 Whole Genome Shotgun Sequencing of the Cannabis Sativa Cultivar \u201cChemdawg\u201d The WestburyLab USENET corpus 4\u4e07\u591a\u4e2aUSENET\u65b0\u95fb\u7ec4\u6570\u636e The WestburyLab USENET corpus is an anonymized compilation of postings from 47,860 English-language newsgroups from 2005-2010. Transportation Databases \u7f8e\u56fd\u4ea4\u901a\u90e8\u7684\u822a\u7a7a\uff0c\u822a\u6d77\uff0c\u516c\u8def\uff0c\u94c1\u8def\uff0c\u7ba1\u9053\uff0c\u81ea\u884c\u8f66\u7b49\u7edf\u8ba1\u6570\u636e Various transportation statistics Twilio/Wigle.net Street Vector Data Set \u5b8c\u6574\u7684\u7f8e\u56fd\u8857\u9053\u540d\u4e0e\u5730\u5740 Twilio/Wigle.net database of mapped US street names and address ranges. Unigene NCBI\u7684\u8f6c\u5f55\u7ec4\u6570\u636e\u5e93 UniGene: An Organized View of the Transcriptome. University of Florida Sparse Matrix Collection \u4f5b\u7f57\u91cc\u8fbe\u5927\u5b66\u7684\u7a00\u758f\u77e9\u9635\u6570\u636e\u96c6 The University of Florida Sparse Matrix Collection is a large, widely available, and actively growing set of sparse matrices that arise in real applications. Wikipedia Extraction (WEX) \u7ef4\u57fa\u767e\u79d1\u7528Freebase\u589e\u5f3a\u8fc7\u7684\u7ed3\u6784\u5316\u6570\u636e A processed dump of the English language Wikipedia Wikipedia Page Traffic Statistic V3 \u7ef4\u57fa\u767e\u79d12011\u5e743\u4e2a\u6708\u7684\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf This dataset contains a 150 GB sample of the data used to power trendingtopics.org . It includes a full 3 months of hourly page traffic statistics from Wikipedia (1/1/2011-3/31/2011). Wikipedia Page Traffic Statistics \u7ef4\u57fa\u767e\u79d12009\u5e747\u4e2a\u6708\u7684\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf Contains 7 months of hourly pageview statistics for all articles in Wikipedia Wikipedia Traffic Statistics V2 \u7ef4\u57fa\u767e\u79d12009-2010\u5e7416\u4e2a\u6708\u6309\u5c0f\u65f6\u8bbf\u95ee\u91cf Contains 16 months of hourly pageview statistics for all articles in Wikipedia Wikipedia XML Data \u7ef4\u57fa\u767e\u79d12009\u7248\uff0cXML\u683c\u5f0f A complete copy of all Wikimedia wikis, in the form of wikitext source and metadata embedded in XML. YRI Trio Dataset \u4e09\u4e2a\u7ea6\u9c81\u5df4\u4eba\u7684\u5b8c\u6574\u57fa\u56e0\u7ec4 Complete genome sequence data for three Yoruba individuals from Ibadan, Nigeria","title":"\u4e00\u4e9b\u6709\u610f\u601d\u7684\u6570\u636e\u96c6"},{"location":"blogs/2020-02-21-keep-ssh-alive/","text":"\u89e3\u51b3ssh\u8fde\u63a5\u670d\u52a1\u5668\u6389\u7ebf\u95ee\u9898 \u6211\u4eec\u90fd\u7ecf\u5386\u8fc7ssh\u8fde\u4e0a\u670d\u52a1\u5668\uff0c\u8fc7\u6bb5\u65f6\u95f4\u6ca1\u64cd\u4f5c\uff0c\u5c31\u81ea\u52a8\u65ad\u5f00\u4e86\uff0c\u6709\u65f6\u5019\u53ef\u80fd\u662f\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4fee\u6539\u4ee3\u7801\uff0c\u4e00\u4e0b\u5b50\u50bb\u4e86\uff0c\u5f53\u7136\u6211\u4eec\u4e0d\u63a8\u8350\u957f\u65f6\u95f4\u5728\u7ebf\u4fee\u6539\u4ee3\u7801\uff1a\uff09 -- D.C OpenSSH\u57fa\u4e8e\u5b89\u5168\u7684\u7406\u7531\uff0c\u5982\u679c\u7528\u6237\u8fde\u7ebf\u5230SSH Server\u540e\u95f2\u7f6e\u4e00\u6bb5\u65f6\u95f4\uff0cSSH Server\u4f1a\u5728\u8d85\u8fc7\u7279\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u7ec8\u6b62SSH\u8fde\u7ebf\u3002 \u4ee5\u4e0b\u65b9\u6cd5\uff0c\u4e2a\u4eba\u63a8\u8350\u7b2c2,3\u79cd\uff0c\u4fee\u6539\u6bcf\u53f0\u670d\u52a1\u5668\u771f\u7684\u5f88\u70e6\u5167~ \u65b9\u6cd51-\u4fee\u6539\u670d\u52a1\u5668\u7684sshd_config \u8fdb\u5230ssh\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u53d1\u73b0\u6709ssh_config\u548csshd_config\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\u4e8c\u8005\u533a\u522b\u5728\u4e8e\uff0cssh_config\u662f\u9488\u5bf9\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0csshd_config\u5219\u662f\u9488\u5bf9\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u3002 $ cd /etc/ssh $ sudo vi /etc/ssh/sshd_config \u627e\u5230\u5185\u5bb9\uff0c\u53bb\u6389\u6ce8\u91ca\u5e76\u4fee\u6539\u5982\u4e0b\uff1a # \u5ba2\u6237\u7aef\u6bcf\u9694\u591a\u5c11\u79d2\u5411\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\u6570\u636e ClientAliveInterval 30 # \u8868\u793a\u4e0a\u8ff0\u591a\u5c11\u6b21\u5fc3\u8df3\u65e0\u54cd\u5e94\u4e4b\u540e\uff0c\u4f1a\u8ba4\u4e3aClient\u5df2\u7ecf\u65ad\u5f00\u3002 ClientAliveCountMax 1800 \u4fdd\u5b58\u5e76\u91cd\u542f\u670d\u52a1\u3002 $ service sshd restart \u65b9\u6cd52-\u4fee\u6539\u672c\u673a\u7684ssh_config \u6253\u5f00\u672c\u673a\u7684ssh_config\u6587\u4ef6\u3002 sudo vi /etc/ssh/ssh_config \u6dfb\u52a0\u5185\u5bb9\u5982\u4e0b\uff1a TCPKeepAlive=yes ServerAliveInterval 60 ServerAliveCountMax 600 StrictHostKeyChecking no ForwardAgent yes Compression yes \u4fdd\u5b58\uff0c\u91cd\u8fdeec2\u3002 \u65b9\u6cd53- \u5229\u7528\u5ba2\u6237\u7aef\u7684\u53cd\u65ad\u5f00\u529f\u80fd tmux\uff1a \u7ec8\u7aef\u590d\u7528\u795e\u5668! \u8fd9\u4e2a\u7ec8\u7aef\u91cc\u9762\u8fd0\u884c\u7684\u6240\u6709\u7a0b\u5e8f\uff0c\u53ea\u8981\u4f60\u4e0d\u5173\u7535\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u4e00\u76f4\u8fd0\u884c\uff0c\u800c\u4e14\u4f60\u5f53\u4f60ssh\u65ad\u5f00\u518d\u91cd\u65b0\u8fde\u4e0a\u7684\u65f6\u5019\u4f1a\u63a5\u7740\u4ee5\u524d\u7684\u5730\u65b9\u3002tmux\u662flinux or Mac\uff0c\u5982\u679c\u662fwindows\uff0c\u53ef\u4ee5\u7528cmder+tmux\uff0c\u6216\u53c2\u8003 \u8fd9\u91cc \uff08\u611f\u8c22\u5927\u795eJJF\u63a8\u8350\uff09 MobaXterm: edit session - Advanced SSH settings - \u9009\u4e2d Do not exit after command ends \u3002 gitbash\uff1a\u4fee\u6539 C:\\Program Files\\Git\\etc\\ssh\\ssh_config \u3002 secureCRT\uff1a\u4f1a\u8bdd\u9009\u9879 - \u7ec8\u7aef - \u53cd\u7a7a\u95f2 - \u53d1\u9001NO-OP\u6bcfxxx\u79d2\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 putty\uff1aConnection - Seconds between keepalive(0 to turn off)\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 iTerm2\uff1aprofiles - sessions - When idle - send ASCII code. XShell\uff1asession properties - connection - Keep Alive - Send keep alive message while this session connected. Interval [xxx] sec. \u4ee5\u4e0a\u8f6f\u4ef6\u6ca1\u5168\u90e8test\u8fc7\uff0c\u4ec5\u57fa\u4e8e\u5bf9\u8f6f\u4ef6\u5f00\u53d1\u56e2\u961f\u7684\u4fe1\u4efb :) \u5173\u4e8etmux \u8981\u6ce8\u610f\uff0ctmux\u662f\u5b89\u88c5\u5728\u670d\u52a1\u5668\u4e0a\u7684\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3ascreen\u7684\u8fdb\u5316\u66ff\u4ee3\u8005\uff0c\u6240\u4ee5\u63a8\u8350\u5728ec2\u7684\u8df3\u677f\u673a\u4e0a\u5b89\u88c5\uff0c\u518d\u8df3\u5230\u5176\u4ed6\u673a\u5668\u3002 \u57fa\u672c\u6982\u5ff5\u662f\uff1asession > window > Pane $ sudo yum install tmux $ vi ~/.tmux.conf \u5199\u5165\u4e0b\u5217\u5185\u5bb9\uff0c\u4fdd\u5b58\u9000\u51fa\u3002 # Send prefix set-option -g prefix C-a unbind-key C-a bind-key C-a send-prefix # Use Alt-arrow keys to switch panes bind -n M-Left select-pane -L bind -n M-Right select-pane -R bind -n M-Up select-pane -U bind -n M-Down select-pane -D # Shift arrow to switch windows bind -n S-Left previous-window bind -n S-Right next-window # use vim mode to edit #setw -g mode-keys vi # Mouse mode #set -g mouse on set -g mode-mouse on set -g mouse-resize-pane on set -g mouse-select-pane on set -g mouse-select-window on # Set easier window split keys bind-key v split-window -h bind-key h split-window -v # Easy config reload bind-key r source-file ~/.tmux.conf \\; display-message \"tmux.conf reloaded\" \u8bbe\u7f6econfig\u4e4b\u540e\u7684\u5e38\u7528\u547d\u4ee4\uff0c\u8bb0\u4f4f\u6240\u6709tmux\u5f00\u5934\u7684\u547d\u4ee4\u90fd\u662f\u5728\u5916\u9762shell\u91cc\uff0c\u6240\u6709 prefix \u5f00\u5934\u7684\u90fd\u662f\u5728session\u91cc\uff1a prefix : ctrl + a (\u540c\u65f6\u6309\uff0c\u653e\u5f00\uff0c\u518d\u6309\u529f\u80fd\u952e) tmux new -s <session name> -t <window name> :\u65b0\u5efa\u5e76\u547d\u540d\uff0c\u61d2\u4eba\u76f4\u63a5 tmux new tmux ls : \u8fd9\u4e2a\u547d\u4ee4\u662f\u5728\u5916\u9762\u7684terminal\u91cc\u8f93\u5165\u7684\u3002\u5f53\u524d\u6b63\u5e38\u8fd0\u4f5c\u4e2d\u7684tmux server\u4f1a\u663e\u793a\uff08attached\uff09\u3002\u6ca1\u6709\u7684\u8bdd\u5c31\u662f\u5df2\u5173\u95ed\uff0ctmux server\u5728\u540e\u53f0\u8fd0\u884c\u3002 prefix + d : \u6302\u8d77session,\u56de\u5230\u5916\u9762\u7684shell\u3002 prefix + : : \u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\uff0c\u6b64\u65f6\u53ef\u4ee5\u8f93\u5165\u652f\u6301\u7684\u547d\u4ee4\uff0c\u4f8b\u5982kill-server\u53ef\u4ee5\u5173\u95edtmux\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u547d\u4ee4\u7f51\u4e0a\u90fd\u6709\u3002 tmux a -t py : \u91cd\u65b0\u8fde\u63a5\u540d\u5b57\u4e3apy\u7684session\u3002\u8fd9\u91cc\u7684a\u662fattach\u7684\u610f\u601d tmux a : \u5982\u679c\u53ea\u6709\u4e00\u4e2asession\u7684\u8bdd\uff0c\u8fd9\u4e2a\u662f\u6700\u5feb\u7684\u8fde\u63a5\u65b9\u6cd5 prefix + $ : \u66f4\u540d\u540e\u597d\u8ba9\u81ea\u5df1\u77e5\u9053\u6bcf\u4e00\u4e2asession\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\u3002\u901a\u5e38\u4e00\u4e2asession\u5bf9\u5e94\u4e00\u4e2aproject tmux kill-session -a -t py : \u5728\u5916\u9762\u8f93\u5165\uff0c\u5220\u9664\u9664\u4e86py\u4ee5\u5916\u7684\u6240\u6709session alt+\u7bad\u5934\u5728pane\u4e4b\u95f4\u5207\u6362 shift+\u7bad\u5934\u5728window\u4e4b\u95f4\u5207\u6362 \u7528\u9f20\u6807\u70b9\u51fb\u5207\u6362window\uff0cpane\uff0c\u8c03\u6574pane\u7684\u5927\u5c0f \u65b9\u4fbf\u5207\u5206pane\u7684\u3002prefix + v \u4ee3\u8868\u7ad6\u7740\u5207\uff0cprefix + h \u4ee3\u8868\u6a2a\u7740\u5207\u3002 \u5982\u679c\u5728\u5f00\u7740tmux\u60c5\u51b5\u4e0b\u4fee\u6539\u4e86.tmux.conf\u7684\u8bbe\u7f6e\u7684\u8bdd\uff0c\u4e0d\u7528\u5173\u6389tmux\u3002\u76f4\u63a5\u7528prefix+r,\u5c31\u80fd\u91cd\u65b0\u52a0\u8f7d\u8bbe\u7f6e\u3002 vim \u7f16\u8f91\u547d\u4ee4\uff0c\u88c5B\u4e4b\u8def\u4e0d\u8f7b\u677e: vi emacs \u529f\u80fd vi emacs \u529f\u80fd ^ M-m \u53cd\u7f29\u8fdb Escape C-g \u6e05\u9664\u9009\u5b9a\u5185\u5bb9 Enter M-w \u590d\u5236\u9009\u5b9a\u5185\u5bb9 j Down \u5149\u6807\u4e0b\u79fb h Left \u5149\u6807\u5de6\u79fb l Right \u5149\u6807\u53f3\u79fb L \u5149\u6807\u79fb\u5230\u5c3e\u884c M M-r \u5149\u6807\u79fb\u5230\u4e2d\u95f4\u884c H M-R \u5149\u6807\u79fb\u5230\u9996\u884c k Up \u5149\u6807\u4e0a\u79fb d C-u \u5220\u9664\u6574\u884c D C-k \u5220\u9664\u5230\u884c\u672b $ C-e \u79fb\u5230\u884c\u5c3e :\u6570\u5b57 g \u524d\u5f80\u6307\u5b9a\u884c C -d M-Down \u5411\u4e0b\u6eda\u52a8\u534a\u5c4f C -u M-Up \u5411\u4e0a\u6eda\u52a8\u534a\u5c4f C -f Page down \u4e0b\u4e00\u9875 w M-f \u4e0b\u4e00\u4e2a\u8bcd p C-y \u7c98\u8d34 C -b Page up \u4e0a\u4e00\u9875 b M-b \u4e0a\u4e00\u4e2a\u8bcd q Escape \u9000\u51fa C -Down or J C-Down \u5411\u4e0b\u7ffb C -Up or K C-Up \u5411\u4e0b\u7ffb n n \u7ee7\u7eed\u641c\u7d22 ? C-r \u5411\u524d\u641c\u7d22 / C-s \u5411\u540e\u641c\u7d22 0 C-a \u79fb\u5230\u884c\u9996 Space C-Space \u5f00\u59cb\u9009\u4e2d C-t \u5b57\u7b26\u8c03\u5e8f Always ask yourself lonely: what's the fact?","title":"\u89e3\u51b3ssh\u8fde\u63a5\u670d\u52a1\u5668\u6389\u7ebf\u95ee\u9898"},{"location":"blogs/2020-02-21-keep-ssh-alive/#ssh","text":"\u6211\u4eec\u90fd\u7ecf\u5386\u8fc7ssh\u8fde\u4e0a\u670d\u52a1\u5668\uff0c\u8fc7\u6bb5\u65f6\u95f4\u6ca1\u64cd\u4f5c\uff0c\u5c31\u81ea\u52a8\u65ad\u5f00\u4e86\uff0c\u6709\u65f6\u5019\u53ef\u80fd\u662f\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4fee\u6539\u4ee3\u7801\uff0c\u4e00\u4e0b\u5b50\u50bb\u4e86\uff0c\u5f53\u7136\u6211\u4eec\u4e0d\u63a8\u8350\u957f\u65f6\u95f4\u5728\u7ebf\u4fee\u6539\u4ee3\u7801\uff1a\uff09 -- D.C OpenSSH\u57fa\u4e8e\u5b89\u5168\u7684\u7406\u7531\uff0c\u5982\u679c\u7528\u6237\u8fde\u7ebf\u5230SSH Server\u540e\u95f2\u7f6e\u4e00\u6bb5\u65f6\u95f4\uff0cSSH Server\u4f1a\u5728\u8d85\u8fc7\u7279\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u7ec8\u6b62SSH\u8fde\u7ebf\u3002 \u4ee5\u4e0b\u65b9\u6cd5\uff0c\u4e2a\u4eba\u63a8\u8350\u7b2c2,3\u79cd\uff0c\u4fee\u6539\u6bcf\u53f0\u670d\u52a1\u5668\u771f\u7684\u5f88\u70e6\u5167~","title":"\u89e3\u51b3ssh\u8fde\u63a5\u670d\u52a1\u5668\u6389\u7ebf\u95ee\u9898"},{"location":"blogs/2020-02-21-keep-ssh-alive/#1-sshd_config","text":"\u8fdb\u5230ssh\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u53d1\u73b0\u6709ssh_config\u548csshd_config\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\u4e8c\u8005\u533a\u522b\u5728\u4e8e\uff0cssh_config\u662f\u9488\u5bf9\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0csshd_config\u5219\u662f\u9488\u5bf9\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u3002 $ cd /etc/ssh $ sudo vi /etc/ssh/sshd_config \u627e\u5230\u5185\u5bb9\uff0c\u53bb\u6389\u6ce8\u91ca\u5e76\u4fee\u6539\u5982\u4e0b\uff1a # \u5ba2\u6237\u7aef\u6bcf\u9694\u591a\u5c11\u79d2\u5411\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\u6570\u636e ClientAliveInterval 30 # \u8868\u793a\u4e0a\u8ff0\u591a\u5c11\u6b21\u5fc3\u8df3\u65e0\u54cd\u5e94\u4e4b\u540e\uff0c\u4f1a\u8ba4\u4e3aClient\u5df2\u7ecf\u65ad\u5f00\u3002 ClientAliveCountMax 1800 \u4fdd\u5b58\u5e76\u91cd\u542f\u670d\u52a1\u3002 $ service sshd restart","title":"\u65b9\u6cd51-\u4fee\u6539\u670d\u52a1\u5668\u7684sshd_config"},{"location":"blogs/2020-02-21-keep-ssh-alive/#2-ssh_config","text":"\u6253\u5f00\u672c\u673a\u7684ssh_config\u6587\u4ef6\u3002 sudo vi /etc/ssh/ssh_config \u6dfb\u52a0\u5185\u5bb9\u5982\u4e0b\uff1a TCPKeepAlive=yes ServerAliveInterval 60 ServerAliveCountMax 600 StrictHostKeyChecking no ForwardAgent yes Compression yes \u4fdd\u5b58\uff0c\u91cd\u8fdeec2\u3002","title":"\u65b9\u6cd52-\u4fee\u6539\u672c\u673a\u7684ssh_config"},{"location":"blogs/2020-02-21-keep-ssh-alive/#3-","text":"tmux\uff1a \u7ec8\u7aef\u590d\u7528\u795e\u5668! \u8fd9\u4e2a\u7ec8\u7aef\u91cc\u9762\u8fd0\u884c\u7684\u6240\u6709\u7a0b\u5e8f\uff0c\u53ea\u8981\u4f60\u4e0d\u5173\u7535\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u4e00\u76f4\u8fd0\u884c\uff0c\u800c\u4e14\u4f60\u5f53\u4f60ssh\u65ad\u5f00\u518d\u91cd\u65b0\u8fde\u4e0a\u7684\u65f6\u5019\u4f1a\u63a5\u7740\u4ee5\u524d\u7684\u5730\u65b9\u3002tmux\u662flinux or Mac\uff0c\u5982\u679c\u662fwindows\uff0c\u53ef\u4ee5\u7528cmder+tmux\uff0c\u6216\u53c2\u8003 \u8fd9\u91cc \uff08\u611f\u8c22\u5927\u795eJJF\u63a8\u8350\uff09 MobaXterm: edit session - Advanced SSH settings - \u9009\u4e2d Do not exit after command ends \u3002 gitbash\uff1a\u4fee\u6539 C:\\Program Files\\Git\\etc\\ssh\\ssh_config \u3002 secureCRT\uff1a\u4f1a\u8bdd\u9009\u9879 - \u7ec8\u7aef - \u53cd\u7a7a\u95f2 - \u53d1\u9001NO-OP\u6bcfxxx\u79d2\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 putty\uff1aConnection - Seconds between keepalive(0 to turn off)\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\u3002 iTerm2\uff1aprofiles - sessions - When idle - send ASCII code. XShell\uff1asession properties - connection - Keep Alive - Send keep alive message while this session connected. Interval [xxx] sec. \u4ee5\u4e0a\u8f6f\u4ef6\u6ca1\u5168\u90e8test\u8fc7\uff0c\u4ec5\u57fa\u4e8e\u5bf9\u8f6f\u4ef6\u5f00\u53d1\u56e2\u961f\u7684\u4fe1\u4efb :)","title":"\u65b9\u6cd53- \u5229\u7528\u5ba2\u6237\u7aef\u7684\u53cd\u65ad\u5f00\u529f\u80fd"},{"location":"blogs/2020-02-21-keep-ssh-alive/#tmux","text":"\u8981\u6ce8\u610f\uff0ctmux\u662f\u5b89\u88c5\u5728\u670d\u52a1\u5668\u4e0a\u7684\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3ascreen\u7684\u8fdb\u5316\u66ff\u4ee3\u8005\uff0c\u6240\u4ee5\u63a8\u8350\u5728ec2\u7684\u8df3\u677f\u673a\u4e0a\u5b89\u88c5\uff0c\u518d\u8df3\u5230\u5176\u4ed6\u673a\u5668\u3002 \u57fa\u672c\u6982\u5ff5\u662f\uff1asession > window > Pane $ sudo yum install tmux $ vi ~/.tmux.conf \u5199\u5165\u4e0b\u5217\u5185\u5bb9\uff0c\u4fdd\u5b58\u9000\u51fa\u3002 # Send prefix set-option -g prefix C-a unbind-key C-a bind-key C-a send-prefix # Use Alt-arrow keys to switch panes bind -n M-Left select-pane -L bind -n M-Right select-pane -R bind -n M-Up select-pane -U bind -n M-Down select-pane -D # Shift arrow to switch windows bind -n S-Left previous-window bind -n S-Right next-window # use vim mode to edit #setw -g mode-keys vi # Mouse mode #set -g mouse on set -g mode-mouse on set -g mouse-resize-pane on set -g mouse-select-pane on set -g mouse-select-window on # Set easier window split keys bind-key v split-window -h bind-key h split-window -v # Easy config reload bind-key r source-file ~/.tmux.conf \\; display-message \"tmux.conf reloaded\" \u8bbe\u7f6econfig\u4e4b\u540e\u7684\u5e38\u7528\u547d\u4ee4\uff0c\u8bb0\u4f4f\u6240\u6709tmux\u5f00\u5934\u7684\u547d\u4ee4\u90fd\u662f\u5728\u5916\u9762shell\u91cc\uff0c\u6240\u6709 prefix \u5f00\u5934\u7684\u90fd\u662f\u5728session\u91cc\uff1a prefix : ctrl + a (\u540c\u65f6\u6309\uff0c\u653e\u5f00\uff0c\u518d\u6309\u529f\u80fd\u952e) tmux new -s <session name> -t <window name> :\u65b0\u5efa\u5e76\u547d\u540d\uff0c\u61d2\u4eba\u76f4\u63a5 tmux new tmux ls : \u8fd9\u4e2a\u547d\u4ee4\u662f\u5728\u5916\u9762\u7684terminal\u91cc\u8f93\u5165\u7684\u3002\u5f53\u524d\u6b63\u5e38\u8fd0\u4f5c\u4e2d\u7684tmux server\u4f1a\u663e\u793a\uff08attached\uff09\u3002\u6ca1\u6709\u7684\u8bdd\u5c31\u662f\u5df2\u5173\u95ed\uff0ctmux server\u5728\u540e\u53f0\u8fd0\u884c\u3002 prefix + d : \u6302\u8d77session,\u56de\u5230\u5916\u9762\u7684shell\u3002 prefix + : : \u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\uff0c\u6b64\u65f6\u53ef\u4ee5\u8f93\u5165\u652f\u6301\u7684\u547d\u4ee4\uff0c\u4f8b\u5982kill-server\u53ef\u4ee5\u5173\u95edtmux\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u547d\u4ee4\u7f51\u4e0a\u90fd\u6709\u3002 tmux a -t py : \u91cd\u65b0\u8fde\u63a5\u540d\u5b57\u4e3apy\u7684session\u3002\u8fd9\u91cc\u7684a\u662fattach\u7684\u610f\u601d tmux a : \u5982\u679c\u53ea\u6709\u4e00\u4e2asession\u7684\u8bdd\uff0c\u8fd9\u4e2a\u662f\u6700\u5feb\u7684\u8fde\u63a5\u65b9\u6cd5 prefix + $ : \u66f4\u540d\u540e\u597d\u8ba9\u81ea\u5df1\u77e5\u9053\u6bcf\u4e00\u4e2asession\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\u3002\u901a\u5e38\u4e00\u4e2asession\u5bf9\u5e94\u4e00\u4e2aproject tmux kill-session -a -t py : \u5728\u5916\u9762\u8f93\u5165\uff0c\u5220\u9664\u9664\u4e86py\u4ee5\u5916\u7684\u6240\u6709session alt+\u7bad\u5934\u5728pane\u4e4b\u95f4\u5207\u6362 shift+\u7bad\u5934\u5728window\u4e4b\u95f4\u5207\u6362 \u7528\u9f20\u6807\u70b9\u51fb\u5207\u6362window\uff0cpane\uff0c\u8c03\u6574pane\u7684\u5927\u5c0f \u65b9\u4fbf\u5207\u5206pane\u7684\u3002prefix + v \u4ee3\u8868\u7ad6\u7740\u5207\uff0cprefix + h \u4ee3\u8868\u6a2a\u7740\u5207\u3002 \u5982\u679c\u5728\u5f00\u7740tmux\u60c5\u51b5\u4e0b\u4fee\u6539\u4e86.tmux.conf\u7684\u8bbe\u7f6e\u7684\u8bdd\uff0c\u4e0d\u7528\u5173\u6389tmux\u3002\u76f4\u63a5\u7528prefix+r,\u5c31\u80fd\u91cd\u65b0\u52a0\u8f7d\u8bbe\u7f6e\u3002 vim \u7f16\u8f91\u547d\u4ee4\uff0c\u88c5B\u4e4b\u8def\u4e0d\u8f7b\u677e: vi emacs \u529f\u80fd vi emacs \u529f\u80fd ^ M-m \u53cd\u7f29\u8fdb Escape C-g \u6e05\u9664\u9009\u5b9a\u5185\u5bb9 Enter M-w \u590d\u5236\u9009\u5b9a\u5185\u5bb9 j Down \u5149\u6807\u4e0b\u79fb h Left \u5149\u6807\u5de6\u79fb l Right \u5149\u6807\u53f3\u79fb L \u5149\u6807\u79fb\u5230\u5c3e\u884c M M-r \u5149\u6807\u79fb\u5230\u4e2d\u95f4\u884c H M-R \u5149\u6807\u79fb\u5230\u9996\u884c k Up \u5149\u6807\u4e0a\u79fb d C-u \u5220\u9664\u6574\u884c D C-k \u5220\u9664\u5230\u884c\u672b $ C-e \u79fb\u5230\u884c\u5c3e :\u6570\u5b57 g \u524d\u5f80\u6307\u5b9a\u884c C -d M-Down \u5411\u4e0b\u6eda\u52a8\u534a\u5c4f C -u M-Up \u5411\u4e0a\u6eda\u52a8\u534a\u5c4f C -f Page down \u4e0b\u4e00\u9875 w M-f \u4e0b\u4e00\u4e2a\u8bcd p C-y \u7c98\u8d34 C -b Page up \u4e0a\u4e00\u9875 b M-b \u4e0a\u4e00\u4e2a\u8bcd q Escape \u9000\u51fa C -Down or J C-Down \u5411\u4e0b\u7ffb C -Up or K C-Up \u5411\u4e0b\u7ffb n n \u7ee7\u7eed\u641c\u7d22 ? C-r \u5411\u524d\u641c\u7d22 / C-s \u5411\u540e\u641c\u7d22 0 C-a \u79fb\u5230\u884c\u9996 Space C-Space \u5f00\u59cb\u9009\u4e2d C-t \u5b57\u7b26\u8c03\u5e8f Always ask yourself lonely: what's the fact?","title":"\u5173\u4e8etmux"},{"location":"blogs/2020-03-15-aws-backup/","text":"\u96c6\u4e2d\u5f0f\u5907\u4efd\u7ba1\u7406\u670d\u52a1AWS Backup \u4e4b\u524d\u7ed9\u540c\u5b66\u4eec\u4ecb\u7ecd\u8fc7\u5982\u4f55\u7ed9ebs\u521b\u5efa\u5feb\u7167\uff0c\u6709\u7528\u5230ec2\u4ee3\u7406\u7684\uff0c\u6709\u7528\u5230\u65e0\u670d\u52a1\u5668\u670d\u52a1lambda\u7684\uff0c\u73b0\u5728\u968f\u7740aws backup\u670d\u52a1\u5728\u56fd\u5185\u7684\u843d\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u4f7f\u7528\u8fd9\u4e2a\u96c6\u4e2d\u5f0f\u7684\u5907\u4efd\u7ba1\u7406\u670d\u52a1\u5566\uff0c\u800c\u4e14\u4e0d\u4ec5\u4ec5\u662febs\u5377\u54e6\uff01 -- D.C \u5148\u770b\u4e0baws backup \u652f\u6301\u7684\u5907\u4efd\u670d\u52a1\uff1a \u652f\u6301\u7684\u670d\u52a1 \u652f\u6301\u7684\u8d44\u6e90 Amazon Elastic File System (Amazon EFS) Amazon EFS \u6587\u4ef6\u7cfb\u7edf Amazon DynamoDB (DynamoDB) DynamoDB \u8868 Amazon Elastic Block Store (Amazon EBS) Amazon EBS \u5377 Amazon Relational Database Service (Amazon RDS) Amazon RDS \u6570\u636e\u5e93* AWS Storage Gateway\uff08\u5377\u7f51\u5173\uff09 AWS Storage Gateway \u5377 *AWS Backup \u5f53\u524d\u652f\u6301\u9664\u4e86 Amazon Aurora \u4e4b\u5916\u7684\u6240\u6709 Amazon RDS \u6570\u636e\u5e93\u5f15\u64ce\u3002 \u6709\u4e9b\u540c\u5b66\u4f1a\u95ee\uff0c\u4e3a\u5565\u4e0d\u652f\u6301Aurora\u554a\uff0c\u4e0d\u662f\u53f7\u79f0\u771f\u6b63\u4e91\u539f\u751f\u7684\u6570\u636e\u5e93\u4e48\uff1f\u5176\u5b9e\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u90fd\u8bf4\u4e86\u662f\u4e91\u539f\u751f\u4e86\uff0c\u4eba\u5bb6\u81ea\u5e266\u526f\u672c\uff0c\u4e14\u81ea\u52a8\u6269\u5c55\u81ea\u52a8\u5907\u4efd\uff0c\u4e0d\u9700\u8981\u501f\u52a9\u5916\u90e8\u670d\u52a1\u4e86\u3002 \u518d\u5f3a\u8c03\u4e00\u70b9\uff0caws\u7684\u5907\u4efd\u90fd\u662f\u589e\u91cf\u5907\u4efd\uff0c\u4e0d\u662f\u7b80\u5355\u7684double\u5173\u7cfb\u3002\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u770b\u56fe\u8bf4\u8bdd\uff1a \u627e\u5230backup \u767b\u5f55aws\u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u70b9\u51fb\u4e0a\u65b9 \u670d\u52a1 \uff0c\u641c\u7d22 backup , \u70b9\u51fb\u8fdb\u5165\u3002 \u521b\u5efa\u5907\u4efd\u8ba1\u5212 \u70b9\u51fb\u5de6\u4fa7\u5217\u8868\u7684 \u5907\u4efd\u8ba1\u5212 ,\u518d\u70b9\u51fb\u53f3\u4fa7\u754c\u9762\u7684 \u521b\u5efa\u5907\u4efd\u8ba1\u5212 \u3002 \u51fa\u73b0\u9009\u9879\uff0c\u6709\u4e09\u79cd\u5206\u522b\u662f\uff1a a. \u4ece\u73b0\u6709\u8ba1\u5212\u5f00\u59cb\uff1b # \u76f4\u63a5\u5728\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4e0a\u9762\u6539 b. \u521b\u5efa\u65b0\u8ba1\u5212\uff1b # \u5b8c\u5168\u521b\u5efa\u65b0\u7684 c. \u4f7f\u7528JSON\u5b9a\u4e00\u8ba1\u5212\uff1b # \u7528JSON\u6a21\u677f\u521b\u5efa\uff0c\u4e00\u822c\u662f\u522b\u4ebashare\u7ed9\u6211\u7684 \u8fd9\u91cc\u6211\u9009\u62e9\u4e00\u4e2a Daily-Monthly-1yr-Retension , \u8bdd\u8bf4\u53d6\u540d\u5b57\u771f\u7684\u592a\u91cd\u8981\u7684\uff0c\u5e0c\u671b\u5927\u5bb6\u90fd\u517b\u6210\u53d6\u540d\u5b57\u4e00\u76ee\u4e86\u7136\u7684\u597d\u4e60\u60ef\u3002\u6bd4\u5982\u8fd9\u4e2aplan\u7684\u610f\u601d\u662f\uff1a \u6bcf\u65e5\u5907\u4efd\uff0c\u6bcf\u6708\u5907\u4efd\uff0c\u4fdd\u5b58\u4e00\u5e74\u3002 \u5907\u4efd\u8ba1\u5212\u540d\u79f0\u6211\u5199\u6210 test \uff0c\u518d\u5f80\u4e0b\u770b\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2aplan\u5176\u5b9e\u662f\u5305\u62ec\u4e24\u6761\u89c4\u5219\uff1a DailyBackups \u548c Monthly \u3002 \u5148\u70b9 DailyBackups \u8fdb\u53bb\u770b\u4e0b(\u4e0b\u56fe)\uff0c\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6bcf\u5929\u5907\u4efd\u4e00\u6b21\uff0c\u521b\u5efa\u4e4b\u65e5\u8d77\u76845\u5468\u540e\u5907\u4efd\u5931\u6548\uff0c\u4e0d\u9700\u8981\u8f6c\u6362\u4e3a\u51b7\u5b58\u50a8\uff08EFS\u76d8\u53ef\u4ee5\u8bbe\u5b9a\u8f6c\u6210\u51b7\u5b58\u50a8\u964d\u4f4e\u6210\u672c\u54e6\uff01\uff09\u53e6\u5916\u6211\u4eec\u6ce8\u610f\u5230\u4e0b\u9762\u8fd8\u6709\u4e00\u4e2a\u9009\u9879 \u590d\u5236\u5230\u533a\u57df\uff08\u53ef\u9009\uff09 \uff0c\u610f\u601d\u662f\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u8de8\u533a\u57df\u5907\u4efd\uff0c\u5317\u4eac-\u5b81\u590f\u4e24\u5730\u5bb9\u707e\uff01 \u70b9\u4e0b\u9762\u7684 \u53d6\u6d88 \uff0c\u518d\u70b9\u51fb Monthly \u770b\u770b, \u539f\u6765\u8fd9\u91cc\u89c4\u5b9a\uff0c\u6bcf\u4e2a\u6708\u7684\u7b2c\u4e00\u5929\u8fdb\u884c\u5907\u4efd\uff0c1\u4e2a\u6708\u540e\u8f6c\u6210\u51b7\u5b58\u50a8\uff0c1\u5e74\u540e\u5907\u4efd\u8fc7\u671f\u3002 \u90a3\u4e48\u8fd9\u4e24\u4e2a\u5408\u5728\u4e00\u8d77\u53c8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6211\u7684\u7406\u89e3\u5982\u4e0b\uff1a a. \u9488\u5bf9\u6211\u4eec\u8981\u5907\u4efd\u7684\u8d44\u6e90\uff0c\u6bcf\u5929\u8fdb\u884c\u70ed\u5907\uff0c\u6c38\u8fdc\u4fdd\u7559\u6700\u8fd1\u4e00\u5468\u7684\u70ed\u5907\u3002 b. \u6bcf\u6708\u521d\u518d\u505a\u4e00\u6b21\u5907\u4efd\uff0c\u6c38\u8fdc\u4fdd\u7559\u5f53\u6708\u7684\u70ed\u5907\uff0c\u4ee5\u53ca\u8fd1\u4e00\u5e74\u7684\u51b7\u5907\u3002 \u5f53\u7136\uff0c\u8fd8\u5f97\u7ed3\u5408\u6211\u4eec\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\u6765\u8fdb\u884c\u53c2\u6570\u8c03\u6574\uff0c\u6700\u7ec8\u5f97\u5230\u6700\u9002\u5408\u6211\u4eec\u7684\u5907\u4efd\u5468\u671f\u3002\u6700\u540e\u7ed9\u8c03\u6574\u597d\u7684\u5907\u4efd\u8ba1\u5212\u6dfb\u52a0\u6807\u7b7e\u5982\uff1a ec2backup:pcluster , \u70b9\u51fb \u521b\u5efa\u8ba1\u5212 \uff0c\u8fd9\u6837\u8ba1\u5212\u5c31\u521b\u5efa\u597d\u4e86\u3002 \u70b9\u51fb test \u8fdb\u53bb\u540e\uff0c\u770b\u5230 \u8d44\u6e90\u5206\u914d \u90a3\u680f\u662f\u7a7a\u7684\uff0c\u6ca1\u9519\uff0c\u63a5\u4e0b\u53bb\u6211\u4eec\u5c31\u8981\u6dfb\u52a0\u7b49\u5f85\u5907\u4efd\u7684\u8d44\u6e90\u4e86\uff0c\u70b9\u51fb\u53f3\u8fb9\u7684 \u5206\u914d\u8d44\u6e90 \u3002 \u51fa\u6765\u8bbe\u7f6e\u754c\u9762\uff0c\u5199\u4e2a\u540d\u79f0\u5982 pcluster , IAM\u89d2\u8272\u4e0d\u7528\u6539\u4f1a\u81ea\u52a8\u914d\u7f6e\u7684\uff0c\u5728\u4e0b\u65b9\u7684 \u5206\u914d\u8d44\u6e90 \u680f\u76ee\uff0c\u6211\u4eec\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a a. \u6839\u636e\u6807\u7b7e\uff1a\u9009\u62e9\u6211\u4eec\u8981\u5907\u4efd\u76845\u7c7b\u8d44\u6e90\u8eab\u4e0a\u7684\u6807\u7b7e\uff0c\u6bd4\u5982\u6211\u7ed9\u4e00\u53f0EC2\u6253\u4e86\u4e2a\u6807\u7b7e Name:2.5.1 b. \u6839\u636e\u8d44\u6e90ID\uff1a\u9009\u62e9\u8d44\u6e90\u7c7b\u578b\uff0c\u70b9\u51fb \u8868\u540d\u79f0 \u7684\u6846\u5185\uff0c\u4f1a\u5217\u51fa\u5bf9\u5e94\u7684ID\uff0c\u9009\u62e9\u6211\u8981\u5907\u4efd\u7684\u90a3\u4e2a\u5c31\u884c\u4e86\u3002 \u70b9\u51fb \u5206\u914d\u8d44\u6e90 \uff0c\u8fd9\u6837\u5907\u4efd\u8ba1\u5212\u5c31\u5b8c\u6210\u4e86\u3002 \u67e5\u770b\u5907\u4efd\u4efb\u52a1 \u56de\u5230aws backup\u7684\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 \u4f5c\u4e1a \uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u8fc7\u53bb24\u5c0f\u65f6\u505a\u8fc7\u7684\u5907\u4efd\u4f5c\u4e1a\u3002 \u518d\u70b9\u51fb\u5de6\u4fa7\u7684 \u53d7\u4fdd\u62a4\u7684\u8d44\u6e90 \uff0c\u53ef\u4ee5\u770b\u5230\u6211\u7684\u4e00\u53f0EC2\u5df2\u7ecf\u5907\u4efd\u597d\u4e86\u3002 \u9a8c\u8bc1\u4e00\u4e0b\uff0c\u56de\u5230EC2\u63a7\u5236\u53f0\uff0c\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 AMI , ding~dong~, \u4ee5 AwsBackup \u5f00\u5934\u7684\u955c\u50cf\u597d\u597d\u7684\u8eba\u7740\u5462\uff0c\u6ca1\u95ee\u9898\uff01 \u8fd8\u539f\u5907\u4efd \u56de\u5230aws backup\u7684\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 \u53d7\u4fdd\u62a4\u7684\u8d44\u6e90 \uff0c\u70b9\u51fbinstance\u540d\u79f0\u8fdb\u53bb\uff0c\u9009\u4e2d \u5907\u4efd \u4e0b\u7684\u6062\u590d\u70b9ID\uff0c\u70b9\u51fb \u8fd8\u539f \u3002 \u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u6211\u6062\u590d\u7684\u662fAMI\uff0c\u5c31\u548c\u6211\u5728ec2\u63a7\u5236\u53f0\u9009\u4e2dAMI\u542f\u52a8\u5b9e\u4f8b\u662f\u4e00\u6837\u7684\uff0c\u5305\u62ec\u5b9e\u4f8b\u7c7b\u578b\u3001VPC\u3001\u5b50\u7f51\u3001\u5b89\u5168\u7ec4\uff0cIAM\uff0c\u9009\u62e9\u597d\u4e86\u4ee5\u540e\uff0c\u70b9\u51fb \u8fd8\u539f\u5907\u4efd \uff0c \u7136\u540e\u5c31\u53bbec2 \u754c\u9762\u67e5\u770b\u65b0\u8d77\u7684instance\u5427\u3002 \u6253\u5b8c\u6536\u5de5\u3002 \u6bcf\u4e00\u6b21\u5371\u673a\u90fd\u662f\u8f6c\u673a\u3002","title":"\u96c6\u4e2d\u5f0f\u5907\u4efd\u7ba1\u7406\u670d\u52a1AWS Backup"},{"location":"blogs/2020-03-15-aws-backup/#aws-backup","text":"\u4e4b\u524d\u7ed9\u540c\u5b66\u4eec\u4ecb\u7ecd\u8fc7\u5982\u4f55\u7ed9ebs\u521b\u5efa\u5feb\u7167\uff0c\u6709\u7528\u5230ec2\u4ee3\u7406\u7684\uff0c\u6709\u7528\u5230\u65e0\u670d\u52a1\u5668\u670d\u52a1lambda\u7684\uff0c\u73b0\u5728\u968f\u7740aws backup\u670d\u52a1\u5728\u56fd\u5185\u7684\u843d\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u4f7f\u7528\u8fd9\u4e2a\u96c6\u4e2d\u5f0f\u7684\u5907\u4efd\u7ba1\u7406\u670d\u52a1\u5566\uff0c\u800c\u4e14\u4e0d\u4ec5\u4ec5\u662febs\u5377\u54e6\uff01 -- D.C \u5148\u770b\u4e0baws backup \u652f\u6301\u7684\u5907\u4efd\u670d\u52a1\uff1a \u652f\u6301\u7684\u670d\u52a1 \u652f\u6301\u7684\u8d44\u6e90 Amazon Elastic File System (Amazon EFS) Amazon EFS \u6587\u4ef6\u7cfb\u7edf Amazon DynamoDB (DynamoDB) DynamoDB \u8868 Amazon Elastic Block Store (Amazon EBS) Amazon EBS \u5377 Amazon Relational Database Service (Amazon RDS) Amazon RDS \u6570\u636e\u5e93* AWS Storage Gateway\uff08\u5377\u7f51\u5173\uff09 AWS Storage Gateway \u5377 *AWS Backup \u5f53\u524d\u652f\u6301\u9664\u4e86 Amazon Aurora \u4e4b\u5916\u7684\u6240\u6709 Amazon RDS \u6570\u636e\u5e93\u5f15\u64ce\u3002 \u6709\u4e9b\u540c\u5b66\u4f1a\u95ee\uff0c\u4e3a\u5565\u4e0d\u652f\u6301Aurora\u554a\uff0c\u4e0d\u662f\u53f7\u79f0\u771f\u6b63\u4e91\u539f\u751f\u7684\u6570\u636e\u5e93\u4e48\uff1f\u5176\u5b9e\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u90fd\u8bf4\u4e86\u662f\u4e91\u539f\u751f\u4e86\uff0c\u4eba\u5bb6\u81ea\u5e266\u526f\u672c\uff0c\u4e14\u81ea\u52a8\u6269\u5c55\u81ea\u52a8\u5907\u4efd\uff0c\u4e0d\u9700\u8981\u501f\u52a9\u5916\u90e8\u670d\u52a1\u4e86\u3002 \u518d\u5f3a\u8c03\u4e00\u70b9\uff0caws\u7684\u5907\u4efd\u90fd\u662f\u589e\u91cf\u5907\u4efd\uff0c\u4e0d\u662f\u7b80\u5355\u7684double\u5173\u7cfb\u3002\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u770b\u56fe\u8bf4\u8bdd\uff1a","title":"\u96c6\u4e2d\u5f0f\u5907\u4efd\u7ba1\u7406\u670d\u52a1AWS Backup"},{"location":"blogs/2020-03-15-aws-backup/#backup","text":"\u767b\u5f55aws\u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u70b9\u51fb\u4e0a\u65b9 \u670d\u52a1 \uff0c\u641c\u7d22 backup , \u70b9\u51fb\u8fdb\u5165\u3002","title":"\u627e\u5230backup"},{"location":"blogs/2020-03-15-aws-backup/#_1","text":"\u70b9\u51fb\u5de6\u4fa7\u5217\u8868\u7684 \u5907\u4efd\u8ba1\u5212 ,\u518d\u70b9\u51fb\u53f3\u4fa7\u754c\u9762\u7684 \u521b\u5efa\u5907\u4efd\u8ba1\u5212 \u3002 \u51fa\u73b0\u9009\u9879\uff0c\u6709\u4e09\u79cd\u5206\u522b\u662f\uff1a a. \u4ece\u73b0\u6709\u8ba1\u5212\u5f00\u59cb\uff1b # \u76f4\u63a5\u5728\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4e0a\u9762\u6539 b. \u521b\u5efa\u65b0\u8ba1\u5212\uff1b # \u5b8c\u5168\u521b\u5efa\u65b0\u7684 c. \u4f7f\u7528JSON\u5b9a\u4e00\u8ba1\u5212\uff1b # \u7528JSON\u6a21\u677f\u521b\u5efa\uff0c\u4e00\u822c\u662f\u522b\u4ebashare\u7ed9\u6211\u7684 \u8fd9\u91cc\u6211\u9009\u62e9\u4e00\u4e2a Daily-Monthly-1yr-Retension , \u8bdd\u8bf4\u53d6\u540d\u5b57\u771f\u7684\u592a\u91cd\u8981\u7684\uff0c\u5e0c\u671b\u5927\u5bb6\u90fd\u517b\u6210\u53d6\u540d\u5b57\u4e00\u76ee\u4e86\u7136\u7684\u597d\u4e60\u60ef\u3002\u6bd4\u5982\u8fd9\u4e2aplan\u7684\u610f\u601d\u662f\uff1a \u6bcf\u65e5\u5907\u4efd\uff0c\u6bcf\u6708\u5907\u4efd\uff0c\u4fdd\u5b58\u4e00\u5e74\u3002 \u5907\u4efd\u8ba1\u5212\u540d\u79f0\u6211\u5199\u6210 test \uff0c\u518d\u5f80\u4e0b\u770b\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2aplan\u5176\u5b9e\u662f\u5305\u62ec\u4e24\u6761\u89c4\u5219\uff1a DailyBackups \u548c Monthly \u3002 \u5148\u70b9 DailyBackups \u8fdb\u53bb\u770b\u4e0b(\u4e0b\u56fe)\uff0c\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6bcf\u5929\u5907\u4efd\u4e00\u6b21\uff0c\u521b\u5efa\u4e4b\u65e5\u8d77\u76845\u5468\u540e\u5907\u4efd\u5931\u6548\uff0c\u4e0d\u9700\u8981\u8f6c\u6362\u4e3a\u51b7\u5b58\u50a8\uff08EFS\u76d8\u53ef\u4ee5\u8bbe\u5b9a\u8f6c\u6210\u51b7\u5b58\u50a8\u964d\u4f4e\u6210\u672c\u54e6\uff01\uff09\u53e6\u5916\u6211\u4eec\u6ce8\u610f\u5230\u4e0b\u9762\u8fd8\u6709\u4e00\u4e2a\u9009\u9879 \u590d\u5236\u5230\u533a\u57df\uff08\u53ef\u9009\uff09 \uff0c\u610f\u601d\u662f\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u8de8\u533a\u57df\u5907\u4efd\uff0c\u5317\u4eac-\u5b81\u590f\u4e24\u5730\u5bb9\u707e\uff01 \u70b9\u4e0b\u9762\u7684 \u53d6\u6d88 \uff0c\u518d\u70b9\u51fb Monthly \u770b\u770b, \u539f\u6765\u8fd9\u91cc\u89c4\u5b9a\uff0c\u6bcf\u4e2a\u6708\u7684\u7b2c\u4e00\u5929\u8fdb\u884c\u5907\u4efd\uff0c1\u4e2a\u6708\u540e\u8f6c\u6210\u51b7\u5b58\u50a8\uff0c1\u5e74\u540e\u5907\u4efd\u8fc7\u671f\u3002 \u90a3\u4e48\u8fd9\u4e24\u4e2a\u5408\u5728\u4e00\u8d77\u53c8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6211\u7684\u7406\u89e3\u5982\u4e0b\uff1a a. \u9488\u5bf9\u6211\u4eec\u8981\u5907\u4efd\u7684\u8d44\u6e90\uff0c\u6bcf\u5929\u8fdb\u884c\u70ed\u5907\uff0c\u6c38\u8fdc\u4fdd\u7559\u6700\u8fd1\u4e00\u5468\u7684\u70ed\u5907\u3002 b. \u6bcf\u6708\u521d\u518d\u505a\u4e00\u6b21\u5907\u4efd\uff0c\u6c38\u8fdc\u4fdd\u7559\u5f53\u6708\u7684\u70ed\u5907\uff0c\u4ee5\u53ca\u8fd1\u4e00\u5e74\u7684\u51b7\u5907\u3002 \u5f53\u7136\uff0c\u8fd8\u5f97\u7ed3\u5408\u6211\u4eec\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\u6765\u8fdb\u884c\u53c2\u6570\u8c03\u6574\uff0c\u6700\u7ec8\u5f97\u5230\u6700\u9002\u5408\u6211\u4eec\u7684\u5907\u4efd\u5468\u671f\u3002\u6700\u540e\u7ed9\u8c03\u6574\u597d\u7684\u5907\u4efd\u8ba1\u5212\u6dfb\u52a0\u6807\u7b7e\u5982\uff1a ec2backup:pcluster , \u70b9\u51fb \u521b\u5efa\u8ba1\u5212 \uff0c\u8fd9\u6837\u8ba1\u5212\u5c31\u521b\u5efa\u597d\u4e86\u3002 \u70b9\u51fb test \u8fdb\u53bb\u540e\uff0c\u770b\u5230 \u8d44\u6e90\u5206\u914d \u90a3\u680f\u662f\u7a7a\u7684\uff0c\u6ca1\u9519\uff0c\u63a5\u4e0b\u53bb\u6211\u4eec\u5c31\u8981\u6dfb\u52a0\u7b49\u5f85\u5907\u4efd\u7684\u8d44\u6e90\u4e86\uff0c\u70b9\u51fb\u53f3\u8fb9\u7684 \u5206\u914d\u8d44\u6e90 \u3002 \u51fa\u6765\u8bbe\u7f6e\u754c\u9762\uff0c\u5199\u4e2a\u540d\u79f0\u5982 pcluster , IAM\u89d2\u8272\u4e0d\u7528\u6539\u4f1a\u81ea\u52a8\u914d\u7f6e\u7684\uff0c\u5728\u4e0b\u65b9\u7684 \u5206\u914d\u8d44\u6e90 \u680f\u76ee\uff0c\u6211\u4eec\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a a. \u6839\u636e\u6807\u7b7e\uff1a\u9009\u62e9\u6211\u4eec\u8981\u5907\u4efd\u76845\u7c7b\u8d44\u6e90\u8eab\u4e0a\u7684\u6807\u7b7e\uff0c\u6bd4\u5982\u6211\u7ed9\u4e00\u53f0EC2\u6253\u4e86\u4e2a\u6807\u7b7e Name:2.5.1 b. \u6839\u636e\u8d44\u6e90ID\uff1a\u9009\u62e9\u8d44\u6e90\u7c7b\u578b\uff0c\u70b9\u51fb \u8868\u540d\u79f0 \u7684\u6846\u5185\uff0c\u4f1a\u5217\u51fa\u5bf9\u5e94\u7684ID\uff0c\u9009\u62e9\u6211\u8981\u5907\u4efd\u7684\u90a3\u4e2a\u5c31\u884c\u4e86\u3002 \u70b9\u51fb \u5206\u914d\u8d44\u6e90 \uff0c\u8fd9\u6837\u5907\u4efd\u8ba1\u5212\u5c31\u5b8c\u6210\u4e86\u3002","title":"\u521b\u5efa\u5907\u4efd\u8ba1\u5212"},{"location":"blogs/2020-03-15-aws-backup/#_2","text":"\u56de\u5230aws backup\u7684\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 \u4f5c\u4e1a \uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u8fc7\u53bb24\u5c0f\u65f6\u505a\u8fc7\u7684\u5907\u4efd\u4f5c\u4e1a\u3002 \u518d\u70b9\u51fb\u5de6\u4fa7\u7684 \u53d7\u4fdd\u62a4\u7684\u8d44\u6e90 \uff0c\u53ef\u4ee5\u770b\u5230\u6211\u7684\u4e00\u53f0EC2\u5df2\u7ecf\u5907\u4efd\u597d\u4e86\u3002 \u9a8c\u8bc1\u4e00\u4e0b\uff0c\u56de\u5230EC2\u63a7\u5236\u53f0\uff0c\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684 AMI , ding~dong~, \u4ee5 AwsBackup \u5f00\u5934\u7684\u955c\u50cf\u597d\u597d\u7684\u8eba\u7740\u5462\uff0c\u6ca1\u95ee\u9898\uff01","title":"\u67e5\u770b\u5907\u4efd\u4efb\u52a1"},{"location":"blogs/2020-03-15-aws-backup/#_3","text":"\u56de\u5230aws backup\u7684\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 \u53d7\u4fdd\u62a4\u7684\u8d44\u6e90 \uff0c\u70b9\u51fbinstance\u540d\u79f0\u8fdb\u53bb\uff0c\u9009\u4e2d \u5907\u4efd \u4e0b\u7684\u6062\u590d\u70b9ID\uff0c\u70b9\u51fb \u8fd8\u539f \u3002 \u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u6211\u6062\u590d\u7684\u662fAMI\uff0c\u5c31\u548c\u6211\u5728ec2\u63a7\u5236\u53f0\u9009\u4e2dAMI\u542f\u52a8\u5b9e\u4f8b\u662f\u4e00\u6837\u7684\uff0c\u5305\u62ec\u5b9e\u4f8b\u7c7b\u578b\u3001VPC\u3001\u5b50\u7f51\u3001\u5b89\u5168\u7ec4\uff0cIAM\uff0c\u9009\u62e9\u597d\u4e86\u4ee5\u540e\uff0c\u70b9\u51fb \u8fd8\u539f\u5907\u4efd \uff0c \u7136\u540e\u5c31\u53bbec2 \u754c\u9762\u67e5\u770b\u65b0\u8d77\u7684instance\u5427\u3002 \u6253\u5b8c\u6536\u5de5\u3002 \u6bcf\u4e00\u6b21\u5371\u673a\u90fd\u662f\u8f6c\u673a\u3002","title":"\u8fd8\u539f\u5907\u4efd"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/","text":"Use k8s on AWS - EKS service k8s\u6700\u8fd1\u662f\u98ce\u5934\u5f88\u76db\uff0c\u56e0\u4e3a\u5b83\u89e3\u51b3\u4e86\u5bb9\u5668\u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u8c03\u5ea6\u95ee\u9898\uff0c\u6240\u4ee5\u5927\u5bb6\u90fd\u60f3\u4e00\u8bd5\u7a76\u7adf\u2014\u2014\u5305\u62ec\u6211\uff0c\u4e00\u822c\u5982\u679c\u6ca1\u6709\u4e91\u8d26\u53f7\u7684\u540c\u5b66\uff0c\u53ea\u80fd\u81ea\u5df1\u4e0b\u8f7dk8s\u7684\u8f6f\u4ef6\u88c5\u5728\u672c\u5730\u670d\u52a1\u5668\u4e0a\uff0c\u8fd8\u8981\u4e0b\u8f7dk8s\u76f8\u5173\u7684\u63d2\u4ef6\uff0c\u914d\u7f6e\u7f51\u7edc\u7b49\u7b49\u4e00\u7cfb\u5217\u8bbe\u7f6e\uff0c\u7ecf\u8fc7\u5404\u79cd\u8c03\u8bd5\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\u3002\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u7528\u8fc7\u4e91\u7684\u670b\u53cb\u81ea\u7136\u662f\u62d2\u7edd\u7684\u2014\u2014\u5305\u62ec\u6211\uff0c\u5b9e\u7528\u4e3b\u4e49\u544a\u8bc9\u6211\u4eec\uff0c\u53ea\u8981\u66f4\u5feb\u8fbe\u5230\u76ee\u7684\u4e0d\u8bba\u8fc7\u7a0b\u548c\u624b\u6bb5\uff0c\u80fd\u76f4\u63a5\u7528\u6258\u7ba1\u7684\uff0c\u5e72\u561b\u8d39\u529b\u8d39\u65f6\u627e\u6761\u5f2f\u8def\u8d70\u5462\u3002 -- D.C \u5148\u4e0a\u4e2a\u73cd\u85cf\u591a\u5e74\u7684k8s\u57fa\u7840\u539f\u7406\u56fe\uff1a \u540d\u8bcd\u89e3\u91ca Master : \u5305\u5de5\u5934\u4e3b\u8282\u70b9,\u7528\u6765\u8c03\u5ea6k8s\u96c6\u7fa4,\u5934\u4e0a\u63a5\u6536\u5916\u90e8\u7684api\u8bf7\u6c42\uff0c\u4ece\u800c\u8fdb\u884c\u4efb\u52a1\u5206\u914d\u548c\u8c03\u5ea6\u7b49\u3002 kube-apiserver : k8s\u5bf9\u5916\u7684\u670d\u52a1\u5165\u53e3\uff0c\u901a\u4fe1\u7ebd\u5e26\uff0c\u65e0\u72b6\u6001\uff0c\u6c34\u5e73\u6269\u5c55\u3002 Kube-scheduler : \u8d1f\u8d23\u5bf9pod\u7684\u4efb\u52a1\u8c03\u5ea6\u3002 kube-controller-manager : \u5904\u7406node\u8282\u70b9\u7684\u5f53\u673a\u554a\uff0cpod\u7684\u526f\u672c\u6570\u554a\uff0c\u7ba1\u7406endpoint\u7ec8\u7aef\u8282\u70b9\uff0c\u8fde\u63a5service\u548cpod\u3001\u4e3a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u9ed8\u8ba4api token\u548caccounts\u3002 etcd : etcd\u662fkubernetes\u96c6\u7fa4\u7528\u6765\u5b58\u50a8\u96c6\u7fa4\u76f8\u5173\u6570\u636e\u7684\u6570\u636e\u4ed3\u5e93\u3002 node : worknodes\uff0c\u5e72\u6d3b\u7684\u8282\u70b9\u3002\u6267\u884c\u5305\u5de5\u5934master\u8282\u70b9\u6307\u6d3e\u7684\u642c\u7816\u4efb\u52a1\u3002 kubelet :\u8d1f\u8d23\u542f\u52a8\u505c\u6b62\u5bb9\u5668\uff0c\u4fdd\u8bc1\u5bb9\u5668\u8fd0\u884c\u3002 kube-proxy :\u8d1f\u8d23\u6839\u636eservice\u751f\u6210\u7f51\u7edc\u89c4\u5219\uff0c\u751f\u6210\u8def\u7531\u89c4\u5219\u3002 Docker engine : \u8fd9\u4e2a\u4e0d\u7528\u8bf4\u4e86\uff0c\u4e00\u4e2apod\u91cc\u9762\u53ef\u4ee5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u3002 Pod : k8s \u4ee5pod\u4e3a\u6700\u5c0f\u5355\u4f4d\u8fdb\u884c\u8c03\u5ea6\u3001\u6269\u5c55\u3001\u5171\u4eab\u8d44\u6e90\u3001\u7ba1\u7406\u751f\u547d\u5468\u671f\u3002\u5728\u4e00\u4e2apod\u91cc\u6240\u6709\u7684\u5bb9\u5668\u5171\u4eab\u4ee5\u4e0b\u8d44\u6e90: PID\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u770b\u5230\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u8fdb\u7a0bID\u3002 \u7f51\u7edc\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u8bbf\u95ee\u540c\u4e00\u4e2aIP\u548c\u7aef\u53e3\u8303\u56f4\u3002 IPC\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u4f7f\u7528SystemV IPC\u6216POSIX\u6d88\u606f\u961f\u5217\u8fdb\u884c\u901a\u4fe1\u3002 UTS\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u5171\u4eab\u4e00\u4e2a\u4e3b\u673a\u540d\u3002 Volumes(\u5171\u4eab\u5b58\u50a8\u5377) : Pod\u4e2d\u7684\u5404\u4e2a\u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u5728Pod\u7ea7\u522b\u5b9a\u4e49\u7684Volumes\u3002 \u597d\u4e86\uff0c\u5c31\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e86\u89e3\u8fd9\u4e48\u591a\u6211\u89c9\u5f97\u5c31\u591f\u4e86\uff0c\u518d\u8bf4\u4f1a\u6655\u3002 \u4ece\u5934\u642d\u5efak8s \u8fd9\u79cd\u642d\u5efa\u65b9\u5f0f\u53ea\u6709\u4e00\u79cd\u53ef\u80fd\uff0c\u5c31\u662f\u672c\u5730\u4f20\u7edf\u73a9\u5bb6\uff0c\u6559\u7a0b\u7f51\u4e0a\u4e00\u5927\u5806\uff0c\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u57fa\u672c\u6b65\u9aa4\uff1a \u51c6\u5907\u51e0\u53f0\u865a\u62df\u673a \u914d\u7f6e\u4e3b\u673a\u540d\u4e0e\u9759\u6001IP \u5173\u95ed\u9632\u706b\u5899 \u6821\u6b63\u7cfb\u7edf\u65f6\u95f4 \u5173\u95edselinux \u5173\u95edswap IPv4\u6d41\u91cf\u4f20\u9012\u5230iptable \u5728\u6240\u6709\u8282\u70b9\u5b89\u88c5Docker\u548cKubeadm\u548cKubelet\u548cKubectl \u90e8\u7f72k8s master \u90e8\u7f72Pod\u7f51\u7edc\u67e5\u4ef6CNI \u52a0\u5165k8s Node \u6d4b\u8bd5k8s\u96c6\u7fa4 \u597d\u4f3c\u88f9\u811a\u5e03\uff0c\u53c8\u81ed\u53c8\u957f\uff0c\u611f\u89c9\u6bcf\u4e00\u6b65\u90fd\u53ef\u80fd\u7f20\u4f4f\u6211\u7684\u8116\u5b50\uff0c\u8ba9\u6211\u5206\u5206\u949f\u4ece\u5165\u95e8\u5230\u653e\u5f03\u3002 EKS - managed k8s on aws aws \u6258\u7ba1\u7684k8s\u670d\u52a1\uff08\u76ee\u524d\u66f4\u65b0\u52301.15\uff09\uff0c\u4e2d\u56fd\u533a\u53ef\u7528\uff0c\u662f\u4e00\u9879\u5b8c\u5168\u6258\u7ba1\u7684 Kubernetes \u670d\u52a1\u3002\u51fa\u4e8e\u5176\u5b89\u5168\u6027\u3001\u53ef\u9760\u6027\u548c\u53ef\u6269\u5c55\u6027\uff0cIntel\u3001Snap\u3001Intuit\u3001GoDaddy \u548c Autodesk \u7b49\u5ba2\u6237\u90fd\u5728\u4f7f\u7528\u5b83\u6765\u8fd0\u884c\u4ed6\u4eec\u6700\u654f\u611f\u7684\u4efb\u52a1\u5173\u952e\u578b\u5e94\u7528\u7a0b\u5e8f\u3002 EKS\u6709\u51e0\u4e2a\u7279\u6027\uff1a \u6258\u7ba1 \uff1a\u4e24\u4e2a\u5b57\uff0c\u7701\u5fc3\uff0c\u591a\u6d3b\u51e0\u5e74\u3002 \u81ea\u52a8\u9ad8\u53ef\u7528 \uff1a\u53ef\u8de8\u591a\u4e2a AWS \u53ef\u7528\u533a\u8fd0\u884c Kubernetes \u7ba1\u7406\u57fa\u7840\u8bbe\u65bd\u3001\u81ea\u52a8\u68c0\u6d4b\u548c\u66ff\u6362\u8fd0\u884c\u72b6\u51b5\u4e0d\u4f73\u7684\u63a7\u5236\u5e73\u9762\u8282\u70b9\uff0c\u5e76\u63d0\u4f9b\u96f6\u505c\u673a\u65f6\u95f4\u7684\u6309\u9700\u5347\u7ea7\u548c\u4fee\u8865 \u63d0\u4f9b\u65e0\u670d\u52a1\u5668\u9009\u9879 - \u652f\u6301 AWS Fargate \u4e3a\u5bb9\u5668\u63d0\u4f9b\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u529f\u80fd\u3002\u4f7f\u7528 Fargate\uff0c\u60a8\u65e0\u9700\u9884\u7f6e\u548c\u7ba1\u7406\u670d\u52a1\u5668\uff0c\u800c\u4e14\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u8d44\u6e90\u5e76\u4e3a\u5176\u4ed8\u8d39\uff0c\u5e76\u901a\u8fc7\u8bbe\u8ba1\u9694\u79bb\u5e94\u7528\u7a0b\u5e8f\u6765\u63d0\u9ad8\u5b89\u5168\u6027\u3002 \u5b89\u5168 \uff1a\u81ea\u52a8\u5c06\u6700\u65b0\u7684\u5b89\u5168\u8865\u4e01\u5e94\u7528\u5230\u60a8\u7684\u96c6\u7fa4\u63a7\u5236\u5e73\u9762\u3002AWS \u8fd8\u4e0e\u793e\u533a\u7d27\u5bc6\u5408\u4f5c\uff0c\u4ee5\u786e\u4fdd\u5728\u5c06\u65b0\u7248\u672c\u548c\u8865\u4e01\u90e8\u7f72\u5230\u73b0\u6709\u96c6\u7fa4\u4e4b\u524d\u89e3\u51b3\u5173\u952e\u7684\u5b89\u5168\u95ee\u9898\u3002 \u901a\u8fc7\u793e\u533a\u6784\u5efa \uff1a\u53ef\u8fd0\u884c\u4e0a\u6e38 Kubernetes\uff0c\u4e14\u7ecf\u8ba4\u8bc1\u53ef\u4e0e Kubernetes \u517c\u5bb9\uff0c\u56e0\u6b64 EKS \u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e0e\u6240\u6709\u6807\u51c6 Kubernetes \u73af\u5883\u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\u5b8c\u5168\u517c\u5bb9\u3002AWS \u4e3b\u52a8\u4e0e Kubernetes \u793e\u533a\u5408\u4f5c\uff0c\u5176\u4e2d\u5305\u62ec\u4e3a Kubernetes \u4ee3\u7801\u5e93\u505a\u8d21\u732e\uff0c\u4ee5\u5e2e\u52a9\u60a8\u5145\u5206\u5229\u7528 AWS \u670d\u52a1\u548c\u529f\u80fd\u3002 EKS\u90e8\u7f72\u6709\u4e09\u79cd\u65b9\u5f0f\uff1a AWS \u63a7\u5236\u53f0 - \u9f20\u6807\u70b9\u70b9\u70b9 eksctl \u547d\u4ee4\u884c CloudFormation/CDK \u597d\u4e86\uff0c\u4e86\u89e3\u5230\u8fd9\u91cc\u4e5f\u591f\u4e86\uff0c\u5426\u5219\u5c31\u4e0d\u53eb\u6258\u7ba1\u4e86\u3002 \u4e00\u952e\u521b\u5efaEKS\u96c6\u7fa4\uff08k8s\uff09 \u51c6\u5907\u5de5\u4f5c\u662f\u8981\u786e\u8ba4\u4f60\u73b0\u5728\u6267\u884c\u547d\u4ee4\u7684shell\u5177\u4e0d\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6\uff1a \u662f\u5426\u5b89\u88c5\u5e76\u914d\u7f6e\u597d\u6700\u65b0\u7684 AWSCLI2 \u662f\u5426\u5b89\u88c5\u4e86 eksctl \u662f\u5426\u5b89\u88c5\u4e86 Kubectl \u5982\u679c\u7b54\u6848\u90fd\u662fyes\uff0c\u90a3\u4e48\u6267\u884ceksctl\u547d\u4ee4\u4e00\u952e\u90e8\u7f72EKS\uff1a $ eksctl create cluster \\ > --name myeks \\ > --version 1.15 \\ > --region cn-northwest-1 \\ > --nodegroup-name workers \\ > --node-type m5.large \\ > --nodes 3 \\ > --managed [\u2139] eksctl version 0.15.0 [\u2139] using region cn-northwest-1 [\u2139] setting availability zones to [cn-northwest-1c cn-northwest-1a cn-northwest-1b] [\u2139] subnets for cn-northwest-1c - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] subnets for cn-northwest-1a - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] subnets for cn-northwest-1b - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] using Kubernetes version 1.15 [\u2139] creating EKS cluster \"myeks\" in \"cn-northwest-1\" region with managed nodes [\u2139] will create 2 separate CloudFormation stacks for cluster itself and the initial managed nodegroup [\u2139] if you encounter any issues, check CloudFormation console or try 'eksctl utils describe-stacks --region=cn-northwest-1 --cluster=myeks' [\u2139] CloudWatch logging will not be enabled for cluster \"myeks\" in \"cn-northwest-1\" [\u2139] you can enable it with 'eksctl utils update-cluster-logging --region=cn-northwest-1 --cluster=myeks' [\u2139] Kubernetes API endpoint access will use default of {publicAccess=true, privateAccess=false} for cluster \"myeks\" in \"cn-northwest-1\" [\u2139] 2 sequential tasks: { create cluster control plane \"myeks\", create managed nodegroup \"workers\" } [\u2139] building cluster stack \"eksctl-myeks-cluster\" [\u2139] deploying stack \"eksctl-myeks-cluster\" [\u2139] building managed nodegroup stack \"eksctl-myeks-nodegroup-workers\" [\u2139] deploying stack \"eksctl-myeks-nodegroup-workers\" [\u2714] all EKS cluster resources for \"myeks\" have been created [\u2714] saved kubeconfig as \"C:\\\\Users\\\\xxx/.kube/config\" [\u2139] nodegroup \"workers\" has 3 node(s) [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] waiting for at least 3 node(s) to become ready in \"workers\" [\u2139] nodegroup \"workers\" has 3 node(s) [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] kubectl command should work with \"C:\\\\Users\\\\xxx/.kube/config\", try 'kubectl get nodes' [\u2714] EKS cluster \"myeks\" in \"cn-northwest-1\" region is ready \u8fd9\u6837\u9ed8\u8ba4\u90e8\u7f72\u7684\u96c6\u7fa4\u67b6\u6784\u957f\u8fd9\u6837\uff0c\u5f53\u7136\u540e\u671f\u6211\u4e5f\u53ef\u4ee5\u770beks\u6587\u6863\u6309\u7167\u6211\u5b9e\u9645\u5de5\u4f5c\u8c03\u6574\uff1a \u8fdbAWS console\u7684EKS\u670d\u52a1\u770b\u4e0b\uff0cmyeks\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\uff01\u70b9\u8fdb\u53bb\u770b\u5230\uff0c3\u4e2a\u642c\u7816\u5de5\u5df2\u7ecfready\uff01 PS: \u5176\u5b9e\u5462\uff0c\u4e00\u952e\u90e8\u7f72\u80cc\u540e\u8fd8\u662f\u8c03\u7528\u4e86AWS\u7684\u81ea\u52a8\u5316\u90e8\u7f72\u795e\u5668 - CloudFormation \u5982\u679c\u6211\u4e0d\u60f3\u6240\u6709\u8d44\u6e90\u90fd\u65b0\u5efa\uff0c\u800c\u662f\u628a\u96c6\u7fa4\u653e\u5728\u73b0\u6709\u7684VPC\u4e0b\uff0c\u90a3\u5c31\u52a0\u4e0a\u8fd9\u4e9b\u9009\u9879\uff1a --vpc-public-subnets public_subnet_1a, public_subnet_1b \\ --vpc-private-subnets private_subnet_1a, prviate_subnet_1b \\ \u5176\u4ed6\u9009\u9879\uff1a --ssh-public-key eks-bjs # \u6307\u5b9a\u73b0\u6709\u7684pem\u6587\u4ef6 --node-ami ami-xxxx # \u53ef\u4ee5\u6307\u5b9a\u81ea\u5df1\u7684ami, but --managed unable to used --node-ami-family # \u6307\u5b9aOS\u7cfb\u7edf, default is Amazon Linux 2 # AmazonLinux2, Ubuntu1804, WindowsServer2019FullContainer, WindowsServer2019CoreContainer $ AWS_PROFILE=bjs # \u6307\u5b9a\u7528\u54ea\u4e2aaksk\u8eab\u4efd\u6765\u521b\u5efa\u96c6\u7fa4 cat ~/.aws/config \u53ef\u4ee5\u770b \u7ba1\u7406EKS \u5728\u672c\u673a\u7528awscli\u628aEKS\u96c6\u7fa4\u7684\u4fe1\u606f\u540c\u6b65\u5230 kubeconfig \u6587\u4ef6\u3002 $ aws eks update-kubeconfig --name <cluster_name> \u4f8b\u5982\uff1a $ aws eks update-kubeconfig --name myeks Added new context arn:aws-cn:eks:cn-northwest-1:xxxxxxxxxxxx:cluster/myeks to C:\\Users\\xxxx\\.kube\\config \u67e5\u770bnodes\uff1a $ kubectl get nodes NAME STATUS ROLES AGE VERSION ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m55s v1.15.10-eks-bac369 ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m49s v1.15.10-eks-bac369 ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m41s v1.15.10-eks-bac369 \u90e8\u7f72\u5e94\u7528 \u8fd9\u91cc\u6211\u4eec\u6574\u4e2a\u6700\u7b80\u5355\u7684web\u670d\u52a1nginx\u6d4b\u8bd5\u4e0b\u5427\uff0c\u65b0\u5efa\u4e00\u4e2adockerfile\uff0c\u8fd9\u4e2a\u529f\u80fd\u5f88\u7b80\u5355\uff0c \u5c31\u662f\u63d0\u4f9b\u4e00\u4e2aweb\u670d\u52a1\u5668\uff0c\u7136\u540e\u9875\u9762\u663e\u793a \u201c Hello, Docker!\u201d \u3002 $ vim dockerfile FROM nginx RUN echo '<h1>Hello, Docker!</h1>' > /usr/share/nginx/html/index.html \u5728aws console\u7684ECR\u91cc\u65b0\u5efa\u4e00\u4e2a\u955c\u50cf\u4ed3\u5e93\uff0c\u7528\u6765\u5b58\u653e\u955c\u50cf\u3002\u8bb0\u4f4f\uff0caws\u4e0a\u6240\u6709\u7684\u955c\u50cf\u90fd\u662f\u6ce8\u518c\u5728ECR\u4e0a\u7edf\u4e00\u7ba1\u7406\u7684\uff0c\u8ba9\u6211\u60f3\u8d77\u4e86\u67d0\u4e91\u7684\u5bb9\u5668\u5c45\u7136\u5c31\u76f4\u63a5\u4e22\u5728\u5bf9\u8c61\u5b58\u50a8\u91cc\uff0c\u846c\u7231\u5bb6\u65cf\u8f7b\u72c2\u4e0d\u7f81\u3002 \u521b\u5efa\u672c\u673adocker\u5e76\u6ce8\u518c\u5230ECR\u7684\u955c\u50cf\u4ed3\u5e93\u91cc\u3002 $ docker build . -t xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest $ docker images REPOSITORY TAG IMAGE ID CREATED SIZE xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest latest fef472de0787 47 hours ago 127MB nginx latest ed21b7a8aee9 2 weeks ago 127MB $ aws ecr get-login-password --region cn-northwest-1 | docker login --username AWS --password-stdin xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest Login Succeeded $ docker push xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest:latest \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2adocker\u5df2\u7ecf\u63a8\u5230\u4ed3\u5e93\u4e86\u3002 \u63a5\u4e0b\u6765\u521b\u5efaYAML\u6587\u4ef6\u5e76\u7528kubectl\u90e8\u7f72\u3002 \u521b\u5efaYAML\u6587\u4ef6 nginx-deployment.yaml , \u90e8\u7f72nginx apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment labels: app: nginx spec: replicas: 3 selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: - name: nginx image: <account_id>.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest:latest # \u81ea\u884c\u4fee\u6539ID ports: - containerPort: 80 $ kubectl.exe apply -f nginx-deployment.yaml deployment.apps/nginx-deployment created $ kubectl.exe get pods NAME READY STATUS RESTARTS AGE nginx-deployment-75d669445d-k2nqg 1/1 Running 0 2m46s nginx-deployment-75d669445d-x6z7d 1/1 Running 0 2m46s nginx-deployment-75d669445d-xdfdx 1/1 Running 0 2m46s \u521b\u5efaYAML\u6587\u4ef6 nginx-svc-nlb.yaml ,\u90e8\u7f72\u7c7b\u578b\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u7684service (AWS Network Load Balance \u670d\u52a1) apiVersion: v1 kind: Service metadata: name: nginx-svc annotations: service.beta.kubernetes.io/aws-load-balancer-type: \"nlb\" spec: type: LoadBalancer selector: app: nginx ports: - protocol: TCP name: http port: 80 targetPort: 80 $ kubectl.exe apply -f nginx-svc-nlb.yaml service/nginx-svc created $ kubectl.exe get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.100.0.1 <none> 443/TCP 51m nginx-svc LoadBalancer 10.100.179.159 a9d4exxxxxxxxxxxxxxxxxxxxxx-dd11xxxxxxx.elb.cn-northwest-1.amazonaws.com.cn 80:30428/TCP 30s \u53ef\u4ee5\u770b\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u5df2\u7ecf\u8d77\u6765\u4e86\uff0c\u6211\u4eec\u5728aws console\u4e2d\u53ef\u4ee5\u770b\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u72b6\u6001\u4ece provisioning \u53d8\u6210 active \u3002 \u7528\u7f51\u9875\u6253\u5f00LoadBalancer\u7684DNS\u5730\u5740 a9d4exxxxxxxxxxxxxxxxxxxxxx-dd11xxxxxxx.elb.cn-northwest-1.amazonaws.com.cn ,\u770b\u5230\u4e86\u4ec0\u4e48\uff1f \u5173\u4e8ek8s\u91cc\u7684IP\u5730\u5740 Kubernetes\u96c6\u7fa4\u91cc\u6709\u4e09\u79cdIP\u5730\u5740\uff0c\u5206\u522b\u5982\u4e0b\uff1a Node IP \uff1aNode\u8282\u70b9\u7684IP\u5730\u5740\uff0c\u5373\u7269\u7406\u7f51\u5361\u7684IP\u5730\u5740\u3002 Pod IP \uff1aPod\u7684IP\u5730\u5740\uff0c\u5373docker\u5bb9\u5668\u7684IP\u5730\u5740\uff0c\u6b64\u4e3a\u865a\u62dfIP\u5730\u5740\u3002 Cluster IP \uff1aService\u7684IP\u5730\u5740\uff0c\u6b64\u4e3a\u865a\u62dfIP\u5730\u5740\u3002 \u5b66\u4e60\u94fe\u63a5 EKS\u5b66\u4e60\u8bb2\u5ea7\u89c6\u9891 aws_EKS_guide eksctl aws_EKS_api aws_cli_eks aws_sdk_python_EKS k8s\u4e2d\u6587\u6587\u6863 \u4eba\u751f\u82e6\u77ed\uff0c\u6211\u7528\u6258\u7ba1\u3002","title":"Use k8s on AWS - EKS service"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#use-k8s-on-aws-eks-service","text":"k8s\u6700\u8fd1\u662f\u98ce\u5934\u5f88\u76db\uff0c\u56e0\u4e3a\u5b83\u89e3\u51b3\u4e86\u5bb9\u5668\u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u8c03\u5ea6\u95ee\u9898\uff0c\u6240\u4ee5\u5927\u5bb6\u90fd\u60f3\u4e00\u8bd5\u7a76\u7adf\u2014\u2014\u5305\u62ec\u6211\uff0c\u4e00\u822c\u5982\u679c\u6ca1\u6709\u4e91\u8d26\u53f7\u7684\u540c\u5b66\uff0c\u53ea\u80fd\u81ea\u5df1\u4e0b\u8f7dk8s\u7684\u8f6f\u4ef6\u88c5\u5728\u672c\u5730\u670d\u52a1\u5668\u4e0a\uff0c\u8fd8\u8981\u4e0b\u8f7dk8s\u76f8\u5173\u7684\u63d2\u4ef6\uff0c\u914d\u7f6e\u7f51\u7edc\u7b49\u7b49\u4e00\u7cfb\u5217\u8bbe\u7f6e\uff0c\u7ecf\u8fc7\u5404\u79cd\u8c03\u8bd5\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\u3002\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u7528\u8fc7\u4e91\u7684\u670b\u53cb\u81ea\u7136\u662f\u62d2\u7edd\u7684\u2014\u2014\u5305\u62ec\u6211\uff0c\u5b9e\u7528\u4e3b\u4e49\u544a\u8bc9\u6211\u4eec\uff0c\u53ea\u8981\u66f4\u5feb\u8fbe\u5230\u76ee\u7684\u4e0d\u8bba\u8fc7\u7a0b\u548c\u624b\u6bb5\uff0c\u80fd\u76f4\u63a5\u7528\u6258\u7ba1\u7684\uff0c\u5e72\u561b\u8d39\u529b\u8d39\u65f6\u627e\u6761\u5f2f\u8def\u8d70\u5462\u3002 -- D.C \u5148\u4e0a\u4e2a\u73cd\u85cf\u591a\u5e74\u7684k8s\u57fa\u7840\u539f\u7406\u56fe\uff1a","title":"Use k8s on AWS - EKS service"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#_1","text":"Master : \u5305\u5de5\u5934\u4e3b\u8282\u70b9,\u7528\u6765\u8c03\u5ea6k8s\u96c6\u7fa4,\u5934\u4e0a\u63a5\u6536\u5916\u90e8\u7684api\u8bf7\u6c42\uff0c\u4ece\u800c\u8fdb\u884c\u4efb\u52a1\u5206\u914d\u548c\u8c03\u5ea6\u7b49\u3002 kube-apiserver : k8s\u5bf9\u5916\u7684\u670d\u52a1\u5165\u53e3\uff0c\u901a\u4fe1\u7ebd\u5e26\uff0c\u65e0\u72b6\u6001\uff0c\u6c34\u5e73\u6269\u5c55\u3002 Kube-scheduler : \u8d1f\u8d23\u5bf9pod\u7684\u4efb\u52a1\u8c03\u5ea6\u3002 kube-controller-manager : \u5904\u7406node\u8282\u70b9\u7684\u5f53\u673a\u554a\uff0cpod\u7684\u526f\u672c\u6570\u554a\uff0c\u7ba1\u7406endpoint\u7ec8\u7aef\u8282\u70b9\uff0c\u8fde\u63a5service\u548cpod\u3001\u4e3a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u9ed8\u8ba4api token\u548caccounts\u3002 etcd : etcd\u662fkubernetes\u96c6\u7fa4\u7528\u6765\u5b58\u50a8\u96c6\u7fa4\u76f8\u5173\u6570\u636e\u7684\u6570\u636e\u4ed3\u5e93\u3002 node : worknodes\uff0c\u5e72\u6d3b\u7684\u8282\u70b9\u3002\u6267\u884c\u5305\u5de5\u5934master\u8282\u70b9\u6307\u6d3e\u7684\u642c\u7816\u4efb\u52a1\u3002 kubelet :\u8d1f\u8d23\u542f\u52a8\u505c\u6b62\u5bb9\u5668\uff0c\u4fdd\u8bc1\u5bb9\u5668\u8fd0\u884c\u3002 kube-proxy :\u8d1f\u8d23\u6839\u636eservice\u751f\u6210\u7f51\u7edc\u89c4\u5219\uff0c\u751f\u6210\u8def\u7531\u89c4\u5219\u3002 Docker engine : \u8fd9\u4e2a\u4e0d\u7528\u8bf4\u4e86\uff0c\u4e00\u4e2apod\u91cc\u9762\u53ef\u4ee5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u3002 Pod : k8s \u4ee5pod\u4e3a\u6700\u5c0f\u5355\u4f4d\u8fdb\u884c\u8c03\u5ea6\u3001\u6269\u5c55\u3001\u5171\u4eab\u8d44\u6e90\u3001\u7ba1\u7406\u751f\u547d\u5468\u671f\u3002\u5728\u4e00\u4e2apod\u91cc\u6240\u6709\u7684\u5bb9\u5668\u5171\u4eab\u4ee5\u4e0b\u8d44\u6e90: PID\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u770b\u5230\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u8fdb\u7a0bID\u3002 \u7f51\u7edc\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u8bbf\u95ee\u540c\u4e00\u4e2aIP\u548c\u7aef\u53e3\u8303\u56f4\u3002 IPC\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u4f7f\u7528SystemV IPC\u6216POSIX\u6d88\u606f\u961f\u5217\u8fdb\u884c\u901a\u4fe1\u3002 UTS\u547d\u540d\u7a7a\u95f4 : Pod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u5171\u4eab\u4e00\u4e2a\u4e3b\u673a\u540d\u3002 Volumes(\u5171\u4eab\u5b58\u50a8\u5377) : Pod\u4e2d\u7684\u5404\u4e2a\u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u5728Pod\u7ea7\u522b\u5b9a\u4e49\u7684Volumes\u3002 \u597d\u4e86\uff0c\u5c31\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e86\u89e3\u8fd9\u4e48\u591a\u6211\u89c9\u5f97\u5c31\u591f\u4e86\uff0c\u518d\u8bf4\u4f1a\u6655\u3002","title":"\u540d\u8bcd\u89e3\u91ca"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#k8s","text":"\u8fd9\u79cd\u642d\u5efa\u65b9\u5f0f\u53ea\u6709\u4e00\u79cd\u53ef\u80fd\uff0c\u5c31\u662f\u672c\u5730\u4f20\u7edf\u73a9\u5bb6\uff0c\u6559\u7a0b\u7f51\u4e0a\u4e00\u5927\u5806\uff0c\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u57fa\u672c\u6b65\u9aa4\uff1a \u51c6\u5907\u51e0\u53f0\u865a\u62df\u673a \u914d\u7f6e\u4e3b\u673a\u540d\u4e0e\u9759\u6001IP \u5173\u95ed\u9632\u706b\u5899 \u6821\u6b63\u7cfb\u7edf\u65f6\u95f4 \u5173\u95edselinux \u5173\u95edswap IPv4\u6d41\u91cf\u4f20\u9012\u5230iptable \u5728\u6240\u6709\u8282\u70b9\u5b89\u88c5Docker\u548cKubeadm\u548cKubelet\u548cKubectl \u90e8\u7f72k8s master \u90e8\u7f72Pod\u7f51\u7edc\u67e5\u4ef6CNI \u52a0\u5165k8s Node \u6d4b\u8bd5k8s\u96c6\u7fa4 \u597d\u4f3c\u88f9\u811a\u5e03\uff0c\u53c8\u81ed\u53c8\u957f\uff0c\u611f\u89c9\u6bcf\u4e00\u6b65\u90fd\u53ef\u80fd\u7f20\u4f4f\u6211\u7684\u8116\u5b50\uff0c\u8ba9\u6211\u5206\u5206\u949f\u4ece\u5165\u95e8\u5230\u653e\u5f03\u3002","title":"\u4ece\u5934\u642d\u5efak8s"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#eks-managed-k8s-on-aws","text":"aws \u6258\u7ba1\u7684k8s\u670d\u52a1\uff08\u76ee\u524d\u66f4\u65b0\u52301.15\uff09\uff0c\u4e2d\u56fd\u533a\u53ef\u7528\uff0c\u662f\u4e00\u9879\u5b8c\u5168\u6258\u7ba1\u7684 Kubernetes \u670d\u52a1\u3002\u51fa\u4e8e\u5176\u5b89\u5168\u6027\u3001\u53ef\u9760\u6027\u548c\u53ef\u6269\u5c55\u6027\uff0cIntel\u3001Snap\u3001Intuit\u3001GoDaddy \u548c Autodesk \u7b49\u5ba2\u6237\u90fd\u5728\u4f7f\u7528\u5b83\u6765\u8fd0\u884c\u4ed6\u4eec\u6700\u654f\u611f\u7684\u4efb\u52a1\u5173\u952e\u578b\u5e94\u7528\u7a0b\u5e8f\u3002 EKS\u6709\u51e0\u4e2a\u7279\u6027\uff1a \u6258\u7ba1 \uff1a\u4e24\u4e2a\u5b57\uff0c\u7701\u5fc3\uff0c\u591a\u6d3b\u51e0\u5e74\u3002 \u81ea\u52a8\u9ad8\u53ef\u7528 \uff1a\u53ef\u8de8\u591a\u4e2a AWS \u53ef\u7528\u533a\u8fd0\u884c Kubernetes \u7ba1\u7406\u57fa\u7840\u8bbe\u65bd\u3001\u81ea\u52a8\u68c0\u6d4b\u548c\u66ff\u6362\u8fd0\u884c\u72b6\u51b5\u4e0d\u4f73\u7684\u63a7\u5236\u5e73\u9762\u8282\u70b9\uff0c\u5e76\u63d0\u4f9b\u96f6\u505c\u673a\u65f6\u95f4\u7684\u6309\u9700\u5347\u7ea7\u548c\u4fee\u8865 \u63d0\u4f9b\u65e0\u670d\u52a1\u5668\u9009\u9879 - \u652f\u6301 AWS Fargate \u4e3a\u5bb9\u5668\u63d0\u4f9b\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u529f\u80fd\u3002\u4f7f\u7528 Fargate\uff0c\u60a8\u65e0\u9700\u9884\u7f6e\u548c\u7ba1\u7406\u670d\u52a1\u5668\uff0c\u800c\u4e14\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u8d44\u6e90\u5e76\u4e3a\u5176\u4ed8\u8d39\uff0c\u5e76\u901a\u8fc7\u8bbe\u8ba1\u9694\u79bb\u5e94\u7528\u7a0b\u5e8f\u6765\u63d0\u9ad8\u5b89\u5168\u6027\u3002 \u5b89\u5168 \uff1a\u81ea\u52a8\u5c06\u6700\u65b0\u7684\u5b89\u5168\u8865\u4e01\u5e94\u7528\u5230\u60a8\u7684\u96c6\u7fa4\u63a7\u5236\u5e73\u9762\u3002AWS \u8fd8\u4e0e\u793e\u533a\u7d27\u5bc6\u5408\u4f5c\uff0c\u4ee5\u786e\u4fdd\u5728\u5c06\u65b0\u7248\u672c\u548c\u8865\u4e01\u90e8\u7f72\u5230\u73b0\u6709\u96c6\u7fa4\u4e4b\u524d\u89e3\u51b3\u5173\u952e\u7684\u5b89\u5168\u95ee\u9898\u3002 \u901a\u8fc7\u793e\u533a\u6784\u5efa \uff1a\u53ef\u8fd0\u884c\u4e0a\u6e38 Kubernetes\uff0c\u4e14\u7ecf\u8ba4\u8bc1\u53ef\u4e0e Kubernetes \u517c\u5bb9\uff0c\u56e0\u6b64 EKS \u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e0e\u6240\u6709\u6807\u51c6 Kubernetes \u73af\u5883\u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\u5b8c\u5168\u517c\u5bb9\u3002AWS \u4e3b\u52a8\u4e0e Kubernetes \u793e\u533a\u5408\u4f5c\uff0c\u5176\u4e2d\u5305\u62ec\u4e3a Kubernetes \u4ee3\u7801\u5e93\u505a\u8d21\u732e\uff0c\u4ee5\u5e2e\u52a9\u60a8\u5145\u5206\u5229\u7528 AWS \u670d\u52a1\u548c\u529f\u80fd\u3002 EKS\u90e8\u7f72\u6709\u4e09\u79cd\u65b9\u5f0f\uff1a AWS \u63a7\u5236\u53f0 - \u9f20\u6807\u70b9\u70b9\u70b9 eksctl \u547d\u4ee4\u884c CloudFormation/CDK \u597d\u4e86\uff0c\u4e86\u89e3\u5230\u8fd9\u91cc\u4e5f\u591f\u4e86\uff0c\u5426\u5219\u5c31\u4e0d\u53eb\u6258\u7ba1\u4e86\u3002","title":"EKS - managed k8s on aws"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#eksk8s","text":"\u51c6\u5907\u5de5\u4f5c\u662f\u8981\u786e\u8ba4\u4f60\u73b0\u5728\u6267\u884c\u547d\u4ee4\u7684shell\u5177\u4e0d\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6\uff1a \u662f\u5426\u5b89\u88c5\u5e76\u914d\u7f6e\u597d\u6700\u65b0\u7684 AWSCLI2 \u662f\u5426\u5b89\u88c5\u4e86 eksctl \u662f\u5426\u5b89\u88c5\u4e86 Kubectl \u5982\u679c\u7b54\u6848\u90fd\u662fyes\uff0c\u90a3\u4e48\u6267\u884ceksctl\u547d\u4ee4\u4e00\u952e\u90e8\u7f72EKS\uff1a $ eksctl create cluster \\ > --name myeks \\ > --version 1.15 \\ > --region cn-northwest-1 \\ > --nodegroup-name workers \\ > --node-type m5.large \\ > --nodes 3 \\ > --managed [\u2139] eksctl version 0.15.0 [\u2139] using region cn-northwest-1 [\u2139] setting availability zones to [cn-northwest-1c cn-northwest-1a cn-northwest-1b] [\u2139] subnets for cn-northwest-1c - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] subnets for cn-northwest-1a - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] subnets for cn-northwest-1b - public:192.168.xx.xx/19 private:192.168.xx.xx/19 [\u2139] using Kubernetes version 1.15 [\u2139] creating EKS cluster \"myeks\" in \"cn-northwest-1\" region with managed nodes [\u2139] will create 2 separate CloudFormation stacks for cluster itself and the initial managed nodegroup [\u2139] if you encounter any issues, check CloudFormation console or try 'eksctl utils describe-stacks --region=cn-northwest-1 --cluster=myeks' [\u2139] CloudWatch logging will not be enabled for cluster \"myeks\" in \"cn-northwest-1\" [\u2139] you can enable it with 'eksctl utils update-cluster-logging --region=cn-northwest-1 --cluster=myeks' [\u2139] Kubernetes API endpoint access will use default of {publicAccess=true, privateAccess=false} for cluster \"myeks\" in \"cn-northwest-1\" [\u2139] 2 sequential tasks: { create cluster control plane \"myeks\", create managed nodegroup \"workers\" } [\u2139] building cluster stack \"eksctl-myeks-cluster\" [\u2139] deploying stack \"eksctl-myeks-cluster\" [\u2139] building managed nodegroup stack \"eksctl-myeks-nodegroup-workers\" [\u2139] deploying stack \"eksctl-myeks-nodegroup-workers\" [\u2714] all EKS cluster resources for \"myeks\" have been created [\u2714] saved kubeconfig as \"C:\\\\Users\\\\xxx/.kube/config\" [\u2139] nodegroup \"workers\" has 3 node(s) [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] waiting for at least 3 node(s) to become ready in \"workers\" [\u2139] nodegroup \"workers\" has 3 node(s) [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] node \"ip-192-168-xx-xx.cn-northwest-1.compute.internal\" is ready [\u2139] kubectl command should work with \"C:\\\\Users\\\\xxx/.kube/config\", try 'kubectl get nodes' [\u2714] EKS cluster \"myeks\" in \"cn-northwest-1\" region is ready \u8fd9\u6837\u9ed8\u8ba4\u90e8\u7f72\u7684\u96c6\u7fa4\u67b6\u6784\u957f\u8fd9\u6837\uff0c\u5f53\u7136\u540e\u671f\u6211\u4e5f\u53ef\u4ee5\u770beks\u6587\u6863\u6309\u7167\u6211\u5b9e\u9645\u5de5\u4f5c\u8c03\u6574\uff1a \u8fdbAWS console\u7684EKS\u670d\u52a1\u770b\u4e0b\uff0cmyeks\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\uff01\u70b9\u8fdb\u53bb\u770b\u5230\uff0c3\u4e2a\u642c\u7816\u5de5\u5df2\u7ecfready\uff01 PS: \u5176\u5b9e\u5462\uff0c\u4e00\u952e\u90e8\u7f72\u80cc\u540e\u8fd8\u662f\u8c03\u7528\u4e86AWS\u7684\u81ea\u52a8\u5316\u90e8\u7f72\u795e\u5668 - CloudFormation \u5982\u679c\u6211\u4e0d\u60f3\u6240\u6709\u8d44\u6e90\u90fd\u65b0\u5efa\uff0c\u800c\u662f\u628a\u96c6\u7fa4\u653e\u5728\u73b0\u6709\u7684VPC\u4e0b\uff0c\u90a3\u5c31\u52a0\u4e0a\u8fd9\u4e9b\u9009\u9879\uff1a --vpc-public-subnets public_subnet_1a, public_subnet_1b \\ --vpc-private-subnets private_subnet_1a, prviate_subnet_1b \\ \u5176\u4ed6\u9009\u9879\uff1a --ssh-public-key eks-bjs # \u6307\u5b9a\u73b0\u6709\u7684pem\u6587\u4ef6 --node-ami ami-xxxx # \u53ef\u4ee5\u6307\u5b9a\u81ea\u5df1\u7684ami, but --managed unable to used --node-ami-family # \u6307\u5b9aOS\u7cfb\u7edf, default is Amazon Linux 2 # AmazonLinux2, Ubuntu1804, WindowsServer2019FullContainer, WindowsServer2019CoreContainer $ AWS_PROFILE=bjs # \u6307\u5b9a\u7528\u54ea\u4e2aaksk\u8eab\u4efd\u6765\u521b\u5efa\u96c6\u7fa4 cat ~/.aws/config \u53ef\u4ee5\u770b","title":"\u4e00\u952e\u521b\u5efaEKS\u96c6\u7fa4\uff08k8s\uff09"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#eks","text":"\u5728\u672c\u673a\u7528awscli\u628aEKS\u96c6\u7fa4\u7684\u4fe1\u606f\u540c\u6b65\u5230 kubeconfig \u6587\u4ef6\u3002 $ aws eks update-kubeconfig --name <cluster_name> \u4f8b\u5982\uff1a $ aws eks update-kubeconfig --name myeks Added new context arn:aws-cn:eks:cn-northwest-1:xxxxxxxxxxxx:cluster/myeks to C:\\Users\\xxxx\\.kube\\config \u67e5\u770bnodes\uff1a $ kubectl get nodes NAME STATUS ROLES AGE VERSION ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m55s v1.15.10-eks-bac369 ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m49s v1.15.10-eks-bac369 ip-192-168-xx-xx.cn-northwest-1.compute.internal Ready <none> 7m41s v1.15.10-eks-bac369","title":"\u7ba1\u7406EKS"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#_2","text":"\u8fd9\u91cc\u6211\u4eec\u6574\u4e2a\u6700\u7b80\u5355\u7684web\u670d\u52a1nginx\u6d4b\u8bd5\u4e0b\u5427\uff0c\u65b0\u5efa\u4e00\u4e2adockerfile\uff0c\u8fd9\u4e2a\u529f\u80fd\u5f88\u7b80\u5355\uff0c \u5c31\u662f\u63d0\u4f9b\u4e00\u4e2aweb\u670d\u52a1\u5668\uff0c\u7136\u540e\u9875\u9762\u663e\u793a \u201c Hello, Docker!\u201d \u3002 $ vim dockerfile FROM nginx RUN echo '<h1>Hello, Docker!</h1>' > /usr/share/nginx/html/index.html \u5728aws console\u7684ECR\u91cc\u65b0\u5efa\u4e00\u4e2a\u955c\u50cf\u4ed3\u5e93\uff0c\u7528\u6765\u5b58\u653e\u955c\u50cf\u3002\u8bb0\u4f4f\uff0caws\u4e0a\u6240\u6709\u7684\u955c\u50cf\u90fd\u662f\u6ce8\u518c\u5728ECR\u4e0a\u7edf\u4e00\u7ba1\u7406\u7684\uff0c\u8ba9\u6211\u60f3\u8d77\u4e86\u67d0\u4e91\u7684\u5bb9\u5668\u5c45\u7136\u5c31\u76f4\u63a5\u4e22\u5728\u5bf9\u8c61\u5b58\u50a8\u91cc\uff0c\u846c\u7231\u5bb6\u65cf\u8f7b\u72c2\u4e0d\u7f81\u3002 \u521b\u5efa\u672c\u673adocker\u5e76\u6ce8\u518c\u5230ECR\u7684\u955c\u50cf\u4ed3\u5e93\u91cc\u3002 $ docker build . -t xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest $ docker images REPOSITORY TAG IMAGE ID CREATED SIZE xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest latest fef472de0787 47 hours ago 127MB nginx latest ed21b7a8aee9 2 weeks ago 127MB $ aws ecr get-login-password --region cn-northwest-1 | docker login --username AWS --password-stdin xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest Login Succeeded $ docker push xxxxxxxxxxx.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest:latest \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2adocker\u5df2\u7ecf\u63a8\u5230\u4ed3\u5e93\u4e86\u3002 \u63a5\u4e0b\u6765\u521b\u5efaYAML\u6587\u4ef6\u5e76\u7528kubectl\u90e8\u7f72\u3002 \u521b\u5efaYAML\u6587\u4ef6 nginx-deployment.yaml , \u90e8\u7f72nginx apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment labels: app: nginx spec: replicas: 3 selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: - name: nginx image: <account_id>.dkr.ecr.cn-northwest-1.amazonaws.com.cn/ekstest:latest # \u81ea\u884c\u4fee\u6539ID ports: - containerPort: 80 $ kubectl.exe apply -f nginx-deployment.yaml deployment.apps/nginx-deployment created $ kubectl.exe get pods NAME READY STATUS RESTARTS AGE nginx-deployment-75d669445d-k2nqg 1/1 Running 0 2m46s nginx-deployment-75d669445d-x6z7d 1/1 Running 0 2m46s nginx-deployment-75d669445d-xdfdx 1/1 Running 0 2m46s \u521b\u5efaYAML\u6587\u4ef6 nginx-svc-nlb.yaml ,\u90e8\u7f72\u7c7b\u578b\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u7684service (AWS Network Load Balance \u670d\u52a1) apiVersion: v1 kind: Service metadata: name: nginx-svc annotations: service.beta.kubernetes.io/aws-load-balancer-type: \"nlb\" spec: type: LoadBalancer selector: app: nginx ports: - protocol: TCP name: http port: 80 targetPort: 80 $ kubectl.exe apply -f nginx-svc-nlb.yaml service/nginx-svc created $ kubectl.exe get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.100.0.1 <none> 443/TCP 51m nginx-svc LoadBalancer 10.100.179.159 a9d4exxxxxxxxxxxxxxxxxxxxxx-dd11xxxxxxx.elb.cn-northwest-1.amazonaws.com.cn 80:30428/TCP 30s \u53ef\u4ee5\u770b\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u5df2\u7ecf\u8d77\u6765\u4e86\uff0c\u6211\u4eec\u5728aws console\u4e2d\u53ef\u4ee5\u770b\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u72b6\u6001\u4ece provisioning \u53d8\u6210 active \u3002 \u7528\u7f51\u9875\u6253\u5f00LoadBalancer\u7684DNS\u5730\u5740 a9d4exxxxxxxxxxxxxxxxxxxxxx-dd11xxxxxxx.elb.cn-northwest-1.amazonaws.com.cn ,\u770b\u5230\u4e86\u4ec0\u4e48\uff1f","title":"\u90e8\u7f72\u5e94\u7528"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#k8sip","text":"Kubernetes\u96c6\u7fa4\u91cc\u6709\u4e09\u79cdIP\u5730\u5740\uff0c\u5206\u522b\u5982\u4e0b\uff1a Node IP \uff1aNode\u8282\u70b9\u7684IP\u5730\u5740\uff0c\u5373\u7269\u7406\u7f51\u5361\u7684IP\u5730\u5740\u3002 Pod IP \uff1aPod\u7684IP\u5730\u5740\uff0c\u5373docker\u5bb9\u5668\u7684IP\u5730\u5740\uff0c\u6b64\u4e3a\u865a\u62dfIP\u5730\u5740\u3002 Cluster IP \uff1aService\u7684IP\u5730\u5740\uff0c\u6b64\u4e3a\u865a\u62dfIP\u5730\u5740\u3002","title":"\u5173\u4e8ek8s\u91cc\u7684IP\u5730\u5740"},{"location":"blogs/2020-04-15-use-k8s-on-aws-EKS/#_3","text":"EKS\u5b66\u4e60\u8bb2\u5ea7\u89c6\u9891 aws_EKS_guide eksctl aws_EKS_api aws_cli_eks aws_sdk_python_EKS k8s\u4e2d\u6587\u6587\u6863 \u4eba\u751f\u82e6\u77ed\uff0c\u6211\u7528\u6258\u7ba1\u3002","title":"\u5b66\u4e60\u94fe\u63a5"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/","text":"\u5982\u4f55\u7ed9EC2\u670d\u52a1\u5668\u5b89\u88c5\u56fe\u5f62\u5316\u684c\u9762 \u56e0\u4e3aAWS\u7684\u865a\u62df\u673aEC2\u9ed8\u8ba4\u90fd\u662fserver\u7248\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5bf9\u4e8e\u7528\u60ef\u4e86\u754c\u9762\u7684\u7ae5\u978b\u672a\u514d\u6709\u4e9b\u6b8b\u5fcd\uff0c\u4eca\u5929\u6211\u4eec\u5c31\u6765DIY\u4e00\u6b3e\u5e26\u684c\u9762\u7684\u670d\u52a1\u5668\u5427\uff01 -- D.C \u542f\u52a8EC2\uff0c\u9009\u62e9\u5408\u9002\u7684\u955c\u50cf\u3002 \u8fd9\u91cc\u4ee5centos7\u4e3a\u4f8b\uff0c\u542f\u52a8\u5b9e\u4f8b\uff0c\u641c\u7d22AMI ID \u4e3a ami-0a809ad76fc7e8390 \u7684centos7\u955c\u50cf\uff0c\u542f\u52a8\u3002 \u767b\u5f55EC2\uff0c\u5b89\u88c5\u63d2\u4ef6\u3002 ssh -i \"yourkey.pem\" centos@ec2-xxx-xxx-xxx-xx.cn-northwest-1.compute.amazonaws.com.cn \u5b89\u88c5\u5fc5\u8981\u7684\u56fe\u5f62\u5316\u63d2\u4ef6\u548cvnc server\u3002 sudo yum groups install \"X Window System\" -y sudo yum install gnome-classic-session gnome-terminal nautilus-open-terminal control-center liberation-mono-fonts -y sudo systemctl set-default graphical.target sudo yum install tigervnc-serve \u521b\u5efavncserver\u7684\u914d\u7f6e\u670d\u52a1\u5e76\u4fee\u6539\u3002 sudo cp /lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@:1.service sudo vi /etc/systemd/system/vncserver@:1.service \u4fee\u6539\u4e3a\uff1a [Unit] Description=Remote desktop service (VNC) After=syslog.target network.target [Service] Type=forking User=root # Clean any existing files in /tmp/.X11-unix environment ExecStartPre=/bin/sh -c '/usr/bin/vncserver -kill %i > /dev/null 2>&1 || :' ExecStart=/sbin/runuser -l root -c \"/usr/bin/vncserver %i -geometry 1280x720\" PIDFile=/root/.vnc/%H%i.pid ExecStop=/bin/sh -c '/usr/bin/vncserver -kill %i > /dev/null 2>&1 || :' [Install] WantedBy=multi-user.target \u4fdd\u5b58\uff0c\u9000\u51fa\u3002 \u8bbe\u7f6evnc\u767b\u5f55\u5bc6\u7801\u5e76\u542f\u52a8vnc\u670d\u52a1\u3002 sudo vncpasswd Password: Verify: Would you like to enter a view-only password (y/n)? n A view-only password is not used \u542f\u52a8\u670d\u52a1\uff1a $sudo systemctl daemon-reload $sudo systemctl start vncserver@:1.service $sudo systemctl status -l vncserver@:1.service \u25cf vncserver@:1.service - Remote desktop service (VNC) Loaded: loaded (/etc/systemd/system/vncserver@:1.service; disabled; vendor preset: disabled) Active: active (running) since Tue 2020-05-12 09:28:38 UTC; 2s ago Process: 2764 ExecStart=/sbin/runuser -l root -c /usr/bin/vncserver %i -geometry 1280x720 (code=exited, status=0/SUCCESS) Process: 2759 ExecStartPre=/bin/sh -c /usr/bin/vncserver -kill %i > /dev/null 2>&1 || : (code=exited, status=0/SUCCESS) Main PID: 2782 (Xvnc) CGroup: /system.slice/system-vncserver.slice/vncserver@:1.service \u2023 2782 /usr/bin/Xvnc :1 -auth /root/.Xauthority -desktop ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal:1 (root) -fp catalogue:/etc/X11/fontpath.d -geometry 1280x720 -pn -rfbauth /root/.vnc/passwd -rfbport 5901 -rfbwait 30000 May 12 09:28:35 ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal systemd[1]: Starting Remote desktop service (VNC)... May 12 09:28:38 ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal systemd[1]: Started Remote desktop service (VNC). $sudo systemctl enable vncserver@:1.service #\u5f00\u673a\u542f\u52a8 \u786e\u8ba4\u4e0b\uff1a $ ps -ef | grep vnc root 2782 1 0 09:28 ? 00:00:00 /usr/bin/Xvnc :1 -auth /root/.Xauthority -desktop ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal:1 (root) -fp catalogue:/etc/X11/fontpath.d -geometry 1280x720 -pn -rfbauth /root/.vnc/passwd -rfbport 5901 -rfbwait 30000 root 2787 1 0 09:28 ? 00:00:00 /bin/sh /root/.vnc/xstartup centos 3255 1155 0 09:29 pts/0 00:00:00 grep --color=auto vnc \u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219 \u5141\u8bb8vnc\u901a\u8fc75901\u7aef\u53e3\u8bbf\u95ee\u670d\u52a1\u5668\u3002 sudo firewall-cmd --add-port=5901/tcp --permanent \u4fee\u6539\u8fd9\u53f0EC2\u7684\u5b89\u5168\u7ec4SG \u5728\u5b89\u5168\u7ec4\u6dfb\u52a0\u4e00\u6761TCP\u89c4\u5219\uff0c\u5141\u8bb85901\u7aef\u53e3\u3002 \u5728\u672c\u5730\u5b89\u88c5VNCViewer \u4e0b\u8f7d\u8f6f\u4ef6 VNCViewer \u8f93\u5165EC2\u7684\u516c\u7f51IP:5901, \u56de\u8f66\u3002 \u786e\u8ba4\u4ee5\u540e\uff0c\u8f93\u5165\u4f60\u7684vncpasswd\uff0c\u70b9\u51fb\u8fde\u63a5\uff0cbingo~ enjoy~ PS: \u5176\u4f59\u7cfb\u7edf\u5b89\u88c5\u6b65\u9aa4\u90fd\u5dee\u4e0d\u591a \u756a\u5916 \u5982\u679c\u6709\u540c\u5b66\u4e0d\u60f3\u76f4\u63a5\u88c5\uff0c\u90a3\u4e48\u76f4\u63a5\u5728\u516c\u6709\u955c\u50cf\u91cc\u641c\u7d22AMI ID ami-00b7f7c2e82fb6706 \u542f\u52a8EC2. SSH\u8fde\u63a5EC2, \u6267\u884c sudo systemctl start vncserver@:1.service \u7528VNCViewer\u8fde\u63a5\u5427 \u9ec4\u6c99\u767e\u6218\u7a7f\u91d1\u7532\uff0c\u4e0d\u7834\u697c\u5170\u7ec8\u4e0d\u8fd8\u3002","title":"\u5982\u4f55\u7ed9EC2\u670d\u52a1\u5668\u5b89\u88c5\u56fe\u5f62\u5316\u684c\u9762"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#ec2","text":"\u56e0\u4e3aAWS\u7684\u865a\u62df\u673aEC2\u9ed8\u8ba4\u90fd\u662fserver\u7248\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5bf9\u4e8e\u7528\u60ef\u4e86\u754c\u9762\u7684\u7ae5\u978b\u672a\u514d\u6709\u4e9b\u6b8b\u5fcd\uff0c\u4eca\u5929\u6211\u4eec\u5c31\u6765DIY\u4e00\u6b3e\u5e26\u684c\u9762\u7684\u670d\u52a1\u5668\u5427\uff01 -- D.C","title":"\u5982\u4f55\u7ed9EC2\u670d\u52a1\u5668\u5b89\u88c5\u56fe\u5f62\u5316\u684c\u9762"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#ec2_1","text":"\u8fd9\u91cc\u4ee5centos7\u4e3a\u4f8b\uff0c\u542f\u52a8\u5b9e\u4f8b\uff0c\u641c\u7d22AMI ID \u4e3a ami-0a809ad76fc7e8390 \u7684centos7\u955c\u50cf\uff0c\u542f\u52a8\u3002","title":"\u542f\u52a8EC2\uff0c\u9009\u62e9\u5408\u9002\u7684\u955c\u50cf\u3002"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#ec2_2","text":"ssh -i \"yourkey.pem\" centos@ec2-xxx-xxx-xxx-xx.cn-northwest-1.compute.amazonaws.com.cn \u5b89\u88c5\u5fc5\u8981\u7684\u56fe\u5f62\u5316\u63d2\u4ef6\u548cvnc server\u3002 sudo yum groups install \"X Window System\" -y sudo yum install gnome-classic-session gnome-terminal nautilus-open-terminal control-center liberation-mono-fonts -y sudo systemctl set-default graphical.target sudo yum install tigervnc-serve","title":"\u767b\u5f55EC2\uff0c\u5b89\u88c5\u63d2\u4ef6\u3002"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#vncserver","text":"sudo cp /lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@:1.service sudo vi /etc/systemd/system/vncserver@:1.service \u4fee\u6539\u4e3a\uff1a [Unit] Description=Remote desktop service (VNC) After=syslog.target network.target [Service] Type=forking User=root # Clean any existing files in /tmp/.X11-unix environment ExecStartPre=/bin/sh -c '/usr/bin/vncserver -kill %i > /dev/null 2>&1 || :' ExecStart=/sbin/runuser -l root -c \"/usr/bin/vncserver %i -geometry 1280x720\" PIDFile=/root/.vnc/%H%i.pid ExecStop=/bin/sh -c '/usr/bin/vncserver -kill %i > /dev/null 2>&1 || :' [Install] WantedBy=multi-user.target \u4fdd\u5b58\uff0c\u9000\u51fa\u3002","title":"\u521b\u5efavncserver\u7684\u914d\u7f6e\u670d\u52a1\u5e76\u4fee\u6539\u3002"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#vncvnc","text":"sudo vncpasswd Password: Verify: Would you like to enter a view-only password (y/n)? n A view-only password is not used \u542f\u52a8\u670d\u52a1\uff1a $sudo systemctl daemon-reload $sudo systemctl start vncserver@:1.service $sudo systemctl status -l vncserver@:1.service \u25cf vncserver@:1.service - Remote desktop service (VNC) Loaded: loaded (/etc/systemd/system/vncserver@:1.service; disabled; vendor preset: disabled) Active: active (running) since Tue 2020-05-12 09:28:38 UTC; 2s ago Process: 2764 ExecStart=/sbin/runuser -l root -c /usr/bin/vncserver %i -geometry 1280x720 (code=exited, status=0/SUCCESS) Process: 2759 ExecStartPre=/bin/sh -c /usr/bin/vncserver -kill %i > /dev/null 2>&1 || : (code=exited, status=0/SUCCESS) Main PID: 2782 (Xvnc) CGroup: /system.slice/system-vncserver.slice/vncserver@:1.service \u2023 2782 /usr/bin/Xvnc :1 -auth /root/.Xauthority -desktop ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal:1 (root) -fp catalogue:/etc/X11/fontpath.d -geometry 1280x720 -pn -rfbauth /root/.vnc/passwd -rfbport 5901 -rfbwait 30000 May 12 09:28:35 ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal systemd[1]: Starting Remote desktop service (VNC)... May 12 09:28:38 ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal systemd[1]: Started Remote desktop service (VNC). $sudo systemctl enable vncserver@:1.service #\u5f00\u673a\u542f\u52a8 \u786e\u8ba4\u4e0b\uff1a $ ps -ef | grep vnc root 2782 1 0 09:28 ? 00:00:00 /usr/bin/Xvnc :1 -auth /root/.Xauthority -desktop ip-xxx-xxx-xxx-xxx.cn-northwest-1.compute.internal:1 (root) -fp catalogue:/etc/X11/fontpath.d -geometry 1280x720 -pn -rfbauth /root/.vnc/passwd -rfbport 5901 -rfbwait 30000 root 2787 1 0 09:28 ? 00:00:00 /bin/sh /root/.vnc/xstartup centos 3255 1155 0 09:29 pts/0 00:00:00 grep --color=auto vnc","title":"\u8bbe\u7f6evnc\u767b\u5f55\u5bc6\u7801\u5e76\u542f\u52a8vnc\u670d\u52a1\u3002"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#_1","text":"\u5141\u8bb8vnc\u901a\u8fc75901\u7aef\u53e3\u8bbf\u95ee\u670d\u52a1\u5668\u3002 sudo firewall-cmd --add-port=5901/tcp --permanent","title":"\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#ec2sg","text":"\u5728\u5b89\u5168\u7ec4\u6dfb\u52a0\u4e00\u6761TCP\u89c4\u5219\uff0c\u5141\u8bb85901\u7aef\u53e3\u3002","title":"\u4fee\u6539\u8fd9\u53f0EC2\u7684\u5b89\u5168\u7ec4SG"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#vncviewer","text":"\u4e0b\u8f7d\u8f6f\u4ef6 VNCViewer \u8f93\u5165EC2\u7684\u516c\u7f51IP:5901, \u56de\u8f66\u3002 \u786e\u8ba4\u4ee5\u540e\uff0c\u8f93\u5165\u4f60\u7684vncpasswd\uff0c\u70b9\u51fb\u8fde\u63a5\uff0cbingo~ enjoy~ PS: \u5176\u4f59\u7cfb\u7edf\u5b89\u88c5\u6b65\u9aa4\u90fd\u5dee\u4e0d\u591a","title":"\u5728\u672c\u5730\u5b89\u88c5VNCViewer"},{"location":"blogs/2020-05-12-install_GUI_on_EC2/#_2","text":"\u5982\u679c\u6709\u540c\u5b66\u4e0d\u60f3\u76f4\u63a5\u88c5\uff0c\u90a3\u4e48\u76f4\u63a5\u5728\u516c\u6709\u955c\u50cf\u91cc\u641c\u7d22AMI ID ami-00b7f7c2e82fb6706 \u542f\u52a8EC2. SSH\u8fde\u63a5EC2, \u6267\u884c sudo systemctl start vncserver@:1.service \u7528VNCViewer\u8fde\u63a5\u5427 \u9ec4\u6c99\u767e\u6218\u7a7f\u91d1\u7532\uff0c\u4e0d\u7834\u697c\u5170\u7ec8\u4e0d\u8fd8\u3002","title":"\u756a\u5916"},{"location":"blogs/2020-06-06-purchase-RI/","text":"\u5165\u95e816-\u901a\u8fc7\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\u663e\u8457\u964d\u4f4e\u6210\u672c \u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e91\u4e0a\u8d44\u6e90\u7684\u9700\u6c42\u662f\u660e\u786e\u800c\u6301\u7eed\u7684\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\uff08Reserved Instance\uff09\uff0c\u571f\u8c6a\u9664\u5916\u3002\u6b63\u5982\u6bcf\u4e2a\u4eba\u7684\u624b\u673a\u90fd\u6709\u4e00\u4e2a\u5957\u9910\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff1a \u6211\u4eec\u53ef\u4ee5\u62ff\u5230\u6309\u9700\u5b9e\u4f8b3\u6298\u5de6\u53f3\u7684\u4ef7\u683c\u6765\u957f\u671f\u8fd0\u884c\u6211\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u800c\u4e0d\u9700\u8981\u9891\u7e41\u5173\u673a\u3002 -- D.C \u6211\u4eec\u77e5\u9053AWS\u6709\u4e09\u79cd\u5b9e\u4f8b\u7c7b\u578b\uff1a\u6309\u9700\u5b9e\u4f8b\uff08\u5355\u4ef7\u6700\u9ad8\uff09\uff0c\u9884\u7559\u5b9e\u4f8b\uff08\u4fbf\u5b9c\uff0c\u53051/3\u5e74\uff09\uff0c\u7ade\u4ef7\u5b9e\u4f8b\uff08\u4fbf\u5b9c\uff0c\u53ef\u80fd\u88ab\u4e2d\u65ad\uff09\u3002 \u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u4e0b\u8fd9\u51e0\u79cd\u7c7b\u578b\u5427\uff1a \u6309\u9700\u5b9e\u4f8b\uff1a \u968f\u7528\u968f\u5f00\uff0c\u7528\u5b8c\u5c31\u5173\u3002\u81ea\u7531\u4e0d\u7f81\u7684\u540c\u65f6\u8981\u4ed8\u51fa\u4ee3(\u9ad8)\u4ef7\u3002 \u9884\u7559\u5b9e\u4f8b\uff1a \u7a33\u624e\u7a33\u6253\uff0c\u53051\u5e74\u6216\u4e09\u5e74\uff0c\u62ff\u6700\u4f4e\u6298\u6263\u3002\uff08\u5e73\u5747\u52303\u6298\uff09 \u7ade\u4ef7\u5b9e\u4f8b\uff1a \u7ade\u4ef7\u65b9\u5f0f\u53d6\u5f97\u7a7a\u95f2\u8d44\u6e90\u4f7f\u7528\u6743\uff0c\u4e0d\u9700\u8981\u627f\u8bfa\u5305\u5e74\uff0c\u540c\u65f6\u4ef7\u683c\u53ea\u6bd4\u9884\u7559\u9ad8\u4e00\u70b9\u70b9\uff0c\u53ef\u4ee5\u8bf4\u662f\u517c\u987e\u4e86\u81ea\u7531\u4e0d\u7f81\u7684\u4f7f\u7528+\u7a33\u624e\u7a33\u6253\u7684\u4ef7\u683c\uff0c\u4f46\u662f\u3002\u3002\u3002\u91cd\u8981\u7684\u4e8b\u60c5\u8bf4\u4e09\u904d\uff0c\u7a7a\u95f2\u8d44\u6e90\u5982\u679c\u88ab\u7cfb\u7edf\u6536\u56de\uff0c\u8fd0\u884c\u7684\u4efb\u52a1\u4f1a\u88ab\u4e2d\u65ad\u3002\u56e0\u6b64\u9002\u7528\u4e8e\u5206\u6790\u65f6\u95f4\u4e0d\u957f\u7684\u4efb\u52a1\uff0c\u6216\u8005\u81ea\u5df1\u505a\u597d\u4e86\u4e2d\u65ad\u540e\u91cd\u8dd1\u7684\u8c03\u5ea6\u7cfb\u7edf\uff0c\u5982\u6b64\u8fd9\u822c\u7ade\u4ef7\u5b9e\u4f8b\u662f\u6700\u9002\u5408\u7684\u3002 \u597d\u4e86\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u672c\u6587\u4ecb\u7ecd\u7684\u662f\u5982\u4f55\u5728aws console\u63a7\u5236\u9762\u677f\u4e0a\u8d2d\u4e70\u9884\u7559\u5b9e\u4f8b\uff0c\u8001\u7528\u6237\u76f4\u63a5\u70b9\u53f3\u4e0a\u65b9\u7684X\u5173\u95ed\uff0c\u4f60\u4eec\u7528\u7684\u6bd4\u6211\u719f :) \u8d2d\u4e70EC2\u9884\u7559\u5b9e\u4f8b \u767b\u5f55web\u754c\u9762\uff0c\u8fdb\u5165EC2\u63a7\u5236\u53f0,\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684Reserve Instance\uff08\u9884\u7559\u5b9e\u4f8b\uff09\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u524d\u6ca1\u6709\u4e70\u8fc7\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53f3\u4fa7\u7684\u8d2d\u4e70\u5217\u8868\u662f\u7a7a\u7a7a\u5982\u4e5f\u3002\u5982\u679c\u6709\u4e70\u8fc7\u5c31\u4f1a\u663e\u793a\u51fa\u8d2d\u4e70\u673a\u5668\u7684\u5230\u671f\u65f6\u95f4\u7b49\u4fe1\u606f\u3002 \u70b9\u51fb\u6309\u94ae Purchase Reserved Instances\uff08\u8d2d\u4e70\u9884\u7559\u5b9e\u4f8b\uff09\u3002 \u968f\u540e\u5728\u8df3\u51fa\u6765\u7684\u754c\u9762\u4e0a\u9009\u62e9\u6211\u4eec\u8981\u4e70\u7684\u673a\u5668\u4fe1\u606f\uff0c\u9009\u62e9\u641c\u7d22\uff0c\u51fa\u6765\u4ef7\u683c\u4ee5\u540e\uff0c\u4fee\u6539\u6240\u8981\u8d2d\u4e70\u7684\u53f0\u6570\uff0c\u52a0\u5165\u8d2d\u7269\u8f66\u3002 Platform\uff1a \u7cfb\u7edf\u9009\u62e9\uff0cwindows\uff0clinux\u7b49 Tenancy: \u9ed8\u8ba4\u5c31\u597d Offering Class: Standard \uff08\u6807\u51c6\uff09\u8fd8\u662f \u53ef\u8f6c\u6362 \uff08convertible\uff09, \u533a\u522b\u662f\uff0c\u5047\u5982\u6211\u4e70\u4e86c\u7cfb\u5217\u7684\u673a\u578bc5.2xlarge\uff0c\u524d\u8005\uff08\u6807\u51c6\uff09\u5141\u8bb8\u6211\u5728\u540c\u6837\u7684c\u7cfb\u5217\u673a\u578b\u4e2d\u8fdb\u884c\u81ea\u52a8\u8d44\u6e90\u5339\u914d,\u4f8b\u5982\u6211\u53ef\u4ee5\u5f00\u4e24\u53f0c5.xlarge\u540c\u6837\u4eab\u53d7\u5305\u5e74\u7684\u6298\u6263\u4ef7\uff1b\u540e\u8005\uff08\u53ef\u8f6c\u6362\uff09\u9664\u4e86\u540c\u7cfb\u5217\u673a\u578b\u5916\uff0c\u8fd8\u5141\u8bb8\u6211\u5728\u5176\u4ed6\u673a\u578b\u4f8b\u5982r\u7cfb\u5217\u6216m\u7cfb\u5217\u673a\u578b\u8fdb\u884c\u81ea\u52a8\u8d44\u6e90\u5339\u914d\u3002\u8bf4\u5230\u8fd9\u91cc\u6709\u540c\u5b66\u80af\u5b9a\u8bf4\uff0c\u90a3\u6211\u80af\u5b9a\u4e70\u53ef\u8f6c\u6362\u554a\uff0c\u81ea\u7531\u561b\uff0c\u592a\u5929\u771f\u4e86\u9a9a\u5e74\uff0c\u4efb\u4f55\u81ea\u7531\u90fd\u662f\u6709\u4ee3\u4ef7\u7684\uff0c\u53ef\u8f6c\u6362\u7684\u4ef7\u683c\u4f1a\u6bd4\u6807\u51c6\u8d35\u54e6~ Instance Type\uff1a \u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\uff0c\u9009\u62e9\u4f60\u8981\u4e70\u7684\u673a\u578b\u3002 Term\uff1a \u8fd9\u4e2a\u5f88\u5173\u952e\u4e86\uff0c\u4e70\u4e00\u5e74\u8fd8\u662f\u4e70\u4e09\u5e74\uff0c\u4e09\u5e74\u7684\u6298\u6263\u7070\u5e38\u5927\u54e6~ Payment Option\uff1a No Upfront(\u65e0\u9884\u4ed8\uff0c\u6298\u7b97\u5230\u6bcf\u6708\u652f\u4ed8\uff0c\u540e\u4ed8\u8d39)\uff1bPartial Upfront\uff08\u9884\u4ed8\u90e8\u5206\uff0c\u5269\u4f59\u7684\u6298\u7b97\u5230\u6bcf\u6708\u652f\u4ed8\uff0c\u540e\u4ed8\u8d39\uff09\uff1bAll Upfront\uff08\u5168\u9884\u4ed8\uff0c\u4e00\u6b21\u6027\u4ed8\u6e05\uff0c\u6700\u4fbf\u5b9c\uff09 ok\uff0c\u5404\u4f4d\u4eb2\u4eec\u8d2d\u7269\u8f66\u6dfb\u52a0\u5b8c\u6bd5\u4e4b\u540e\uff0c\u53ef\u4ee5\u70b9\u51fb \u67e5\u770b\u8d2d\u7269\u8f66 \u51fa\u6765\u4e0b\u9762\u7684\u754c\u9762,\u663e\u793a\u4e86\u6211\u4eec\u4e0a\u4e00\u6b65\u6240\u9009\u7684\u4fe1\u606f\uff08PS: r5.4xlarge = 16vCPU, 128G\u5185\u5b58\uff09\u3002\u6ce8\u610f\u8fd9\u91cc\u6709\u4e2atip\uff0c\u5c31\u662f\u6709\u4e2a Order On(\u8ba2\u8d2d\u65f6\u95f4) \u9009\u9879\u3002 \u70b9\u51fb Order On(\u8ba2\u8d2d\u65f6\u95f4) \u8fdb\u53bb\u53ef\u4ee5\u9009\u62e9\u8fd9\u4e2a\u673a\u5668\u8d2d\u4e70\u751f\u6548\u7684\u65f6\u95f4\uff0c\u6bd4\u5982\u6211\u57286\u67081\u53f7\u8ba2\u8d2d\u4f46\u662f\u5e0c\u671b\u57286\u670828\u53f70\u70b9\u5f00\u59cb\u751f\u6548\u3002\u6709\u540c\u5b66\u8981\u95ee\u4e86\uff0c\u8fd9\u4e2a\u4e1c\u897f\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u55ef\u3002\u3002\u3002\u8bd5\u60f3\u67d0\u516c\u53f81\u6708\u4e70\u4e863\u53f0\uff0c\u8fc7\u4e86\u5341\u51e0\u5929\u53c8\u4e70\u4e863\u53f0\uff0c\u4e0b\u4e2a\u6708\u53c8\u4e70\u4e863\u53f0\uff0c\u90fd\u662f\u5305\u4e00\u5e74\uff0c\u90a3\u4e48\u5728\u660e\u5e74\u7684\u5bf9\u5e94\u65f6\u95f4\u70b9\uff0c\u662f\u4e0d\u662f\u8981\u5206\u522b\u4e0b\u4e09\u6b21\u5355\uff0c\u591a\u9ebb\u70e6\u554a\uff01\u6709\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c\u6211\u5c31\u53ef\u4ee5\u4e00\u6b21\u4e0b\u5355\u628a\u673a\u5668\u90fd\u4e70\u4e86\uff0c\u8bbe\u5b9a\u597d\u751f\u6548\u65f6\u95f4\uff0c\u4e5f\u4e0d\u4f1a\u6d6a\u8d39\u53bb\u5e74\u82b1\u51fa\u53bb\u7684\u94f6\u5b50\u3002\u8fd9\u91cc\u8fd8\u662f\u8981\u8d5e\u4e00\u4e0bAWS \u5ba2\u6237\u81f3\u4e0a\u7684\u4f01\u4e1a\u6587\u5316\u3002 OK, \u786e\u8ba4\u4fe1\u606f\u65e0\u8bef\uff0c\u751f\u6548\u65f6\u95f4\u4e5f\u8bbe\u597d\u4e86\uff08\u9ed8\u8ba4\u662f\u4e0b\u5355\u7684\u90a3\u4e00\u523b\u8d77\u751f\u6548\uff09\uff0c\u90a3\u5c31\u70b9\u51fb\u4e0b\u5355\u5427\uff0cOrder\uff01\u4e4b\u540e\u5c31\u53ef\u4ee5\u5728\u9884\u7559\u5b9e\u4f8b\u754c\u9762\u770b\u5230\u6211\u4e70\u7684\u673a\u5668\u4e86\u3002 \u6700\u540e\u4e00\u6b65\uff0c\u628a\u4e70\u7684\u673a\u5668\u90fd\u5f00\u8d77\u6765\uff0c\u5f00\u59cb\u6211\u7684AWS\u4e91\u7aef\u5f81\u7a0b\uff01 \u8d2d\u4e70\u5176\u4ed6\u5305\u5e74\u5b9e\u4f8b \u8bf7\u53c2\u8003EC2\u7684\u5b9e\u4f8b\u8d2d\u4e70\u65b9\u5f0f\uff0c\u5bf9\u5e94\u7684\u670d\u52a1\u63a7\u5236\u53f0\u5de6\u4fa7\u5bfc\u822a\u680f\u90fd\u4f1a\u6709 \u9884\u7559\u5b9e\u4f8b \u7684\u6309\u94ae\u6765\u4f9b\u6211\u4eec\u8d2d\u4e70\u3002 \u5982\u6709\u5176\u4ed6\u4e0d\u6e05\u695a\u7684\uff0c\u4e5f\u53ef\u4ee5\u5728\u7fa4\u91cc\u95ee\u5404\u4f4d\u9aa8\u7070\u7ea7\u5927\u795e\u3002 EC2\u4ef7\u683c\u53c2\u8003\uff1a \u70b9\u6211 \u4e0d\u5fc5\u4e3a\u4e86\u7528\u7535\u706f\uff0c\u800c\u53bb\u9020\u4e00\u5ea7\u53d1\u7535\u5382\uff0c\u4e91\u4e5f\u662f\u5982\u6b64\u3002","title":"\u5165\u95e816-\u901a\u8fc7\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\u663e\u8457\u964d\u4f4e\u6210\u672c"},{"location":"blogs/2020-06-06-purchase-RI/#16-","text":"\u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e91\u4e0a\u8d44\u6e90\u7684\u9700\u6c42\u662f\u660e\u786e\u800c\u6301\u7eed\u7684\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\uff08Reserved Instance\uff09\uff0c\u571f\u8c6a\u9664\u5916\u3002\u6b63\u5982\u6bcf\u4e2a\u4eba\u7684\u624b\u673a\u90fd\u6709\u4e00\u4e2a\u5957\u9910\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff1a \u6211\u4eec\u53ef\u4ee5\u62ff\u5230\u6309\u9700\u5b9e\u4f8b3\u6298\u5de6\u53f3\u7684\u4ef7\u683c\u6765\u957f\u671f\u8fd0\u884c\u6211\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u800c\u4e0d\u9700\u8981\u9891\u7e41\u5173\u673a\u3002 -- D.C \u6211\u4eec\u77e5\u9053AWS\u6709\u4e09\u79cd\u5b9e\u4f8b\u7c7b\u578b\uff1a\u6309\u9700\u5b9e\u4f8b\uff08\u5355\u4ef7\u6700\u9ad8\uff09\uff0c\u9884\u7559\u5b9e\u4f8b\uff08\u4fbf\u5b9c\uff0c\u53051/3\u5e74\uff09\uff0c\u7ade\u4ef7\u5b9e\u4f8b\uff08\u4fbf\u5b9c\uff0c\u53ef\u80fd\u88ab\u4e2d\u65ad\uff09\u3002 \u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u4e0b\u8fd9\u51e0\u79cd\u7c7b\u578b\u5427\uff1a \u6309\u9700\u5b9e\u4f8b\uff1a \u968f\u7528\u968f\u5f00\uff0c\u7528\u5b8c\u5c31\u5173\u3002\u81ea\u7531\u4e0d\u7f81\u7684\u540c\u65f6\u8981\u4ed8\u51fa\u4ee3(\u9ad8)\u4ef7\u3002 \u9884\u7559\u5b9e\u4f8b\uff1a \u7a33\u624e\u7a33\u6253\uff0c\u53051\u5e74\u6216\u4e09\u5e74\uff0c\u62ff\u6700\u4f4e\u6298\u6263\u3002\uff08\u5e73\u5747\u52303\u6298\uff09 \u7ade\u4ef7\u5b9e\u4f8b\uff1a \u7ade\u4ef7\u65b9\u5f0f\u53d6\u5f97\u7a7a\u95f2\u8d44\u6e90\u4f7f\u7528\u6743\uff0c\u4e0d\u9700\u8981\u627f\u8bfa\u5305\u5e74\uff0c\u540c\u65f6\u4ef7\u683c\u53ea\u6bd4\u9884\u7559\u9ad8\u4e00\u70b9\u70b9\uff0c\u53ef\u4ee5\u8bf4\u662f\u517c\u987e\u4e86\u81ea\u7531\u4e0d\u7f81\u7684\u4f7f\u7528+\u7a33\u624e\u7a33\u6253\u7684\u4ef7\u683c\uff0c\u4f46\u662f\u3002\u3002\u3002\u91cd\u8981\u7684\u4e8b\u60c5\u8bf4\u4e09\u904d\uff0c\u7a7a\u95f2\u8d44\u6e90\u5982\u679c\u88ab\u7cfb\u7edf\u6536\u56de\uff0c\u8fd0\u884c\u7684\u4efb\u52a1\u4f1a\u88ab\u4e2d\u65ad\u3002\u56e0\u6b64\u9002\u7528\u4e8e\u5206\u6790\u65f6\u95f4\u4e0d\u957f\u7684\u4efb\u52a1\uff0c\u6216\u8005\u81ea\u5df1\u505a\u597d\u4e86\u4e2d\u65ad\u540e\u91cd\u8dd1\u7684\u8c03\u5ea6\u7cfb\u7edf\uff0c\u5982\u6b64\u8fd9\u822c\u7ade\u4ef7\u5b9e\u4f8b\u662f\u6700\u9002\u5408\u7684\u3002 \u597d\u4e86\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u672c\u6587\u4ecb\u7ecd\u7684\u662f\u5982\u4f55\u5728aws console\u63a7\u5236\u9762\u677f\u4e0a\u8d2d\u4e70\u9884\u7559\u5b9e\u4f8b\uff0c\u8001\u7528\u6237\u76f4\u63a5\u70b9\u53f3\u4e0a\u65b9\u7684X\u5173\u95ed\uff0c\u4f60\u4eec\u7528\u7684\u6bd4\u6211\u719f :)","title":"\u5165\u95e816-\u901a\u8fc7\u8d2d\u4e70\u5305\u5e74\u5b9e\u4f8b\u663e\u8457\u964d\u4f4e\u6210\u672c"},{"location":"blogs/2020-06-06-purchase-RI/#ec2","text":"\u767b\u5f55web\u754c\u9762\uff0c\u8fdb\u5165EC2\u63a7\u5236\u53f0,\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u680f\u7684Reserve Instance\uff08\u9884\u7559\u5b9e\u4f8b\uff09\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u524d\u6ca1\u6709\u4e70\u8fc7\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53f3\u4fa7\u7684\u8d2d\u4e70\u5217\u8868\u662f\u7a7a\u7a7a\u5982\u4e5f\u3002\u5982\u679c\u6709\u4e70\u8fc7\u5c31\u4f1a\u663e\u793a\u51fa\u8d2d\u4e70\u673a\u5668\u7684\u5230\u671f\u65f6\u95f4\u7b49\u4fe1\u606f\u3002 \u70b9\u51fb\u6309\u94ae Purchase Reserved Instances\uff08\u8d2d\u4e70\u9884\u7559\u5b9e\u4f8b\uff09\u3002 \u968f\u540e\u5728\u8df3\u51fa\u6765\u7684\u754c\u9762\u4e0a\u9009\u62e9\u6211\u4eec\u8981\u4e70\u7684\u673a\u5668\u4fe1\u606f\uff0c\u9009\u62e9\u641c\u7d22\uff0c\u51fa\u6765\u4ef7\u683c\u4ee5\u540e\uff0c\u4fee\u6539\u6240\u8981\u8d2d\u4e70\u7684\u53f0\u6570\uff0c\u52a0\u5165\u8d2d\u7269\u8f66\u3002 Platform\uff1a \u7cfb\u7edf\u9009\u62e9\uff0cwindows\uff0clinux\u7b49 Tenancy: \u9ed8\u8ba4\u5c31\u597d Offering Class: Standard \uff08\u6807\u51c6\uff09\u8fd8\u662f \u53ef\u8f6c\u6362 \uff08convertible\uff09, \u533a\u522b\u662f\uff0c\u5047\u5982\u6211\u4e70\u4e86c\u7cfb\u5217\u7684\u673a\u578bc5.2xlarge\uff0c\u524d\u8005\uff08\u6807\u51c6\uff09\u5141\u8bb8\u6211\u5728\u540c\u6837\u7684c\u7cfb\u5217\u673a\u578b\u4e2d\u8fdb\u884c\u81ea\u52a8\u8d44\u6e90\u5339\u914d,\u4f8b\u5982\u6211\u53ef\u4ee5\u5f00\u4e24\u53f0c5.xlarge\u540c\u6837\u4eab\u53d7\u5305\u5e74\u7684\u6298\u6263\u4ef7\uff1b\u540e\u8005\uff08\u53ef\u8f6c\u6362\uff09\u9664\u4e86\u540c\u7cfb\u5217\u673a\u578b\u5916\uff0c\u8fd8\u5141\u8bb8\u6211\u5728\u5176\u4ed6\u673a\u578b\u4f8b\u5982r\u7cfb\u5217\u6216m\u7cfb\u5217\u673a\u578b\u8fdb\u884c\u81ea\u52a8\u8d44\u6e90\u5339\u914d\u3002\u8bf4\u5230\u8fd9\u91cc\u6709\u540c\u5b66\u80af\u5b9a\u8bf4\uff0c\u90a3\u6211\u80af\u5b9a\u4e70\u53ef\u8f6c\u6362\u554a\uff0c\u81ea\u7531\u561b\uff0c\u592a\u5929\u771f\u4e86\u9a9a\u5e74\uff0c\u4efb\u4f55\u81ea\u7531\u90fd\u662f\u6709\u4ee3\u4ef7\u7684\uff0c\u53ef\u8f6c\u6362\u7684\u4ef7\u683c\u4f1a\u6bd4\u6807\u51c6\u8d35\u54e6~ Instance Type\uff1a \u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\uff0c\u9009\u62e9\u4f60\u8981\u4e70\u7684\u673a\u578b\u3002 Term\uff1a \u8fd9\u4e2a\u5f88\u5173\u952e\u4e86\uff0c\u4e70\u4e00\u5e74\u8fd8\u662f\u4e70\u4e09\u5e74\uff0c\u4e09\u5e74\u7684\u6298\u6263\u7070\u5e38\u5927\u54e6~ Payment Option\uff1a No Upfront(\u65e0\u9884\u4ed8\uff0c\u6298\u7b97\u5230\u6bcf\u6708\u652f\u4ed8\uff0c\u540e\u4ed8\u8d39)\uff1bPartial Upfront\uff08\u9884\u4ed8\u90e8\u5206\uff0c\u5269\u4f59\u7684\u6298\u7b97\u5230\u6bcf\u6708\u652f\u4ed8\uff0c\u540e\u4ed8\u8d39\uff09\uff1bAll Upfront\uff08\u5168\u9884\u4ed8\uff0c\u4e00\u6b21\u6027\u4ed8\u6e05\uff0c\u6700\u4fbf\u5b9c\uff09 ok\uff0c\u5404\u4f4d\u4eb2\u4eec\u8d2d\u7269\u8f66\u6dfb\u52a0\u5b8c\u6bd5\u4e4b\u540e\uff0c\u53ef\u4ee5\u70b9\u51fb \u67e5\u770b\u8d2d\u7269\u8f66 \u51fa\u6765\u4e0b\u9762\u7684\u754c\u9762,\u663e\u793a\u4e86\u6211\u4eec\u4e0a\u4e00\u6b65\u6240\u9009\u7684\u4fe1\u606f\uff08PS: r5.4xlarge = 16vCPU, 128G\u5185\u5b58\uff09\u3002\u6ce8\u610f\u8fd9\u91cc\u6709\u4e2atip\uff0c\u5c31\u662f\u6709\u4e2a Order On(\u8ba2\u8d2d\u65f6\u95f4) \u9009\u9879\u3002 \u70b9\u51fb Order On(\u8ba2\u8d2d\u65f6\u95f4) \u8fdb\u53bb\u53ef\u4ee5\u9009\u62e9\u8fd9\u4e2a\u673a\u5668\u8d2d\u4e70\u751f\u6548\u7684\u65f6\u95f4\uff0c\u6bd4\u5982\u6211\u57286\u67081\u53f7\u8ba2\u8d2d\u4f46\u662f\u5e0c\u671b\u57286\u670828\u53f70\u70b9\u5f00\u59cb\u751f\u6548\u3002\u6709\u540c\u5b66\u8981\u95ee\u4e86\uff0c\u8fd9\u4e2a\u4e1c\u897f\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u55ef\u3002\u3002\u3002\u8bd5\u60f3\u67d0\u516c\u53f81\u6708\u4e70\u4e863\u53f0\uff0c\u8fc7\u4e86\u5341\u51e0\u5929\u53c8\u4e70\u4e863\u53f0\uff0c\u4e0b\u4e2a\u6708\u53c8\u4e70\u4e863\u53f0\uff0c\u90fd\u662f\u5305\u4e00\u5e74\uff0c\u90a3\u4e48\u5728\u660e\u5e74\u7684\u5bf9\u5e94\u65f6\u95f4\u70b9\uff0c\u662f\u4e0d\u662f\u8981\u5206\u522b\u4e0b\u4e09\u6b21\u5355\uff0c\u591a\u9ebb\u70e6\u554a\uff01\u6709\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c\u6211\u5c31\u53ef\u4ee5\u4e00\u6b21\u4e0b\u5355\u628a\u673a\u5668\u90fd\u4e70\u4e86\uff0c\u8bbe\u5b9a\u597d\u751f\u6548\u65f6\u95f4\uff0c\u4e5f\u4e0d\u4f1a\u6d6a\u8d39\u53bb\u5e74\u82b1\u51fa\u53bb\u7684\u94f6\u5b50\u3002\u8fd9\u91cc\u8fd8\u662f\u8981\u8d5e\u4e00\u4e0bAWS \u5ba2\u6237\u81f3\u4e0a\u7684\u4f01\u4e1a\u6587\u5316\u3002 OK, \u786e\u8ba4\u4fe1\u606f\u65e0\u8bef\uff0c\u751f\u6548\u65f6\u95f4\u4e5f\u8bbe\u597d\u4e86\uff08\u9ed8\u8ba4\u662f\u4e0b\u5355\u7684\u90a3\u4e00\u523b\u8d77\u751f\u6548\uff09\uff0c\u90a3\u5c31\u70b9\u51fb\u4e0b\u5355\u5427\uff0cOrder\uff01\u4e4b\u540e\u5c31\u53ef\u4ee5\u5728\u9884\u7559\u5b9e\u4f8b\u754c\u9762\u770b\u5230\u6211\u4e70\u7684\u673a\u5668\u4e86\u3002 \u6700\u540e\u4e00\u6b65\uff0c\u628a\u4e70\u7684\u673a\u5668\u90fd\u5f00\u8d77\u6765\uff0c\u5f00\u59cb\u6211\u7684AWS\u4e91\u7aef\u5f81\u7a0b\uff01","title":"\u8d2d\u4e70EC2\u9884\u7559\u5b9e\u4f8b"},{"location":"blogs/2020-06-06-purchase-RI/#_1","text":"\u8bf7\u53c2\u8003EC2\u7684\u5b9e\u4f8b\u8d2d\u4e70\u65b9\u5f0f\uff0c\u5bf9\u5e94\u7684\u670d\u52a1\u63a7\u5236\u53f0\u5de6\u4fa7\u5bfc\u822a\u680f\u90fd\u4f1a\u6709 \u9884\u7559\u5b9e\u4f8b \u7684\u6309\u94ae\u6765\u4f9b\u6211\u4eec\u8d2d\u4e70\u3002 \u5982\u6709\u5176\u4ed6\u4e0d\u6e05\u695a\u7684\uff0c\u4e5f\u53ef\u4ee5\u5728\u7fa4\u91cc\u95ee\u5404\u4f4d\u9aa8\u7070\u7ea7\u5927\u795e\u3002 EC2\u4ef7\u683c\u53c2\u8003\uff1a \u70b9\u6211 \u4e0d\u5fc5\u4e3a\u4e86\u7528\u7535\u706f\uff0c\u800c\u53bb\u9020\u4e00\u5ea7\u53d1\u7535\u5382\uff0c\u4e91\u4e5f\u662f\u5982\u6b64\u3002","title":"\u8d2d\u4e70\u5176\u4ed6\u5305\u5e74\u5b9e\u4f8b"},{"location":"blogs/2020-12-31-final-day-of-2020/","text":"final day of 2020 \u4f60\u4f1a\u53d1\u73b0\u81ea\u5df1\u6210\u957f\u4e86\uff01A party for you! Stay tuned. -- D.C","title":"2020 12 31 final day of 2020"},{"location":"blogs/2020-12-31-final-day-of-2020/#final-day-of-2020","text":"\u4f60\u4f1a\u53d1\u73b0\u81ea\u5df1\u6210\u957f\u4e86\uff01A party for you! Stay tuned. -- D.C","title":"final day of 2020"}]}